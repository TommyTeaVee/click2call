function tsk_buff_str2ib(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;for(var e=_.length,t=new Array(e),s=0;e>s;++s)t[s]=_.charCodeAt(s);return t}function tsk_buff_ab2str(_){return tsk_buff_u8b2ascii(new Uint8Array(_))}function tsk_buff_u8b2ascii(_){for(var e=new String,t=void 0==_.byteLength?_.length:_.byteLength,s=0;t>s;++s)e+=String.fromCharCode(255&_[s]);return e}function tsk_buff_u8b2utf8(_){try{for(var e,t=new String,s=void 0==_.byteLength?_.length:_.byteLength,i=0;s>i;)e=_[i],128>e?(t+=String.fromCharCode(e),++i):e>191&&224>e?(t+=String.fromCharCode((31&e)<<6|63&_[i+1]),i+=2):(t+=String.fromCharCode((15&e)<<12|(63&_[i+1])<<6|63&_[i+2]),i+=3);return t}catch(r){return tsk_utils_log_error(r),tsk_buff_u8b2ascii(_)}}function tsk_buff_str2u8b(_){for(var e=new Uint8Array(_.length),t=0;t<_.length;++t)e[t]=255&_[t].charCodeAt(0);return e}function tsk_fsm(_,e,t,s){this.i_state_curr=_,this.i_state_term=e,this.fn_onterm=t,this.o_usr_data=s,this.ao_entries=new Array,this.b_debug=!1}function tsk_fsm_entry(_,e,t,s,i,r){this.i_state_from=_,this.i_action=e,this.fn_condition=t,this.i_state_to=s,this.fn_execute=i,this.s_description=r}function tsk_fsm_entry_compare(_,e){return _&&e?_.i_state_from==tsk_fsm.prototype.__i_state_any?20:e.i_state_from==tsk_fsm.prototype.__i_state_any?-20:_.i_action==tsk_fsm.prototype.__i_action_any?10:e.i_action==tsk_fsm.prototype.__i_action_any?-10:_.fn_condition?-1:e.fn_condition?1:0:0}function tsk_param_create(_,e){var t=new Object;return t.s_name=_,t.s_value=e,t.b_tag=!1,t}function tsk_param_create_null(){return tsk_param_create(null,null)}function tsk_param_parse(_){if(!tsk_string_is_null_or_empty(_)){var e=0,t=_.length,s=tsk_string_index_of(_,t,"="),i=null,r=null;return s>=0&&t>s?(i=_.substring(e,e+(s-e)),r=_.substring(s+1,s+(t-s))):i=_,tsk_param_create(i,r)}return null}function tsk_param_get_index_by_name(_,e){if(_&&!tsk_string_is_null_or_empty(e))for(var t=e.toLowerCase(),s=0;s<_.length;++s)if(_[s].s_name.toLowerCase()==t)return s;return-1}function tsk_param_get_by_name(_,e){var t=tsk_param_get_index_by_name(_,e);return-1!=t?_[t]:null}function tsk_param_get_value_by_name(_,e){var t=tsk_param_get_by_name(_,e);return t?t.s_value:null}function tsk_params_have_param(_,e){return null!=tsk_param_get_by_name(_,e)}function tsk_params_add(_,e,t){if(_&&!tsk_string_is_null_or_empty(e)){var s=tsk_param_get_index_by_name(_,e);-1!=s?_[s].s_value=t:_.push(tsk_param_create(e,t))}}function tsk_params_add_param(_,e){_&&e&&tsk_params_add(_,e.s_name,e.s_value)}function tsk_params_remove_by_name(_,e){if(_&&!tsk_string_is_null_or_empty(e)){var t=tsk_param_get_index_by_name(_,e);-1!=t&&_.splice(t,1)}}function tsk_param_tostring(_){return _&&_.s_name?tsk_string_is_null_or_empty(_.s_value)?_.s_name:_.s_name+"="+_.s_value:""}function tsk_params_tostring(_,e){var t="";if(_)for(var s=0;s<_.length;++s)tsk_string_is_null_or_empty(t)||(t+=e),t+=tsk_param_tostring(_[s]);return t}function tsk_ragel_state_create(){var _=new Object;return tsk_ragel_state_init(_,null,0),_}function tsk_ragel_state_init(_,e,t){_.i_cs=0,_.i_p=0,_.i_pe=t,_.o_data=e,_.s_data=null,_.i_eof=0,_.i_tag_start=0,_.i_tag_end=t}function tsk_ragel_state_init_ai(_,e){return tsk_ragel_state_init_str(_,tsk_buff_ab2str(e))}function tsk_ragel_state_init_str(_,e){tsk_ragel_state_init(_,tsk_buff_str2ib(e),e.length),_.s_data=e}function tsk_ragel_parser_get_string(_,e,t){var s=e-t,i=null;return s>0&&(i=_.substring(t,t+s)),i}function tsk_ragel_parser_get_int(_,e,t){var s=0,i=tsk_ragel_parser_get_string(_,e,t);return tsk_string_is_null_or_empty(i)||(s=parseInt(i)),s}function tsk_ragel_parser_get_param(_,e,t){if(!tsk_string_is_null_or_empty(_)){var s=e-t;return tsk_param_parse(_.substring(t,t+s))}return null}function tsk_ragel_add_param(_,e,t,s){var i=tsk_ragel_parser_get_param(_,e,t);i&&s.push(i)}function tsk_ragel_parser_add_string(_,e,t,s){var i=tsk_ragel_parser_get_string(_,e,t);return tsk_string_is_null_or_empty(i)||s.push(i),s}function tsk_ragel_scanner_get_string(_,e,t){var s=t-e,i=null;return s>0&&(i=_.substring(e,e+s)),i}function tsk_ragel_scanner_get_int(_,e,t){var s=tsk_ragel_scanner_get_string(_,e,t);return s?parseInt(s):0}function tsk_tagel_scanner_add_param(_,e,t){if(t&&!tsk_string_is_null_or_empty(_)){var s=te-ts,i=tsk_param_parse(_.substring(i_ts,i_ts+s));t.push(i)}}function tsk_string_is_null_or_empty(_){return!_||""==_}function tsk_string_is_string(_){return _ instanceof String||"string"==typeof _}function tsk_string_index_of(_,e,t){var s=-1;return _&&t&&(s=_.indexOf(t)),e>s?s:-1}function tsk_string_contains(_,e,t){return tsk_string_index_of(_,e,t)>=0}function tsk_string_unquote(_,e,t){var s=_;if(s){var i=s.length;i>=2&&s[0]==e&&s[i-1]==t&&(s=_.substring(1,i-1))}return s}function tsk_string_unquote_2(_){return tsk_string_unquote(_,'"','"')}function tsk_strdup(_){return _?new String(_).toString():_}function tsk_string_format(_){for(var e=1;e<arguments.length;e++){var t=new RegExp("\\{"+(e-1)+"\\}","gi");_=_.replace(t,arguments[e])}return _}function tsk_string_equals(_,e){return _==e}function tsk_string_iequals(_,e){return _&&e?_.toLowerCase()==e.toLowerCase():_==e}function tsk_string_random_from_dict(_,e){for(var t="",s=0;_>s;s++)t+=e[Math.floor(Math.random()*e.length)];return t}function tsk_string_random(_){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";return tsk_string_random_from_dict(_,e)}function tsk_string_random_uuid(){var _="0123456789abcdef";return tsk_string_format("{0}-{1}-{2}-{3}-{4}",tsk_string_random_from_dict(8,_),tsk_string_random_from_dict(4,_),tsk_string_random_from_dict(4,_),tsk_string_random_from_dict(4,_),tsk_string_random_from_dict(12,_))}function tsk_string_to_int(_,e){try{return parseInt(_)}catch(t){return e}}function tsk_string_to_object(s_str){if(!tsk_string_is_null_or_empty(s_str))try{return eval("var obj = "+s_str+";"),obj}catch(e){}}function tsk_string_parse_url(_){if(!_)return tsk_utils_log_error("Invalid argument"),null;var e=_.indexOf("://"),t=_.lastIndexOf(":");if(-1==e||-1==t)return tsk_utils_log_error(_+" not valid as url"),null;var s=new Array;s.push(_.substring(0,e)),s.push(_.substring(e+3,t));try{var i=_.substring(e+3).indexOf("/");-1==i?s.push(parseInt(_.substring(t+1),10)):(s.push(parseInt(_.substring(t+1,i+e+3),10)),s.push(_.substring(i+e+3+1)))}catch(r){return tsk_utils_log_error(r),null}return s}function tsk_utils_init_webrtc(){WebRtc4all_Init()}function tsk_utils_have_websocket(){try{return!!window.WebSocket}catch(_){return!1}}function tsk_utils_have_webrtc(){return WebRtc4all_GetType()!=WebRtcType_e.NONE}function tsk_utils_have_webrtc4all(){return tsk_utils_have_webrtc4npapi()||tsk_utils_have_webrtc4ie()}function tsk_utils_have_webrtc4npapi(){return WebRtc4all_GetType()==WebRtcType_e.NPAPI}function tsk_utils_have_webrtc4ie(){return WebRtc4all_GetType()==WebRtcType_e.IE}function tsk_utils_have_webrtc4native(){return WebRtc4all_GetType()==WebRtcType_e.NATIVE}function tsk_utils_have_webrtc4ericsson(){return WebRtc4all_GetType()==WebRtcType_e.ERICSSON}function tsk_utils_webrtc4all_get_version(){return WebRtc4all_GetVersion()}function tsk_utils_have_stream(){try{return tsk_utils_have_webrtc4all()||!!navigator.nativeGetUserMedia}catch(_){}return!1}function tsk_utils_get_navigator_friendly_name(){if(!__s_navigator_friendly_name&&(__s_navigator_friendly_name="unknown",navigator.userAgent||navigator.appName))for(var _=[{s_id:"chrome",s_name:"chrome"},{s_id:"firefox",s_name:"firefox"},{s_id:"safari",s_name:"safari"},{s_id:"opera",s_name:"opera"},{s_id:"microsoft internet explorer",s_name:"ie"},{s_id:"netscape",s_name:"netscape"}],e=navigator.userAgent?navigator.userAgent.toLowerCase():"null",t=navigator.appName?navigator.appName.toLowerCase():"null",s=0;s<_.length;++s)if(-1!=e.indexOf(_[s].s_id)||-1!=t.indexOf(_[s].s_id)){__s_navigator_friendly_name=_[s].s_name;break}return __s_navigator_friendly_name}function tsk_utils_get_system_friendly_name(){if(!__s_system_friendly_name&&(__s_system_friendly_name="unknown",navigator.appVersion))for(var _=[{s_id:"mac",s_name:"mac"},{s_id:"powerpc",s_name:"powerpc"},{s_id:"win",s_name:"windows"},{s_id:"sunos",s_name:"sunos"},{s_id:"linux",s_name:"linux"}],e=navigator.appVersion.toLowerCase(),t=0;t<_.length;++t)if(-1!=e.indexOf(_[t].s_id)){__s_system_friendly_name=_[t].s_name;break}return __s_system_friendly_name}function tsk_utils_log_set_level(_){__i_debug_level=_}function tsk_utils_log_info(_){window.console&&__i_debug_level>=4&&tsk_utils_log("info",_)}function tsk_utils_log_warn(_){window.console&&__i_debug_level>=3&&tsk_utils_log("warn",_)}function tsk_utils_log_error(_){window.console&&__i_debug_level>=2&&tsk_utils_log("error",_)}function tsk_utils_log(_,e){if(window.console&&window.console[_]){var t=new Date;window.console[_]("["+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+"] "+e)}}function tsk_utils_log_fatal(_){__i_debug_level>=1&&tsk_utils_log_error(_)}function WebRtc4all_Init(){if(!__b_webrtc4all_initialized){try{var _=document.createElement("embed");_.id="WebRtc4npapi",_.type="application/w4a",_.width=_.height="1px",_.stype="visibility:hidden;",document.body.appendChild(_)}catch(e){}try{__webrtc_type==WebRtcType_e.NONE&&(window.nativeRTCPeerConnection=window.webkitPeerConnection00||window.webkitRTCPeerConnection||window.mozRTCPeerConnection,window.nativeRTCSessionDescription=window.mozRTCSessionDescription||window.RTCSessionDescription,window.nativeRTCIceCandidate=window.mozRTCIceCandidate||window.RTCIceCandidate,window.nativeURL=window.webkitURL||window.URL,navigator.nativeGetUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.nativeGetUserMedia&&window.nativeRTCPeerConnection?__webrtc_type=WebRtcType_e.NATIVE:navigator.nativeGetUserMedia&&window.webkitPeerConnection&&(__webrtc_type=WebRtcType_e.ERICSSON))}catch(e){}if(__webrtc_type==WebRtcType_e.NONE||__webrtc_type==WebRtcType_e.W4A)try{(__b_webrtc4ie_peerconn=new ActiveXObject("webrtc4ie.PeerConnection"))&&(__webrtc_type=WebRtcType_e.IE)}catch(e){WebRtc4npapi.supportsPeerConnection&&(__webrtc_type=WebRtcType_e.NPAPI)}__b_webrtc4all_initialized=!0,navigator.nativeGetUserMedia&&WebRtc4all_GetType()==WebRtcType_e.ERICSSON&&navigator.nativeGetUserMedia("audio, video",function(_){tsk_utils_log_info("Got stream :)"),__o_roap_stream=_},function(_){tsk_utils_log_error(_)})}}function WebRtc4all_GetVersion(){try{if(__webrtc_type==WebRtcType_e.IE)return __b_webrtc4ie_peerconn.version;if(__webrtc_type==WebRtcType_e.NPAPI)return WebRtc4npapi.version}catch(_){}return"0.0.0.0"}function WebRtc4all_SetType(_){if(__webrtc_type!=WebRtcType_e.NONE)return tsk_utils_log_error("Trying not set default webrtc type after init() is not allowed"),!1;switch(_){case"w4a":__webrtc_type=WebRtcType_e.W4A;break;case"ericsson":__webrtc_type=WebRtcType_e.ERICSSON;break;case"native":__webrtc_type=WebRtcType_e.NATIVE;break;default:return tsk_utils_log_error("["+_+"] not valid as default webrtc type"),!1}return!0}function WebRtc4all_GetType(){return __webrtc_type}function WebRtc4all_GetLooper(){if(void 0==__looper&&tsk_utils_have_webrtc4ie())try{if(fakeLooper&&fakeLooper.hWnd)__looper=fakeLooper.hWnd;else if(__o_display_local&&__o_display_local.hWnd||__o_display_remote&&__o_display_remote.hWnd)__looper=__o_display_local&&__o_display_local.hWnd?__o_display_local.hWnd:__o_display_remote.hWnd;else{var _=document.createElement("object");_.classid="clsid:7082C446-54A8-4280-A18D-54143846211A",_.width=_.height="1px",document.body.appendChild(_),__looper=_.hWnd}__looper||tsk_utils_log_error("Failed to create looper. Your app may crash on IE11")}catch(e){tsk_utils_log_error(e),__looper=null}return __looper}function WebRtc4all_SetDisplays(_,e){__webrtc_type==WebRtcType_e.IE?(_&&(_.innerHTML='<object id="__o_display_local" classid="clsid:5C2C407B-09D9-449B-BB83-C39B7802A684" class="video" width="88px" height="72px" style="margin-top: -80px; margin-left: 5px; background-color: #000000; visibility:visible"> </object>',__o_display_local.style.visibility="hidden"),e&&(e.innerHTML='<object id="__o_display_remote" classid="clsid:5C2C407B-09D9-449B-BB83-C39B7802A684" width="100%" height="100%" style="visibility:visible;"> </object>',__o_display_remote.style.visibility="hidden")):__webrtc_type==WebRtcType_e.NPAPI&&(_&&(_.innerHTML='<embed id="__o_display_local" type="application/w4a-display" class="video" width="88px" height="72px" style="margin-top: -80px; margin-left: 5px; background-color: #000000; visibility:visible"> </embed>',__o_display_local.style.visibility="hidden"),e&&(e.innerHTML='<embed id="__o_display_remote" type="application/w4a-display" width="100%" height="100%" style="visibility:visible;"> </embed>',__o_display_remote.style.visibility="hidden"))}function w4aSessionDescription(_){__b_webrtc4all_initialized||WebRtc4all_Init();var e=__webrtc_type==WebRtcType_e.IE;this.o_sdp=e?new ActiveXObject("webrtc4ie.SessionDescription"):WebRtc4npapi.createSessionDescription(),this.o_sdp.Init(_?_+"":null)}function w4aIceCandidate(_,e){this.media=_,this.label=e}function w4aPeerConnection(s_configuration,f_IceCallback){__b_webrtc4all_initialized||WebRtc4all_Init();var This=this,b_isInternetExplorer=__webrtc_type==WebRtcType_e.IE;this.s_configuration=s_configuration,this.f_IceCallback=f_IceCallback,this.o_peer=b_isInternetExplorer?new ActiveXObject("webrtc4ie.PeerConnection"):WebRtc4npapi.createPeerConnection(),this.o_peer.Init(s_configuration);try{this.o_peer.localVideo=window.__o_display_local?window.__o_display_local.hWnd:0}catch(e){}try{this.o_peer.remoteVideo=window.__o_display_remote?window.__o_display_remote.hWnd:0}catch(e){}b_isInternetExplorer?(eval("function This.o_peer::IceCallback(media, label, bMoreToFollow) { return This.onIceCallback (media, label, bMoreToFollow); }"),eval("function This.o_peer::Rfc5168Callback(command) { return This.onRfc5168Callback(command); }")):(this.o_peer.opaque=This,this.o_peer.setCallbackFuncName("w4aPeerConnection_NPAPI_OnEvent"),this.o_peer.setRfc5168CallbackFuncName&&this.o_peer.setRfc5168CallbackFuncName("w4aPeerConnection_NPAPI_OnRfc5168Event"))}function w4aPeerConnection_NPAPI_OnEvent(_,e,t,s){_.onIceCallback(e,t,s)}function w4aPeerConnection_NPAPI_OnRfc5168Event(_,e){_.onRfc5168Callback(e)}function tmedia_defaults_get_media_type(){return __tmedia_defaults_e_media_type}function tmedia_session_mgr(_,e,t,s,i,r){this.s_addr=e,this.s_public_addr=null,this.b_ipv6=t,this.fn_callback=i,this.o_usr_data=r,this.sdp={},this.sdp.i_lo_ver=-1,this.sdp.o_lo=null,this.sdp.i_ro_ver=-1,this.sdp.o_ro=null,this.o_stream_local=null,this.o_stream_remote=null,this.b_started=!1,this.b_ro_changed=!1,this.b_lo_changed=!1,this.b_state_changed=!1,this.b_media_type_changed=!1,this.e_type=_,this.ao_sessions=new Array,this.ao_params=new Array,void 0==__o_peerconnection_class&&(tsk_utils_have_webrtc4all()?(__o_peerconnection_class=w4aPeerConnection,__o_sessiondescription_class=w4aSessionDescription,__o_iceCandidate_class=w4aIceCandidate):tsk_utils_have_webrtc()&&(WebRtc4all_GetType()==WebRtcType_e.NATIVE?window.webkitPeerConnection00&&window.SessionDescription&&window.IceCandidate?(__o_peerconnection_class=window.webkitPeerConnection00,__o_sessiondescription_class=window.SessionDescription,__o_iceCandidate_class=window.IceCandidate):window.nativeRTCPeerConnection&&window.nativeRTCSessionDescription&&window.nativeRTCIceCandidate&&(__o_peerconnection_class=window.nativeRTCPeerConnection,__o_sessiondescription_class=window.nativeRTCSessionDescription,__o_iceCandidate_class=window.nativeRTCIceCandidate):WebRtc4all_GetType()==WebRtcType_e.ERICSSON&&window.webkitPeerConnection&&(__o_peerconnection_class=window.webkitPeerConnection)),tsk_utils_log_info("PeerConnectionClass = "+(__o_peerconnection_class||"unknown")+" SessionDescriptionClass = "+(__o_sessiondescription_class||"unknown")+" IceCandidateClass = "+(__o_iceCandidate_class||"unknown"))),s&&this.load_sessions()}function tmedia_session(_,e){this.e_type=_,this.b_ro_changed=!1,this.b_initialized=!1,this.b_prepared=!1,this.b_lo_held=!1,this.b_ro_held=!1,this.o_sdp=null,this.o_mgr=e}function tmedia_session_jsep(_){tmedia_session.call(this,_.e_type,_)}function tmedia_session_jsep00(_){tmedia_session_jsep.call(this,_)}function tmedia_session_jsep01(_){tmedia_session_jsep.call(this,_),"firefox"==tsk_utils_get_navigator_friendly_name()?(this.o_media_constraints={offerToReceiveAudio:!!(this.e_type.i_id&tmedia_type_e.AUDIO.i_id),offerToReceiveVideo:!!(this.e_type.i_id&tmedia_type_e.VIDEO.i_id)},tmedia_session_jsep01.mozThis=this,this.o_media_constraints.MozDontOfferDataChannel=!0):this.o_media_constraints={mandatory:{OfferToReceiveAudio:!!(this.e_type.i_id&tmedia_type_e.AUDIO.i_id),OfferToReceiveVideo:!!(this.e_type.i_id&tmedia_type_e.VIDEO.i_id)}}}function tmedia_session_roap(_){this.__proto__.__proto__=new tmedia_session(tmedia_type_e.AUDIO_VIDEO,_),this.e_state=tmedia_session_state_e.NONE,this.o_pc=null,this.o_pc_json=null,this.o_remote_stream=null,this.o_local_stream=null,this.o_sdp_json_lo=null,this.o_sdp_lo=null,this.o_sdp_json_ro=null,this.o_sdp_ro=null,this.b_ro_changed=!1,this.b_lo_held=!1,this.b_ro_held=!1}function tmedia_param(_,e,t,s){this.e_type=_,this.e_media_type=e,this.s_key=t,this.o_value=s}function tsdp_header(_){this.e_type=_}function tsdp_header_compare_by_rank(_,e){return _&&e?_.e_type.i_rank-e.e_type.i_rank:-1}function tsdp_header_A(_,e){tsdp_header.call(this,tsdp_header_type_e.A),this.s_field=_,this.s_value=e}function tsdp_header_C(_,e,t){tsdp_header.call(this,tsdp_header_type_e.C),this.s_nettype=_,this.s_addrtype=e,this.s_addr=t}function tsdp_header_M(_,e,t){tsdp_header.call(this,tsdp_header_type_e.M),this.s_media=_,this.i_port=e,this.i_nports=0,this.s_proto=t,this.as_fmt=new Array,this.o_hdr_I=null,this.o_hdr_C=null,this.ao_hdr_B=new Array,this.o_hdr_K=null,this.ao_hdr_A=new Array,this.ao_hdr_Dummy=new Array}function tsdp_header_O(_,e,t,s,i,r){tsdp_header.call(this,tsdp_header_type_e.O),this.s_username=_,this.i_sess_id=e,this.i_sess_version=t,this.s_nettype=s,this.s_addrtype=i,this.s_addr=r}function tsdp_header_Str(_,e){tsdp_header.call(this,_),this.s_value=e}function tsdp_header_B(_){tsdp_header_Str.call(this,tsdp_header_type_e.B,_)}function tsdp_header_E(_){tsdp_header_Str.call(this,tsdp_header_type_e.E,_)}function tsdp_header_I(_){tsdp_header_Str.call(this,tsdp_header_type_e.I,_)}function tsdp_header_K(_){tsdp_header_Str.call(this,tsdp_header_type_e.K,_)}function tsdp_header_P(_){tsdp_header_Str.call(this,tsdp_header_type_e.P,_)}function tsdp_header_R(_){tsdp_header_Str.call(this,tsdp_header_type_e.R,_)}function tsdp_header_S(_){tsdp_header_Str.call(this,tsdp_header_type_e.S,_)}function tsdp_header_T(_){tsdp_header_Str.call(this,tsdp_header_type_e.T,_)}function tsdp_header_U(_){tsdp_header_Str.call(this,tsdp_header_type_e.U,_)}function tsdp_header_Z(_){tsdp_header_Str.call(this,tsdp_header_type_e.Z,_)}function tsdp_header_Dummy(_,e){tsdp_header_Str.call(this,tsdp_header_type_e.DUMMY,e),this.s_name=_}function tsdp_header_V(_){tsdp_header.call(this,tsdp_header_type_e.V),this.i_version=_,this.toString=function(){return this.i_version.toString()}}function tsdp_message(_,e,t){this.ao_headers=new Array,_&&(this.add_headers(new tsdp_header_V(0),new tsdp_header_O(tsdp_message.prototype.__s_o_username_default,tsdp_message.prototype.__i_o_session_id_default,t,"IN",e?"IP6":"IP4",_)),this.add_headers(new tsdp_header_S(tsdp_message.prototype.__s_s_value_default)),this.add_headers(new tsdp_header_T(0,0)))}function tsip_action(_){this.e_type=_,this.ao_headers=new Array,this.o_content=null,this.line_resp={},this.line_resp.i_code=0,this.line_resp.s_phrase=null,this.media={},this.media.e_type=tmedia_type_e.NONE,this.media.ao_params=new Array,this.dtmf={},this.dtmf.i_volume=-1,this.dtmf.i_event=-1,this.ect={},this.ect.s_to=null}function tsip_event(_,e,t,s,i){this.init(_,e,t,s,i)}function tsip_message(_){this.s_version=tsip_message.prototype.__s_version_default,this.e_type=_,this.line={request:{},response:{}},this.o_hdr_firstVia=null,this.o_hdr_From=null,this.o_hdr_To=null,this.o_hdr_Contact=null,this.o_hdr_Call_ID=null,this.o_hdr_CSeq=null,this.o_hdr_Expires=null,this.o_hdr_Content_Type=null,this.o_hdr_Content_Length=null,this.o_content=null,this.ao_headers=new Array,this.s_sigcomp_id=null,this.o_socket=null,this.o_remote_addr=null,this.b_update=!1}function tsip_response(_,e,t){if(!e||!t)return tsk_utils_log_error("Invalid argument"),null;if(tsip_message.call(this,tsip_message_type_e.RESPONSE),this.line.response.i_status_code=_,this.line.response.s_reason_phrase=e,this.o_socket=t.o_socket,this.o_remote_addr=t.o_remote_addr,this.o_hdr_From=t.o_hdr_From,this.o_hdr_Call_ID=t.o_hdr_Call_ID,this.o_hdr_CSeq=t.o_hdr_CSeq,this.o_hdr_firstVia=t.o_hdr_firstVia,this.o_hdr_firstVia)for(var s,i=1;s=t.get_header_at(tsip_header_type_e.Via,i++);)this.add_header(s);for(var r,i=0;r=t.get_header_at(tsip_header_type_e.Record_Route,i++);)this.add_header(r);this.o_hdr_To=t.o_hdr_To,this.add_header(new tsip_header_Content_Length(0))}function tsip_request(_,e,t,s,i,r){return _&&e&&i?(tsip_message.call(this,tsip_message_type_e.REQUEST),this.line.request.s_method=_,this.line.request.o_uri=e,this.line.request.e_type=tsip_message.prototype.GetRequestType(_),this.add_headers(new tsip_header_CSeq(r,_),new tsip_header_Call_ID(i),new tsip_header_Max_Forwards(TSIP_HEADER_MAX_FORWARDS_DEFAULT),new tsip_header_Content_Length(0)),s&&this.add_headers(new tsip_header_To(s,null)),void(t&&this.add_headers(new tsip_header_From(t,null)))):(tsk_utils_log_error("Invalid argument"),null)}function prev_not_comma(_,e){return _.i_pe<=e||","!=_.o_data[e-1]}function tsip_message_parser_init(_){var e=0;e=tsip_machine_parser_message_start,_.i_cs=e}function tsip_message_parser_execute(_,e,t){var s,i,r,a,n,o,p,c,d,l,h,u=_.i_cs,m=_.i_p,g=_.i_pe,y=_.i_eof,f=_.o_data;for(s=i=r=a=n=null,o=0,p=10,c=15,d=20,l=30,h=40;;){if(_trigger_goto=!1,0>=o){if(m==g){o=l;continue}if(0==u){o=h;continue}}if(p>=o){r=_tsip_machine_parser_message_key_offsets[u],i=_tsip_machine_parser_message_index_offsets[u],s=_tsip_machine_parser_message_single_lengths[u],_break_match=!1;do{if(s>0){for(_lower=r,_upper=r+s-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),f[m]<_tsip_machine_parser_message_trans_keys[_mid])_upper=_mid-1;else{if(!(f[m]>_tsip_machine_parser_message_trans_keys[_mid])){i+=_mid-r,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;r+=s,i+=s}if(s=_tsip_machine_parser_message_range_lengths[u],s>0){for(_lower=r,_upper=r+(s<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),f[m]<_tsip_machine_parser_message_trans_keys[_mid])_upper=_mid-2;else{if(!(f[m]>_tsip_machine_parser_message_trans_keys[_mid+1])){i+=_mid-r>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;i+=s}}while(!1);if(i=_tsip_machine_parser_message_indicies[i],u=_tsip_machine_parser_message_trans_targs[i],0!=_tsip_machine_parser_message_trans_actions[i])for(a=_tsip_machine_parser_message_trans_actions[i],n=_tsip_machine_parser_message_actions[a],a+=1;n>0;)switch(n-=1,a+=1,_tsip_machine_parser_message_actions[a-1]){case 0:_.i_tag_start=m;break;case 1:_.i_tag_end=m,e.e_type==tsip_message_type_e.UNKNOWN?(e.e_type=tsip_message_type_e.REQUEST,e.line.request.s_method||(e.line.request.s_method=tsk_ragel_parser_get_string(_.s_data,m,_.i_tag_start),e.line.request.e_type=tsip_message.prototype.GetRequestType(e.line.request.s_method))):_.cs=tsip_machine_parser_message_error;break;case 2:if(_.i_tag_end=m,!e.line.request.o_uri){var E=tsk_ragel_parser_get_string(_.s_data,m,_.i_tag_start);e.line.request.o_uri=tsip_uri.prototype.Parse(E)}break;case 3:_.i_tag_end=m,e.s_version=tsk_ragel_parser_get_string(_.s_data,m,_.i_tag_start);break;case 4:if(_.i_tag_end=m,e.e_type==tsip_message_type_e.UNKNOWN){e.e_type=tsip_message_type_e.RESPONSE;var k=tsk_ragel_parser_get_string(_.s_data,m,_.i_tag_start);e.line.response.i_status_code=parseInt(k)}else _.i_cs=tsip_machine_parser_message_error;break;case 5:_.i_tag_end=m,e.line.response.s_reason_phrase||(e.line.response.s_reason_phrase=tsk_ragel_parser_get_string(_.s_data,m,_.i_tag_start));break;case 6:_.i_tag_end=m,tsip_header_parse(_,e);break;case 7:_.i_cs=u,_.i_p=m,_.i_pe=g,_.i_eof=y,tsip_message_parser_eoh(_,e,t),u=_.i_cs,m=_.i_p,g=_.i_pe,y=_.i_eof}if(_trigger_goto)continue}if(d>=o){if(0==u){o=h;continue}if(m+=1,m!=g){o=p;continue}}if(h>=o)break}_.i_cs=u,_.i_p=m,_.i_pe=g,_.i_eof=y}function tsip_message_parser_eoh(_,e,t){if(e&&t){var s=e.get_content_length();if(_.i_p+s<_.i_pe&&!e.o_content){var i=_.i_p+1,r=i+s;e.o_content=new Array(r-i);for(var a=i,n=0;r>a;++a,++n)e.o_content[n]=_.o_data[a];_.i_p+=s}else _.i_p=_.i_pe-1}}function tsip_session(_){return _?(this.i_id=++tsip_session.prototype.__i_session_id,this.i_id_parent=tsip_session.prototype.__i_session_id_invalid,this.b_server=!1,this.o_stack=_,this.o_usr_data=null,this.ao_caps=new Array,this.ao_headers=new Array,this.o_uri_from=_.identity.o_uri_impu,this.o_uri_to=null,this.i_expires=tsip_session.prototype.__i_expires_default,this.b_silent_hangup=!1,this.b_no_contact=!1,this.media={},this.media.e_type=tmedia_type_e.NONE,this.media.b_100rel=!1,this.media.o_bandwidth=_.media.o_bandwidth,this.media.o_video_size=_.media.o_video_size,this.media.o_audio_constraints=_.media.o_audio_constraints,this.media.timers={},this.media.timers.s_refresher=null,this.media.timers.i_timeout=0,this.media.qos={},this.media.qos.e_type=tmedia_qos_stype_e.NONE,this.media.qos.e_strength=tmedia_qos_strength_e.NONE,this.media.msrp={},void(this.media.msrp.fn_callback=null)):(tsk_utils_log_error("Invalid argument"),null)}function tsip_event_info(_,e,t,s,i){tsip_event.call(this,_,e,t,s,tsip_event_type_e.INFO),this.e_type=i}function tsip_session_invite(_){tsip_session.call(this,_),this.__set(Array.prototype.slice.call(arguments,1)),this.o_url_local=null,this.o_url_remote=null}function tsip_event_invite(_,e,t,s,i){tsip_event.call(this,_,e,t,s,tsip_event_type_e.INVITE),this.e_invite_type=i}function tsip_event_message(_,e,t,s,i){this.__proto__=new tsip_event(_,e,t,s,tsip_event_type_e.MESSAGE),this.e_message_type=i}function tsip_session_message(_){tsip_session.call(this,_),this.__set(Array.prototype.slice.call(arguments,1))}function tsip_event_options(_,e,t,s,i){this.__proto__=new tsip_event(_,e,t,s,tsip_event_type_e.OPTIONS),this.e_type=i}function tsip_event_publish(_,e,t,s,i){tsip_event.call(this,_,e,t,s,tsip_event_type_e.PUBLISH),this.e_publish_type=i}function tsip_session_publish(_){tsip_session.call(this,_),this.__set(Array.prototype.slice.call(arguments,1))}function tsip_session_register(_){tsip_session.call(this,_),this.__set(Array.prototype.slice.call(arguments,1))}function tsip_event_register(_,e,t,s,i){tsip_event.call(this,_,e,t,s,tsip_event_type_e.REGISTER),this.e_register_type=i}function tsip_event_subscribe(_,e,t,s,i){tsip_event.call(this,_,e,t,s,tsip_event_type_e.SUBSCRIBE),this.e_subscribe_type=i}function tsip_session_subscribe(_){tsip_session.call(this,_),this.__set(Array.prototype.slice.call(arguments,1))}function tsip_stack(_,e,t,s,i){if(!_||!e||!t)return tsk_utils_log_error("Invalid argument"),null;var r=tsip_uri.prototype.Parse(t);if(!r)return tsk_utils_log_error("'"+t+"' is not a valid IMPU Uri"),null;0!=tsk_string_index_of(_,_.length,"sip:")&&0!=tsk_string_index_of(_,_.length,"sips:")&&(_=tsk_string_format("sip:{0}",_));var a=tsip_uri.prototype.Parse(_);return a?(this.e_state=tsip_transport_state_e.NONE,this.identity={},this.identity.s_display_name=r.s_user_name,this.identity.o_uri_impu=r,this.identity.o_uri_pref=null,this.identity.s_impi=e,this.identity.s_password=null,this.identity.s_digest=null,this.network={},this.network.o_transport=null,this.network.s_transport="ws",this.network.s_local_ip=null,this.network.i_local_port=0,this.network.s_proxy_cscf_host=s,this.network.i_proxy_cscf_port=i,this.network.e_proxy_cscf_type=tsk_utils_have_webrtc4all()?tsip_transport_type_e.UDP:tsip_transport_type_e.WS,this.network.o_uri_realm=a,this.network.s_proxy_outbound_host=null,this.network.i_proxy_outbound_port=5060,this.network.e_proxy_outbound_type=this.network.e_proxy_cscf_type,this.network.s_websocket_server_url=null,this.network.ao_ice_servers=null,this.network.b_rtcweb_enabled=!1,this.network.b_click2call_enabled=!1,this.network.aor={},this.network.aor.s_ip=null,this.network.aor.i_port=0,this.security={},this.security.b_earlyIMS=!0,this.security.tls={},this.security.tls.s_ca=null,this.security.tls.s_pbk=null,this.security.tls.s_pvk=null,this.natt={},this.natt.stun={},this.natt.stun.s_ip=null,this.natt.stun.i_port=0,this.natt.stun.s_login=null,this.natt.stun.s_pwd=null,this.media={},this.media.b_cache_stream=!1,this.media.o_bandwidth={audio:void 0,video:void 0},this.media.o_video_size={minWidth:void 0,minHeight:void 0,maxWidth:void 0,maxHeight:void 0},this.media.o_audio_constraints={googEchoCancellation:void 0,googNoiseSuppression:void 0,googAutoGainControl:void 0},this.o_timers=new tsip_timers,this.ao_sessions=new Array,this.ao_headers=new Array,this.o_usr_data=null,this.ao_uri_paths=new Array,this.ao_uri_service_routes=new Array,this.ao_uri_associated_uris=new Array,this.o_layer_dialog=new tsip_dialog_layer(this),this.o_layer_transac=new tsip_transac_layer(this),this.o_layer_transport=new tsip_transport_layer(this),void this.__set(Array.prototype.slice.call(arguments,5))):(tsk_utils_log_error("'"+_+"' is not a valid realm"),null)}function __tsip_stack_transport_callback(_){var e=_.o_transport.o_stack;switch(_.e_type){case tsip_transport_event_type_e.STARTED:e.e_state=tsip_transport_state_e.STARTED,e.signal(tsip_event_code_e.STACK_STARTED,"Stack started");break;case tsip_transport_event_type_e.STOPPED:e.e_state==tsip_transport_state_e.STARTING?e.signal(tsip_event_code_e.STACK_FAILED_TO_START,"Failed to connet to the server"):e.signal(tsip_event_code_e.STACK_STOPPED,"Stack stopped"),e.e_state=tsip_transport_state_e.STOPPED,e.o_layer_transport.transport_remove(_.o_transport);break;case tsip_transport_event_type_e.ERROR:}return 0}function tsip_timers(){this.T1=tsip_timers_e.T1,this.T2=tsip_timers_e.T2,this.T4=tsip_timers_e.T4,this.A=tsip_timers_e.A,this.B=tsip_timers_e.B,this.C=tsip_timers_e.C,this.D=tsip_timers_e.D,this.E=tsip_timers_e.E,this.F=tsip_timers_e.F,this.G=tsip_timers_e.G,this.H=tsip_timers_e.H,this.I=tsip_timers_e.I,this.J=tsip_timers_e.J,this.K=tsip_timers_e.K,this.L=tsip_timers_e.L,this.M=tsip_timers_e.M}function tsip_timers_setH(_){this.H=_}function tsip_uri(_){this.e_type=_,this.s_scheme=null,this.s_host=null,this.e_host_type=tsip_host_type_e.unknown,this.i_port=0,this.s_user_name=null,this.s_password=null,this.s_display_name=null,this.ao_params=new Array,this.toString=function(){return tsip_uri_tostring(this,!0,!0)}}function tsip_uri_make_valid(_,e){if(!_||!e)return tsk_utils_log_error("Invalid argument"),null;if(0==tsk_string_index_of(_,_.length,'"')||0==tsk_string_index_of(_,_.length,"<"))return tsip_uri.prototype.Parse(_);var t=0==tsk_string_index_of(_,_.length,"tel:");return 0==tsk_string_index_of(_,_.length,"sip:")||0==tsk_string_index_of(_,_.length,"sips:")||t||(_="sip:"+_),t||-1!=tsk_string_index_of(_,_.length,"@")||(_+="@"+e),tsip_uri.prototype.Parse(_)}function __tsip_uri_tostring(_,e){var t=tsk_string_format("{0}:{1}{2}{3}{4}{5}{6}{7}{8}{9}",_.s_scheme?_.s_scheme:"sip",_.s_user_name?_.s_user_name:"",_.s_password?":":"",_.s_password?_.s_password:"",_.s_host&&_.s_user_name?"@":"",_.e_host_type==tsip_host_type_e.ipv6?"[":"",_.s_host?_.s_host:"",_.e_host_type==tsip_host_type_e.ipv6?"]":"",_.i_port>0?":":"",_.i_port>0?_.i_port:"");return t&&e&&_.ao_params.length>0&&(t+=tsk_string_format(";{0}",tsk_params_tostring(_.ao_params,";"))),t}function tsip_uri_tostring(_,e,t){if(_){if(t){var s="";return _.s_display_name&&(s+=tsk_string_format('"{0}"',_.s_display_name)),s+=tsk_string_format("<{0}>",__tsip_uri_tostring(_,e))}return __tsip_uri_tostring(_,e)}return tsk_utils_log_error("Invalid argument"),null}function tsip_uri_strcmp(_,e,t){if(_&&e){var s=!1,i=!1;return tsk_string_contains(_,_.length,"%")&&(s=!0,
_=decodeURIComponent(_)),tsk_string_contains(e,e.length,"%")&&(i=!0,e=decodeURIComponent(e)),t?_.localeCompare(e):_.toLowerCase().localeCompare(e.toLowerCase())}return-1}function tsip_uri_strequals(_,e){return 0==tsip_uri_strcmp(_,e,!0)}function tsip_uri_striequals(_,e){return 0==tsip_uri_strcmp(_,e,!1)}function tsip_uri_compare_parameter(_,e,t){var s=tsk_param_get_by_name(_.ao_params,t),i=tsk_param_get_by_name(e.ao_params,t);return(s||i)&&(s&&!i||!s&&i||!tsip_uri_striequals(s.s_value,i.s_value))?-3:0}function tsip_uri_compare(_,e){if(_&&e){var t,s,i;if(!(tsk_string_equals(_.s_scheme,e.s_scheme)&&tsip_uri_strequals(_.s_user_name,e.s_user_name)&&tsip_uri_strequals(_.s_host,e.s_host)&&tsk_string_equals(_.s_password,e.s_password)&&_.i_port==e.i_port))return-2;if(!_.ao_params&&!e.ao_params||0==_.ao_params.length&&0==e.ao_params.length)return 0;if(0!=(i=tsip_uri_compare_parameter(_,e,"transport")))return i;if(0!=(i=tsip_uri_compare_parameter(_,e,"ttl")))return i;if(0!=(i=tsip_uri_compare_parameter(_,e,"user")))return i;if(0!=(i=tsip_uri_compare_parameter(_,e,"method")))return i;if(0!=(i=tsip_uri_compare_parameter(_,e,"maddr")))return i;for(var r=0;r<_.ao_params.length;++r)if(t=_.ao_params[r],(s=tsk_param_get_by_name(e.ao_params,t.s_name))&&!tsip_uri_striequals(t.s_value,s.s_value))return-4;for(var r=0;r<e.ao_params.length;++r)if(s=e.ao_params[r],(t=tsk_param_get_by_name(_.ao_params,s.s_name))&&!tsip_uri_striequals(t.s_value,s.s_value))return-4;return 0}return _||e?-1:0}function tsip_auth_basic_response(_,e){return Base64.encode(tsk_string_format("{0}:{1}",_,e))}function tsip_auth_digest_HA1(_,e,t){return MD5.hexdigest(tsk_string_format("{0}:{1}:{2}",_,e,t))}function tsip_auth_digest_HA1sess(_,e,t,s,i){return MD5.hexdigest(tsk_string_format("{0}:{1}:{2}:{3}:{4}",_,e,t,s,i))}function tsip_auth_digest_HA2(_,e,t,s){var i=null;if(tsk_string_is_null_or_empty(s)||tsk_string_iequals(s,"auth"))i=tsk_string_format("{0}:{1}",_,e);else if(tsk_string_iequals(s,"auth-int"))if(t){var r=MD5.hash(t);i=tsk_string_format("{0}:{1}:{2}",_,e,r)}else i=tsk_string_format("{0}:{1}:{2}",_,e,"d41d8cd98f00b204e9800998ecf8427e");return MD5.hexdigest(i)}function tsip_auth_digest_response(_,e,t,s,i,r){return tsk_string_iequals(i,"auth")||tsk_string_iequals(i,"auth-int")?MD5.hexdigest(tsk_string_format("{0}:{1}:{2}:{3}:{4}:{5}",_,e,t,s,i,r)):MD5.hexdigest(tsk_string_format("{0}:{1}:{2}",_,e,r))}function tsip_challenge(_,e,t,s,i,r,a,n){this.o_stack=_,this.b_isproxy=e,this.s_scheme=t,this.s_realm=s,this.s_nonce=i,this.s_opaque=r,this.s_algorithm=a,this.s_cnonce=null,this.i_nc=0,n&&(this.s_qop=tsk_string_contains(n,n.length,"auth-int")?"auth-int":tsk_string_contains(n,n.length,"auth")?"auth":null,this.reset_cnonce())}function tsip_dialog(){this.e_type=tsip_dialog_type_e.UNKNOWN,this.o_fsm=null,this.o_session=null,this.o_action_curr=null,this.e_state=tsip_dialog_state_e.INITIAL,this.b_initialized=!1,this.b_running=!1,this.last_error={},this.last_error.s_phrase=null,this.last_error.i_code=0,this.last_error.o_message=null,this.s_tag_local=null,this.o_uri_local=null,this.s_tag_remote=null,this.o_uri_remote=null,this.o_uri_remote_target=null,this.i_cseq_value=0,this.s_cseq_method=null,this.i_expires=0,this.s_callid=null,this.ao_hdr_record_routes=null,this.ao_challenges=null,this.fn_callback=null}function tsip_dialog_compare(_,e){return _&&e&&_.s_callid==e.s_callid&&_.s_tag_local==e.s_tag_local&&_.s_tag_remote==e.s_tag_remote?0:-1}function tsip_dialog_generic(_,e,t){tsip_dialog.call(this),this.b_disconnecting=!1,this.o_last_iMessage=null,this.o_timerRefresh=null,this.o_timerShutdown=null,this.i_timerShutdown=(tsip_dialog.prototype.__i_timer_shutdown<<1)/3,this.init(_,t,e,tsip_dialog_generic_states_e.STARTED,tsip_dialog_generic_states_e.TERMINATED),this.set_callback(__tsip_dialog_generic_event_callback),this.o_fsm.set_debug_enabled(tsip_dialog_generic.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_dialog_generic_onterm,this),this.init_message(),this.init_publish(),this.init_subscribe(),this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.I_1XX,tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_InProgress_2_InProgress_X_1xx,"tsip_dialog_generic_InProgress_2_InProgress_X_1xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.I_2XX,__tsip_dialog_generic_cond_is_dialogless,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_InProgress_2_Terminated_X_2xx,"tsip_dialog_generic_InProgress_2_Terminated_X_2xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.I_2XX,__tsip_dialog_generic_cond_is_disconnecting,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_InProgress_2_Terminated_X_2xx,"tsip_dialog_generic_InProgress_2_Terminated_X_2xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.I_2XX,__tsip_dialog_generic_cond_is_dialogfull,tsip_dialog_generic_states_e.CONNECTED,tsip_dialog_generic_InProgress_2_Connected_X_2xx,"tsip_dialog_generic_InProgress_2_Connected_X_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.I_401_407_421_494,tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_InProgress_2_InProgress_X_401_407_421_494,"tsip_dialog_generic_InProgress_2_InProgress_X_401_407_421_494"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.I_300_to_699,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_InProgress_2_Terminated_X_300_to_699,"tsip_dialog_generic_InProgress_2_Terminated_X_300_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.CANCEL,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_InProgress_2_Terminated_X_cancel,"tsip_dialog_generic_InProgress_2_Terminated_X_cancel"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_actions_e.SHUTDOWN,tsip_dialog_generic_states_e.TERMINATED,null,"tsip_dialog_generic_InProgress_2_Terminated_X_shutdown"),tsk_fsm_entry.prototype.Create(tsip_dialog_generic_states_e.INCOMING,tsip_dialog_generic_actions_e.ACCEPT,__tsip_dialog_generic_cond_is_dialogless,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_Incoming_2_Terminated_X_accept,"tsip_dialog_generic_Incoming_2_Terminated_X_accept"),tsk_fsm_entry.prototype.Create(tsip_dialog_generic_states_e.INCOMING,tsip_dialog_generic_actions_e.ACCEPT,__tsip_dialog_generic_cond_is_dialogfull,tsip_dialog_generic_states_e.CONNECTED,tsip_dialog_generic_Incoming_2_Connected_X_accept,"tsip_dialog_generic_Incoming_2_Connected_X_accept"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.INCOMING,tsip_dialog_generic_actions_e.REJECT,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_Incoming_2_Terminated_X_reject,"tsip_dialog_generic_Incoming_2_Terminated_X_reject"),tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_dialog_generic_states_e.INCOMING,"tsip_dialog_generic_Incoming_2_Incoming_X_any"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.HANGUP,__tsip_dialog_generic_cond_not_silent_hangup,tsip_dialog_generic_states_e.INPROGRESS,__tsip_dialog_generic_Any_2_InProgress_X_hangup,"tsip_dialog_generic_Any_2_InProgress_X_hangup"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.HANGUP,__tsip_dialog_generic_cond_silent_hangup,tsip_dialog_generic_states_e.TERMINATED,null,"tsip_dialog_generic_Any_2_InProgress_X_silenthangup"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.SHUTDOWN,__tsip_dialog_generic_cond_not_silent_shutdown,tsip_dialog_generic_states_e.INPROGRESS,__tsip_dialog_generic_Any_2_InProgress_X_shutdown,"tsip_dialog_generic_Any_2_InProgress_X_shutdown"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.SHUTDOWN,__tsip_dialog_generic_cond_silent_shutdown,tsip_dialog_generic_states_e.TERMINATED,null,"tsip_dialog_generic_Any_2_InProgress_X_silentshutdown"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.SHUTDOWN_TIMEDOUT,tsip_dialog_generic_states_e.TERMINATED,null,"tsip_dialog_generic_shutdown_timedout"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.TRANSPORT_ERROR,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_Any_2_Terminated_X_transportError,"tsip_dialog_generic_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.ERROR,tsip_dialog_generic_states_e.TERMINATED,tsip_dialog_generic_Any_2_Terminated_X_Error,"tsip_dialog_generic_Any_2_Terminated_X_Error"))}function __tsip_dialog_generic_timer_callback(_,e){var t=-1;if(_)if(_.o_timerRefresh==e)switch(_.e_type){case tsip_dialog_type_e.PUBLISH:t=_.fsm_act(tsip_dialog_generic_actions_e.O_PUBLISH,null,null);break;case tsip_dialog_type_e.SUBSCRIBE:t=_.fsm_act(tsip_dialog_generic_actions_e.O_SUBSCRIBE,null,null)}else _.o_timerShutdown==e&&(t=_.fsm_act(tsip_dialog_generic_actions_e.SHUTDOWN,null,null));return t}function __tsip_dialog_generic_event_callback(_,e,t){var s=-1;switch(e){case tsip_dialog_event_type_e.I_MSG:t&&(t.is_response()?s=t.is_1xx()?_.fsm_act(tsip_dialog_generic_actions_e.I_1XX,t,null):t.is_2xx()?_.fsm_act(tsip_dialog_generic_actions_e.I_2XX,t,null):t.is_response_xxx(401)||t.is_response_xxx(407)||t.is_response_xxx(421)||t.is_response_xxx(494)?_.fsm_act(tsip_dialog_generic_actions_e.I_401_407_421_494,t,null):t.is_response_xxx(423)?_.fsm_act(tsip_dialog_generic_actions_e.I_423,t,null):t.is_3456()?_.fsm_act(tsip_dialog_generic_actions_e.I_300_to_699,t,null):_.fsm_act(tsip_dialog_generic_actions_e.ERROR,t,null):t.is_message()?s=_.fsm_act(tsip_dialog_generic_actions_e.I_MESSAGE,t,null):t.is_options()?s=_.fsm_act(tsip_dialog_generic_actions_e.I_OPTIONS,t,null):t.is_notify()?s=_.fsm_act(tsip_dialog_generic_actions_e.I_NOTIFY,t,null):t.is_subscribe()?s=_.fsm_act(tsip_dialog_generic_actions_e.I_SUBSCRIBE,t,null):t.is_info()?s=_.fsm_act(tsip_dialog_generic_actions_e.I_INFO,t,null):t.is_publish()&&(s=_.fsm_act(tsip_dialog_generic_actions_e.I_PUBLISH,t,null)));break;case tsip_dialog_event_type_e.CANCELED:s=_.fsm_act(tsip_dialog_generic_actions_e.CANCEL,t,null);break;case tsip_dialog_event_type_e.TERMINATED:case tsip_dialog_event_type_e.TIMEDOUT:case tsip_dialog_event_type_e.ERROR:case tsip_dialog_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_dialog_generic_actions_e.TRANSPORT_ERROR,t,null)}return s}function __tsip_dialog_generic_cond_is_dialogless(_,e){switch(_.e_type){case tsip_dialog_type_e.INFO:case tsip_dialog_type_e.MESSAGE:case tsip_dialog_type_e.OPTIONS:return!0;default:return!1}}function __tsip_dialog_generic_cond_is_dialogfull(_,e){return!__tsip_dialog_generic_cond_is_dialogless(_,e)}function __tsip_dialog_generic_cond_is_resp2message(_,e){return e.is_response_to_message()}function __tsip_dialog_generic_cond_is_message(_,e){return e.is_message()}function __tsip_dialog_generic_cond_is_disconnecting(_,e){return _.b_disconnecting}function __tsip_dialog_generic_cond_is_connecting(_,e){return!__tsip_dialog_generic_cond_is_disconnecting(_,e)}function __tsip_dialog_generic_cond_silent_hangup(_,e){return _.o_session.b_silent_hangup}function __tsip_dialog_generic_cond_not_silent_hangup(_,e){return!__tsip_dialog_generic_cond_silent_hangup(_,e)}function __tsip_dialog_generic_cond_silent_shutdown(_,e){return __tsip_dialog_generic_cond_silent_hangup(_,e)}function __tsip_dialog_generic_cond_not_silent_shutdown(_,e){return!__tsip_dialog_generic_cond_silent_shutdown(_,e)}function tsip_dialog_generic_InProgress_2_InProgress_X_1xx(_){var e=_[0],t=_[1];return e.signal_ao(t.get_response_code(),t.get_response_phrase(),t)}function tsip_dialog_generic_InProgress_2_Terminated_X_2xx(_){var e=_[0],t=_[1];return e.signal_ao(t.get_response_code(),t.get_response_phrase(),t)}function tsip_dialog_generic_InProgress_2_Connected_X_2xx(_){var e=_[0],t=_[1],s=e.e_state==tsip_dialog_state_e.INITIAL;if(0!=(i_ret=e.update_with_response(t)))return i_ret;if(e.e_type==tsip_dialog_type_e.PUBLISH){var i;(i=t.get_header(tsip_header_type_e.SIP_ETag))&&(i.s_value?e.s_etag=i.s_value:tsk_utils_log_warn("SIP-ETag header without value: Is it a bug?"))}return e.set_action_curr(null),e.i_timerRefresh=e.get_newdelay(t),e.timer_schedule("generic","Refresh"),e.signal_ao(t.get_response_code(),t.get_response_phrase(),t),s&&e.signal(tsip_event_code_e.DIALOG_CONNECTED,"Connected"),0}function tsip_dialog_generic_InProgress_2_InProgress_X_401_407_421_494(_){var e,t=_[0],s=_[1];if(e=t.update_with_response(s))return t.signal_ao(s.get_response_code(),s.get_response_phrase(),s),t.set_last_error(s.get_response_code(),s.get_response_phrase(),s),e;switch(t.e_type){case tsip_dialog_type_e.MESSAGE:return t.send_message();case tsip_dialog_type_e.PUBLISH:return t.send_publish();case tsip_dialog_type_e.SUBSCRIBE:return t.send_subscribe()}return 0}function tsip_dialog_generic_InProgress_2_Terminated_X_300_to_699(_){var e=_[0],t=_[1];return e.set_last_error(t.get_response_code(),t.get_response_phrase(),t),e.signal_ao(t.get_response_code(),t.get_response_phrase(),t)}function tsip_dialog_generic_InProgress_2_Terminated_X_cancel(_){return tsk_utils_log_error("Not implemented"),0}function tsip_dialog_generic_Incoming_2_Terminated_X_accept(_){var e=_[0],t=_[2];if(e.o_last_iMessage){var s,i=-1;if(e.set_action_curr(t),!(s=e.response_new(200,"OK",e.o_last_iMessage)))return tsk_utils_log_error("Failed to create SIP response."),-1;if(0==(i=tsip_dialog.prototype.ApplyAction(s,t))&&(i=e.response_send(s)))return tsk_utils_log_error("Failed to send SIP response."),i}else tsk_utils_log_error("Invalid state");return 0}function tsip_dialog_generic_Incoming_2_Connected_X_accept(_){return tsk_utils_log_error("Not implemented"),0}function tsip_dialog_generic_Incoming_2_Terminated_X_reject(_){return tsk_utils_log_error("Not implemented"),0}function __tsip_dialog_generic_Any_2_InProgress_X_hangup(_){var e=_[0],t=_[2];switch(e.set_action_curr(t),e.signal(tsip_event_code_e.DIALOG_TERMINATING,"Disconnecting..."),e.b_disconnecting=!0,e.e_type){case tsip_dialog_type_e.PUBLISH:return e.send_publish();case tsip_dialog_type_e.SUBSCRIBE:return e.send_subscribe()}return 0}function __tsip_dialog_generic_Any_2_InProgress_X_shutdown(_){var e=_[0];switch(e.timer_schedule("generic","Shutdown"),e.signal(tsip_event_code_e.DIALOG_TERMINATING,"Disconnecting..."),e.b_disconnecting=!0,e.e_type){case tsip_dialog_type_e.PUBLISH:return e.send_publish();case tsip_dialog_type_e.SUBSCRIBE:return e.send_subscribe()}return 0}function tsip_dialog_generic_Any_2_Terminated_X_transportError(_){return tsk_utils_log_error("Not implemented"),0}function tsip_dialog_generic_Any_2_Terminated_X_Error(_){return tsk_utils_log_error("Not implemented"),0}function __tsip_dialog_generic_onterm(_){return tsk_utils_log_info("=== "+_.e_type.s_name+" Dialog terminated ==="),_.timer_cancel("Refresh"),_.timer_cancel("Shutdown"),_.signal(tsip_event_code_e.DIALOG_TERMINATED,_.last_error.s_phrase?_.last_error.s_phrase:"Disconnected",_.last_error.o_message),_.deinit()}function tsip_dialog_generic_Started_2_InProgress_X_oMessage(_){var e=_[0],t=_[2];return e.b_running=!0,e.set_action_curr(t),e.send_message()}function tsip_dialog_generic_Started_2_Incoming_X_iMessage(_){var e=_[0],t=_[1];return e.signal_i(tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",t),e.o_last_iMessage=t,0}function tsip_dialog_generic_Any_2_InProgress_X_oPublish(_){var e=_[0],t=_[2];return e.b_running||(e.b_running=!0),e.set_action_curr(t),e.e_state==tsip_dialog_state_e.INITIAL&&e.signal(tsip_event_code_e.DIALOG_CONNECTING,"Connecting..."),e.send_publish()}function tsip_dialog_generic_Any_2_InProgress_X_oSubscribe(_){var e=_[0],t=_[2];return e.b_running||(e.b_running=!0),e.set_action_curr(t),e.e_state==tsip_dialog_state_e.INITIAL&&e.signal(tsip_event_code_e.DIALOG_CONNECTING,"Connecting..."),e.send_subscribe()}function tsip_dialog_generic_Any_2_Any_X_iNotify(_){var e,t=_[0],s=_[1],i=-1;return(e=t.response_new(200,"OK",s))&&(i=t.response_send(e)),t.i_timerRefresh=t.get_newdelay(s),t.timer_schedule("generic","Refresh"),t.signal_i(tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming NOTIFY",s),i}function tsip_dialog_invite(_,e){tsip_dialog.call(this),this.o_last_oInvite=null,this.o_wait_oMessage=null,this.o_last_iOffer=null,this.o_last_iRefer=null,this.o_ss_transf=null,this.e_next_offer_type=tsip_dialog_invite_next_offer_type_e.NONE,this.i_rseq=0,this.b_support_update=!1,this.supported={},this.supported.b_100rel=_.media.b_100rel,this.supported.b_norefsub=!0,this.supported.b_refer_sub=!0,this.supported.b_timer=_.media.timers.i_timeout>0,this.require={},this.require.b_100rel=!1,this.require.b_norefsub=!1,this.require.b_timer=!1,this.hold={},this.hold.b_local=!1,this.hold.b_remote=!1,this.init(tsip_dialog_type_e.INVITE,e,_,tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_states_e.TERMINATED),this.set_callback(__tsip_dialog_invite_event_callback),this.o_fsm.set_debug_enabled(tsip_dialog_invite.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_dialog_invite_onterm,this),this.o_msession_mgr=null,this.b_is_client=!1,this.b_is_transf=!1,this.o_timerShutdown=null,this.i_timerShutdown=tsip_dialog.prototype.__i_timer_shutdown>>1,this.stimers={},this.stimers.i_timeout=_.media.timers.i_timeout,this.stimers.s_refresher=null,this.stimers.i_minse=0,this.stimers.b_is_refresher=!1,this.o_timer100Rel=null,this.i_timer100Rel=0,this.o_timerSession=null,this.o_timerShutdown=null,this.i_timerShutdown=tsip_dialog.prototype.__i_timer_shutdown,this.o_timerLoSdpRequest=null,this.i_timerLoSdpRequest=tsip_dialog_invite.prototype.__i_lo_sdp_request_timeout,this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_dialog_invite_states_e.STARTED,"tsip_dialog_invite_Started_2_Started_X_any"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.DTMF_SEND,tsip_dialog_invite_states_e.CONNECTED,x0000_Connected_2_Connected_X_oDTMF,"x0000_Connected_2_Connected_X_oDTMF"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.MSRP_SEND_MSG,tsip_dialog_invite_states_e.CONNECTED,x0000_Connected_2_Connected_X_oLMessage,"x0000_Connected_2_Connected_X_oLMessage"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.I_ACK,tsip_dialog_invite_states_e.CONNECTED,x0000_Connected_2_Connected_X_iACK,"x0000_Connected_2_Connected_X_iACK"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.I_INVITE,tsip_dialog_invite_states_e.CONNECTED,x0000_Connected_2_Connected_X_iINVITEorUPDATE,"x0000_Connected_2_Connected_X_iINVITE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.I_UPDATE,tsip_dialog_invite_states_e.CONNECTED,x0000_Connected_2_Connected_X_iINVITEorUPDATE,"x0000_Connected_2_Connected_X_iUPDATE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.O_INVITE,tsip_dialog_invite_states_e.CONNECTED,x0000_Connected_2_Connected_X_oINVITE,"x0000_Connected_2_Connected_X_oINVITE"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.O_BYE,tsip_dialog_invite_states_e.TRYING,x0000_Any_2_Trying_X_oBYE,"x0000_Any_2_Trying_X_oBYE"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_BYE,tsip_dialog_invite_states_e.TERMINATED,x0000_Any_2_Terminated_X_iBYE,"x0000_Any_2_Terminated_X_iBYE"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2bye,tsip_dialog_invite_states_e.TERMINATED,null,"x0000_Any_2_Terminated_X_i3xxTOi6xxBYE"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2bye,tsip_dialog_invite_states_e.TERMINATED,null,"x0000_Any_2_Terminated_X_i2xxBYE"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.O_SHUTDOWN,tsip_dialog_invite_states_e.TRYING,x0000_Any_2_Trying_X_shutdown,"x0000_Any_2_Trying_X_shutdown"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.SHUTDOWN_TIMEDOUT,tsip_dialog_invite_states_e.TERMINATED,null,"tsip_dialog_invite_shutdown_timedout"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_1XX,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_i1xx,"x0000_Any_2_Any_X_i1xx"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.O_INFO,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_oINFO,"x0000_Any_2_Any_X_oINFO"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_INFO,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_iINFO,"x0000_Any_2_Any_X_iINFO"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_PRACK,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_iPRACK,"x0000_Any_2_Any_X_iPRACK"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_OPTIONS,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_iOPTIONS,"x0000_Any_2_Any_X_iOPTIONS"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2invite,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_i2xxINVITEorUPDATE,"x0000_Any_2_Any_X_i2xxINVITE"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2update,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_i2xxINVITEorUPDATE,"x0000_Any_2_Any_X_i2xxUPDATE"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_401_407,__tsip_dialog_invite_cond_is_resp2invite,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_i401_407_INVITEorUPDATE,"x0000_Any_2_Any_X_i401_407_INVITE"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_401_407,__tsip_dialog_invite_cond_is_resp2update,tsk_fsm.prototype.__i_state_any,x0000_Any_2_Any_X_i401_407_INVITEorUPDATE,"x0000_Any_2_Any_X_i401_407_UPDATE"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2prack,tsk_fsm.prototype.__i_state_any,null,"x0000_Any_2_Any_X_i2xxPRACK"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2info,tsk_fsm.prototype.__i_state_any,null,"x0000_Any_2_Any_X_i2xxINFO"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.TIMER_LO_SDP_REQUEST,tsip_dialog_invite_states_e.TERMINATED,x9997_Any_2_Any_X_LoSdpRequestTimeout,"x9997_Any_2_Any_X_LoSdpRequestTimeout"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.TRANSPORT_ERROR,tsip_dialog_invite_states_e.TERMINATED,x9998_Any_2_Terminated_X_transportError,"x9998_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.ERROR,tsip_dialog_invite_states_e.TERMINATED,x9999_Any_2_Terminated_X_Error,"x9999_Any_2_Terminated_X_Error")),this.init_client(),this.init_server(),this.init_hold(),this.init_ect()}function __tsip_dialog_invite_timer_callback(_,e){var t=-1;return _&&(_.o_timerSession==e?t=_.fsm_act(tsip_dialog_invite_actions_e.TIMER_REFRESH,null,null):_.o_timer100Rel==e?t=_.fsm_act(tsip_dialog_invite_actions_e.TIMER_100REL,null,null):_.o_timerShutdown==e?t=_.fsm_act(tsip_dialog_invite_actions_e.SHUTDOWN_TIMEDOUT,null,null):_.o_timerLoSdpRequest==e&&(t=_.fsm_act(tsip_dialog_invite_actions_e.TIMER_LO_SDP_REQUEST,null,null))),t}function __tsip_dialog_invite_media_callback(_,e,t){var s;switch(e){case tmedia_session_events_e.GET_LO_SUCCESS:if(_.timer_cancel("LoSdpRequest"),_.o_wait_oMessage){var i=_.o_msession_mgr.get_lo(),r=null;i&&(r=i.toString())&&(_.o_wait_oMessage.add_content(new String(r),"application/sdp"),_.o_wait_oMessage.is_request()?_.o_wait_oMessage.is_ack()?s=_.get_stack().o_layer_transport.send(null,_.o_wait_oMessage):(s=_.request_send(_.o_wait_oMessage),0==s&&_.o_wait_oMessage.is_invite()&&(_.o_last_oInvite=_.o_wait_oMessage)):s=_.response_send(_.o_wait_oMessage)),_.o_wait_oMessage=null}else _.e_state==tsip_dialog_state_e.ESTABLISHED&&(s=_.e_next_offer_type==tsip_dialog_invite_next_offer_type_e.SUCCESS&&_.o_last_iOffer?_.send_response(_.o_last_iOffer,200,"OK",!0):_.send_offer(!0,!0));_.o_msession_mgr&&!_.o_msession_mgr.is_started()&&_.o_msession_mgr.has_lo()&&_.o_msession_mgr.has_ro()&&(s=_.o_msession_mgr.start()),_.e_next_offer_type=tsip_dialog_invite_next_offer_type_e.NONE;break;case tmedia_session_events_e.GET_LO_FAILED:_.timer_cancel("LoSdpRequest"),_.set_last_error(tsip_event_code_e.DIALOG_WEBRTC_ERROR,"Failed to get local SDP offer"),_.e_next_offer_type=tsip_dialog_invite_next_offer_type_e.NONE;var a=new tsip_action(tsip_action_type_e.HANGUP);a.set_line_resp(603,"Failed to get local SDP"),_.hangup(a);break;case tmedia_session_events_e.STREAM_LOCAL_REQUESTED:_.signal_invite(tsip_event_invite_type_e.M_STREAM_LOCAL_REQUESTED,tsip_event_code_e.DIALOG_MEDIA_LOCAL_REQUESTED,"Media Requested",null);break;case tmedia_session_events_e.STREAM_LOCAL_ACCEPTED:_.signal_invite(tsip_event_invite_type_e.M_STREAM_LOCAL_ACCEPTED,tsip_event_code_e.DIALOG_MEDIA_LOCAL_ACCEPTED,"Media Accepted",null);break;case tmedia_session_events_e.STREAM_LOCAL_REFUSED:_.signal_invite(tsip_event_invite_type_e.M_STREAM_LOCAL_REFUSED,tsip_event_code_e.DIALOG_MEDIA_LOCAL_REFUSED,"Media Refused",null);var a=new tsip_action(tsip_action_type_e.HANGUP);a.set_line_resp(603,"Media stream permission denied"),_.hangup(a);break;case tmedia_session_events_e.STREAM_LOCAL_ADDED:_.get_session().__set_stream_local(_.o_msession_mgr.get_stream_local()),_.signal_invite(tsip_event_invite_type_e.M_STREAM_LOCAL_ADDED,tsip_event_code_e.DIALOG_MEDIA_ADDED,"Media Added",null);break;case tmedia_session_events_e.STREAM_LOCAL_REMOVED:_.get_session().__set_stream_local(null),_.signal_invite(tsip_event_invite_type_e.M_STREAM_LOCAL_REMOVED,tsip_event_code_e.DIALOG_MEDIA_REMOVED,"Media Removed",null);break;case tmedia_session_events_e.STREAM_REMOTE_ADDED:_.get_session().__set_stream_remote(_.o_msession_mgr.get_stream_remote()),_.signal_invite(tsip_event_invite_type_e.M_STREAM_REMOTE_ADDED,tsip_event_code_e.DIALOG_MEDIA_ADDED,"Media Added",null);break;case tmedia_session_events_e.STREAM_REMOTE_REMOVED:_.get_session().__set_stream_remote(null),_.signal_invite(tsip_event_invite_type_e.M_STREAM_REMOTE_REMOVED,tsip_event_code_e.DIALOG_MEDIA_REMOVED,"Media Removed",null);break;case tmedia_session_events_e.RFC5168_REQUEST_IDR:_.send_info('<?xml version="1.0" encoding="utf-8"?>\r\n <media_control>\r\n   <vc_primitive>\r\n     <to_encoder>\r\n       <picture_fast_update>\r\n       </picture_fast_update>\r\n     </to_encoder>\r\n   </vc_primitive>\r\n </media_control>\r\n',"application/media_control+xml")}}function __tsip_dialog_invite_event_callback(_,e,t){var s=-1;switch(e){case tsip_dialog_event_type_e.I_MSG:t&&(t.is_response()?t.is_1xx()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_1XX,t,null):t.is_2xx()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_2XX,t,null):t.is_response_xxx(401)||t.is_response_xxx(407)?s=_.fsm_act(tsip_dialog_invite_actions_e.I_401_407,t,null):t.is_response_xxx(422)?s=_.fsm_act(tsip_dialog_invite_actions_e.I_422,t,null):t.is_3456()&&(s=_.fsm_act(tsip_dialog_invite_actions_e.I_300_to_699,t,null)):t.is_invite()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_INVITE,t,null):t.is_update()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_UPDATE,t,null):t.is_prack()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_PRACK,t,null):t.is_ack()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_ACK,t,null):t.is_options()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_OPTIONS,t,null):t.is_bye()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_BYE,t,null):t.is_cancel()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_CANCEL,t,null):t.is_info()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_INFO,t,null):t.is_notify()?s=_.fsm_act(tsip_dialog_invite_actions_e.I_NOTIFY,t,null):t.is_refer()&&(s=_.fsm_act(tsip_dialog_invite_actions_e.I_REFER,t,null)));break;case tsip_dialog_event_type_e.CANCELED:s=_.fsm_act(tsip_dialog_invite_actions_e.O_CANCEL,t,null);break;case tsip_dialog_event_type_e.TIMEDOUT:t&&t.is_request()&&t.is_info()||(s=_.fsm_act(tsip_dialog_invite_actions_e.TRANSPORT_ERROR,t,null));break;case tsip_dialog_event_type_e.TERMINATED:case tsip_dialog_event_type_e.ERROR:case tsip_dialog_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_dialog_invite_actions_e.TRANSPORT_ERROR,t,null)}return s}function __tsip_dialog_invite_cond_is_resp2invite(_,e){return e.is_response_to_invite()}function __tsip_dialog_invite_cond_is_resp2update(_,e){return e.is_response_to_update()}function __tsip_dialog_invite_cond_is_resp2invite_or_update(_,e){return __tsip_dialog_invite_cond_is_resp2invite(_,e)||__tsip_dialog_invite_cond_is_resp2update(_,e)}function __tsip_dialog_invite_cond_is_resp2bye(_,e){return e.is_response_to_bye()}function __tsip_dialog_invite_cond_is_resp2prack(_,e){return e.is_response_to_prack()}function __tsip_dialog_invite_cond_is_resp2info(_,e){return e.is_response_to_info()}function __tsip_dialog_invite_cond_is_resp2cancel(_,e){return e.is_response_to_cancel()}function __tsip_dialog_invite_cond_is_resp2refer(_,e){return e.is_response_to_refer()}function __tsip_dialog_invite_cond_is_1xx_notify(_,e){var t=__tsip_dialog_invite_get_sip_frag_respcode(e);return t>=100&&199>=t}function __tsip_dialog_invite_cond_is_23456_notify(_,e){var t=__tsip_dialog_invite_get_sip_frag_respcode(e);return t>=200&&699>=t}function __tsip_dialog_invite_cond_is_f_refer(_,e){var t=e.get_header(tsip_header_type_e.Refer_To);return!t||!t.o_uri}function __tsip_dialog_invite_cond_is_1xx_f_notify(_,e){return e.is_1xx()}function __tsip_dialog_invite_cond_is_23456_f_notify(_,e){return e.is_23456()}function x0000_Connected_2_Connected_X_oDTMF(_){return tsk_utils_log_error("Not implemented"),0}function x0000_Connected_2_Connected_X_oLMessage(_){return tsk_utils_log_error("Not implemented"),0}function x0000_Connected_2_Connected_X_iACK(_){var e=_[0],t=_[1],s=0,i=e.o_msession_mgr&&!e.o_msession_mgr.has_ro();return(s=e.process_ro(t,i))?s:(e.o_msession_mgr&&(s=e.o_msession_mgr.acked()),e.signal_invite(tsip_event_invite_type_e.DIALOG_REQUEST_INCOMING,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",t),s)}function x0000_Connected_2_Connected_X_iINVITEorUPDATE(_){var e,t,s,i,r=_[0],a=_[1],n=r.o_msession_mgr?r.o_msession_mgr.get_media_type():tmedia_type_e.NONE,o=r.o_msession_mgr?r.o_msession_mgr.is_roap():!1;return r.o_last_iOffer=a,o&&(r.e_next_offer_type=tsip_dialog_invite_next_offer_type_e.SUCCESS),(e=r.process_ro(a,!0))?e:(i=a.has_content(),s=r.o_msession_mgr?r.o_msession_mgr.get_media_type():tmedia_type_e.NONE,t=!a.has_content()&&a.is_invite(),e=r.hold_handle(a),o||(e=r.send_response(a,200,"OK",r.o_msession_mgr&&(i||t||r.o_msession_mgr.has_ro_changed()||r.o_msession_mgr.has_state_changed()||n!=s))),r.signal_invite(tsip_event_invite_type_e.DIALOG_REQUEST_INCOMING,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",a),e)}function x0000_Connected_2_Connected_X_oINVITE(_){return tsk_utils_log_error("Not implemented"),0}function x0000_Any_2_Any_X_i1xx(_){
var e=_[0],t=_[1],s=0;if(s=e.update_with_response(t))return s;if(t.get_response_code()>=101&&t.get_response_code()<=199){var i=e.o_msession_mgr&&!e.o_msession_mgr.has_lo();if(t.has_content()&&(s=e.process_ro(t,i)))return s;if(t.is_required("100rel")&&(s=e.send_prack(t)))return s}return s=e.signal_invite(tsip_event_invite_type_e.I_AO_REQUEST,t.get_response_code(),t.get_response_phrase(),t),e.b_is_transf&&(s=e.notify_parent(t)),s}function x0000_Any_2_Any_X_oINFO(_){var e,t=_[0],s=_[2];if(t.b_running=!0,t.set_action_curr(s),e=t.request_new("INFO")){var i;return 0==(i=tsip_dialog.prototype.ApplyAction(e,s))&&(i=t.request_send(e)),i}return tsk_utils_log_error("Failed to create new INFO request"),-1}function x0000_Any_2_Any_X_iINFO(_){var e=_[0],t=_[1],s=e.send_response(t,200,"OK");if(e.signal_invite(tsip_event_invite_type_e.DIALOG_REQUEST_INCOMING,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",t),e.o_msession_mgr&&t.has_content()){var i=t.get_content_as_string();tsk_string_is_null_or_empty(i)||e.o_msession_mgr.processContent("INFO",t.get_content_type(),i,i.length)}return s}function x0000_Any_2_Any_X_i401_407_INVITEorUPDATE(_){var e=_[0],t=_[1],s=0;return(s=e.update_with_response(t))?(e.signal_invite(tsip_event_invite_type_e.I_AO_REQUEST,t.get_response_code(),t.get_response_phrase(),t),s):e.send_offer(t.is_response_to_invite(),!1)}function x0000_Any_2_Any_X_i2xxINVITEorUPDATE(_){var e=_[0],t=_[1],s=0;if(this.o_last_oInvite&&this.o_last_oInvite.o_hdr_CSeq.i_seq==t.o_hdr_CSeq.i_seq&&t.is_response_to_invite())return e.send_ack(t);if(s=e.update_with_response(t))return s;var i=e.o_msession_mgr&&!e.o_msession_mgr.has_lo();return(s=e.process_ro(t,i))?s:(t.is_response_to_invite()&&(s=e.send_ack(t)),s)}function x0000_Any_2_Any_X_iPRACK(_){return tsk_utils_log_error("Not implemented"),0}function x0000_Any_2_Any_X_iOPTIONS(_){var e=_[0],t=_[1];return e.signal_invite(tsip_event_invite_type_e.DIALOG_REQUEST_INCOMING,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",t),e.send_response(t,200,"OK",!1)}function x0000_Any_2_Trying_X_oBYE(_){var e,t=_[0];return t.signal(tsip_event_code_e.DIALOG_TERMINATING,"Call terminating..."),0==(e=t.send_bye())&&t.o_msession_mgr&&t.o_msession_mgr.is_started()&&(e=t.o_msession_mgr.stop()),e}function x0000_Any_2_Terminated_X_iBYE(_){var e=_[0],t=_[1];return e.set_last_error(tsip_event_code_e.DIALOG_TERMINATED,"Call terminated"),e.send_response(t,200,"OK",!1)}function x0000_Any_2_Trying_X_shutdown(_){var e=_[0];return e.timer_schedule("invite","Shutdown"),e.signal(tsip_event_code_e.DIALOG_TERMINATING,"Call terminating..."),e.e_state==tsip_dialog_state_e.ESTABLISHED?e.send_bye():e.e_state==tsip_dialog_state_e.EARLY?e.send_cancel():void 0}function x9997_Any_2_Any_X_LoSdpRequestTimeout(_){return tsk_utils_log_error("Not implemented"),0}function x9998_Any_2_Terminated_X_transportError(_){var e=_[0];return e.set_last_error(tsip_event_code_e.DIALOG_TRANSPORT_ERROR,"Transport error"),0}function x9999_Any_2_Terminated_X_Error(_){_[0];return 0}function __tsip_dialog_invite_onterm(_){return tsk_utils_log_info("=== INVITE Dialog terminated ==="),_.timer_cancel("100Rel"),_.timer_cancel("Session"),_.timer_cancel("Shutdown"),_.timer_cancel("LoSdpRequest"),_.o_msession_mgr&&(i_ret=_.o_msession_mgr.stop()),_.signal(tsip_event_code_e.DIALOG_TERMINATED,_.last_error.s_phrase?_.last_error.s_phrase:"Call terminated",_.last_error.o_message),_.deinit()}function c0000_Started_2_Outgoing_X_oINVITE(_){var e,t=_[0],s=_[2];return t.o_msession_mgr||(t.o_msession_mgr=t.new_msession_mgr(s?s.media.e_type:tmedia_type_e.AUDIO_VIDEO,t.get_stack().network.s_local_ip,!1,!0)),t.b_is_client=!0,t.b_is_transf=t.get_session().i_id_parent!=tsip_session.prototype.__i_session_id_invalid,t.set_action_curr(s),t.get_session().media.e_type=s.media.e_type,s.media.ao_params.length>0?(tsk_utils_log_error("Not implemented"),-1):(t.get_session().media.timers.i_timeout&&(t.stimers.i_timeout=t.get_session().media.timers.i_timeout,t.stimers.s_refresher=t.get_session().media.timers.s_refresher,t.stimers.is_refresher=tsk_stri,g_iequals(t.stimers.s_refresher,"uac"),t.supported.b_timer=!0),e=t.send_invite(!1),t.signal(tsip_event_code_e.DIALOG_CONNECTING,"Call in progress..."),e)}function c0000_Outgoing_2_Outgoing_X_iINVITEorUPDATE(_){return tsk_utils_log_error("Not implemented"),0}function c0000_Outgoing_2_Connected_X_i2xxINVITE(_){var e=_[0],t=_[1],s=0;if(s=e.update_with_response(t))return ret;var i=e.o_msession_mgr&&!e.o_msession_mgr.has_lo();return(s=e.process_ro(t,i))?s:(s=e.send_ack(t),e.b_support_update=t.is_allowed("UPDATE"),e.stimers.i_timeout&&e.stimers_handle(t),e.signal_invite(tsip_event_invite_type_e.M_EARLY_MEDIA,t.get_response_code(),t.get_response_phrase(),t),e.signal(tsip_event_code_e.DIALOG_CONNECTED,"In Call"),e.b_is_transf&&(s=e.notify_parent(t),e.b_is_transf=!1),s)}function c0000_Outgoing_2_Terminated_X_i300_to_i699INVITE(_){var e=_[0],t=_[1],s=0;return e.set_last_error(t.get_response_code(),t.get_response_phrase(),t),s=e.signal_invite(tsip_event_invite_type_e.I_AO_REQUEST,t.get_response_code(),t.get_response_phrase(),t),e.b_is_transf&&(s=e.notify_parent(t),e.b_is_transf=!1),s}function c0000_Outgoing_2_Cancelling_X_oCANCEL(_){var e=_[0];return e.o_msession_mgr&&(i_ret=e.o_msession_mgr.stop()),e.signal(tsip_event_code_e.DIALOG_TERMINATING,"Call terminating..."),e.send_cancel()}function c0000_Cancelling_2_Terminated_X_i300_to_699(_){var e=_[0],t=_[1];return e.set_last_error(t.get_response_code(),t.get_response_phrase(),t),0}function x0400_Connected_2_oECTing_X_oECT(_){var e,t=_[0],s=_[2];return e=t.ect_send_refer(s.ect.s_to),0==e&&t.signal_invite(tsip_event_invite_type_e.O_ECT_TRYING,tsip_event_code_e.DIALOG_REQUEST_SENT,"Call Transfer Initiated",null),e}function x0400_oECTing_2_oECTing_X_i2xx(_){var e,t=_[0],s=_[1];return e=s.get_header(tsip_header_type_e.Refer_Sub),e&&(this.supported.b_refer_sub=e.b_sub),s.is_required("norefersub")&&(this.require.b_norefsub=!0),t.signal_invite(tsip_event_invite_type_e.O_ECT_ACCEPTED,s.get_response_code(),s.get_response_phrase(),s),0}function x0400_oECTing_2_Connected_X_i3456(_){var e=_[0],t=_[1];return e.signal_invite(tsip_event_invite_type_e.O_ECT_FAILED,t.get_response_code(),t.get_response_phrase(),t),0}function x0400_oECTing_2_oECTing_X_iNOTIFY(_){var e,t=_[0],s=_[1];if(e=__tsip_dialog_invite_get_sip_frag_msg(s)){var i=t.send_response(s,200,"OK",!1);return t.signal_invite(tsip_event_invite_type_e.O_ECT_NOTIFY,e.get_response_code(),e.get_response_phrase(),e),i}return 0}function x0400_Connected_2_iECTreq_X_iREFER(_){var e=_[0];return e.o_last_iRefer=_[1],e.send_response(e.o_last_iRefer,100,"Asking for Transfer",!1),e.signal_invite(tsip_event_invite_type_e.I_ECT_REQUESTED,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",e.o_last_iRefer),0}function x0400_iECTreq_2_Connected_X_reject(_){var e=_[0],t=_[2],s=t.line_resp.i_code>=300?t.line_resp.i_code:603,i=t.line_resp.s_phrase?t.line_resp.s_phrase:"Decline",r=tsk_string_format('SIP; cause={0}; text="{1}"',s,i);return e.send_error(e.o_last_iRefer,s,i,r)}function x0400_iECTreq_2_iECTing_X_accept(_){var e,t=_[0];_[2];e=t.send_response(t.o_last_iRefer,202,"Transfering...",!1);var s=t.o_last_iRefer.get_header(tsip_header_type_e.Refer_To);return this.o_ss_transf=new tsip_session_invite(t.get_stack(),tsip_session.prototype.SetToStr(s.o_uri.tostring(!1,!1)),tsip_session.prototype.SetCaps("+sip.ice")),this.o_ss_transf.media.e_type=t.get_session().media.e_type,this.o_ss_transf.i_id_parent=t.get_session().get_id(),tsip_event.prototype.Signal(tsip_event_invite_type_e.I_ECT_NEW_CALL,this.o_ss_transf,tsip_event_code_e.DIALOG_REQUEST_OUTGOING,"ECTing",t.o_last_iRefer),this.o_ss_transf.call(this.o_ss_transf.media.e_type)}function x0400_iECTing_2_iECTing_X_1xxfNOTIFY(_){var e=_[0],t=_[1];return e.ect_send_notify(t.get_response_code(),t.get_response_phrase())}function x0400_iECTing_2_Connected_X_23456fNOTIFY(_){var e=_[0],t=_[1],s=t.get_response_code();return e.ect_send_notify(s,t.get_response_phrase()),s>=200&&299>=s?(e.signal_invite(tsip_event_invite_type_e.I_ECT_COMPLETED,t.get_response_code(),t.get_response_phrase(),e.o_last_iRefer),e.send_bye()):(e.signal_invite(tsip_event_invite_type_e.I_ECT_FAILED,t.get_response_code(),t.get_response_phrase(),e.o_last_iRefer),0)}function __tsip_dialog_invite_get_sip_frag_respcode(_){var e=__tsip_dialog_invite_get_sip_frag_msg(_);return e?e.get_response_code():0}function __tsip_dialog_invite_get_sip_frag_msg(_){if(!_)return tsk_utils_log_error("Invalid parameter"),null;var e;if(_.has_content()&&tsk_string_iequals(_.get_content_type(),"message/sipfrag")){var t=_.get_content_as_string();if(t){t.lastIndexOf("\r\n")!=t.length-2&&(t+="\r\n"),t+="\r\n";var s=tsk_ragel_state_create();if(tsk_ragel_state_init_str(s,t),e=tsip_message.prototype.Parse(s,!1),e&&!e.is_response())return tsk_utils_log_error("SipFrag doesn't contain response"),null}}return e}function x0100_Connected_2_Holding_X_oHold(_){var e,t=_[0],s=_[2];return t.o_msession_mgr?(e=t.o_msession_mgr.hold(s.media.e_type),t.set_action_curr(s),iret=t.send_invite(!1),0):(tsk_utils_log_warn("Media Session manager is Null"),0)}function x0101_Holding_2_Connected_X_ixxx(_){var e,t=_[0],s=_[1];return t.set_action_curr(null),(e=t.process_ro(s))?e:(s.is_response_to_invite()&&(e=t.send_ack(s)),s.is_2xx()?(t.signal_invite(tsip_event_invite_type_e.M_LOCAL_HOLD_OK,s.get_response_code(),s.get_response_phrase(),s),t.hold.b_local=!0):(t.signal_invite(tsip_event_invite_type_e.M_LOCAL_HOLD_NOK,s.get_response_code(),s.get_response_phrase(),s),t.hold.b_local=!1),e)}function x0102_Connected_2_Resuming_X_oResume(_){var e,t=_[0],s=_[2];return t.hold.b_local?t.o_msession_mgr?(e=t.o_msession_mgr.resume(s.media.e_type,!0),e=t.o_msession_mgr.resume(s.media.e_type,!1),t.set_action_curr(s),e=t.send_invite(!1),0):(tsk_utils_log_warn("Media Session manager is Null"),0):(tsk_utils_log_warn("Not on hold state"),0)}function x0103_Resuming_2_Connected_X_ixxx(_){var e,t=_[0],s=_[1];return t.set_action_curr(null),(e=t.process_ro(s))?e:(s.is_response_to_invite()&&(e=t.send_ack(s)),s.is_2xx()?(t.signal_invite(tsip_event_invite_type_e.M_LOCAL_RESUME_OK,s.get_response_code(),s.get_response_phrase(),s),t.hold.b_local=!1):(t.signal_invite(tsip_event_invite_type_e.M_LOCAL_RESUME_NOK,s.get_response_code(),s.get_response_phrase(),s),t.hold.b_local=!0),e)}function __tsip_dialog_invite_cond_is_bad_extension(_,e){var t,s,i,r;for(s=0;t=e.get_header_at(tsip_header_type_e.Require,s);++s){var a=!1,n=null;for(r=0;r<t.as_options.length;++r){for(a=!0,n=t.as_options[r],i=0;n&&i<tsip_dialog_invite.prototype.__ao_supported_options.length;++i)if(tsk_string_iequals(n,tsip_dialog_invite.prototype.__ao_supported_options[i])){a=!1;break}if(a)break}if(a&&n)return _.send_unsupported(e,n),!0}return!1}function __tsip_dialog_invite_cond_is_bad_content(_,e){var t,s=(_.e_state==tsip_dialog_state_e.initial&&!e.has_content(),_.o_msession_mgr&&!_.o_msession_mgr.has_ro());return(t=_.process_ro(e,s))?(t=_.send_error(e,488,"Not Acceptable",'SIP; cause=488; text="Bad content"'),!0):!1}function __tsip_dialog_invite_cond_is_toosmall(_,e){if(_.get_session().media.timers.i_timeout&&(e.is_supported("timer")||e.is_required("timer"))){var t;if(t=e.get_header(tsip_header_type_e.Session_Expires)){if(t.i_delta_seconds<TSIP_SESSION_EXPIRES_MIN_VALUE)return _.stimers.i_minse=TSIP_SESSION_EXPIRES_MIN_VALUE,_.send_response(e,422,"Session Interval Too Small",!1),!0;var s;_.stimers.i_timeout=t.i_delta_seconds,_.stimers.s_refresher=t.b_refresher_uas?"uas":"uac",_.stimers.b_is_refresher=tsk_string_iequals(_.stimers.s_refresher,"uas"),(s=e.get_header(tsip_header_type_e.Min_SE))&&(_.stimers.i_minse=s.i_value)}}return!1}function __tsip_dialog_invite_cond_enable_100rel(_,e){return e.is_supported("100rel")&&_.supported.b_100rel||e.is_required("100rel")}function __tsip_dialog_invite_cond_prack_matched(_,e){var t;if(!_.o_last_o1xxrel)return!1;if(t=e.get_header(tsip_header_type_e.RAck)){if(t.i_seq==_.i_rseq&&tsk_string_iequals(t.s_method,_.o_last_o1xxrel.o_hdr_CSeq.s_method)&&t.i_cseq==_.o_last_o1xxrel.o_hdr_CSeq.i_seq)return _.i_rseq++,!0;tsk_utils_log_warn("Failed to match PRACK request")}return!1}function s0000_Started_2_Terminated_X_iINVITE(_){return 0}function s0000_Started_2_Started_X_iINVITE(_){var e=_[0];return e.b_is_client=!1,0}function s0000_Started_2_InProgress_X_iINVITE(_){var e=_[0],t=_[1];return e.b_is_client=!1,e.o_last_iInvite=t,e.b_support_update=t.is_allowed("UPDATE"),e.update_with_invite(t),e.i_rseq=Math.floor(65535*Math.random()),e.require.b_100rel=!0,e.send_response(t,183,"Session in Progress",!0)}function s0000_Started_2_Ringing_X_iINVITE(_){var e,t=_[0],s=_[1];return t.b_is_client=!1,t.o_last_iInvite=s,t.b_support_update=s.is_allowed("UPDATE"),t.o_last_iInvite&&(t.o_last_iInvite.is_supported("100rel")||t.o_last_iInvite.is_required("100rel"))&&t.supported.b_100rel&&(t.require.b_100rel=!0),t.get_session().media.timers.i_timeout&&(e=s.get_header(tsip_header_type_e.Session_Expires))&&(t.stimers.timer.i_timeout=e.i_delta_seconds,t.stimers.s_refresher=e.s_refresher_uas?"uas":"uac",t.stimers.b_is_refresher=e.s_refresher_uas,t.require.b_timer=!0),t.update_with_invite(s),t.send_response(s,180,"Ringing",!1),t.signal_invite(tsip_event_invite_type_e.I_NEW_CALL,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Call",s),0}function s0000_InProgress_2_Ringing_X_iPRACK(_){var e,t=_[0],s=_[1];if(t.timer_cancel("100Rel"),0==(e=t.send_response(s,200,"OK",!1))&&++t.i_rseq,t.o_msession_mgr&&!t.o_msession_mgr.sdp.o_ro){if(!s.has_content())return e=t.send_error(t.o_last_iInvite,488,"Not Acceptable",'SIP; cause=488; text="Offer expected in the PRACK"'),-3;var i=t.o_msession_mgr&&!t.o_msession_mgr.has_ro();if(e=t.process_ro(s,i))return e=t.send_error(t.o_last_iInvite,488,"Not Acceptable",'SIP; cause=488; text="Bad content"'),-4}return e=t.send_response(t.o_last_iInvite,180,"Ringing",!1),t.signal_invite(tsip_event_invite_type_e.I_NEW_CALL,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Call",s),e}function s0000_InProgress_2_InProgress_X_iUPDATE(_){return tsk_utils_log_error("Not implemented"),0}function s0000_Inprogress_2_Terminated_X_iCANCEL(_){return tsk_utils_log_error("Not implemented"),0}function s0000_Ringing_2_Ringing_X_iPRACK(_){var e,t=_[0],s=_[1];return t.o_last_iInvite?(t.timer_cancel("100Rel"),e=t.send_response(s,200,"OK",!1),t.signal_invite(tsip_event_invite_type_e.I_REQUEST,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",s),e):0}function s0000_Ringing_2_Connected_X_Accept(_){var e,t=_[0],s=_[2];return t.e_state=tsip_dialog_state_e.ESTABLISHED,t.set_action_curr(s),t.o_msession_mgr&&!t.o_msession_mgr.is_started()&&t.o_msession_mgr.has_lo()&&t.o_msession_mgr.has_ro()&&(e=t.o_msession_mgr.start()),t.timer_cancel("100Rel"),e=t.send_response(t.o_last_iInvite,200,"OK",!0),t.stimers.i_timeout&&tsk_utils_log_error(t.stimers.b_is_refresher?"Not implemented":"Not implemented"),t.signal(tsip_event_code_e.DIALOG_CONNECTED,"In call"),!t.o_msession_mgr.has_lo(),e}function s0000_Ringing_2_Terminated_X_Reject(_){var e,t,s,i,r=_[0],a=_[2];return r.set_action_curr(a),r.timer_cancel("100Rel"),t=a&&a.line_resp.i_code>=300?a.line_resp.i_code:603,s=a&&a.line_resp.s_phrase?a.line_resp.s_phrase:"Decline",i=tsk_string_format('SIP; cause={0}; text="{1}"',t,s),e=r.send_error(r.o_last_iInvite,t,s,i),r.set_last_error(t,"Call Rejected"),e}function s0000_Ringing_2_Terminated_X_iCANCEL(_){var e,t,s=_[0],i=_[1];return(e=s.response_new(200,"OK",i))&&(t=s.get_stack().o_layer_transport.send(null,e)),t=s.send_error(s.o_last_iInvite,487,"Request Cancelled",'SIP; cause=487; text="Request Cancelled"'),s.set_last_error(487,"Request Cancelled"),s.signal_invite(tsip_event_invite_type_e.I_REQUEST,tsip_event_code_e.DIALOG_REQUEST_INCOMING,"Incoming Request",i),t}function s0000_Any_2_Any_X_timer100rel(_){var e,t=_[0];return t.o_last_o1xxrel?(t.i_timer100Rel<<=1)>=t.get_stack().o_timers.getA()<<6?(tsk_utils_log_error("Sending reliable 1xx failed"),-2):(e=t.response_send(t.o_last_o1xxrel))?e:(t.timer_schedule("invite","100Rel"),e):0}function tsip_dialog_register(_,e){tsip_dialog.call(this),this.o_last_iRegister=null,this.b_unregistering=!1,this.b_is_server=!1,this.o_timerRefresh=null,this.o_timerShutdown=null,this.i_timerShutdown=(tsip_dialog.prototype.__i_timer_shutdown<<1)/3,this.init(tsip_dialog_type_e.REGISTER,e,_,tsip_dialog_register_states_e.STARTED,tsip_dialog_register_states_e.TERMINATED),this.set_callback(__tsip_dialog_register_event_callback),this.o_fsm.set_debug_enabled(tsip_dialog_register.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_dialog_register_onterm,this),this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.STARTED,tsip_dialog_register_actions_e.O_REGISTER,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_Started_2_InProgress_X_oRegister,"tsip_dialog_register_Started_2_InProgress_X_oRegister"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.I_1XX,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_InProgress_2_InProgress_X_1xx,"tsip_dialog_register_InProgress_2_InProgress_X_1xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.I_2XX,__tsip_dialog_register_cond_client_unregistering,tsip_dialog_register_states_e.TERMINATED,__tsip_dialog_register_InProgress_2_Terminated_X_2xx,"tsip_dialog_register_InProgress_2_Terminated_X_2xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.I_2XX,__tsip_dialog_register_cond_client_registering,tsip_dialog_register_states_e.CONNECTED,__tsip_dialog_register_InProgress_2_Connected_X_2xx,"tsip_dialog_register_InProgress_2_Connected_X_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.I_401_407_421_494,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_InProgress_2_InProgress_X_401_407_421_494,"tsip_dialog_register_InProgress_2_InProgress_X_401_407_421_494"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.I_423,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_InProgress_2_InProgress_X_423,"tsip_dialog_register_InProgress_2_InProgress_X_423"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.I_300_to_699,tsip_dialog_register_states_e.TERMINATED,__tsip_dialog_register_InProgress_2_Terminated_X_300_to_699,"tsip_dialog_register_InProgress_2_Terminated_X_300_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.CANCEL,tsip_dialog_register_states_e.TERMINATED,__tsip_dialog_register_InProgress_2_Terminated_X_cancel,"tsip_dialog_register_InProgress_2_Terminated_X_cancel"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.HANGUP,tsip_dialog_register_states_e.TERMINATED,null,"tsip_dialog_register_InProgress_2_Terminated_X_hangup"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.INPROGRESS,tsip_dialog_register_actions_e.SHUTDOWN,tsip_dialog_register_states_e.TERMINATED,null,"tsip_dialog_register_InProgress_2_Terminated_X_shutdown"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_register_states_e.CONNECTED,tsip_dialog_register_actions_e.O_REGISTER,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_Connected_2_InProgress_X_oRegister,"tsip_dialog_register_Connected_2_InProgress_X_oRegister"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.HANGUP,__tsip_dialog_register_cond_not_silent_hangup,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_Any_2_InProgress_X_hangup,"tsip_dialog_register_Any_2_InProgress_X_hangup"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.HANGUP,__tsip_dialog_register_cond_silent_hangup,tsip_dialog_register_states_e.TERMINATED,null,"tsip_dialog_register_Any_2_InProgress_X_silenthangup"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.SHUTDOWN,__tsip_dialog_register_cond_not_silent_shutdown,tsip_dialog_register_states_e.INPROGRESS,__tsip_dialog_register_Any_2_InProgress_X_shutdown,"tsip_dialog_register_Any_2_InProgress_X_shutdown"),tsk_fsm_entry.prototype.Create(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.SHUTDOWN,__tsip_dialog_register_cond_silent_shutdown,tsip_dialog_register_states_e.TERMINATED,null,"tsip_dialog_register_Any_2_InProgress_X_silentshutdown"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.SHUTDOWN_TIMEDOUT,tsip_dialog_register_states_e.TERMINATED,null,"tsip_dialog_register_shutdown_timedout"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.TRANSPORT_ERROR,tsip_dialog_register_states_e.TERMINATED,__tsip_dialog_register_Any_2_Terminated_X_transportError,"tsip_dialog_register_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_register_actions_e.ERROR,tsip_dialog_register_states_e.TERMINATED,__tsip_dialog_register_Any_2_Terminated_X_Error,"tsip_dialog_register_Any_2_Terminated_X_Error"))}function __tsip_dialog_register_timer_callback(_,e){var t=-1;return _&&(_.o_timerRefresh==e?t=_.fsm_act(tsip_dialog_register_actions_e.O_REGISTER,null,null):_.o_timerShutdown==e&&(t=_.fsm_act(tsip_dialog_register_actions_e.SHUTDOWN,null,null))),t}function __tsip_dialog_register_event_callback(_,e,t){var s=-1;switch(e){case tsip_dialog_event_type_e.I_MSG:t&&(t.is_response()?s=t.is_1xx()?_.fsm_act(tsip_dialog_register_actions_e.I_1XX,t,null):t.is_2xx()?_.fsm_act(tsip_dialog_register_actions_e.I_2XX,t,null):t.is_response_xxx(401)||t.is_response_xxx(407)||t.is_response_xxx(421)||t.is_response_xxx(494)?_.fsm_act(tsip_dialog_register_actions_e.I_401_407_421_494,t,null):t.is_response_xxx(423)?_.fsm_act(tsip_dialog_register_actions_e.I_423,t,null):_.fsm_act(tsip_dialog_register_actions_e.ERROR,t,null):t.is_register()&&(s=_.fsm_act(tsip_dialog_register_actions_e.I_REGISTER,t,null)));break;case tsip_dialog_event_type_e.CANCELED:s=_.fsm_act(tsip_dialog_register_actions_e.CANCEL,t,null);break;case tsip_dialog_event_type_e.TERMINATED:case tsip_dialog_event_type_e.TIMEDOUT:case tsip_dialog_event_type_e.ERROR:case tsip_dialog_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_dialog_register_actions_e.TRANSPORT_ERROR,t,null)}return s}function __tsip_dialog_register_cond_client_unregistering(_,e){return!_.b_is_server&&_.b_unregistering}function __tsip_dialog_register_cond_client_registering(_,e){return!__tsip_dialog_register_cond_client_unregistering(_,e)}function __tsip_dialog_register_cond_silent_hangup(_,e){return _.o_session.b_silent_hangup}function __tsip_dialog_register_cond_not_silent_hangup(_,e){return!__tsip_dialog_register_cond_silent_hangup(_,e)}function __tsip_dialog_register_cond_silent_shutdown(_,e){return __tsip_dialog_register_cond_silent_hangup(_,e)}function __tsip_dialog_register_cond_not_silent_shutdown(_,e){return!__tsip_dialog_register_cond_silent_shutdown(_,e)}function __tsip_dialog_register_Started_2_InProgress_X_oRegister(_){var e=_[0],t=_[2];return e.b_running=!0,e.set_action_curr(t),e.signal(tsip_event_code_e.DIALOG_CONNECTING,"Connecting..."),e.send_register(!0)}function __tsip_dialog_register_InProgress_2_InProgress_X_1xx(_){var e=_[0],t=_[1];return e.signal_register(tsip_event_register_type_e.AO_REGISTER,t.get_response_code(),t.get_response_phrase(),t),e.update_with_response(t)}function __tsip_dialog_register_InProgress_2_Terminated_X_2xx(_){var e=_[0],t=_[1];return e.set_last_error(t.get_response_code(),t.get_response_phrase(),t),e.signal_register(tsip_event_register_type_e.AO_UNREGISTER,t.get_response_code(),t.get_response_phrase(),t),0}function __tsip_dialog_register_InProgress_2_Connected_X_2xx(_){var e,t,s,i,r,a=_[0],n=_[1],o=a.e_state==tsip_dialog_state_e.INITIAL,p=a.get_stack();for(p.ao_uri_associated_uris.splice(0,p.ao_uri_associated_uris.length),p.ao_uri_service_routes.splice(0,p.ao_uri_service_routes.length),p.ao_uri_paths.splice(0,p.ao_uri_paths.length),t=0;r=n.get_header_at(tsip_header_type_e.P_Associated_URI,t);++t)r.o_uri&&p.ao_uri_associated_uris.push(r.o_uri);for(t=0;i=n.get_header_at(tsip_header_type_e.Service_Route,t);++t)i.o_uri&&p.ao_uri_service_routes.push(i.o_uri);for(t=0;s=n.get_header_at(tsip_header_type_e.Path,t);++t)s.o_uri&&p.ao_uri_paths.push(s.o_uri);if(o){var c,d=!0,l=null;for(t=0;t<p.ao_uri_associated_uris.length;++t)if((c=p.ao_uri_associated_uris[t].o_uri)&&(0==t&&(l=p.ao_uri_associated_uris[t].o_uri),0==p.identity.o_uri_pref.compare(c))){d=!1;break}d&&l&&(p.identity.o_uri_pref=l)}return 0!=(e=a.update_with_response(n))?e:(a.set_action_curr(null),a.i_timerRefresh=a.get_newdelay(n),a.timer_schedule("register","Refresh"),a.signal_register(tsip_event_register_type_e.AO_REGISTER,n.get_response_code(),n.get_response_phrase(),n),o&&a.signal(tsip_event_code_e.DIALOG_CONNECTED,"Connected"),e)}function __tsip_dialog_register_InProgress_2_InProgress_X_401_407_421_494(_){var e,t=_[0],s=_[1];return(e=t.update_with_response(s))?(t.signal_register(tsip_event_register_type_e.AO_REGISTER,s.get_response_code(),s.get_response_phrase(),s),t.set_last_error(s.get_response_code(),s.get_response_phrase(),s),e):t.send_register(!1)}function __tsip_dialog_register_InProgress_2_InProgress_X_423(_){var e,t=_[0],s=_[1],i=0;return e=s.get_header(tsip_header_type_e.Min_Expires),e?(t.i_expires=1e3*e.i_value,i=t.send_register(!1)):(tsk_utils_log_error("Missing header: Min_Expires"),i=-1),i}function __tsip_dialog_register_InProgress_2_Terminated_X_300_to_699(_){var e=_[0],t=_[1];return e.set_last_error(t.get_response_code(),t.get_response_phrase(),t),e.signal_register(e.b_unregistering?tsip_event_register_type_e.AO_UNREGISTER:tsip_event_register_type_e.AO_REGISTER,t.get_response_code(),t.get_response_phrase(),t),0}function __tsip_dialog_register_InProgress_2_Terminated_X_cancel(_){var e,t=_[0],s=_[3];return t.set_action_curr(s),e=t.get_layer_transac().cancel_by_dialog(t),t.signal(tsip_event_code_e.DIALOG_CANCELLED,"Registration cancelled"),e}function __tsip_dialog_register_Connected_2_InProgress_X_oRegister(_){var e=_[0],t=_[3];return e.set_action_curr(t),e.send_register(!0)}function __tsip_dialog_register_Any_2_InProgress_X_hangup(_){var e=_[0],t=_[3];return e.set_action_curr(t),e.signal(tsip_event_code_e.DIALOG_TERMINATING,"Disconnecting..."),e.b_unregistering=!0,e.send_register(!0)}function __tsip_dialog_register_Any_2_InProgress_X_shutdown(_){var e=_[0];return e.timer_schedule("register","Shutdown"),e.signal(tsip_event_code_e.DIALOG_TERMINATING,"Disconnecting..."),e.b_unregistering=!0,e.send_register(!0)}function __tsip_dialog_register_Any_2_Terminated_X_transportError(_){var e=_[0];return e.signal(tsip_event_code_e.DIALOG_TRANSPORT_ERROR,"Transport error"),0}function __tsip_dialog_register_Any_2_Terminated_X_Error(_){var e=_[0],t=_[1];return t?(e.set_last_error(t.get_response_code(),t.get_response_phrase(),t),e.signal_register(e.b_unregistering?tsip_event_register_type_e.AO_UNREGISTER:tsip_event_register_type_e.AO_REGISTER,t.get_response_code(),t.get_response_phrase(),t)):e.signal(tsip_event_code_e.DIALOG_GLOBAL_ERROR,"Global error"),0}function __tsip_dialog_register_onterm(_){return tsk_utils_log_info("=== REGISTER Dialog terminated ==="),_.timer_cancel("Refresh"),_.timer_cancel("Shutdown"),_.signal(tsip_event_code_e.DIALOG_TERMINATED,_.last_error.s_phrase?_.last_error.s_phrase:"Disconnected",_.last_error.o_message),_.deinit()}function tsip_dialog_layer(_){return _?(this.o_stack=_,this.ao_dialogs=new Array,this.shutdown={},this.shutdown.b_inprogress=!1,this.shutdown.b_phase2=!1,void(this.b_locked=!1)):(tsk_utils_log_error("Invalid argument"),null)}function tsip_dialog_layer_find_result(_,e){this.o_dialog=_,this.b_cid_matched=e}function tsip_header(_){this.e_type=_,this.ao_params=new Array}function tsip_header_Int(_,e){tsip_header.call(this,_),this.i_value=e}function tsip_header_Content_Length(_){tsip_header_Int.call(this,tsip_header_type_e.Content_Length,_)}function tsip_header_Expires(_){tsip_header_Int.call(this,tsip_header_type_e.Expires,_)}function tsip_header_Max_Forwards(_){tsip_header_Int.call(this,tsip_header_type_e.Max_Forwards,_)}function tsip_header_Min_Expires(_){tsip_header_Int.call(this,tsip_header_type_e.Min_Expires,_)}function tsip_header_Min_SE(_){tsip_header_Int.call(this,tsip_header_type_e.Min_SE,_)}function tsip_header_RSeq(_){tsip_header_Int.call(this,tsip_header_type_e.RSeq,_)}function tsip_header_NameAddr(_,e,t){tsip_header.call(this,_),this.s_display_name=e?e.s_display_name:null,this.o_uri=e,this.s_tag=t}function tsip_header_From(_,e){tsip_header_NameAddr.call(this,tsip_header_type_e.From,_,e)}function tsip_header_To(_,e){tsip_header_NameAddr.call(this,tsip_header_type_e.To,_,e)}function tsip_header_Refer_To(_){tsip_header_NameAddr.call(this,tsip_header_type_e.Refer_To,_)}function tsip_header_Referred_By(_){tsip_header_NameAddr.call(this,tsip_header_type_e.Referred_By,_)}function tsip_header_P_Asserted_Identity(_){tsip_header_NameAddr.call(this,tsip_header_type_e.P_Asserted_Identity,_)}function tsip_header_P_Associated_URI(_){tsip_header_NameAddr.call(this,tsip_header_type_e.P_Associated_URI,_)}function tsip_header_P_Preferred_Identity(_){tsip_header_NameAddr.call(this,tsip_header_type_e.P_Preferred_Identity,_)}function tsip_header_Path(_){tsip_header_NameAddr.call(this,tsip_header_type_e.Path,_)}function tsip_header_Record_Route(_){tsip_header_NameAddr.call(this,tsip_header_type_e.Record_Route,_)}function tsip_header_Route(_){tsip_header_NameAddr.call(this,tsip_header_type_e.Route,_)}function tsip_header_Service_Route(_){tsip_header_NameAddr.call(this,tsip_header_type_e.Service_Route,_)}function tsip_header_Str(_,e){tsip_header.call(this,_),this.s_value=e}function tsip_header_Call_ID(_){tsip_header_Str.call(this,tsip_header_type_e.Call_ID,_)}function tsip_header_Date(_){tsip_header_Str.call(this,tsip_header_type_e.Date,_)}function tsip_header_Event(_){tsip_header_Str.call(this,tsip_header_type_e.Event,_)}function tsip_header_Organization(_){tsip_header_Str.call(this,tsip_header_type_e.Organization,_)}function tsip_header_P_Access_Network_Info(_){tsip_header_Str.call(this,tsip_header_type_e.P_Access_Network_Info,_)}function tsip_header_P_Charging_Function_Addresses(_){tsip_header_Str.call(this,tsip_header_type_e.P_Charging_Function_Addresses,_)}function tsip_header_Server(_){tsip_header_Str.call(this,tsip_header_type_e.Server,_)}function tsip_header_SIP_ETag(_){tsip_header_Str.call(this,tsip_header_type_e.SIP_ETag,_)}function tsip_header_SIP_If_Match(_){tsip_header_Str.call(this,tsip_header_type_e.SIP_If_Match,_)}function tsip_header_User_Agent(_){tsip_header_Str.call(this,tsip_header_type_e.User_Agent,_)}function tsip_header_Warning(_){tsip_header_Str.call(this,tsip_header_type_e.Warning,_)}function tsip_header_Dummy(_,e){tsip_header_Str.call(this,tsip_header_type_e.Dummy,e),this.s_name=_}function tsip_header_StrArray(_,e){tsip_header.call(this,_),this.as_values=new Array,e&&this.as_values.push(e)}function tsip_header_Allow(_){tsip_header_StrArray.call(this,tsip_header_type_e.Allow,_)}function tsip_header_Allow_Events(_){tsip_header_StrArray.call(this,tsip_header_type_e.Allow_Events,_)}function tsip_header_Privacy(_){tsip_header_StrArray.call(this,tsip_header_type_e.Privacy,_)}function tsip_header_Require(_){tsip_header_StrArray.call(this,tsip_header_type_e.Require,_)}function tsip_header_Supported(_){tsip_header_StrArray.call(this,tsip_header_type_e.Supported,_)}function tsip_header_Authorization(){tsip_header.call(this,tsip_header_type_e.Authorization),this.s_scheme=null,this.s_username=null,this.s_realm=null,this.s_nonce=null,
this.s_uri=null,this.s_response=null,this.s_algorithm=null,this.s_cnonce=null,this.s_opaque=null,this.s_qop=null,this.s_nc=null}function tsip_header_Contact(){tsip_header.call(this,tsip_header_type_e.Contact),this.s_display_name=null,this.o_uri=null,this.i_expires=-1}function tsip_header_Content_Type(_){tsip_header.call(this,tsip_header_type_e.Content_Type),this.s_type=_}function tsip_header_CSeq(_,e){tsip_header.call(this,tsip_header_type_e.CSeq),this.i_seq=_,this.s_method=e,e?this.e_req_type=tsip_message.prototype.GetRequestType(this.s_method):this.e_req_type=tsip_request_type_e.UNKNOWN}function tsip_header_RAck(_,e,t){tsip_header.call(this,tsip_header_type_e.RAck),this.i_seq=_,this.i_cseq=e,this.s_method=t}function tsip_header_Refer_Sub(_){tsip_header.call(this,tsip_header_type_e.Refer_Sub),this.b_sub=_}function tsip_header_Session_Expires(_,e){tsip_header.call(this,tsip_header_type_e.Session_Expires),this.i_delta_seconds=_,this.b_refresher_uas=e}function tsip_header_Subscription_State(_,e,t,s){tsip_header.call(this,tsip_header_type_e.Subscription_State),this.s_state=_,this.s_reason=e,this.i_expires=t,this.i_retry_after=s}function tsip_header_Via(_,e,t,s,i){tsip_header.call(this,tsip_header_type_e.Via),this.s_branch=null,this.s_host=s,this.i_port=i,this.s_comp=null,this.s_sigcomp_id=null,this.s_received=null,this.s_maddr=null,this.s_proto_name=_,this.s_proto_version=e,this.s_transport=t,this.i_rport=-1,this.i_ttl=-1,this.is_transport_reliable=function(){return tsk_string_iequals(this.s_transport,"UDP")},this.is_transport_unreliable=function(){return!this.is_transport_reliable()}}function tsip_header_WWW_Authenticate(){tsip_header.call(this,tsip_header_type_e.WWW_Authenticate),this.s_scheme=null,this.s_realm=null,this.s_domain=null,this.s_nonce=null,this.s_opaque=null,this.b_stale=!1,this.s_algorithm=null,this.s_qop=null}function prev_not_comma(_,e){return _.i_pe<=e||","!=_.o_data[e-1]}function tsip_header_parse(_,e){var t=0,s=_.i_tag_start,i=_.i_tag_end,r=_.o_data,a=_.s_data.substring(_.i_tag_start,_.i_tag_start+(_.i_tag_end-_.i_tag_start));t=tsip_machine_parser_headers_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_headers_key_offsets[t],o=_tsip_machine_parser_headers_index_offsets[t],n=_tsip_machine_parser_headers_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_headers_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_headers_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_headers_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_headers_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_headers_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_headers_indicies[o],t=_tsip_machine_parser_headers_trans_targs[o],0!=_tsip_machine_parser_headers_trans_actions[o])for(c=_tsip_machine_parser_headers_trans_actions[o],d=_tsip_machine_parser_headers_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_headers_actions[c-1]){case 0:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 1:var f=tsip_header_Allow.prototype.Parse(a);e.add_headers(f);break;case 2:var f=tsip_header_Authorization.prototype.Parse(a);e.add_headers(f);break;case 3:var f=tsip_header_Call_ID.prototype.Parse(a);e.add_headers(f);break;case 4:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 5:for(var E=tsip_header_Contact.prototype.Parse(a),k=0;k<E.length;++k)e.add_header(E[k]);break;case 6:var f=tsip_header_Content_Length.prototype.Parse(a);e.add_headers(f);break;case 7:var f=tsip_header_Content_Type.prototype.Parse(a);e.add_headers(f);break;case 8:var f=tsip_header_CSeq.prototype.Parse(a);e.add_headers(f);break;case 9:var f=tsip_header_Event.prototype.Parse(a);e.add_headers(f);break;case 10:var f=tsip_header_Expires.prototype.Parse(a);e.add_headers(f);break;case 11:var f=tsip_header_From.prototype.Parse(a);e.add_headers(f);break;case 12:var f=tsip_header_Max_Forwards.prototype.Parse(a);e.add_headers(f);break;case 13:var f=tsip_header_WWW_Authenticate.prototype.Parse(a);e.add_headers(f),s=i-1;break;case 14:var f=tsip_header_Authorization.prototype.Parse(a);e.add_headers(f);break;case 15:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 16:var E=tsip_header_Record_Route.prototype.Parse(a);if(E)for(var k=0;k<E.length;++k)e.add_header(E[k]);break;case 17:var f=tsip_header_Refer_To.prototype.Parse(a);e.add_headers(f);break;case 18:var f=tsip_header_Referred_By.prototype.Parse(a);e.add_headers(f);break;case 19:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 20:var f=tsip_header_Require.prototype.Parse(a);e.add_headers(f);break;case 21:var E=tsip_header_Route.prototype.Parse(a);if(E)for(var k=0;k<E.length;++k)e.add_header(E[k]);break;case 22:var f=tsip_header_RSeq.prototype.Parse(a);e.add_headers(f);break;case 23:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 24:var f=tsip_header_Supported.prototype.Parse(a);e.add_headers(f);break;case 25:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 26:var f=tsip_header_To.prototype.Parse(a);e.add_headers(f);break;case 27:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f);break;case 28:var f=tsip_header_User_Agent.prototype.Parse(a);e.add_headers(f);break;case 29:var E=tsip_header_Via.prototype.Parse(a);if(E)for(var k=0;k<E.length;++k)e.add_header(E[k]);break;case 30:var f=tsip_header_WWW_Authenticate.prototype.Parse(a);e.add_headers(f),s=i-1;break;case 31:var f=tsip_header_Dummy.prototype.Parse(a);e.add_headers(f)}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 419>t?(tsk_utils_log_error("Failed to parse header: "+a),-2):0}function tsip_transac(){this.e_type=tsip_transac_type_e.NONE,this.o_dialog=null,this.o_fsm=null,this.b_reliable=!0,this.b_running=!1,this.b_initialized=!1,this.s_branch=null,this.i_cseq_value=0,this.s_cseq_method=null,this.s_callid=null,this.fn_callback=null}function tsip_transac_compare(_,e){return _&&e&&_.s_branch==e.s_branch&&_.s_cseq_method==e.s_cseq_method?0:-1}function tsip_transac_ict(_,e,t,s){var i;return s&&(i=s.get_stack())?(tsip_transac.call(this),this.init(tsip_transac_type_e.ICT,_,e,"INVITE",t,s,tsip_transac_ict_states_e.STARTED,tsip_transac_ict_states_e.TERMINATED),this.set_callback(__tsip_transac_ict_event_callback),this.o_fsm.set_debug_enabled(tsip_transac_ict.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_transac_ict_onterm,this),this.o_timerA=null,this.o_timerB=null,this.o_timerD=null,this.o_timerM=null,this.i_timerA=i.o_timers.getA(),this.i_timerB=i.o_timers.getB(),this.i_timerD=_?0:i.o_timers.getD(),this.i_timerM=i.o_timers.getM(),void this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.STARTED,tsip_transac_ict_actions_e.SEND,tsip_transac_ict_states_e.CALLING,__tsip_transac_ict_Started_2_Calling_X_send,"tsip_transac_ict_Started_2_Calling_X_send"),tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_transac_ict_states_e.STARTED,"tsip_transac_ict_Started_2_Started_X_any"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.CALLING,tsip_transac_ict_actions_e.TIMER_A,tsip_transac_ict_states_e.CALLING,__tsip_transac_ict_Calling_2_Calling_X_timerA,"tsip_transac_ict_Calling_2_Calling_X_timerA"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.CALLING,tsip_transac_ict_actions_e.TIMER_B,tsip_transac_ict_states_e.TERMINATED,__tsip_transac_ict_Calling_2_Terminated_X_timerB,"tsip_transac_ict_Calling_2_Terminated_X_timerB"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.CALLING,tsip_transac_ict_actions_e.I_300_to_699,tsip_transac_ict_states_e.COMPLETED,__tsip_transac_ict_Calling_2_Completed_X_300_to_699,"tsip_transac_ict_Calling_2_Completed_X_300_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.CALLING,tsip_transac_ict_actions_e.I_1XX,tsip_transac_ict_states_e.PROCEEDING,__tsip_transac_ict_Calling_2_Proceeding_X_1xx,"tsip_transac_ict_Calling_2_Proceeding_X_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.CALLING,tsip_transac_ict_actions_e.I_2XX,tsip_transac_ict_states_e.ACCEPTED,__tsip_transac_ict_Calling_2_Accepted_X_2xx,"tsip_transac_ict_Calling_2_Accepted_X_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.PROCEEDING,tsip_transac_ict_actions_e.I_1XX,tsip_transac_ict_states_e.PROCEEDING,__tsip_transac_ict_Proceeding_2_Proceeding_X_1xx,"tsip_transac_ict_Proceeding_2_Proceeding_X_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.PROCEEDING,tsip_transac_ict_actions_e.I_300_to_699,tsip_transac_ict_states_e.COMPLETED,__tsip_transac_ict_Proceeding_2_Completed_X_300_to_699,"tsip_transac_ict_Proceeding_2_Completed_X_300_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.PROCEEDING,tsip_transac_ict_actions_e.I_2XX,tsip_transac_ict_states_e.ACCEPTED,__tsip_transac_ict_Proceeding_2_Accepted_X_2xx,"tsip_transac_ict_Proceeding_2_Accepted_X_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.COMPLETED,tsip_transac_ict_actions_e.I_300_to_699,tsip_transac_ict_states_e.COMPLETED,__tsip_transac_ict_Completed_2_Completed_X_300_to_699,"tsip_transac_ict_Completed_2_Completed_X_300_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.COMPLETED,tsip_transac_ict_actions_e.TIMER_D,tsip_transac_ict_states_e.TERMINATED,__tsip_transac_ict_Completed_2_Terminated_X_timerD,"tsip_transac_ict_Completed_2_Terminated_X_timerD"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.ACCEPTED,tsip_transac_ict_actions_e.I_2XX,tsip_transac_ict_states_e.ACCEPTED,__tsip_transac_ict_Accepted_2_Accepted_X_2xx,"tsip_transac_ict_Accepted_2_Accepted_X_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ict_states_e.ACCEPTED,tsip_transac_ict_actions_e.TIMER_M,tsip_transac_ict_states_e.TERMINATED,__tsip_transac_ict_Accepted_2_Terminated_X_timerM,"tsip_transac_ict_Accepted_2_Terminated_X_timerM"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_ict_actions_e.TRANSPORT_ERROR,tsip_transac_ict_states_e.TERMINATED,__tsip_transac_ict_Any_2_Terminated_X_transportError,"tsip_transac_ict_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_ict_actions_e.ERROR,tsip_transac_ict_states_e.TERMINATED,__tsip_transac_ict_Any_2_Terminated_X_Error,"tsip_transac_ict_Any_2_Terminated_X_Error"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_ict_actions_e.CANCEL,tsip_transac_ict_states_e.TERMINATED,__tsip_transac_ict_Any_2_Terminated_X_cancel,"tsip_transac_ict_Any_2_Terminated_X_cancel"))):(tsk_utils_log_error("Invalid argument"),null)}function __tsip_transac_ict_Started_2_Calling_X_send(_){var e=_[0];return e.send(e.s_branch,e.o_request),e.b_reliable||e.timer_schedule("ict","A"),e.timer_schedule("ict","B"),0}function __tsip_transac_ict_Calling_2_Calling_X_timerA(_){var e=_[0];return e.send(e.s_branch,e.o_request),e.i_timerA<<=1,e.timer_schedule("ict","A"),0}function __tsip_transac_ict_Calling_2_Terminated_X_timerB(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TIMEDOUT,null),0}function __tsip_transac_ict_Calling_2_Completed_X_300_to_699(_){var e,t=_[0],s=_[1];return t.b_reliable||t.timer_cancel("A"),t.timer_cancel("B"),t.timer_schedule("ict","D"),(e=t.send_ack(s))<=0?e:t.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,s)}function __tsip_transac_ict_Calling_2_Proceeding_X_1xx(_){var e=_[0],t=_[1];return e.b_reliable||e.timer_cancel("A"),e.timer_cancel("B"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function __tsip_transac_ict_Calling_2_Accepted_X_2xx(_){var e=_[0],t=_[1];return e.timer_schedule("ict","M"),e.b_reliable||e.timer_schedule("ict","A"),e.timer_schedule("ict","B"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function __tsip_transac_ict_Proceeding_2_Proceeding_X_1xx(_){var e=_[0],t=_[1];return e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function __tsip_transac_ict_Proceeding_2_Completed_X_300_to_699(_){var e,t=_[0],s=_[1];return t.b_reliable||t.timer_cancel("A"),t.timer_cancel("B"),t.timer_schedule("ict","D"),(e=t.send_ack(s))<=0?e:t.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,s)}function __tsip_transac_ict_Proceeding_2_Accepted_X_2xx(_){var e=_[0],t=_[1];return e.timer_schedule("ict","M"),e.b_reliable||e.timer_schedule("ict","A"),e.timer_schedule("ict","B"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function __tsip_transac_ict_Completed_2_Completed_X_300_to_699(_){var e=_[0],t=_[1];return e.send_ack(t)<=0?-1:0}function __tsip_transac_ict_Completed_2_Terminated_X_timerD(_){return 0}function __tsip_transac_ict_Accepted_2_Accepted_X_2xx(_){var e=_[0],t=_[1];return e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function __tsip_transac_ict_Accepted_2_Terminated_X_timerM(_){return 0}function __tsip_transac_ict_Any_2_Terminated_X_transportError(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null)}function __tsip_transac_ict_Any_2_Terminated_X_Error(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.ERROR,null)}function __tsip_transac_ict_Any_2_Terminated_X_cancel(_){return 0}function __tsip_transac_ict_onterm(_){return _.timer_cancel("A"),_.timer_cancel("B"),_.timer_cancel("D"),_.timer_cancel("M"),_.deinit()}function __tsip_transac_ict_event_callback(_,e,t){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var s=0;switch(e){case tsip_transac_event_type_e.INCOMING_MSG:t&&t.is_response()&&(t.is_1xx()?s=_.fsm_act(tsip_transac_ict_actions_e.I_1XX,t):t.is_2xx()?s=_.fsm_act(tsip_transac_ict_actions_e.I_2XX,t):t.is_3456()?s=_.fsm_act(tsip_transac_ict_actions_e.I_300_to_699,t):tsk_utils_log_warn("Not supported status code: "+t.get_response_code()));break;case tsip_transac_event_type_e.CANCELED:case tsip_transac_event_type_e.TERMINATED:case tsip_transac_event_type_e.TIMEDOUT:break;case tsip_transac_event_type_e.ERROR:s=_.fsm_act(tsip_transac_ict_actions_e.ERROR,t);break;case tsip_transac_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_transac_ict_actions_e.TRANSPORT_ERROR,t)}return s}function __tsip_transac_ict_timer_callback(_,e){_&&(e==_.o_timerA?_.fsm_act(tsip_transac_ict_actions_e.TIMER_A,null):e==_.o_timerB?_.fsm_act(tsip_transac_ict_actions_e.TIMER_B,null):e==_.o_timerD?_.fsm_act(tsip_transac_ict_actions_e.TIMER_D,null):e==_.o_timerM&&_.fsm_act(tsip_transac_ict_actions_e.TIMER_M,null))}function tsip_transac_ist(_,e,t,s){var i;return s&&(i=s.get_stack())?(tsip_transac.call(this),this.o_lastResponse=null,this.init(tsip_transac_type_e.IST,_,e,"INVITE",t,s,tsip_transac_ist_states_e.STARTED,tsip_transac_ist_states_e.TERMINATED),this.set_callback(__tsip_transac_ist_event_callback),this.o_fsm.set_debug_enabled(tsip_transac_ist.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_transac_ist_onterm,this),this.o_timerH=null,this.o_timerI=null,this.o_timerG=null,this.o_timerL=null,this.o_timerX=null,this.i_timerH=i.o_timers.getH(),this.i_timerI=_?0:i.o_timers.getI(),this.i_timerG=i.o_timers.getG(),this.i_timerL=i.o_timers.getL(),this.i_timerX=i.o_timers.getG(),void this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.STARTED,tsip_transac_ist_actions_e.RECV_INVITE,tsip_transac_ist_states_e.PROCEEDING,__tsip_transac_ist_Started_2_Proceeding_X_INVITE,"tsip_transac_ist_Started_2_Proceeding_X_INVITE"),tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_transac_ist_states_e.STARTED,"tsip_transac_ist_Started_2_Started_X_any"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.PROCEEDING,tsip_transac_ist_actions_e.RECV_INVITE,tsip_transac_ist_states_e.PROCEEDING,__tsip_transac_ist_Proceeding_2_Proceeding_X_INVITE,"tsip_transac_ist_Proceeding_2_Proceeding_X_INVITE"),tsk_fsm_entry.prototype.Create(tsip_transac_ist_states_e.PROCEEDING,tsip_transac_ist_actions_e.SEND_1XX,__tsip_transac_ist_cond_is_resp2invite,tsip_transac_ist_states_e.PROCEEDING,__tsip_transac_ist_Proceeding_2_Proceeding_X_1xx,"tsip_transac_ist_Proceeding_2_Proceeding_X_1xx"),tsk_fsm_entry.prototype.Create(tsip_transac_ist_states_e.PROCEEDING,tsip_transac_ist_actions_e.SEND_300_to_699,__tsip_transac_ist_cond_is_resp2invite,tsip_transac_ist_states_e.COMPLETED,__tsip_transac_ist_Proceeding_2_Completed_X_300_to_699,"tsip_transac_ist_Proceeding_2_Completed_X_300_to_699"),tsk_fsm_entry.prototype.Create(tsip_transac_ist_states_e.PROCEEDING,tsip_transac_ist_actions_e.SEND_2XX,__tsip_transac_ist_cond_is_resp2invite,tsip_transac_ist_states_e.ACCEPTED,__tsip_transac_ist_Proceeding_2_Accepted_X_2xx,"tsip_transac_ist_Proceeding_2_Accepted_X_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.COMPLETED,tsip_transac_ist_actions_e.RECV_INVITE,tsip_transac_ist_states_e.COMPLETED,__tsip_transac_ist_Completed_2_Completed_INVITE,"tsip_transac_ist_Completed_2_Completed_INVITE"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.COMPLETED,tsip_transac_ist_actions_e.TIMER_G,tsip_transac_ist_states_e.COMPLETED,__tsip_transac_ist_Completed_2_Completed_timerG,"tsip_transac_ist_Completed_2_Completed_timerG"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.COMPLETED,tsip_transac_ist_actions_e.TIMER_H,tsip_transac_ist_states_e.TERMINATED,__tsip_transac_ist_Completed_2_Terminated_timerH,"tsip_transac_ist_Completed_2_Terminated_timerH"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.COMPLETED,tsip_transac_ist_actions_e.RECV_ACK,tsip_transac_ist_states_e.CONFIRMED,__tsip_transac_ist_Completed_2_Confirmed_ACK,"tsip_transac_ist_Completed_2_Confirmed_ACK"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.ACCEPTED,tsip_transac_ist_actions_e.RECV_INVITE,tsip_transac_ist_states_e.ACCEPTED,__tsip_transac_ist_Accepted_2_Accepted_INVITE,"tsip_transac_ist_Accepted_2_Accepted_INVITE"),tsk_fsm_entry.prototype.Create(tsip_transac_ist_states_e.ACCEPTED,tsip_transac_ist_actions_e.SEND_2XX,__tsip_transac_ist_cond_is_resp2invite,tsip_transac_ist_states_e.ACCEPTED,__tsip_transac_ist_Accepted_2_Accepted_2xx,"tsip_transac_ist_Accepted_2_Accepted_2xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.ACCEPTED,tsip_transac_ist_actions_e.TIMER_X,tsip_transac_ist_states_e.ACCEPTED,__tsip_transac_ist_Accepted_2_Accepted_timerX,"tsip_transac_ist_Accepted_2_Accepted_timerX"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.ACCEPTED,tsip_transac_ist_actions_e.RECV_ACK,tsip_transac_ist_states_e.ACCEPTED,__tsip_transac_ist_Accepted_2_Accepted_iACK,"tsip_transac_ist_Accepted_2_Accepted_iACK"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.ACCEPTED,tsip_transac_ist_actions_e.TIMER_L,tsip_transac_ist_states_e.TERMINATED,__tsip_transac_ist_Accepted_2_Terminated_timerL,"tsip_transac_ist_Accepted_2_Terminated_timerL"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_ist_states_e.CONFIRMED,tsip_transac_ist_actions_e.TIMER_I,tsip_transac_ist_states_e.TERMINATED,__tsip_transac_ist_Confirmed_2_Terminated_timerI,"tsip_transac_ist_Confirmed_2_Terminated_timerI"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_ist_actions_e.TRANSPORT_ERROR,tsip_transac_ist_states_e.TERMINATED,__tsip_transac_ist_Any_2_Terminated_X_transportError,"tsip_transac_ist_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_ist_actions_e.ERROR,tsip_transac_ist_states_e.TERMINATED,__tsip_transac_ist_Any_2_Terminated_X_Error,"tsip_transac_ist_Any_2_Terminated_X_Error"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_ist_actions_e.CANCEL,tsip_transac_ist_states_e.TERMINATED,__tsip_transac_ist_Any_2_Terminated_X_cancel,"tsip_transac_ist_Any_2_Terminated_X_cancel"))):(tsk_utils_log_error("Invalid argument"),null)}function __tsip_transac_ist_cond_is_resp2invite(_,e){return e.is_response_to_invite()}function __tsip_transac_ist_Started_2_Proceeding_X_INVITE(_){var e=_[0],t=_[1],s=-1;if(t){var i;(i=new tsip_response(100,"Trying (sent from the Transaction Layer)",t))&&(s=e.send(e.s_branch,i)>0?0:-1,e.set_last_response(i))}return 0==s&&(s=e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)),s}function __tsip_transac_ist_Proceeding_2_Proceeding_X_INVITE(_){var e=_[0],t=-1;return e.o_lastResponse&&(t=e.send(e.s_branch,e.o_lastResponse)>0?0:-1),t}function __tsip_transac_ist_Proceeding_2_Proceeding_X_1xx(_){var e,t=_[0],s=_[1];return e=t.send(t.s_branch,s)>0?0:-1,t.set_last_response(s),e}function __tsip_transac_ist_Proceeding_2_Completed_X_300_to_699(_){var e,t=_[0],s=_[1];return t.b_reliable||t.timer_schedule("ist","G"),e=t.send(t.s_branch,s)>0?0:-1,t.set_last_response(s),t.timer_schedule("ist","H"),e}function __tsip_transac_ist_Proceeding_2_Accepted_X_2xx(_){var e,t=_[0],s=_[1];return e=t.send(t.s_branch,s)>0?0:-1,t.set_last_response(s),t.timer_schedule("ist","X"),t.i_timerX<<=1,t.timer_schedule("ist","L"),e}function __tsip_transac_ist_Completed_2_Completed_INVITE(_){var e,t=_[0];return t.o_lastResponse&&(e=t.send(t.s_branch,t.o_lastResponse)>0?0:-1),e}function __tsip_transac_ist_Completed_2_Completed_timerG(_){var e,t=_[0];return t.o_lastResponse&&(e=t.send(t.s_branch,t.o_lastResponse)>0?0:-1),t.i_timerG=Math.min(t.i_timerG<<1,t.get_stack().o_timers.getT2()),t.timer_schedule("ist","G"),e}function __tsip_transac_ist_Completed_2_Terminated_timerH(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null)}function __tsip_transac_ist_Completed_2_Confirmed_ACK(_){var e=_[0];return e.timer_cancel("G"),e.timer_schedule("ist","I"),0}function __tsip_transac_ist_Accepted_2_Accepted_INVITE(_){var e=_[0];return e.o_lastResponse?e.send(e.s_branch,e.o_lastResponse)>0?0:-1:0}function __tsip_transac_ist_Accepted_2_Accepted_2xx(_){var e,t=_[0],s=_[1];return e=t.send(t.s_branch,s)>0?0:-1,t.set_last_response(s),e}function __tsip_transac_ist_Accepted_2_Accepted_timerX(_){var e=_[0];if(e.o_lastResponse){var t=e.send(e.s_branch,e.o_lastResponse)>0?0:-1;return 0==t&&(e.i_timerX<<=1,e.timer_schedule("ist","X")),t}return 0}function __tsip_transac_ist_Accepted_2_Accepted_iACK(_){var e=_[0],t=_[1];return e.timer_cancel("X"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function __tsip_transac_ist_Accepted_2_Terminated_timerL(_){return 0}function __tsip_transac_ist_Confirmed_2_Terminated_timerI(_){return 0}function __tsip_transac_ist_Any_2_Terminated_X_transportError(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null)}function __tsip_transac_ist_Any_2_Terminated_X_Error(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.ERROR,null)}function __tsip_transac_ist_Any_2_Terminated_X_cancel(_){return 0}function __tsip_transac_ist_onterm(_){return _.timer_cancel("H"),_.timer_cancel("I"),_.timer_cancel("G"),_.timer_cancel("L"),_.timer_cancel("X"),_.deinit()}function __tsip_transac_ist_event_callback(_,e,t){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var s=-1;switch(e){case tsip_transac_event_type_e.INCOMING_MSG:t&&t.is_request()&&(t.is_invite()?s=_.fsm_act(tsip_transac_ist_actions_e.RECV_INVITE,t):t.is_ack()&&(s=_.fsm_act(tsip_transac_ist_actions_e.RECV_ACK,t)));break;case tsip_transac_event_type_e.OUTGOING_MSG:t&&t.is_response()&&(t.is_1xx()?s=_.fsm_act(tsip_transac_ist_actions_e.SEND_1XX,t):t.is_2xx()?s=_.fsm_act(tsip_transac_ist_actions_e.SEND_2XX,t):t.is_3456()&&(s=_.fsm_act(tsip_transac_ist_actions_e.SEND_300_to_699,t)));break;case tsip_transac_event_type_e.CANCELED:case tsip_transac_event_type_e.TERMINATED:case tsip_transac_event_type_e.TIMEDOUT:break;case tsip_transac_event_type_e.ERROR:s=_.fsm_act(tsip_transac_ist_actions_e.ERROR,t);break;case tsip_transac_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_transac_ist_actions_e.TRANSPORT_ERROR,t)}return s}function __tsip_transac_ist_timer_callback(_,e){_&&(e==_.o_timerH?_.fsm_act(tsip_transac_ist_actions_e.TIMER_H,null):e==_.o_timerI?_.fsm_act(tsip_transac_ist_actions_e.TIMER_I,null):e==_.o_timerG?_.fsm_act(tsip_transac_ist_actions_e.TIMER_G,null):e==_.o_timerL?_.fsm_act(tsip_transac_ist_actions_e.TIMER_L,null):e==_.o_timerX&&_.fsm_act(tsip_transac_ist_actions_e.TIMER_X,null))}function tsip_transac_layer(_){return _?(this.o_stack=_,void(this.ao_transacs=new Array)):(tsk_utils_log_error("Invalid argument"),null)}function tsip_transac_nict(_,e,t,s,i){var r;return i&&(r=i.get_stack())?(tsip_transac.call(this),this.o_request=null,this.init(tsip_transac_type_e.NICT,_,e,t,s,i,tsip_transac_nict_states_e.STARTED,tsip_transac_nict_states_e.TERMINATED),this.set_callback(__tsip_transac_nict_event_callback),this.o_fsm.set_debug_enabled(tsip_transac_nict.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_transac_nict_onterm,this),this.o_timerE=null,this.o_timerF=null,this.o_timerK=null,this.i_timerE=r.o_timers.getE(),this.i_timerF=r.o_timers.getF(),this.i_timerK=_?0:r.o_timers.getK(),void this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.STARTED,tsip_transac_nict_actions_e.SEND,tsip_transac_nict_states_e.TRYING,__tsip_transac_nict_Started_2_Trying_X_send,"__tsip_transac_nict_Started_2_Trying_X_send"),tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_transac_nict_states_e.STARTED,"tsip_transac_nict_Started_2_Started_X_any"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.TRYING,tsip_transac_nict_actions_e.TIMER_E,tsip_transac_nict_states_e.TRYING,__tsip_transac_nict_Trying_2_Trying_X_timerE,"__tsip_transac_nict_Trying_2_Trying_X_timerE"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.TRYING,tsip_transac_nict_actions_e.TIMER_F,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Trying_2_Terminated_X_timerF,"__tsip_transac_nict_Trying_2_Terminated_X_timerF"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.TRYING,tsip_transac_nict_actions_e.TRANSPORT_ERROR,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Trying_2_Terminated_X_transportError,"__tsip_transac_nict_Trying_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.TRYING,tsip_transac_nict_actions_e.I_1xx,tsip_transac_nict_states_e.PROCEEDING,__tsip_transac_nict_Trying_2_Proceedding_X_1xx,"__tsip_transac_nict_Trying_2_Proceedding_X_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.TRYING,tsip_transac_nict_actions_e.I_200_to_699,tsip_transac_nict_states_e.COMPLETED,__tsip_transac_nict_Trying_2_Completed_X_200_to_699,"__tsip_transac_nict_Trying_2_Completed_X_200_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.PROCEEDING,tsip_transac_nict_actions_e.TIMER_E,tsip_transac_nict_states_e.PROCEEDING,__tsip_transac_nict_Proceeding_2_Proceeding_X_timerE,"__tsip_transac_nict_Proceeding_2_Proceeding_X_timerE"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.PROCEEDING,tsip_transac_nict_actions_e.TIMER_F,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Proceeding_2_Terminated_X_timerF,"__tsip_transac_nict_Proceeding_2_Terminated_X_timerF"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.PROCEEDING,tsip_transac_nict_actions_e.TRANSPORT_ERROR,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Proceeding_2_Terminated_X_transportError,"__tsip_transac_nict_Proceeding_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.PROCEEDING,tsip_transac_nict_actions_e.I_1xx,tsip_transac_nict_states_e.PROCEEDING,__tsip_transac_nict_Proceeding_2_Proceeding_X_1xx,"__tsip_transac_nict_Proceeding_2_Proceeding_X_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.PROCEEDING,tsip_transac_nict_actions_e.I_200_to_699,tsip_transac_nict_states_e.COMPLETED,__tsip_transac_nict_Proceeding_2_Completed_X_200_to_699,"__tsip_transac_nict_Proceeding_2_Completed_X_200_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nict_states_e.COMPLETED,tsip_transac_nict_actions_e.TIMER_K,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Completed_2_Terminated_X_timerK,"__tsip_transac_nict_Completed_2_Terminated_X_timerK"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nict_actions_e.TRANSPORT_ERROR,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Any_2_Terminated_X_transportError,"__tsip_transac_nict_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nict_actions_e.ERROR,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Any_2_Terminated_X_Error,"__tsip_transac_nict_Any_2_Terminated_X_Error"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nict_actions_e.CANCEL,tsip_transac_nict_states_e.TERMINATED,__tsip_transac_nict_Any_2_Terminated_X_cancel,"__tsip_transac_nict_Any_2_Terminated_X_cancel"))):(tsk_utils_log_error("Invalid argument"),null)}function __tsip_transac_nict_Started_2_Trying_X_send(_){var e=_[0],t=_[1];return e.send(e.s_branch,t),e.timer_schedule("nict","F"),e.b_reliable||e.timer_schedule("nict","E"),0}function __tsip_transac_nict_Trying_2_Trying_X_timerE(_){var e=_[0];return e.send(e.s_branch,e.o_request),e.i_timerE=Math.min(e.i_timerE<<1,e.get_stack().o_timers.getT2()),e.timer_schedule("nict","E"),0}function __tsip_transac_nict_Trying_2_Terminated_X_timerF(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TIMEDOUT,e.o_request),0}function __tsip_transac_nict_Trying_2_Terminated_X_transportError(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,e.o_request),0}function __tsip_transac_nict_Trying_2_Proceedding_X_1xx(_){var e=_[0],t=_[1];return e.b_reliable||e.timer_cancel("E"),e.timer_cancel("F"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t),0}function __tsip_transac_nict_Trying_2_Completed_X_200_to_699(_){var e=_[0],t=_[1];return e.b_reliable||e.timer_cancel("E"),e.timer_cancel("F"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t),e.timer_schedule("nict","K"),0}function __tsip_transac_nict_Proceeding_2_Proceeding_X_timerE(_){var e=_[0];return e.send(e.s_branch,e.o_request),e.i_timerE=Math.min(e.i_timerE<<1,e.get_stack().o_timers.getT2()),e.timer_schedule("nict","E"),0}function __tsip_transac_nict_Proceeding_2_Terminated_X_timerF(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null),0}function __tsip_transac_nict_Proceeding_2_Terminated_X_transportError(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null),0}function __tsip_transac_nict_Proceeding_2_Proceeding_X_1xx(_){var e=_[0],t=_[1];return e.b_reliable||e.timer_cancel("E"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t),0}function __tsip_transac_nict_Proceeding_2_Completed_X_200_to_699(_){var e=_[0],t=_[1];return e.b_reliable||e.timer_cancel("E"),e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t),e.timer_schedule("nict","K"),0}function __tsip_transac_nict_Completed_2_Terminated_X_timerK(_){return 0}function __tsip_transac_nict_Any_2_Terminated_X_transportError(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null)}function __tsip_transac_nict_Any_2_Terminated_X_Error(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.ERROR,null)}function __tsip_transac_nict_Any_2_Terminated_X_cancel(_){return 0}function __tsip_transac_nict_onterm(_){return _.timer_cancel("E"),_.timer_cancel("F"),
_.timer_cancel("K"),_.deinit()}function __tsip_transac_nict_event_callback(_,e,t){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var s=0;switch(e){case tsip_transac_event_type_e.INCOMING_MSG:t&&t.is_response()&&(t.is_1xx()?s=_.fsm_act(tsip_transac_nict_actions_e.I_1xx,t):t.is_23456()?s=_.fsm_act(tsip_transac_nict_actions_e.I_200_to_699,t):tsk_utils_log_warn("Not supported status code: "+t.get_response_code()));break;case tsip_transac_event_type_e.CANCELED:case tsip_transac_event_type_e.TERMINATED:case tsip_transac_event_type_e.TIMEDOUT:break;case tsip_transac_event_type_e.ERROR:s=_.fsm_act(tsip_transac_nict_actions_e.ERROR,t);break;case tsip_transac_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_transac_nict_actions_e.TRANSPORT_ERROR,t)}return s}function __tsip_transac_nict_timer_callback(_,e){_&&(e==_.o_timerE?_.fsm_act(tsip_transac_nict_actions_e.TIMER_E,null):e==_.o_timerF?_.fsm_act(tsip_transac_nict_actions_e.TIMER_F,null):e==_.o_timerK&&_.fsm_act(tsip_transac_nict_actions_e.TIMER_K,null))}function tsip_transac_nist(_,e,t,s,i){var r;return i&&(r=i.get_stack())?(tsip_transac.call(this),this.o_lastResponse=null,this.init(tsip_transac_type_e.nist,_,e,t,s,i,tsip_transac_nist_states_e.STARTED,tsip_transac_nist_states_e.TERMINATED),this.set_callback(__tsip_transac_nist_event_callback),this.o_fsm.set_debug_enabled(tsip_transac_nist.prototype.__b_debug_state_machine),this.o_fsm.set_onterm_callback(__tsip_transac_nist_onterm,this),this.o_timerJ=null,this.i_timerJ=_?0:r.o_timers.getJ(),void this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.STARTED,tsip_transac_nist_actions_e.RECV_REQUEST,tsip_transac_nist_states_e.TRYING,tsip_transac_nist_Started_2_Trying_X_request,"tsip_transac_nist_Started_2_Trying_X_request"),tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_transac_nist_states_e.STARTED,"tsip_transac_nist_Started_2_Started_X_any"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.TRYING,tsip_transac_nist_actions_e.SEND_1XX,tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_Trying_2_Proceeding_X_send_1xx,"tsip_transac_nist_Trying_2_Proceeding_X_send_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.TRYING,tsip_transac_nist_actions_e.SEND_200_to_699,tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_Trying_2_Completed_X_send_200_to_699,"tsip_transac_nist_Trying_2_Completed_X_send_200_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_actions_e.SEND_1XX,tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_Proceeding_2_Proceeding_X_send_1xx,"tsip_transac_nist_Proceeding_2_Proceeding_X_send_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_actions_e.SEND_200_to_699,tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_Proceeding_2_Completed_X_send_200_to_699,"tsip_transac_nist_Proceeding_2_Completed_X_send_200_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_actions_e.RECV_REQUEST,tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_Proceeding_2_Proceeding_X_request,"tsip_transac_nist_Proceeding_2_Proceeding_X_request"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_actions_e.RECV_REQUEST,tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_Completed_2_Completed_X_request,"tsip_transac_nist_Completed_2_Completed_X_request"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_actions_e.TIMER_J,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Completed_2_Terminated_X_tirmerJ,"tsip_transac_nist_Completed_2_Terminated_X_tirmerJ"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nist_actions_e.TRANSPORT_ERROR,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Any_2_Terminated_X_transportError,"tsip_transac_nist_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nist_actions_e.ERROR,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Any_2_Terminated_X_Error,"tsip_transac_nist_Any_2_Terminated_X_Error"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nist_actions_e.CANCEL,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Any_2_Terminated_X_cancel,"tsip_transac_nist_Any_2_Terminated_X_cancel"))):(tsk_utils_log_error("Invalid argument"),null)}function tsip_transac_nist_Started_2_Trying_X_request(_){var e=_[0],t=_[1];return e.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,t)}function tsip_transac_nist_Trying_2_Proceeding_X_send_1xx(_){var e,t=_[0],s=_[1];return e=t.send(this.s_branch,s)>0?0:-1,t.o_lastResponse=s,e}function tsip_transac_nist_Trying_2_Completed_X_send_200_to_699(_){var e,t=_[0],s=_[1];return e=t.send(this.s_branch,s)>0?0:-1,t.timer_schedule("nist","J"),t.o_lastResponse=s,e}function tsip_transac_nist_Proceeding_2_Proceeding_X_send_1xx(_){var e=_[0],t=_[1];return e.o_lastResponse=t,e.send(this.s_branch,t)>0?0:-1}function tsip_transac_nist_Proceeding_2_Proceeding_X_request(_){var e=_[0];return e.o_lastResponse&&e.send(this.s_branch,e.o_lastResponse),0}function tsip_transac_nist_Proceeding_2_Completed_X_send_200_to_699(_){var e,t=_[0],s=_[1];return e=t.send(this.s_branch,s)>0?0:-1,t.timer_schedule("nist","J"),t.o_lastResponse=s,e}function tsip_transac_nist_Completed_2_Completed_X_request(_){var e=_[0];return e.o_lastResponse&&e.send(this.s_branch,e.o_lastResponse),0}function tsip_transac_nist_Completed_2_Terminated_X_tirmerJ(_){return 0}function tsip_transac_nist_Any_2_Terminated_X_transportError(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null)}function tsip_transac_nist_Any_2_Terminated_X_Error(_){var e=_[0];return e.get_dialog().callback(tsip_dialog_event_type_e.ERROR,null)}function tsip_transac_nist_Any_2_Terminated_X_cancel(_){return 0}function __tsip_transac_nist_onterm(_){return _.timer_cancel("J"),_.deinit()}function __tsip_transac_nist_event_callback(_,e,t){var s=-1;switch(e){case tsip_transac_event_type_e.INCOMING_MSG:t&&t.is_request()&&(s=_.fsm_act(tsip_transac_nist_actions_e.RECV_REQUEST,t));break;case tsip_transac_event_type_e.OUTGOING_MSG:t&&t.is_response()&&(t.is_1xx()?s=_.fsm_act(tsip_transac_nist_actions_e.SEND_1XX,t):t.is_23456()&&(s=_.fsm_act(tsip_transac_nist_actions_e.SEND_200_to_699,t)));break;case tsip_transac_event_type_e.CANCELED:case tsip_transac_event_type_e.TERMINATED:case tsip_transac_event_type_e.TIMEDOUT:break;case tsip_transac_event_type_e.ERROR:s=_.fsm_act(tsip_transac_nist_actions_e.ERROR,t);break;case tsip_transac_event_type_e.TRANSPORT_ERROR:s=_.fsm_act(tsip_transac_nist_actions_e.TRANSPORT_ERROR,t)}return s}function __tsip_transac_nist_timer_callback(_,e){_&&e==_.o_timerJ&&_.fsm_act(tsip_transac_nist_actions_e.TIMER_J,null)}function tsip_transport(_,e,t,s,i,r){if(!e)return tsk_utils_log_error("Invalid argument"),null;switch(_){case tsip_transport_type_e.WS:this.b_reliable=!0,this.s_scheme="sip",this.s_protocol="ws",this.s_via_protocol="WS",this.s_service="SIP+D2W",this.o_ws=null,this.__start=function(){return __tsip_transport_ws_start(this)},this.__stop=function(){return __tsip_transport_ws_stop(this)},this.__have_socket=function(_){return __tsip_transport_ws_have_socket(this,_)},this.__send=function(_,e){return __tsip_transport_ws_send(this,_,e)};break;case tsip_transport_type_e.WSS:this.b_reliable=!0,this.s_scheme="sip",this.s_protocol="wss",this.s_via_protocol="WSS",this.s_service="SIP+D2W",this.o_ws=null,this.__start=function(){return __tsip_transport_ws_start(this)},this.__stop=function(){return __tsip_transport_ws_stop(this)},this.__have_socket=function(_){return __tsip_transport_ws_have_socket(this,_)},this.__send=function(_,e){return __tsip_transport_ws_send(this,_,e)};break;case tsip_transport_type_e.UDP:if(!tsk_utils_have_webrtc4all())return tsk_utils_log_error("Transport not supported"),null;this.b_reliable=!1,this.s_scheme="sip",this.s_protocol="udp",this.s_via_protocol="UDP",this.s_service="SIP+D2U",this.o_transport=null,this.__start=function(){return __tsip_transport_webrtc4all_start(this)},this.__stop=function(){return __tsip_transport_webrtc4all_stop(this)},this.__have_socket=function(_){return __tsip_transport_webrtc4all_have_socket(this,_)},this.__send=function(_,e){return __tsip_transport_webrtc4all_send(this,_,e)};break;case tsip_transport_type_e.TCP:case tsip_transport_type_e.TLS:case tsip_transport_type_e.SCTP:case tsip_transport_type_e.DTLS:default:return tsk_utils_log_error(_+" not supported as a valid SIP transport"),null}return this.e_type=_,this.o_stack=e,this.s_host=t,this.i_port=s,this.s_description=i,this.fn_callback=r,this.b_started=!1,this}function tsip_transport_event(_,e,t,s){return this.o_transport=_,this.e_type=e,this.s_description=t,this.o_data=s,this}function __tsip_transport_ws_start(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var e=tsk_string_is_null_or_empty(_.o_stack.network.s_websocket_server_url)?tsk_string_format("{0}://{1}:{2}",_.s_protocol,_.s_host,_.i_port):_.o_stack.network.s_websocket_server_url;return tsk_utils_log_info("Connecting to '"+e+"'"),_.o_ws=new WebSocket(e,"sip"),_.o_ws.binaryType="arraybuffer",_.o_ws.o_transport=_,_.o_ws.onopen=__tsip_transport_ws_onopen,_.o_ws.onclose=__tsip_transport_ws_onclose,_.o_ws.onmessage=__tsip_transport_ws_onmessage,_.o_ws.onerror=__tsip_transport_ws_onerror,0}function __tsip_transport_ws_stop(_){return _?(_.o_ws&&_.o_ws.close(),0):(tsk_utils_log_error("Invalid argument"),-1)}function __tsip_transport_ws_have_socket(_,e){return _.o_ws==e}function __tsip_transport_ws_send(_,e,t){return _.o_ws?(_.o_ws.send(e),t):(tsk_utils_log_error("Invalid state"),0)}function __tsip_transport_ws_onopen(_){tsk_utils_log_info("__tsip_transport_ws_onopen"),this.o_transport.b_started=!0,this.o_transport.signal(tsip_transport_event_type_e.STARTED,_.reason,null)}function __tsip_transport_ws_onclose(_){tsk_utils_log_info("__tsip_transport_ws_onclose"),this.o_transport.b_started=!1,this.o_transport.signal(tsip_transport_event_type_e.STOPPED,_.reason,null)}function __tsip_transport_ws_onmessage(_){tsk_utils_log_info("__tsip_transport_ws_onmessage");var e=tsk_ragel_state_create();"string"==typeof _.data?tsk_ragel_state_init_str(e,_.data):tsk_ragel_state_init_ai(e,_.data);var t=tsip_message.prototype.Parse(e,!0);return t?(tsk_utils_log_info("recv="+t),t.o_socket=this,this.o_transport.get_layer().handle_incoming_message(t)):(tsk_utils_log_error("Failed to parse message: "+_.data),-1)}function __tsip_transport_ws_onerror(_){tsk_utils_log_info("__tsip_transport_ws_onerror"),this.o_transport.signal(tsip_transport_event_type_e.ERROR,_.reason,null)}function __tsip_transport_webrtc4all_start(o_self){if(!o_self)return tsk_utils_log_error("Invalid argument"),-1;var b_isInternetExplorer=WebRtc4all_GetType()==WebRtcType_e.IE,s_url=tsk_string_is_null_or_empty(o_self.o_stack.network.s_proxy_outbound_host)?tsk_string_format("{0}://{1}:{2}",o_self.s_protocol,o_self.s_host,o_self.i_port):tsk_string_format("{0}://{1}:{2}",o_self.s_protocol,o_self.o_stack.network.s_proxy_outbound_host,o_self.o_stack.network.i_proxy_outbound_port);tsk_utils_log_info("Connecting to '"+s_url+"'"),b_isInternetExplorer?(o_self.o_transport=new ActiveXObject("webrtc4ie.NetTransport"),eval("function o_self.o_transport::OnEvent(i_type, s_data) { return __tsip_transport_webrtc4all_onevent (o_self, i_type, s_data); }")):(o_self.o_transport=WebRtc4npapi.createNetTransport(),o_self.o_transport.opaque=o_self,o_self.o_transport.setCallbackFuncName("__tsip_transport_webrtc4all_onevent"));try{o_self.o_stack.network.s_proxy_outbound_host&&o_self.o_stack.network.i_proxy_outbound_port?(o_self.s_host=o_self.o_stack.network.s_proxy_outbound_host,o_self.i_port=o_self.o_stack.network.i_proxy_outbound_port):o_self.o_transport.SetDomain(o_self.o_stack.network.o_uri_realm.s_host),o_self.o_transport.Start(b_isInternetExplorer?WebRtc4all_GetLooper():0),o_self.o_transport.defaultDestAddr&&o_self.o_transport.defaultDestPort&&(o_self.s_host=o_self.o_transport.defaultDestAddr,o_self.i_port=o_self.o_transport.defaultDestPort,tsk_utils_log_info("Transport default destination="+o_self.s_host+":"+o_self.i_port)),o_self.b_started=!0,o_self.signal(tsip_transport_event_type_e.STARTED,"Network transport started",null)}catch(e){return tsk_utils_log_error(e),-1}return 0}function __tsip_transport_webrtc4all_stop(_){return _?(_.o_transport&&_.o_transport.Stop(),0):(tsk_utils_log_error("Invalid argument"),-1)}function __tsip_transport_webrtc4all_have_socket(_,e){return _.o_transport==e}function __tsip_transport_webrtc4all_send(_,e,t){return _.o_transport?(_.o_transport.SendTo(e,_.s_host,_.i_port),t):(tsk_utils_log_error("Invalid state"),0)}function __tsip_transport_webrtc4all_onevent(_,e,t){if(tsk_utils_log_info("__tsip_transport_webrtc4all_onevent"),t){var s=tsk_ragel_state_create();tsk_ragel_state_init_str(s,t);var i=tsip_message.prototype.Parse(s,!0);return i?(tsk_utils_log_info("RECV="+i.toString()),i.o_socket=_.o_transport,_.get_layer().handle_incoming_message(i)):(tsk_utils_log_error("Failed to parse message: "+evt.data),-1)}}function tsip_transport_layer(_){return _?(this.o_stack=_,this.b_running=!1,void(this.ao_transports=new Array)):(tsk_utils_log_error("Invalid argument"),null)}function tsip_transport_layer_find_result(){this.o_transport=null,this.s_dest_ip=null,this.i_dest_port=0}var __b_release_mode=!0,Base64=function(){var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e={encode:function(e){var t,s,i,r,a,n,o,p="",c=0;do t=e.charCodeAt(c++),s=e.charCodeAt(c++),i=e.charCodeAt(c++),r=t>>2,a=(3&t)<<4|s>>4,n=(15&s)<<2|i>>6,o=63&i,isNaN(s)?n=o=64:isNaN(i)&&(o=64),p=p+_.charAt(r)+_.charAt(a)+_.charAt(n)+_.charAt(o);while(c<e.length);return p},decode:function(e){var t,s,i,r,a,n,o,p="",c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do r=_.indexOf(e.charAt(c++)),a=_.indexOf(e.charAt(c++)),n=_.indexOf(e.charAt(c++)),o=_.indexOf(e.charAt(c++)),t=r<<2|a>>4,s=(15&a)<<4|n>>2,i=(3&n)<<6|o,p+=String.fromCharCode(t),64!=n&&(p+=String.fromCharCode(s)),64!=o&&(p+=String.fromCharCode(i));while(c<e.length);return p}};return e}();tsk_fsm.prototype.__i_state_any=-65535,tsk_fsm.prototype.__i_state_default=-65520,tsk_fsm.prototype.__i_state_none=-65280,tsk_fsm.prototype.__i_state_final=-61440,tsk_fsm.prototype.__i_action_any=-65535,tsk_fsm.prototype.is_terminated=function(){return this.i_state_curr==this.i_state_term},tsk_fsm.prototype.is_debug_enabled=function(){return this.b_debug},tsk_fsm.prototype.set_debug_enabled=function(_){this.b_debug=_},tsk_fsm.prototype.set_onterm_callback=function(_,e){this.fn_onterm=_,this.o_usr_data=e},tsk_fsm.prototype.get_usr_data=function(){return this.o_usr_data},tsk_fsm.prototype.set=function(){for(var _=0;_<arguments.length;++_)arguments[_]&&this.ao_entries.push(arguments[_]);return this.ao_entries.sort(tsk_fsm_entry_compare),0},tsk_fsm.prototype.act=function(_,e,t){var s,i=!1,r=!1,a=0;if(this.is_terminated())return tsk_utils_log_warn("The FSM is in the final state"),-2;this.b_locked=!0;for(var n=0;n<this.ao_entries.length;++n)if((s=this.ao_entries[n])&&(s.i_state_from==tsk_fsm.prototype.__i_state_any||s.i_state_from==this.i_state_curr)&&(s.i_action==tsk_fsm.prototype.__i_action_any||s.i_action==_)&&(!s.fn_condition||s.fn_condition(e,t))){if(this.is_debug_enabled()&&tsk_utils_log_info("State machine: "+s.s_description),s.i_state_to!=tsk_fsm.prototype.__i_state_any&&(this.i_state_curr=s.i_state_to),s.fn_execute)try{(a=s.fn_execute(Array.prototype.slice.call(arguments,3)))&&tsk_utils_log_info("State machine: Exec function failed. Moving to the termnial state")}catch(o){tsk_utils_log_error(o),a=-3}else a=0;r=0!=a||this.i_state_curr==this.i_state_term,i=!0;break}return r&&(this.i_state_curr=this.i_state_term,this.fn_onterm&&this.fn_onterm(this.o_usr_data)),this.b_locked=!1,a},tsk_fsm_entry.prototype.Create=function(_,e,t,s,i,r){return new tsk_fsm_entry(_,e,t,s,i,r)},tsk_fsm_entry.prototype.CreateAlways=function(_,e,t,s,i){return new tsk_fsm_entry(_,e,null,t,s,i)},tsk_fsm_entry.prototype.CreateNothing=function(_,e,t,s){return new tsk_fsm_entry(_,e,t,_,null,s)},tsk_fsm_entry.prototype.CreateAlwaysNothing=function(_,e){return new tsk_fsm_entry(_,tsk_fsm.prototype.__i_action_any,null,_,null,e)};var MD5=function(){var _=0,e="",t=8,s=function(_,e){var t=(65535&_)+(65535&e),s=(_>>16)+(e>>16)+(t>>16);return s<<16|65535&t},i=function(_,e){return _<<e|_>>>32-e},r=function(_){for(var e=[],s=(1<<t)-1,i=0;i<_.length*t;i+=t)e[i>>5]|=(_.charCodeAt(i/t)&s)<<i%32;return e},a=function(_){for(var e="",s=(1<<t)-1,i=0;i<32*_.length;i+=t)e+=String.fromCharCode(_[i>>5]>>>i%32&s);return e},n=function(e){for(var t=_?"0123456789ABCDEF":"0123456789abcdef",s="",i=0;i<4*e.length;i++)s+=t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15);return s},o=function(_){for(var t,s,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",a=0;a<4*_.length;a+=3)for(t=(_[a>>2]>>8*(a%4)&255)<<16|(_[a+1>>2]>>8*((a+1)%4)&255)<<8|_[a+2>>2]>>8*((a+2)%4)&255,s=0;4>s;s++)r+=8*a+6*s>32*_.length?e:i.charAt(t>>6*(3-s)&63);return r},p=function(_,e,t,r,a,n){return s(i(s(s(e,_),s(r,n)),a),t)},c=function(_,e,t,s,i,r,a){return p(e&t|~e&s,_,e,i,r,a)},d=function(_,e,t,s,i,r,a){return p(e&s|t&~s,_,e,i,r,a)},l=function(_,e,t,s,i,r,a){return p(e^t^s,_,e,i,r,a)},h=function(_,e,t,s,i,r,a){return p(t^(e|~s),_,e,i,r,a)},u=function(_,e){_[e>>5]|=128<<e%32,_[(e+64>>>9<<4)+14]=e;for(var t,i,r,a,n=1732584193,o=-271733879,p=-1732584194,u=271733878,m=0;m<_.length;m+=16)t=n,i=o,r=p,a=u,n=c(n,o,p,u,_[m+0],7,-680876936),u=c(u,n,o,p,_[m+1],12,-389564586),p=c(p,u,n,o,_[m+2],17,606105819),o=c(o,p,u,n,_[m+3],22,-1044525330),n=c(n,o,p,u,_[m+4],7,-176418897),u=c(u,n,o,p,_[m+5],12,1200080426),p=c(p,u,n,o,_[m+6],17,-1473231341),o=c(o,p,u,n,_[m+7],22,-45705983),n=c(n,o,p,u,_[m+8],7,1770035416),u=c(u,n,o,p,_[m+9],12,-1958414417),p=c(p,u,n,o,_[m+10],17,-42063),o=c(o,p,u,n,_[m+11],22,-1990404162),n=c(n,o,p,u,_[m+12],7,1804603682),u=c(u,n,o,p,_[m+13],12,-40341101),p=c(p,u,n,o,_[m+14],17,-1502002290),o=c(o,p,u,n,_[m+15],22,1236535329),n=d(n,o,p,u,_[m+1],5,-165796510),u=d(u,n,o,p,_[m+6],9,-1069501632),p=d(p,u,n,o,_[m+11],14,643717713),o=d(o,p,u,n,_[m+0],20,-373897302),n=d(n,o,p,u,_[m+5],5,-701558691),u=d(u,n,o,p,_[m+10],9,38016083),p=d(p,u,n,o,_[m+15],14,-660478335),o=d(o,p,u,n,_[m+4],20,-405537848),n=d(n,o,p,u,_[m+9],5,568446438),u=d(u,n,o,p,_[m+14],9,-1019803690),p=d(p,u,n,o,_[m+3],14,-187363961),o=d(o,p,u,n,_[m+8],20,1163531501),n=d(n,o,p,u,_[m+13],5,-1444681467),u=d(u,n,o,p,_[m+2],9,-51403784),p=d(p,u,n,o,_[m+7],14,1735328473),o=d(o,p,u,n,_[m+12],20,-1926607734),n=l(n,o,p,u,_[m+5],4,-378558),u=l(u,n,o,p,_[m+8],11,-2022574463),p=l(p,u,n,o,_[m+11],16,1839030562),o=l(o,p,u,n,_[m+14],23,-35309556),n=l(n,o,p,u,_[m+1],4,-1530992060),u=l(u,n,o,p,_[m+4],11,1272893353),p=l(p,u,n,o,_[m+7],16,-155497632),o=l(o,p,u,n,_[m+10],23,-1094730640),n=l(n,o,p,u,_[m+13],4,681279174),u=l(u,n,o,p,_[m+0],11,-358537222),p=l(p,u,n,o,_[m+3],16,-722521979),o=l(o,p,u,n,_[m+6],23,76029189),n=l(n,o,p,u,_[m+9],4,-640364487),u=l(u,n,o,p,_[m+12],11,-421815835),p=l(p,u,n,o,_[m+15],16,530742520),o=l(o,p,u,n,_[m+2],23,-995338651),n=h(n,o,p,u,_[m+0],6,-198630844),u=h(u,n,o,p,_[m+7],10,1126891415),p=h(p,u,n,o,_[m+14],15,-1416354905),o=h(o,p,u,n,_[m+5],21,-57434055),n=h(n,o,p,u,_[m+12],6,1700485571),u=h(u,n,o,p,_[m+3],10,-1894986606),p=h(p,u,n,o,_[m+10],15,-1051523),o=h(o,p,u,n,_[m+1],21,-2054922799),n=h(n,o,p,u,_[m+8],6,1873313359),u=h(u,n,o,p,_[m+15],10,-30611744),p=h(p,u,n,o,_[m+6],15,-1560198380),o=h(o,p,u,n,_[m+13],21,1309151649),n=h(n,o,p,u,_[m+4],6,-145523070),u=h(u,n,o,p,_[m+11],10,-1120210379),p=h(p,u,n,o,_[m+2],15,718787259),o=h(o,p,u,n,_[m+9],21,-343485551),n=s(n,t),o=s(o,i),p=s(p,r),u=s(u,a);return[n,o,p,u]},m=function(_,e){var s=r(_);s.length>16&&(s=u(s,_.length*t));for(var i=new Array(16),a=new Array(16),n=0;16>n;n++)i[n]=909522486^s[n],a[n]=1549556828^s[n];var o=u(i.concat(r(e)),512+e.length*t);return u(a.concat(o),640)},g={hexdigest:function(_){return n(u(r(_),_.length*t))},b64digest:function(_){return o(u(r(_),_.length*t))},hash:function(_){return a(u(r(_),_.length*t))},hmac_hexdigest:function(_,e){return n(m(_,e))},hmac_b64digest:function(_,e){return o(m(_,e))},hmac_hash:function(_,e){return a(m(_,e))},test:function(){return"900150983cd24fb0d6963f7d28e17f72"===MD5.hexdigest("abc")}};return g}(),__s_navigator_friendly_name=void 0,__s_system_friendly_name=void 0,__i_debug_level=4,sipml5_version="1.3.203";tsk_utils_log_info("SIPML5 API version = "+sipml5_version);var tmedia_type_e={NONE:{i_id:0,s_name:null},GHOST:{i_id:1,s_name:null},AUDIO:{i_id:2,s_name:"audio"},VIDEO:{i_id:4,s_name:"video"},CHAT:{i_id:8,s_name:"message"},FILE:{i_id:16,s_name:"message"},T38:{i_id:32,s_name:"t38"},SCREEN_SHARE:{i_id:68,s_name:"sccreen share"},MSRP:{i_id:24,s_name:"message"},AUDIO_VIDEO:{i_id:6,s_name:"audio/video"},ALL:{i_id:255,s_name:"all"}};window.__b_release_mode||tmedia_api_add_js_scripts("head","src/tinyMEDIA/src/tmedia_webrtc4all.js","src/tinyMEDIA/src/tmedia_defaults.js","src/tinyMEDIA/src/tmedia_session.js"),w4aPeerConnection.prototype.s_configuration=null,w4aPeerConnection.prototype.f_IceCallback=null,w4aPeerConnection.prototype.f_Rfc5168Callback,w4aPeerConnection.prototype.o_peer=null,w4aPeerConnection.prototype.localDescription=null,w4aPeerConnection.prototype.remoteDescription=null,w4aSessionDescription.prototype.o_sdp=null,w4aIceCandidate.prototype.media=null,w4aIceCandidate.prototype.label=null;var __o_roap_stream=null,__o_jsep_stream_audio=null,__o_jsep_stream_audiovideo=null,WebRtcType_e={NONE:-1,NATIVE:0,IE:1,NPAPI:2,W4A:3,ERICSSON:4},__webrtc_type=WebRtcType_e.NONE,__b_webrtc4all_initialized=!1,__b_webrtc4ie_peerconn=void 0,__looper=void 0;w4aSessionDescription.prototype.toSdp=function(){return this.o_sdp.toSdp()},w4aSessionDescription.prototype.toString=w4aSessionDescription.prototype.toSdp,w4aSessionDescription.prototype.addCandidate=function(_){_&&_.media&&_.label&&this.o_sdp.addCandidate(_.media,_.label)},w4aIceCandidate.prototype.toSdp=function(){return this.label},w4aPeerConnection.SDP_OFFER=256,w4aPeerConnection.SDP_PRANSWER=512,w4aPeerConnection.SDP_ANSWER=768,w4aPeerConnection.NEW=0,w4aPeerConnection.OPENING=1,w4aPeerConnection.ACTIVE=2,w4aPeerConnection.CLOSED=3,w4aPeerConnection.ICE_GATHERING=256,w4aPeerConnection.ICE_WAITING=512,w4aPeerConnection.ICE_CHECKING=768,w4aPeerConnection.ICE_CONNECTED=1024,w4aPeerConnection.ICE_COMPLETED=1280,w4aPeerConnection.ICE_FAILED=1536,w4aPeerConnection.ICE_CLOSED=1792,w4aPeerConnection.prototype.createOffer=function(_){if(__webrtc_type==WebRtcType_e.IE)return new w4aSessionDescription(this.o_peer.createOffer(_.has_audio,_.has_video));var e=this.o_peer.createOffer(_.has_audio,_.has_video);return e?new w4aSessionDescription(e.toSdp()):null},w4aPeerConnection.prototype.createAnswer=function(_,e){if(__webrtc_type==WebRtcType_e.IE)return new w4aSessionDescription(this.o_peer.createAnswer(e.has_audio,e.has_video));var t=this.o_peer.createAnswer(e.has_audio,e.has_video);return t?new w4aSessionDescription(t.toSdp()):null},w4aPeerConnection.prototype.setLocalDescription=function(_,e){this.o_peer.setLocalDescription(_,__webrtc_type==WebRtcType_e.IE?e.toSdp():e.o_sdp),this.localDescription=new w4aSessionDescription(this.o_peer.localDescription)},w4aPeerConnection.prototype.setRemoteDescription=function(_,e){this.o_peer.setRemoteDescription(_,__webrtc_type==WebRtcType_e.IE?e.toSdp():e.o_sdp),this.remoteDescription=new w4aSessionDescription(this.o_peer.remoteDescription)},w4aPeerConnection.prototype.startIce=function(_){this.o_peer.startIce(0,WebRtc4all_GetLooper())},w4aPeerConnection.prototype.startMedia=function(_){if(this.o_peer)try{this.o_peer.startMedia()}catch(e){}},w4aPeerConnection.prototype.processIceMessage=function(_){tsk_utils_log_error("Not implemented")},w4aPeerConnection.prototype.addStream=function(_,e){},w4aPeerConnection.prototype.removeStream=function(_){},w4aPeerConnection.prototype.processContent=function(_,e,t,s){if(this.o_peer)try{this.o_peer.processContent(_,e,t,s)}catch(i){}},w4aPeerConnection.prototype.close=function(){this.o_peer&&this.o_peer.close()},w4aPeerConnection.prototype.onIceCallback=function(_,e,t){tsk_utils_log_info("w4aPeerConnection::onIceCallback("+_+","+e+","+t+")"),this.iceState=this.o_peer.iceState,this.f_IceCallback&&this.f_IceCallback(new w4aIceCandidate(_,e),t)},w4aPeerConnection.prototype.onRfc5168Callback=function(_){tsk_utils_log_info("w4aPeerConnection::onRfc5168Callback("+_+")"),this.o_mgr&&this.o_mgr.callback?"picture_fast_update"===_&&this.o_mgr.callback(tmedia_session_events_e.RFC5168_REQUEST_IDR,this.o_mgr.e_type):tsk_utils_log_error("No manager associated to this peerconnection")};var __tmedia_defaults_e_media_type=tmedia_type_e.AUDIO_VIDEO,__o_peerconnection_class=void 0,__o_sessiondescription_class=void 0,__o_iceCandidate_class=void 0,tmedia_session_events_e={GET_LO_SUCCESS:0,GET_LO_FAILED:1,SET_RO_SUCCESS:10,SET_RO_FAILED:11,SET_ACK_SUCCESS:20,SET_ACK_FAILED:21,STREAM_LOCAL_REQUESTED:30,STREAM_LOCAL_ACCEPTED:31,STREAM_LOCAL_REFUSED:32,STREAM_LOCAL_ADDED:33,STREAM_LOCAL_REMOVED:34,STREAM_REMOTE_ADDED:35,STREAM_REMOTE_REMOVED:36,RFC5168_REQUEST_IDR:40};tmedia_session_mgr.prototype.__ao_supported_media=[tmedia_type_e.AUDIO,tmedia_type_e.VIDEO],tmedia_session_mgr.prototype.is_roap=function(){return WebRtc4all_GetType()==WebRtcType_e.ERICSSON},tmedia_session_mgr.prototype.is_jsep=function(){return!this.is_roap()},tmedia_session_mgr.prototype.get_stream_local=function(){return this.o_stream_local},tmedia_session_mgr.prototype.get_stream_remote=function(){return this.o_stream_remote},tmedia_session_mgr.prototype.set_stream_local=function(_){this.o_stream_local=_,this.callback(_?tmedia_session_events_e.STREAM_LOCAL_ADDED:tmedia_session_events_e.STREAM_LOCAL_REMOVED,tmedia_type_e.VIDEO)},tmedia_session_mgr.prototype.set_stream_remote=function(_){this.o_stream_remote=_,this.callback(_?tmedia_session_events_e.STREAM_REMOTE_ADDED:tmedia_session_events_e.STREAM_REMOTE_REMOVED,tmedia_type_e.VIDEO)},tmedia_session_mgr.prototype.set_fn_callback=function(_,e){this.fn_callback=_,this.o_usr_data=e},tmedia_session_mgr.prototype.callback=function(_,e){this.fn_callback&&(_==tmedia_session_events_e.GET_LO_SUCCESS&&(this.b_lo_changed=!0,this.ao_sessions.length>0&&(this.sdp.o_lo=this.ao_sessions[0].o_sdp_lo)),this.fn_callback(this.o_usr_data,_,e))},tmedia_session_mgr.prototype.set_media_type=function(_){return this.e_type!=_&&(this.b_media_type_changed=!0,this.e_type=_),0},tmedia_session_mgr.prototype.get_media_type=function(){return this.e_type},tmedia_session_mgr.prototype.has_media=function(_){for(var e=0;e<this.ao_sessions.length;++e)if(this.ao_sessions[e].e_type==_)return!0;return!1},tmedia_session_mgr.prototype.has_ro_changed=function(){return this.b_ro_changed},tmedia_session_mgr.prototype.has_state_changed=function(){return this.b_state_changed},tmedia_session_mgr.prototype.has_active_session=function(){for(var _=0;_<this.ao_sessions.length;++_)if(this.ao_sessions[_].o_sdp_lo)return!0;return!1},tmedia_session_mgr.prototype.is_started=function(){return this.b_started},tmedia_session_mgr.prototype.has_lo=function(){return null!=this.sdp.o_lo},tmedia_session_mgr.prototype.has_ro=function(){return null!=this.sdp.o_ro},tmedia_session_mgr.prototype.remove_media=function(_){for(var e=0;e<this.ao_sessions.length;++e)if(this.ao_sessions[e].e_type==_){this.ao_sessions[e].stop(),this.ao_sessions.splice(e,1);break}},tmedia_session_mgr.prototype.apply_params=function(){for(var _,e=0;e<this.ao_params.length;++e)if(_=this.ao_params[e])switch(_.e_type){case tmedia_param_type_e.CODEC:break;case tmedia_param_type_e.MANAGER:break;case tmedia_param_type_e.SESSION:for(var t=0;t<this.ao_sessions.length;++t)this.ao_sessions[t].e_type.i_id&_.e_media_type.i_id&&this.ao_sessions[t].set(_)}this.ao_params.splice(0,this.ao_params.length)},tmedia_session_mgr.prototype.load_sessions=function(){var _=null;if(0==this.ao_sessions.length||this.b_media_type_changed){for(var e=0;e<tmedia_session_mgr.prototype.__ao_supported_media.length;++e){var t=tmedia_session_mgr.prototype.__ao_supported_media[e];t.i_id&this.e_type.i_id&&!this.has_media(t)?(_=tmedia_session.prototype.Create(t,this))&&this.ao_sessions.push(_):t.i_id&this.e_type.i_id||!this.has_media(t)||this.remove_media(t)}this.set(tmedia_session_mgr.prototype.SetParamSession(this.e_type,"local-ip",this.s_addr),tmedia_session_mgr.prototype.SetParamSession(this.e_type,"local-ipver",this.b_ipv6?"ipv6":"ipv4")),this.apply_params(self)}return 0},tmedia_session_mgr.prototype.__update_ro=function(_){this.sdp.o_ro=_;for(var e,t=!0,s=0;e=_.get_header_at(tsdp_header_type_e.M,s++);)if(!e.is_held(!1)){t=!1;break}for(var i=0;i<this.ao_sessions.length;++i)this.ao_sessions[i].b_ro_held=t;return 0},tmedia_session_mgr.prototype.get_lo=function(){return 0==this.ao_sessions.length&&0!=this.load_sessions()?(tsk_utils_log_error("Failed to prepare the session manager"),null):((this.b_ro_changed||this.b_lo_changed||this.b_state_changed||this.b_mediaType_changed)&&this.sdp.o_lo&&(this.sdp.o_lo=null,this.b_mediaType_changed&&this.load_sessions(),this.b_lo_changed=!1,this.b_ro_changed=!1,this.b_state_changed=!1,this.b_mediaType_changed=!1),this.ao_sessions.length>0&&(this.sdp.o_lo=this.ao_sessions[0].get_lo()),this.sdp.o_lo)},tmedia_session_mgr.prototype.set_ro=function(_,e){if(!_)return tsk_utils_log_error("Invalid parameter"),-1;var t,s,i=0,r=!1,a=!1,n=!1,o=tmedia_type_e.NONE,p=!1,c=null!=this.sdp.o_ro;if(!(t=_.get_header(tsdp_header_type_e.O)))return tsk_utils_log_error("o= line is missing"),-2;if(this.sdp.i_ro_ver==t.i_sess_version)return tsk_utils_log_warn("Remote offer has not changed"),0;if(this.sdp.i_ro_ver=t.i_sess_version,(s=_.get_header(tsdp_header_type_e.C))&&s.s_addr&&(p=tsk_string_iequals("IP4",s.s_addrtype)&&tsk_string_iequals("127.0.0.1",s.s_addr)||tsk_string_iequals("IP6",s.s_addrtype)&&tsk_string_iequals("::1",s.s_addr)),this.sdp.o_lo&&(o=_.get_media_type(),o==tmedia_type_e.VIDEO&&this.e_type==tmedia_type_e.SCREEN_SHARE&&(o=this.e_type),(n=o!=this.e_type)&&(tsk_utils_log_error("this.set_media_type(e_new_mediatype);"),tsk_utils_log_info("media type has changed"))),this.b_started&&!this.is_roap()&&!this.is_jsep()&&(!a&&!p||n)){if(i=this.stop())return tsk_utils_log_error("Failed to stop session manager"),i;r=!0}if(this.__update_ro(_),i=this.load_sessions())return tsk_utils_log_error("Failed to prepare the session manager"),i;s&&s.s_addr&&this.set(tmedia_session_mgr.prototype.SetParamSession(this.e_type,"remote-ip",s.s_addr));for(var d=0;d<this.ao_sessions.length;++d)this.ao_sessions[d].set_ro(_,e);return this.b_ro_changed=c,this.get_lo(self),r&&(i=this.start())?(tsk_utils_log_warn("Failed to re-start session manager"),i):0},tmedia_session_mgr.prototype.processContent=function(_,e,t,s){for(var i=0;i<this.ao_sessions.length;++i)this.ao_sessions[i].processContent(_,e,t,s)},tmedia_session_mgr.prototype.start=function(){for(var _=0,e=0;e<this.ao_sessions.length;++e)if(_=this.ao_sessions[e].start())return _;return this.b_started=!0,0},tmedia_session_mgr.prototype.stop=function(){for(var _=0,e=0;e<this.ao_sessions.length;++e)if(_=this.ao_sessions[e].stop())return _;return this.b_started=!1,0},tmedia_session_mgr.prototype.acked=function(){for(var _=0,e=0;e<this.ao_sessions.length;++e)if(_=this.ao_sessions[e].acked())return _;return 0},tmedia_session_mgr.prototype.is_held=function(_,e){for(var t,s,i,r=!1,a=0;a<this.ao_sessions.length;++a){var n=this.ao_sessions[a];if(!_||n.e_type.i_id&_.i_id){if(e&&n.o_sdp_lo)i=n.o_sdp_lo;else{if(e||!n.o_sdp_ro)continue;i=n.o_sdp_ro}for(r=!0,t=0;s=i.get_header_at(tsdp_header_type_e.M,t++);)if(!s.is_held(e))return!1}}return r?!0:!1},tmedia_session_mgr.prototype.hold=function(_){for(var e,t=0;t<this.ao_sessions.length;++t)if(!_||this.ao_sessions[t].e_type.i_id&_.i_id){if(this.b_state_changed=!0,
e=this.ao_sessions[t].hold())return e;this.ao_sessions[t].b_lo_held=!0}return 0},tmedia_session_mgr.prototype.resume=function(_){for(var e,t=0;t<this.ao_sessions.length;++t)if(!_||this.ao_sessions[t].e_type.i_id&_.i_id){if(this.b_state_changed=!0,e=this.ao_sessions[t].resume())return e;this.ao_sessions[t].b_lo_held=!1}return 0},tmedia_session_mgr.prototype.set=function(){for(var _=0;_<arguments.length;++_)arguments[_]&&this.ao_params.push(arguments[_]);this.ao_sessions.length>0&&this.apply_params()},tmedia_session_mgr.prototype.SetParamSession=function(_,e,t){return new tmedia_param(tmedia_param_type_e.SESSION,_,e,t)},tmedia_session_mgr.prototype.SetParamCodec=function(_,e,t){return new tmedia_param(tmedia_param_type_e.CODEC,_,e,t)},tmedia_session_mgr.prototype.SetParam=function(_,e,t){return new tmedia_param(tmedia_param_type_e.MANAGER,_,e,t)},tmedia_session.prototype.set=function(_){return this.__set(_)},tmedia_session.prototype.prepare=function(){return this.__prepare()},tmedia_session.prototype.start=function(){return this.__start()},tmedia_session.prototype.pause=function(){return this.__pause()},tmedia_session.prototype.stop=function(){return this.__stop()},tmedia_session.prototype.get_lo=function(){return this.__get_lo()},tmedia_session.prototype.set_ro=function(_,e){return this.__set_ro(_,e)},tmedia_session.prototype.processContent=function(_,e,t,s){return this.__processContent?this.__processContent(_,e,t,s):void 0},tmedia_session.prototype.acked=function(){return this.__acked()},tmedia_session.prototype.hold=function(){return this.__hold()},tmedia_session.prototype.resume=function(){return this.__resume()},tmedia_session.prototype.Create=function(_,e){switch(_){case tmedia_type_e.AUDIO:case tmedia_type_e.VIDEO:case tmedia_type_e.SCREEN_SHARE:return 0==e.ao_sessions.length?e.is_jsep()?tmedia_session_jsep.prototype.CreateInstance(e):new tmedia_session_roap(e):null;case tmedia_type_e.GHOST:return new tmedia_session_ghost(e);default:return tsk_utils_log_error(_+" not supported as media type"),null}},window.__b_release_mode||tmedia_api_add_js_scripts("head","src/tinyMEDIA/src/tmedia_session_jsep.js","src/tinyMEDIA/src/tmedia_session_roap.js","src/tinyMEDIA/src/tmedia_session_ghost.js"),tmedia_session_jsep.prototype=Object.create(tmedia_session.prototype),tmedia_session_jsep00.prototype=Object.create(tmedia_session_jsep.prototype),tmedia_session_jsep01.prototype=Object.create(tmedia_session_jsep.prototype),tmedia_session_jsep.prototype.o_pc=null,tmedia_session_jsep.prototype.b_cache_stream=!1,tmedia_session_jsep.prototype.o_local_stream=null,tmedia_session_jsep.prototype.o_sdp_jsep_lo=null,tmedia_session_jsep.prototype.o_sdp_lo=null,tmedia_session_jsep.prototype.b_sdp_lo_pending=!1,tmedia_session_jsep.prototype.i_sdp_lo_version=-1,tmedia_session_jsep.prototype.o_sdp_json_ro=null,tmedia_session_jsep.prototype.o_sdp_ro=null,tmedia_session_jsep.prototype.b_sdp_ro_pending=!1,tmedia_session_jsep.prototype.b_sdp_ro_offer=!1,tmedia_session_jsep.prototype.s_answererSessionId=null,tmedia_session_jsep.prototype.s_offererSessionId=null,tmedia_session_jsep.prototype.ao_ice_servers=null,tmedia_session_jsep.prototype.o_bandwidth={audio:void 0,video:void 0},tmedia_session_jsep.prototype.o_video_size={minWidth:void 0,minHeight:void 0,maxWidth:void 0,maxHeight:void 0},tmedia_session_jsep.prototype.o_audio_constraints={googEchoCancellation:void 0,googNoiseSuppression:void 0,googAutoGainControl:void 0},tmedia_session_jsep.prototype.b_ro_changed=!1,tmedia_session_jsep.prototype.b_lo_held=!1,tmedia_session_jsep.prototype.b_ro_held=!1,tmedia_session_jsep.prototype.CreateInstance=function(_){return __o_peerconnection_class===window.webkitPeerConnection00||__o_peerconnection_class===window.w4aPeerConnection?new tmedia_session_jsep00(_):new tmedia_session_jsep01(_)},tmedia_session_jsep.prototype.__set=function(_){if(!_)return-1;switch(_.s_key){case"ice-servers":return this.ao_ice_servers=_.o_value,0;case"cache-stream":return this.b_cache_stream=!!_.o_value,0;case"bandwidth":return this.o_bandwidth=_.o_value,0;case"video-size":return this.o_video_size=_.o_value,0;case"audio-constraints":return this.o_audio_constraints=_.o_value,0}return-2},tmedia_session_jsep.prototype.__prepare=function(){return 0},tmedia_session_jsep.prototype.__processContent=function(_,e,t,s){return this.o_pc&&this.o_pc.processContent?this.o_pc.processContent(_,e,t,s):void 0},tmedia_session_jsep.prototype.__start=function(){if(this.o_local_stream&&this.o_local_stream.start)this.o_local_stream.start();else if(this.o_pc&&__o_peerconnection_class===window.w4aPeerConnection)try{this.o_pc.startMedia()}catch(_){}return 0},tmedia_session_jsep.prototype.__pause=function(){return this.o_local_stream&&this.o_local_stream.pause&&this.o_local_stream.pause(),0},tmedia_session_jsep.prototype.__stop=function(){return this.close(),this.o_sdp_lo=null,tsk_utils_log_info("PeerConnection::stop()"),0},tmedia_session_jsep.prototype.decorate_lo=function(_){if(this.o_sdp_lo){var e;(e=this.o_sdp_lo.get_header(tsdp_header_type_e.S))&&(e.s_value="Doubango Telecom - "+tsk_utils_get_navigator_friendly_name());var t;-1==this.i_sdp_lo_version&&(this.i_sdp_lo_version=__o_peerconnection_class==window.webkitRTCPeerConnection||__o_peerconnection_class==w4aPeerConnection?2:1),(t=this.o_sdp_lo.get_header(tsdp_header_type_e.O))&&(t.i_sess_version=this.i_sdp_lo_version,_&&++this.i_sdp_lo_version),this.e_type.i_id&tmedia_type_e.VIDEO.i_id||this.o_sdp_lo.remove_media("video");for(var s,i=0,r=__o_peerconnection_class==w4aPeerConnection,a=!!this.o_sdp_lo.get_header_a("fingerprint");s=this.o_sdp_lo.get_header_at(tsdp_header_type_e.M,i++);){if(s.set_holdresume_att(this.b_lo_held,this.b_ro_held),!this.b_lo_held&&"0.0.0.0"==s.o_hdr_C.s_addr)for(var n,o=0;n=s.find_a_at("candidate",o++);)if(n.s_value.indexOf("typ srflx")>=0){var p=n.s_value.match(/[0-9]{1,3}(\.[0-9]{1,3}){3}/g);if(p.length>0){var c=p[0].substring(1,p[0].length);s.o_hdr_C.s_addr=c;break}}r||(s.find_a("crypto")?s.s_proto="RTP/SAVPF":(a||s.find_a("fingerprint"))&&(s.s_proto="UDP/TLS/RTP/SAVPF")),this.o_bandwidth&&(this.o_bandwidth.audio&&"audio"==s.s_media.toLowerCase()?s.add_header(new tsdp_header_B("AS:"+this.o_bandwidth.audio)):this.o_bandwidth.video&&"video"==s.s_media.toLowerCase()&&s.add_header(new tsdp_header_B("AS:"+this.o_bandwidth.video)))}if(this.b_lo_held){t.s_addr="0.0.0.0";var d;for((d=this.o_sdp_lo.get_header(tsdp_header_type_e.C))&&(d.s_addr="0.0.0.0"),i=0;s=this.o_sdp_lo.get_header_at(tsdp_header_type_e.M,i++);)s.s_proto="RTP/AVP",s.i_nports=0,s.i_port=0,s.ao_hdr_A=new Array,s.as_fmt=new Array}}return 0},tmedia_session_jsep.prototype.decorate_ro=function(_){if(this.o_sdp_ro){var e,t,s,i=0,r=__o_peerconnection_class==w4aPeerConnection;_&&this.o_sdp_ro.remove_header(tsdp_header_type_e.A);for(var a=function(_,e){var t=_.s_value.match(/^\d\s+(\w+):([\D|\d]+)/i);return t&&3==t.length?t[e]:void 0},n=function(_){_&&"acap"==_.s_field&&(_.s_field=a(_,1),_.s_value=a(_,2))},o=function(_,e,t,s){var i=0,r=function(_,e,t){if(_)for(var s=_.ao_headers||_.ao_hdr_A,r=0;r<s.length;++r)if(s[r].e_type==tsdp_header_type_e.A&&s[r].s_value){var n=s[r].s_field===e;if(n||"acap"!=s[r].s_field||(n=a(s[r],1)==e),n&&i++>=t)return s[r]}},n=r(_,t,s);return n?n:r(_.get_header_m_by_name(e),t,s)},p=!!this.o_sdp_ro.get_header_a("fingerprint");e=this.o_sdp_ro.get_header_at(tsdp_header_type_e.M,i++);){if(!r&&e.s_proto.indexOf("SAVP")<0){if(e.find_a("crypto")){e.s_proto="RTP/SAVPF";break}if(p||e.find_a("fingerprint")){e.s_proto="UDP/TLS/RTP/SAVPF";break}}if(!r&&e.s_proto.indexOf("SAVP")<0&&(t=o(this.o_sdp_ro,e.s_media,"fingerprint",0))&&(n(t),(t=o(this.o_sdp_ro,e.s_media,"setup",0))&&n(t),(t=o(this.o_sdp_ro,e.s_media,"connection",0))&&n(t),e.s_proto="UDP/TLS/RTP/SAVP"),!r&&e.s_proto.indexOf("SAVP")<0)for(s=0;t=o(this.o_sdp_ro,e.s_media,"crypto",s++);)n(t),e.s_proto="RTP/SAVPF";r||-1==e.s_proto.indexOf("UDP/TLS/RTP/SAVP")||(e.s_proto="RTP/SAVPF"),s=0;for(var c,d,l;t=o(this.o_sdp_ro,e.s_media,"rtpmap",s++);)if(-1!=t.s_value.indexOf("telephone-event")){console.log("FOUND TELEPHONE-EVENT PAYLOAD: "+t.s_value);var h=t.s_value.match(/^(\d+)\s+([\w\-]+)\/([\D|\d]+)/i);if(h&&4==h.length){c=h[1],d=h[2],l=h[3],t.s_value="126 telephone-event/"+l;for(var u=0;u<e.as_fmt.length;u++)e.as_fmt[u]==""+c&&(e.as_fmt[u]="126")}break}for(s=0;t=o(this.o_sdp_ro,e.s_media,"fmtp",s++);)if(0==t.s_value.indexOf(""+c)){var m,h=t.s_value.match(/^(\d+)\s+(\d+)/i);h&&3==h.length&&(m=h[2],t.s_value="126 "+m)}}}return 0},tmedia_session_jsep.prototype.subscribe_stream_events=function(){this.o_pc&&(this.o_pc.onstatechange=function(_){tsk_utils_log_info("__on_state_change")},this.o_pc.onopen=function(_){tsk_utils_log_info("__on_open")},this.o_pc.onaddstream=function(_){tsk_utils_log_info("__on_add_stream");var e=tmedia_session_jsep01.mozThis||this.o_session;if(e.o_remote_stream=_.stream,e.o_mgr){if(!e.o_remote_stream.videoTracks||!e.o_remote_stream.audioTracks){var t=!!(e.e_type.i_id&tmedia_type_e.AUDIO.i_id),s=!!(e.e_type.i_id&tmedia_type_e.VIDEO.i_id);e.o_remote_stream.audioTracks=e.o_remote_stream.getAudioTracks?e.o_remote_stream.getAudioTracks():{length:t?1:0},e.o_remote_stream.videoTracks=e.o_remote_stream.getVideoTracks?e.o_remote_stream.getVideoTracks():{length:s?1:0}}e.o_mgr.set_stream_remote(_.stream)}},this.o_pc.onremovestream=function(_){tsk_utils_log_info("__on_remove_stream");var e=tmedia_session_jsep01.mozThis||this.o_session;e.o_remote_stream=null,e.o_mgr&&e.o_mgr.set_stream_remote(null)})},tmedia_session_jsep.prototype.close=function(){if(this.o_mgr&&(this.o_mgr.set_stream_remote(null),this.o_mgr.set_stream_local(null)),this.o_pc){if(this.o_local_stream){try{this.o_pc.removeStream(this.o_local_stream)}catch(_){}this.b_cache_stream&&this.e_type!=tmedia_type_e.SCREEN_SHARE||this.o_local_stream.stop(),this.o_local_stream=null}this.o_pc.close(),this.o_pc=null,this.b_sdp_lo_pending=!1,this.b_sdp_ro_pending=!1}},tmedia_session_jsep.prototype.__acked=function(){return 0},tmedia_session_jsep.prototype.__hold=function(){return this.b_lo_held?void 0:(this.b_lo_held=!0,this.close(),this.o_sdp_ro=null,this.decorate_lo(!0),0)},tmedia_session_jsep.prototype.__resume=function(){return this.b_lo_held?(this.b_lo_held=!1,this.close(),tmedia_session_jsep01.mozThis&&(tmedia_session_jsep01.mozThis.localDescription=null),this.o_sdp_lo=null,this.o_sdp_ro=null,0):void 0},tmedia_session_jsep00.prototype.__get_lo=function(){if(!this.o_pc&&!this.b_lo_held){this.o_mgr.set_stream_local(__o_roap_stream),this.o_local_stream=__o_roap_stream;var _=this;this.o_pc=new __o_peerconnection_class("STUN stun.l.google.com:19302",function(e,t){e&&_.o_sdp_jsep_lo.addCandidate(e),t||(_.o_sdp_lo=tsdp_message.prototype.Parse(_.o_sdp_jsep_lo.toSdp()),_.o_sdp_lo&&_.decorate_lo(!0),_.o_mgr&&_.o_mgr.callback(tmedia_session_events_e.GET_LO_SUCCESS,_.e_type),_.b_sdp_lo_pending=!1)}),this.o_pc.o_session=this,this.o_pc.o_mgr=this.o_mgr,this.subscribe_stream_events()}if(!this.o_sdp_lo&&!this.b_sdp_lo_pending){var e=!0,t=(this.b_sdp_ro_pending||this.b_sdp_ro_offer)&&null!=this.o_sdp_ro;if(this.o_pc.localDescription)switch(this.o_pc.iceState){case __o_peerconnection_class.ICE_COMPLETED:case __o_peerconnection_class.ICE_FAILED:case __o_peerconnection_class.ICE_CLOSED:e=!1}this.b_sdp_ro_pending&&this.o_sdp_ro&&this.__set_ro(this.o_sdp_ro,!0),this.o_sdp_jsep_lo=t?this.o_pc.createAnswer(this.o_pc.remoteDescription.toSdp(),{has_audio:!!(this.e_type.i_id&tmedia_type_e.AUDIO.i_id),has_video:!!(this.e_type.i_id&tmedia_type_e.VIDEO.i_id)}):this.o_pc.createOffer({has_audio:!!(this.e_type.i_id&tmedia_type_e.AUDIO.i_id),has_video:!!(this.e_type.i_id&tmedia_type_e.VIDEO.i_id)}),e||(this.o_sdp_lo=tsdp_message.prototype.Parse(this.o_sdp_jsep_lo.toSdp()),this.o_sdp_lo&&(this.decorate_lo(!1),this.o_sdp_jsep_lo=new __o_sessiondescription_class(this.o_sdp_lo))),this.o_pc.setLocalDescription(t?__o_peerconnection_class.SDP_ANSWER:__o_peerconnection_class.SDP_OFFER,this.o_sdp_jsep_lo),e&&(this.b_sdp_lo_pending=!0,this.o_pc.startIce({use_candidates:"all"}))}return this.o_sdp_lo},tmedia_session_jsep00.prototype.__set_ro=function(_,e){if(!_)return tsk_utils_log_error("Invalid argument"),-1;if(this.o_sdp_ro=_,this.b_sdp_ro_offer=e,this.o_pc)try{this.decorate_ro(!0),this.o_pc.setRemoteDescription(e?__o_peerconnection_class.SDP_OFFER:__o_peerconnection_class.SDP_ANSWER,new __o_sessiondescription_class(this.o_sdp_ro.toString())),!this.b_sdp_ro_pending&&e&&(this.o_sdp_lo=null)}catch(t){return this.o_mgr.callback(tmedia_session_events_e.SET_RO_FAILED,this.e_type),tsk_utils_log_error(t),-2}finally{this.b_sdp_ro_pending=!1}else this.b_sdp_ro_pending=!0;return 0},tmedia_session_jsep01.mozThis=void 0,tmedia_session_jsep01.onGetUserMediaSuccess=function(_,e){tsk_utils_log_info("onGetUserMediaSuccess");var t=tmedia_session_jsep01.mozThis||e;if(t&&t.o_pc&&t.o_mgr){if(!t.b_sdp_lo_pending)return void tsk_utils_log_warn("onGetUserMediaSuccess but no local sdp request is pending");if(!_.videoTracks||!_.audioTracks){var s=!!(t.e_type.i_id&tmedia_type_e.AUDIO.i_id),i=!!(t.e_type.i_id&tmedia_type_e.VIDEO.i_id);_.audioTracks=_.getAudioTracks?_.getAudioTracks():{length:s?1:0},_.videoTracks=_.getVideoTracks?_.getVideoTracks():{length:i?1:0}}_.audioTracks.length>0&&0==_.videoTracks.length?__o_jsep_stream_audio=_:_.audioTracks.length>0&&_.videoTracks.length>0&&(__o_jsep_stream_audiovideo=_),t.o_local_stream||t.o_mgr.callback(tmedia_session_events_e.STREAM_LOCAL_ACCEPTED,this.e_type),tmedia_session_jsep01.mozThis&&(__o_jsep_stream_audiovideo=__o_jsep_stream_audio=_),t.o_local_stream=_,t.o_pc.addStream(_),t.o_mgr.set_stream_local(_);var r=(t.b_sdp_ro_pending||t.b_sdp_ro_offer)&&null!=t.o_sdp_ro;r?(tsk_utils_log_info("createAnswer"),t.o_pc.createAnswer(tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onCreateSdpSuccess:function(_){tmedia_session_jsep01.onCreateSdpSuccess(_,t)},tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onCreateSdpError:function(_){tmedia_session_jsep01.onCreateSdpError(_,t)},t.o_media_constraints,!1)):(tsk_utils_log_info("createOffer"),t.o_pc.createOffer(tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onCreateSdpSuccess:function(_){tmedia_session_jsep01.onCreateSdpSuccess(_,t)},tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onCreateSdpError:function(_){tmedia_session_jsep01.onCreateSdpError(_,t)},t.o_media_constraints))}},tmedia_session_jsep01.onGetUserMediaError=function(_,e){tsk_utils_log_info("onGetUserMediaError");var t=tmedia_session_jsep01.mozThis||e;t&&t.o_mgr&&(tsk_utils_log_error(_),t.o_mgr.callback(tmedia_session_events_e.STREAM_LOCAL_REFUSED,t.e_type))},tmedia_session_jsep01.onCreateSdpSuccess=function(_,e){tsk_utils_log_info("onCreateSdpSuccess");var t=tmedia_session_jsep01.mozThis||e;t&&t.o_pc&&(t.iceFinished=!1,t.o_pc.setLocalDescription(_,tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onSetLocalDescriptionSuccess:function(){tmedia_session_jsep01.onSetLocalDescriptionSuccess(t)},tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onSetLocalDescriptionError:function(_){tmedia_session_jsep01.onSetLocalDescriptionError(_,t)}))},tmedia_session_jsep01.onCreateSdpError=function(_,e){tsk_utils_log_info("onCreateSdpError");var t=tmedia_session_jsep01.mozThis||e;t&&t.o_mgr&&(tsk_utils_log_error(_),t.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,t.e_type))},tmedia_session_jsep01.onSetLocalDescriptionSuccess=function(_){},tmedia_session_jsep01.onSetLocalDescriptionError=function(_,e){tsk_utils_log_info("onSetLocalDescriptionError");var t=tmedia_session_jsep01.mozThis||e;t&&t.o_mgr&&(tsk_utils_log_error(_.toString()),t.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,t.e_type))},tmedia_session_jsep01.onSetRemoteDescriptionSuccess=function(_){tsk_utils_log_info("onSetRemoteDescriptionSuccess");var e=tmedia_session_jsep01.mozThis||_;e&&!e.b_sdp_ro_pending&&e.b_sdp_ro_offer&&(e.o_sdp_lo=null)},tmedia_session_jsep01.onSetRemoteDescriptionError=function(_,e){tsk_utils_log_info("onSetRemoteDescriptionError");var t=tmedia_session_jsep01.mozThis||e;t&&(t.o_mgr.callback(tmedia_session_events_e.SET_RO_FAILED,t.e_type),tsk_utils_log_error(_))},tmedia_session_jsep01.onIceGatheringCompleted=function(_){tsk_utils_log_info("onIceGatheringCompleted");var e=tmedia_session_jsep01.mozThis||_;if(e&&e.o_pc){if(!e.b_sdp_lo_pending)return void tsk_utils_log_warn("onIceGatheringCompleted but no local sdp request is pending");e.b_sdp_lo_pending=!1;var t=e.o_pc.localDescription||e.localDescription;t?(e.o_sdp_jsep_lo=t,e.o_sdp_lo=tsdp_message.prototype.Parse(e.o_sdp_jsep_lo.sdp),e.decorate_lo(!0),e.o_mgr&&e.o_mgr.callback(tmedia_session_events_e.GET_LO_SUCCESS,e.e_type)):(e.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,e.e_type),tsk_utils_log_error("localDescription is null"))}},tmedia_session_jsep01.onIceCandidate=function(_,e){tsk_utils_log_info("onIceCandidate");var t=tmedia_session_jsep01.mozThis||e;if(t&&t.o_pc&&!t.iceFinished){var s="complete"==t.o_pc.iceGatheringState,i=_&&!_.candidate,r=_&&_.candidate&&-1!==_.candidate.candidate.indexOf("typ srflx");i||r||s?(tsk_utils_log_info("ICE GATHERING COMPLETED!"),tmedia_session_jsep01.onIceGatheringCompleted(t),t.iceFinished=!0):"failed"==t.o_pc.iceState&&(tsk_utils_log_error("Ice state is 'failed'"),t.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,t.e_type))}},tmedia_session_jsep01.prototype.__get_lo=function(){var _=this,e=this.ao_ice_servers;if(!this.o_pc&&!this.b_lo_held){var t={mandatory:{},optional:[]};if((this.e_type.i_id&tmedia_type_e.SCREEN_SHARE.i_id)==tmedia_type_e.SCREEN_SHARE.i_id&&(t.mandatory.chromeMediaSource="screen"),this.e_type.i_id&tmedia_type_e.VIDEO.i_id){this.o_video_size&&(this.o_video_size.minWidth&&(t.mandatory.minWidth=this.o_video_size.minWidth),this.o_video_size.minHeight&&(t.mandatory.minHeight=this.o_video_size.minHeight),this.o_video_size.maxWidth&&(t.mandatory.maxWidth=this.o_video_size.maxWidth),this.o_video_size.maxHeight&&(t.mandatory.maxHeight=this.o_video_size.maxHeight));try{tsk_utils_log_info("Video Contraints:"+JSON.stringify(t))}catch(s){}}var i={mandatory:{},optional:[]};this.o_audio_constraints&&"chrome"==tsk_utils_get_navigator_friendly_name()&&(void 0!=this.o_audio_constraints.googEchoCancellation&&(i.mandatory.googEchoCancellation=this.o_audio_constraints.googEchoCancellation),void 0!=this.o_audio_constraints.googNoiseSuppression&&(i.mandatory.googNoiseSuppression=this.o_audio_constraints.googNoiseSuppression),void 0!=this.o_audio_constraints.googAutoGainControl&&(i.mandatory.googAutoGainControl=this.o_audio_constraints.googAutoGainControl));var e=this.ao_ice_servers;e||(e=tmedia_session_jsep01.mozThis?[{url:"stun:23.21.150.121:3478"},{url:"stun:216.93.246.18:3478"},{url:"stun:66.228.45.110:3478"},{url:"stun:173.194.78.127:19302"}]:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun.counterpath.net:3478"},{url:"stun:numb.viagenie.ca:3478"}]);try{tsk_utils_log_info("ICE servers:"+JSON.stringify(e))}catch(s){}this.o_pc=new __o_peerconnection_class(e&&!e.length?null:{iceServers:e},this.o_media_constraints),this.o_pc.onicecandidate=tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onIceCandidate:function(e){tmedia_session_jsep01.onIceCandidate(e,_)},this.o_pc.o_mgr=this.o_mgr,tmedia_session_jsep01.mozThis||(this.o_pc.o_session=this),this.subscribe_stream_events()}return this.o_sdp_lo||this.b_sdp_lo_pending||(this.b_sdp_lo_pending=!0,this.b_sdp_ro_pending&&this.o_sdp_ro&&this.__set_ro(this.o_sdp_ro,!0),this.e_type==tmedia_type_e.AUDIO&&this.b_cache_stream&&__o_jsep_stream_audio?tmedia_session_jsep01.onGetUserMediaSuccess(__o_jsep_stream_audio,_):this.e_type==tmedia_type_e.AUDIO_VIDEO&&this.b_cache_stream&&__o_jsep_stream_audiovideo?tmedia_session_jsep01.onGetUserMediaSuccess(__o_jsep_stream_audiovideo,_):(this.o_mgr.callback(tmedia_session_events_e.STREAM_LOCAL_REQUESTED,this.e_type),navigator.nativeGetUserMedia({audio:this.e_type==tmedia_type_e.SCREEN_SHARE?!1:this.e_type.i_id&tmedia_type_e.AUDIO.i_id?i:!1,video:this.e_type.i_id&tmedia_type_e.VIDEO.i_id?t:!1,data:!1},tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onGetUserMediaSuccess:function(e){tmedia_session_jsep01.onGetUserMediaSuccess(e,_)},tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onGetUserMediaError:function(e){tmedia_session_jsep01.onGetUserMediaError(e,_)}))),this.o_sdp_lo},tmedia_session_jsep01.prototype.__set_ro=function(_,e){if(!_)return tsk_utils_log_error("Invalid argument"),-1;if(this.o_sdp_ro=_,this.b_sdp_ro_offer=e,this.o_pc)try{var t=this;this.decorate_ro(!1),tsk_utils_log_info("setRemoteDescription("+(e?"offer)":"answer)")+"\n"+this.o_sdp_ro),this.o_pc.setRemoteDescription(new __o_sessiondescription_class({type:e?"offer":"answer",sdp:t.o_sdp_ro.toString()}),tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onSetRemoteDescriptionSuccess:function(){tmedia_session_jsep01.onSetRemoteDescriptionSuccess(t)},tmedia_session_jsep01.mozThis?tmedia_session_jsep01.onSetRemoteDescriptionError:function(_){tmedia_session_jsep01.onSetRemoteDescriptionError(_,t)})}catch(s){return tsk_utils_log_error(s),this.o_mgr.callback(tmedia_session_events_e.SET_RO_FAILED,this.e_type),-2}finally{this.b_sdp_ro_pending=!1}else this.b_sdp_ro_pending=!0;return 0};var __o_session_roap=null,tmedia_session_state_e={NONE:-1,OFFER_SENT:0,OFFER_RECEIVED:1,ANSWER_SENT:2,ANSWER_RECEIVED:3,LOCAL_HOLD:10};tmedia_session_roap.prototype.__set=function(_){return 0},tmedia_session_roap.prototype.__prepare=function(){return 0},tmedia_session_roap.prototype.__start=function(){return 0},tmedia_session_roap.prototype.__pause=function(){return 0},tmedia_session_roap.prototype.__stop=function(){return tsk_utils_log_info("PeerConnection::stop()"),this.o_pc&&(this.o_pc.close(),this.o_pc=null),this.o_mgr.set_stream_remote(null),this.o_mgr.set_stream_local(null),0},tmedia_session_roap.prototype.__get_lo=function(){return tsk_utils_log_info("ROAP: __get_lo"),this.o_pc?this.o_sdp_lo:(__o_session_roap=this,this.o_mgr.set_stream_local(__o_roap_stream),__o_session_roap.o_local_stream=__o_roap_stream,__o_session_roap.o_pc=new __o_peerconnection_class("STUN stun.l.google.com:19302",__o_session_roap.__on_signaling_message),__o_session_roap.o_pc.o_session=__o_session_roap,__o_session_roap.o_pc.onstatechange=tmedia_session_roap.prototype.__on_state_change,__o_session_roap.o_pc.onconnecting=tmedia_session_roap.prototype.__on_connecting,__o_session_roap.o_pc.onopen=tmedia_session_roap.prototype.__on_open,__o_session_roap.o_pc.onaddstream=tmedia_session_roap.prototype.__on_add_stream,__o_session_roap.o_pc.onremovestream=tmedia_session_roap.prototype.__on_remove_stream,__o_session_roap.o_pc&&(tsk_utils_log_info("ROAP: __get_lo::addStream()"),__o_session_roap.o_pc.addStream(__o_session_roap.o_local_stream)),this.e_state==tmedia_session_state_e.OFFER_RECEIVED&&this.o_sdp_ro&&this.__set_ro(this.o_sdp_ro,!0),null)},tmedia_session_roap.prototype.__hold=function(){return this.b_lo_held=!0,this.o_pc&&this.o_local_stream?(this.o_pc.removeStream(this.o_local_stream),0):(tsk_utils_log_error("Invalid state"),-1)},tmedia_session_roap.prototype.__set_ro=function(_,e){if(tsk_utils_log_info("ROAP: __set_ro"),this.o_sdp_ro=_,!this.o_pc)return this.e_state=tmedia_session_state_e.OFFER_RECEIVED,0;var t,s,i,r=null,a=1,n=Math.floor(65535*Math.random());(t=this.o_sdp_ro.get_header(tsdp_header_type_e.O))&&(a=t.i_sess_version),this.e_state=e?tmedia_session_state_e.OFFER_RECEIVED:tmedia_session_state_e.ANSWER_RECEIVED,this.o_pc_json?(s=this.o_pc_json.answererSessionId?this.o_pc_json.answererSessionId:tsk_string_random(16),i=this.o_pc_json.offererSessionId?this.o_pc_json.offererSessionId:tsk_string_random(16),r="OFFER"==this.o_pc_json.messageType?tsk_string_format('{\n"answererSessionId" : "{0}",\n"messageType" : "ANSWER",\n"offererSessionId" : "{1}",\n"sdp" : "{2}",\n"seq" : {3}\n}\n',s,i,this.o_sdp_ro.toString("\\r\\n"),this.o_sdp_json_lo.seq):tsk_string_format('{\n"answererSessionId" : "{0}",\n"messageType" : "OFFER",\n"offererSessionId" : "{1}",\n"sdp" : "{2}",\n"seq" : {3},\n"tieBreaker": {4}\n}\n',s,i,this.o_sdp_ro.toString("\\r\\n"),this.o_sdp_json_lo.seq+1,n)):r=tsk_string_format('{\n"messageType" : "OFFER",\n"offererSessionId" : "{0}",\n"sdp" : "{1}",\n"seq" : {2},\n"tieBreaker": {3}\n}\n',tsk_string_random(16),this.o_sdp_ro.toString("\\r\\n"),a,n);try{return tsk_utils_log_info("RO="+r),this.o_sdp_json_ro=JSON.parse(r),this.o_pc.processSignalingMessage("SDP\n"+r),0}catch(o){return __o_session_roap.o_mgr.callback(tmedia_session_events_e.SET_RO_FAILED,this.e_type),tsk_utils_log_error(o),-2}},tmedia_session_roap.prototype.__acked=function(){if(this.o_sdp_json_lo&&"ANSWER"==this.o_sdp_json_lo.messageType){var _=tsk_string_format('SDP\n{\n"answererSessionId" : "{0}",\n"messageType" : "OK",\n"offererSessionId" : "{1}",\n"seq" : {2}\n}\n',this.o_sdp_json_lo.offererSessionId,this.o_sdp_json_lo.answererSessionId,this.o_sdp_json_lo.seq);tsk_utils_log_info("ACK="+_);try{this.o_pc.processSignalingMessage(_)}catch(e){return tsk_utils_log_error(e),-2}}return 0},tmedia_session_roap.prototype.__on_signaling_message=function(_){tsk_utils_log_info("LO="+_),0==tsk_string_index_of(_,3,"SDP")&&(_=_.substring(3));try{if(__o_session_roap.o_pc_json=JSON.parse(_),"OFFER"==__o_session_roap.o_pc_json.messageType||"ANSWER"==__o_session_roap.o_pc_json.messageType){var e=tsdp_message.prototype.Parse(__o_session_roap.o_pc_json.sdp);if(!e)return tsk_utils_log_error("failed to parse sdp"+__o_session_roap.o_pc_json.sdp),void __o_session_roap.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,this.e_type);e.get_header_m_by_name("audio"),e.get_header_m_by_name("video");__o_session_roap.o_sdp_json_lo=__o_session_roap.o_pc_json,__o_session_roap.o_sdp_lo=e;var t;(t=__o_session_roap.o_sdp_lo.get_header(tsdp_header_type_e.S))&&(t.s_value="webrtc (roap)");var s;if((s=__o_session_roap.o_sdp_lo.get_header(tsdp_header_type_e.O))&&(s.i_sess_version=__o_session_roap.o_sdp_json_lo.seq),__o_session_roap.b_lo_held||__o_session_roap.b_ro_held)for(var i,r=0;i=__o_session_roap.o_sdp_lo.get_header_at(tsdp_header_type_e.M,r++);)i.set_holdresume_att(__o_session_roap.b_lo_held,__o_session_roap.b_ro_held);__o_session_roap.e_state==tmedia_session_state_e.LOCAL_HOLD&&(__o_session_roap.e_state=tmedia_session_state_e.OFFER_SENT),__o_session_roap.o_mgr.callback(tmedia_session_events_e.GET_LO_SUCCESS,this.e_type)}else"OK"==__o_session_roap.o_pc_json.messageType&&__o_session_roap.o_mgr.callback(tmedia_session_events_e.SET_RO_SUCCESS,this.e_type);"ERROR"==__o_session_roap.o_pc_json.messageType&&(tsk_utils_log_error("onSignalingMessage::messageType = ERROR"),__o_session_roap.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,this.e_type))}catch(a){return __o_session_roap.o_mgr.callback(tmedia_session_events_e.GET_LO_FAILED,this.e_type),void tsk_utils_log_error(a)}},tmedia_session_roap.prototype.__on_state_change=function(_){tsk_utils_log_info("__on_state_change")},tmedia_session_roap.prototype.__on_connecting=function(_){tsk_utils_log_info("__on_connecting")},tmedia_session_roap.prototype.__on_open=function(_){tsk_utils_log_info("__on_open")},tmedia_session_roap.prototype.__on_add_stream=function(_){tsk_utils_log_info("__on_add_stream"),__o_session_roap&&(__o_session_roap.o_remote_stream=_.stream,__o_session_roap.o_mgr&&__o_session_roap.o_mgr.set_stream_remote(_.stream))},tmedia_session_roap.prototype.__on_remove_stream=function(_){tsk_utils_log_info("__on_remove_stream"),__o_session_roap&&(__o_session_roap.o_remote_stream=null,__o_session_roap.o_mgr&&__o_session_roap.o_mgr.set_stream_remote(null))};var tmedia_param_type_e={CODEC:0,SESSION:1,MANAGER:2},tmedia_qos_status_e={CURR:0,DEST:1,CONF:3},tmedia_qos_ptype_e={QOS:0},tmedia_qos_stype_e={NONE:0,SEGMENTED:1,E2E:2},tmedia_qos_strength_e={NONE:0,FAILURE:1,UNKNOWN:2,OPTIONAL:3,MANDATORY:4},tmedia_qos_direction_e={NONE:0,SEND:2,RECV:4,SEND_RECV:6},tsdp_header_type_e={NONE:{i_rank:-1,c_name:null},A:{i_rank:13,c_name:"a"},B:{i_rank:8,c_name:"b"},C:{i_rank:7,c_name:"c"},DUMMY:{i_rank:255,c_name:"*"},E:{i_rank:5,c_name:"e"},I:{i_rank:3,c_name:"i"},K:{i_rank:12,c_name:"k"},M:{i_rank:14,c_name:"m"},O:{i_rank:1,c_name:"o"},P:{i_rank:6,c_name:"p"},R:{i_rank:10,c_name:"r"},S:{i_rank:2,c_name:"s"},T:{i_rank:9,c_name:"t"},U:{i_rank:4,c_name:"u"},V:{i_rank:0,c_name:"v"},Z:{i_rank:11,c_name:"z"}};tsdp_header.prototype.tostring_full=function(_,e){return tsk_string_format("{0}={1}{2}",this.get_name(),this.toString(e),_?"":e?e:"\r\n")},tsdp_header.prototype.get_name=function(){return this.e_type==tsdp_header_type_e.DUMMY?this.c_name:this.e_type.c_name},window.__b_release_mode||tsdp_api_add_js_scripts("head","src/tinySDP/src/headers/tsdp_header_A.js","src/tinySDP/src/headers/tsdp_header_C.js","src/tinySDP/src/headers/tsdp_header_M.js","src/tinySDP/src/headers/tsdp_header_O.js","src/tinySDP/src/headers/tsdp_header_Str.js","src/tinySDP/src/headers/tsdp_header_V.js"),tsdp_header_A.prototype=Object.create(tsdp_header.prototype),_tsdp_machine_parser_header_A_actions=[0,1,0,1,1,1,2,2,0,2],_tsdp_machine_parser_header_A_key_offsets=[0,0,1,3,18,19,35,35,38],_tsdp_machine_parser_header_A_trans_keys=[97,32,61,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,13,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,13,0,65535,13,0,65535,0],_tsdp_machine_parser_header_A_single_lengths=[0,1,2,5,1,6,0,1,1],_tsdp_machine_parser_header_A_range_lengths=[0,0,0,5,0,5,0,1,1],_tsdp_machine_parser_header_A_index_offsets=[0,0,2,5,16,18,30,31,34],_tsdp_machine_parser_header_A_indicies=[0,1,0,2,1,2,3,3,3,3,3,3,3,3,3,1,4,1,5,6,6,6,7,6,6,6,6,6,6,1,1,9,8,1,11,10,1,0],_tsdp_machine_parser_header_A_trans_targs=[2,0,3,5,6,4,5,7,8,4,8,4],_tsdp_machine_parser_header_A_trans_actions=[0,0,0,1,0,3,0,3,1,7,0,5],_tsdp_machine_parser_header_A_eof_actions=[0,0,0,0,0,3,0,7,5],tsdp_machine_parser_header_A_start=1,tsdp_machine_parser_header_A_first_final=5,tsdp_machine_parser_header_A_error=0,tsdp_machine_parser_header_A_en_main=1,tsdp_header_A.prototype.toString=function(){return tsk_string_format("{0}{1}{2}",this.s_field,this.s_value?":":"",this.s_value?this.s_value:"")},tsdp_header_A.prototype.RemoveAllByField=function(_,e){var t;if(!_||!e)return tsk_utils_log_error("Invalid parameter"),-1;for(i=0;i<_.length;)t=_[i],tsk_string_iequals(e,t.s_field)?_.splice(i,1):++i;return 0},tsdp_header_A.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=new tsdp_header_A(null,null);t=tsdp_machine_parser_header_A_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsdp_machine_parser_header_A_key_offsets[t],p=_tsdp_machine_parser_header_A_index_offsets[t],o=_tsdp_machine_parser_header_A_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsdp_machine_parser_header_A_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsdp_machine_parser_header_A_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsdp_machine_parser_header_A_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsdp_machine_parser_header_A_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsdp_machine_parser_header_A_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(p=_tsdp_machine_parser_header_A_indicies[p],t=_tsdp_machine_parser_header_A_trans_targs[p],0!=_tsdp_machine_parser_header_A_trans_actions[p])for(d=_tsdp_machine_parser_header_A_trans_actions[p],l=_tsdp_machine_parser_header_A_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsdp_machine_parser_header_A_actions[d-1]){case 0:e=s;break;case 1:n.s_field=tsk_ragel_parser_get_string(_,s,e);break;case 2:n.s_value=tsk_ragel_parser_get_string(_,s,e)}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r){for(__acts=_tsdp_machine_parser_header_A_eof_actions[t],__nacts=_tsdp_machine_parser_header_A_actions[__acts],
__acts+=1;__nacts>0;)switch(__nacts-=1,__acts+=1,_tsdp_machine_parser_header_A_actions[__acts-1]){case 0:e=s;break;case 1:n.s_field=tsk_ragel_parser_get_string(_,s,e);break;case 2:n.s_value=tsk_ragel_parser_get_string(_,s,e)}if(_trigger_goto)continue}if(f>=h)break}return 5>t?(tsk_utils_log_error('Failed to parse "a=" header: '+_),null):n},tsdp_header_C.prototype=Object.create(tsdp_header.prototype),_tsdp_machine_parser_header_C_actions=[0,1,0,1,1,1,2,1,3,2,0,2,2,0,3],_tsdp_machine_parser_header_C_key_offsets=[0,0,1,3,6,9,12,15,16,19,22],_tsdp_machine_parser_header_C_trans_keys=[99,32,61,32,0,65535,32,0,65535,32,0,65535,32,0,65535,10,13,0,65535,13,0,65535,0],_tsdp_machine_parser_header_C_single_lengths=[0,1,2,1,1,1,1,1,1,1,0],_tsdp_machine_parser_header_C_range_lengths=[0,0,0,1,1,1,1,0,1,1,0],_tsdp_machine_parser_header_C_index_offsets=[0,0,2,5,8,11,14,17,19,22,25],_tsdp_machine_parser_header_C_trans_targs=[2,0,2,3,0,3,4,0,5,4,0,8,6,0,8,6,0,10,0,7,9,0,7,9,0,0,0],_tsdp_machine_parser_header_C_trans_actions=[0,0,0,0,0,0,1,0,3,0,0,9,1,0,5,0,0,0,0,12,1,0,7,0,0,0,0],_tsdp_machine_parser_header_C_eof_actions=[0,0,0,0,0,0,0,0,12,7,0],tsdp_machine_parser_header_C_start=1,tsdp_machine_parser_header_C_first_final=8,tsdp_machine_parser_header_C_error=0,tsdp_machine_parser_header_C_en_main=1,tsdp_header_C.prototype.toString=function(){return tsk_string_format("{0} {1} {2}",this.s_nettype,this.s_addrtype,this.s_addr)},tsdp_header_C.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=new tsdp_header_C(null,null,null);t=tsdp_machine_parser_header_C_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsdp_machine_parser_header_C_key_offsets[t],p=_tsdp_machine_parser_header_C_index_offsets[t],o=_tsdp_machine_parser_header_C_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsdp_machine_parser_header_C_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsdp_machine_parser_header_C_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsdp_machine_parser_header_C_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsdp_machine_parser_header_C_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsdp_machine_parser_header_C_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(t=_tsdp_machine_parser_header_C_trans_targs[p],0!=_tsdp_machine_parser_header_C_trans_actions[p])for(d=_tsdp_machine_parser_header_C_trans_actions[p],l=_tsdp_machine_parser_header_C_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsdp_machine_parser_header_C_actions[d-1]){case 0:e=s;break;case 1:n.s_nettype=tsk_ragel_parser_get_string(_,s,e);break;case 2:n.s_addrtype=tsk_ragel_parser_get_string(_,s,e);break;case 3:n.s_addr=tsk_ragel_parser_get_string(_,s,e)}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r){for(__acts=_tsdp_machine_parser_header_C_eof_actions[t],__nacts=_tsdp_machine_parser_header_C_actions[__acts],__acts+=1;__nacts>0;)switch(__nacts-=1,__acts+=1,_tsdp_machine_parser_header_C_actions[__acts-1]){case 0:e=s;break;case 3:n.s_addr=tsk_ragel_parser_get_string(_,s,e)}if(_trigger_goto)continue}if(f>=h)break}return 8>t?(tsk_utils_log_error('Failed to parse "c=" header: '+_),null):n},tsdp_header_M.prototype=Object.create(tsdp_header.prototype),_tsdp_machine_parser_header_M_actions=[0,1,0,1,1,1,2,1,3,1,4],_tsdp_machine_parser_header_M_key_offsets=[0,0,1,3,18,33,35,39,53,54,68,70,73,88,88,103],_tsdp_machine_parser_header_M_trans_keys=[109,32,61,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,48,57,32,47,48,57,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,33,37,39,126,42,43,45,46,48,57,65,90,95,122,48,57,32,48,57,13,32,33,37,39,47,126,42,43,45,57,65,90,95,122,13,33,37,39,126,42,43,45,46,48,57,65,90,95,122,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,0],_tsdp_machine_parser_header_M_single_lengths=[0,1,2,5,5,0,2,4,1,4,0,1,7,0,5,6],_tsdp_machine_parser_header_M_range_lengths=[0,0,0,5,5,1,1,5,0,5,1,1,4,0,5,5],_tsdp_machine_parser_header_M_index_offsets=[0,0,2,5,16,27,29,33,43,45,55,57,60,72,73,84],_tsdp_machine_parser_header_M_indicies=[0,1,0,2,1,2,3,3,3,3,3,3,3,3,3,1,4,5,5,5,5,5,5,5,5,5,1,6,1,7,8,9,1,10,10,10,10,10,10,10,10,10,1,11,1,12,12,12,12,12,12,12,12,12,1,13,1,7,14,1,15,16,12,12,12,17,12,12,12,12,12,1,1,18,19,19,19,19,19,19,19,19,19,1,20,21,22,22,22,22,22,22,22,22,22,1,0],_tsdp_machine_parser_header_M_trans_targs=[2,0,3,4,5,4,6,7,10,6,12,13,12,11,11,8,14,9,8,15,8,14,15],_tsdp_machine_parser_header_M_trans_actions=[0,0,0,1,3,0,1,5,5,0,1,0,0,1,0,7,7,0,0,1,9,9,0],_tsdp_machine_parser_header_M_eof_actions=[0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,9],tsdp_machine_parser_header_M_start=1,tsdp_machine_parser_header_M_first_final=12,tsdp_machine_parser_header_M_error=0,tsdp_machine_parser_header_M_en_main=1,tsdp_header_M.prototype.toString=function(_){_||(_="\r\n");for(var e=tsk_string_format("{0} {1}{2}{3} {4}",this.s_media,this.i_port,this.i_nports?"/":"",this.i_nports?this.i_nports:"",this.s_proto),t=0;t<this.as_fmt.length;++t)e+=" "+this.as_fmt[t];var s=!this.o_hdr_I&&!this.o_hdr_C&&0==this.ao_hdr_B.length&&!this.o_hdr_K&&0==this.ao_hdr_A.length.length;if(s)return e;e+=_,this.o_hdr_I&&(e+=this.o_hdr_I.tostring_full(!1,_)),this.o_hdr_C&&(e+=this.o_hdr_C.tostring_full(!1,_));for(var t=0;t<this.ao_hdr_B.length;++t)e+=this.ao_hdr_B[t].tostring_full(!1,_);this.o_hdr_K&&(e+=this.o_hdr_K.tostring_full(!1,_));for(var t=0;t<this.ao_hdr_A.length;++t)e+=this.ao_hdr_A[t].tostring_full(!1,_);for(var t=0;t<this.ao_hdr_Dummy.length;++t)e+=this.ao_hdr_Dummy[t].tostring_full(!1,_);return e.substring(0,e.length-_.length)},tsdp_header_M.prototype.remove_header=function(_){switch(_){case tsdp_header_type_e.I:this.o_hdr_I=null;break;case tsdp_header_type_e.C:this.o_hdr_C=null;break;case tsdp_header_type_e.B:this.ao_hdr_B.splice(0,this.ao_hdr_B.length);break;case tsdp_header_type_e.K:this.o_hdr_K=null}return 0},tsdp_header_M.prototype.add_header=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;switch(_.e_type){case tsdp_header_type_e.I:this.o_hdr_I=_;break;case tsdp_header_type_e.C:this.o_hdr_C=_;break;case tsdp_header_type_e.B:this.ao_hdr_B.push(_);break;case tsdp_header_type_e.K:this.o_hdr_K=_;break;case tsdp_header_type_e.A:this.ao_hdr_A.push(_)}return 0},tsdp_header_M.prototype.add_fmt=function(_){_&&this.as_fmt.push(_)},tsdp_header_M.prototype.add_headers=function(){for(var _=0;_<arguments.length;++_)arguments[_]&&this.add_header(arguments[_])},tsdp_header_M.prototype.find_a_at=function(_,e){if(!_||0>e)return tsk_utils_log_error("Invalid argument"),null;for(var t=0,s=0;s<this.ao_hdr_A.length;++s)if(this.ao_hdr_A[s].s_field==_&&t++>=e)return this.ao_hdr_A[s];return null},tsdp_header_M.prototype.find_a=function(_){return this.find_a_at(_,0)},tsdp_header_M.prototype.get_rtpmap=function(_){var e=_?_.length:0;if(0>=e||e>3)return tsk_utils_log_error("Invalid argument"),null;for(var t,s,i,r=null,a=0;i=this.find_a_at(a++);)if(!((t=i.s_value?i.s_value.length:0)<e+1)&&0==(s=tsk_string_index_of(i.s_value,t,_))&&" "==i.s_value[e]){r=i.s_value.substring(e+1,A_len);break}return r},tsdp_header_M.prototype.get_fmtp=function(_){var e=_?_.length:0;if(0>=e||e>3)return tsk_utils_log_error("Invalid argument"),null;for(var t,s,i,r=null,a=0;i=this.find_a_at(a++);)if(!((t=i.s_value?i.s_value.length:0)<e+1)&&0==(s=tsk_string_index_of(i.s_value,t,_))&&" "==i.s_value[e]){r=i.s_value.substring(e+1,A_len);break}return r},tsdp_header_M.prototype.hold=function(_){var e;if(e=this.find_a(_?"recvonly":"sendonly"))e.s_field=_?"inactive":"recvonly";else if(e=this.find_a("sendrecv"))e.s_field=_?"sendonly":"recvonly";else if(!(e=this.find_a(_?"sendonly":"recvonly"))&&!(e=this.find_a("inactive"))){var t;(t=new tsdp_header_A(_?"sendonly":"recvonly",null))&&this.add_header(t)}return 0},tsdp_header_M.prototype.set_holdresume_att=function(_,e){var t,s=[["sendrecv","recvonly"],["sendonly","inactive"]];if((t=this.find_a("sendrecv"))||(t=this.find_a("sendonly"))||(t=this.find_a("recvonly"))||(t=this.find_a("inactive")))t.s_field=s[_?1:0][e?1:0];else{var i;(i=new tsdp_header_A(s[_?1:0][e?1:0],null))&&this.add_headers(i)}return 0},tsdp_header_M.prototype.is_held=function(_){return this.find_a("inactive")?!0:_?this.find_a("recvonly")?!0:!1:this.find_a("sendonly")?!0:!1},tsdp_header_M.prototype.resume=function(_){var e;return(e=this.find_a("inactive"))?e.s_field=_?"recvonly":"sendonly":(e=this.find_a(_?"sendonly":"recvonly"))&&(e.s_field=sendrecv),0},tsdp_header_M.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=new tsdp_header_M(null,0,null);t=tsdp_machine_parser_header_M_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsdp_machine_parser_header_M_key_offsets[t],p=_tsdp_machine_parser_header_M_index_offsets[t],o=_tsdp_machine_parser_header_M_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsdp_machine_parser_header_M_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsdp_machine_parser_header_M_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsdp_machine_parser_header_M_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsdp_machine_parser_header_M_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsdp_machine_parser_header_M_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(p=_tsdp_machine_parser_header_M_indicies[p],t=_tsdp_machine_parser_header_M_trans_targs[p],0!=_tsdp_machine_parser_header_M_trans_actions[p])for(d=_tsdp_machine_parser_header_M_trans_actions[p],l=_tsdp_machine_parser_header_M_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsdp_machine_parser_header_M_actions[d-1]){case 0:e=s;break;case 1:n.s_media=tsk_ragel_parser_get_string(_,s,e);break;case 2:n.i_port=tsk_ragel_parser_get_int(_,s,e);break;case 3:n.s_proto=tsk_ragel_parser_get_string(_,s,e);break;case 4:tsk_ragel_parser_add_string(_,s,e,n.as_fmt)}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r){for(__acts=_tsdp_machine_parser_header_M_eof_actions[t],__nacts=_tsdp_machine_parser_header_M_actions[__acts],__acts+=1;__nacts>0;)switch(__nacts-=1,__acts+=1,_tsdp_machine_parser_header_M_actions[__acts-1]){case 3:n.s_proto=tsk_ragel_parser_get_string(_,s,e);break;case 4:tsk_ragel_parser_add_string(_,s,e,n.as_fmt)}if(_trigger_goto)continue}if(f>=h)break}return 12>t?(tsk_utils_log_error('Failed to parse "m=" header: '+_),null):n},tsdp_header_O.prototype=Object.create(tsdp_header.prototype),_tsdp_machine_parser_header_O_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,2,0,4,2,0,5,2,0,6],_tsdp_machine_parser_header_O_key_offsets=[0,0,1,3,6,9,11,14,16,19,22,25,28,31,32,35,38],_tsdp_machine_parser_header_O_trans_keys=[111,32,61,32,0,65535,32,0,65535,48,57,32,48,57,48,57,32,48,57,32,0,65535,32,0,65535,32,0,65535,32,0,65535,10,13,0,65535,13,0,65535,0],_tsdp_machine_parser_header_O_single_lengths=[0,1,2,1,1,0,1,0,1,1,1,1,1,1,1,1,0],_tsdp_machine_parser_header_O_range_lengths=[0,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0],_tsdp_machine_parser_header_O_index_offsets=[0,0,2,5,8,11,13,16,18,21,24,27,30,33,35,38,41],_tsdp_machine_parser_header_O_trans_targs=[2,0,2,3,0,3,4,0,5,4,0,6,0,7,6,0,8,0,9,8,0,11,10,0,11,10,0,14,12,0,14,12,0,16,0,13,15,0,13,15,0,0,0],_tsdp_machine_parser_header_O_trans_actions=[0,0,0,0,0,0,1,0,3,0,0,1,0,5,0,0,1,0,7,0,0,15,1,0,9,0,0,18,1,0,11,0,0,0,0,21,1,0,13,0,0,0,0],_tsdp_machine_parser_header_O_eof_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,13,0],tsdp_machine_parser_header_O_start=1,tsdp_machine_parser_header_O_first_final=14,tsdp_machine_parser_header_O_error=0,tsdp_machine_parser_header_O_en_main=1,tsdp_header_O.prototype.toString=function(){return tsk_string_format("{0} {1} {2} {3} {4} {5}",this.s_username,this.i_sess_id,this.i_sess_version,this.s_nettype,this.s_addrtype,this.s_addr)},tsdp_header_O.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=new tsdp_header_O(null,0,0,null,null,null);t=tsdp_machine_parser_header_O_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsdp_machine_parser_header_O_key_offsets[t],p=_tsdp_machine_parser_header_O_index_offsets[t],o=_tsdp_machine_parser_header_O_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsdp_machine_parser_header_O_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsdp_machine_parser_header_O_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsdp_machine_parser_header_O_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsdp_machine_parser_header_O_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsdp_machine_parser_header_O_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(t=_tsdp_machine_parser_header_O_trans_targs[p],0!=_tsdp_machine_parser_header_O_trans_actions[p])for(d=_tsdp_machine_parser_header_O_trans_actions[p],l=_tsdp_machine_parser_header_O_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsdp_machine_parser_header_O_actions[d-1]){case 0:e=s;break;case 1:n.s_username=tsk_ragel_parser_get_string(_,s,e);break;case 2:n.i_sess_id=tsk_ragel_parser_get_int(_,s,e);break;case 3:n.i_sess_version=tsk_ragel_parser_get_int(_,s,e);break;case 4:n.s_nettype=tsk_ragel_parser_get_string(_,s,e);break;case 5:n.s_addrtype=tsk_ragel_parser_get_string(_,s,e);break;case 6:n.s_addr=tsk_ragel_parser_get_string(_,s,e)}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r){for(__acts=_tsdp_machine_parser_header_O_eof_actions[t],__nacts=_tsdp_machine_parser_header_O_actions[__acts],__acts+=1;__nacts>0;)switch(__nacts-=1,__acts+=1,_tsdp_machine_parser_header_O_actions[__acts-1]){case 0:e=s;break;case 6:n.s_addr=tsk_ragel_parser_get_string(_,s,e)}if(_trigger_goto)continue}if(f>=h)break}return 14>t?(tsk_utils_log_error('Failed to parse "o=" header: '+_),null):n},tsdp_header_Str.prototype=Object.create(tsdp_header.prototype),tsdp_header_B.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_E.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_I.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_K.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_P.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_R.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_S.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_T.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_U.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_Z.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_Dummy.prototype=Object.create(tsdp_header_Str.prototype),tsdp_header_Str.prototype.s_value=null,_tsdp_machine_parser_header_Str_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9,1,10,1,11,1,12,2,0,12],_tsdp_machine_parser_header_Str_key_offsets=[0,0,14,16,18,19,21,23,25,27,29,31,33,35,37,39,43,46],_tsdp_machine_parser_header_Str_trans_keys=[98,101,105,107,112,114,115,116,117,122,65,90,97,121,32,61,32,61,10,32,61,32,61,32,61,32,61,32,61,32,61,32,61,32,61,32,61,32,61,13,32,0,65535,13,0,65535,0],_tsdp_machine_parser_header_Str_single_lengths=[0,10,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,0],_tsdp_machine_parser_header_Str_range_lengths=[0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],_tsdp_machine_parser_header_Str_index_offsets=[0,0,13,16,19,21,24,27,30,33,36,39,42,45,48,51,55,58],_tsdp_machine_parser_header_Str_trans_targs=[5,6,7,8,9,10,11,12,13,14,2,2,0,3,15,0,3,15,0,17,0,3,15,0,3,15,0,3,15,0,3,15,0,3,15,0,3,15,0,3,15,0,3,15,0,3,15,0,3,15,0,4,15,16,0,4,16,0,0,0],_tsdp_machine_parser_header_Str_trans_actions=[0,0,0,0,0,0,0,0,0,0,1,1,0,23,23,0,0,0,0,0,0,3,3,0,5,5,0,7,7,0,9,9,0,11,11,0,13,13,0,15,15,0,17,17,0,19,19,0,21,21,0,27,0,1,0,25,0,0,0,0],_tsdp_machine_parser_header_Str_eof_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,25,0],tsdp_machine_parser_header_Str_start=1,tsdp_machine_parser_header_Str_first_final=15,tsdp_machine_parser_header_Str_error=0,tsdp_machine_parser_header_Str_en_main=1,tsdp_header_Str.prototype.toString=function(){return this.s_value},tsdp_header_Str.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=null;t=tsdp_machine_parser_header_Str_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsdp_machine_parser_header_Str_key_offsets[t],p=_tsdp_machine_parser_header_Str_index_offsets[t],o=_tsdp_machine_parser_header_Str_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsdp_machine_parser_header_Str_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsdp_machine_parser_header_Str_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsdp_machine_parser_header_Str_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsdp_machine_parser_header_Str_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsdp_machine_parser_header_Str_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(t=_tsdp_machine_parser_header_Str_trans_targs[p],0!=_tsdp_machine_parser_header_Str_trans_actions[p])for(d=_tsdp_machine_parser_header_Str_trans_actions[p],l=_tsdp_machine_parser_header_Str_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsdp_machine_parser_header_Str_actions[d-1]){case 0:e=s;break;case 1:n=new tsdp_header_B;break;case 2:n=new tsdp_header_E;break;case 3:n=new tsdp_header_I;break;case 4:n=new tsdp_header_K;break;case 5:n=new tsdp_header_P;break;case 6:n=new tsdp_header_R;break;case 7:n=new tsdp_header_S;break;case 8:n=new tsdp_header_T;break;case 9:n=new tsdp_header_U;break;case 10:n=new tsdp_header_Z;break;case 11:n=new tsdp_header_Dummy,n.c_name=tsk_ragel_parser_get_string(_,s,e)[0];break;case 12:n&&(n.s_value=tsk_ragel_parser_get_string(_,s,e))}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r){for(__acts=_tsdp_machine_parser_header_Str_eof_actions[t],__nacts=_tsdp_machine_parser_header_Str_actions[__acts],__acts+=1;__nacts>0;)switch(__nacts-=1,__acts+=1,_tsdp_machine_parser_header_Str_actions[__acts-1]){case 0:e=s;break;case 12:n&&(n.s_value=tsk_ragel_parser_get_string(_,s,e))}if(_trigger_goto)continue}if(f>=h)break}return 15>t?(tsk_utils_log_error("Failed to parse header: "+_),null):n},tsdp_header_V.prototype=Object.create(tsdp_header.prototype),_tsdp_machine_parser_header_V_actions=[0,1,0,1,1],_tsdp_machine_parser_header_V_key_offsets=[0,0,1,3,6,7,10],_tsdp_machine_parser_header_V_trans_keys=[118,32,61,32,48,57,10,13,48,57,0],_tsdp_machine_parser_header_V_single_lengths=[0,1,2,1,1,1,0],_tsdp_machine_parser_header_V_range_lengths=[0,0,0,1,0,1,0],_tsdp_machine_parser_header_V_index_offsets=[0,0,2,5,8,10,13],_tsdp_machine_parser_header_V_trans_targs=[2,0,2,3,0,3,5,0,6,0,4,5,0,0,0],_tsdp_machine_parser_header_V_trans_actions=[0,0,0,0,0,0,1,0,0,0,3,0,0,0,0],_tsdp_machine_parser_header_V_eof_actions=[0,0,0,0,0,3,0],tsdp_machine_parser_header_V_start=1,tsdp_machine_parser_header_V_first_final=5,tsdp_machine_parser_header_V_error=0,tsdp_machine_parser_header_V_en_main=1,tsdp_header_V.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=new tsdp_header_V(0);t=tsdp_machine_parser_header_V_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsdp_machine_parser_header_V_key_offsets[t],p=_tsdp_machine_parser_header_V_index_offsets[t],o=_tsdp_machine_parser_header_V_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsdp_machine_parser_header_V_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsdp_machine_parser_header_V_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsdp_machine_parser_header_V_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsdp_machine_parser_header_V_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsdp_machine_parser_header_V_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(t=_tsdp_machine_parser_header_V_trans_targs[p],0!=_tsdp_machine_parser_header_V_trans_actions[p])for(d=_tsdp_machine_parser_header_V_trans_actions[p],l=_tsdp_machine_parser_header_V_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsdp_machine_parser_header_V_actions[d-1]){case 0:e=s;break;case 1:n.i_version=tsk_ragel_parser_get_int(_,s,e)}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r){for(__acts=_tsdp_machine_parser_header_V_eof_actions[t],__nacts=_tsdp_machine_parser_header_V_actions[__acts],__acts+=1;__nacts>0;)switch(__nacts-=1,__acts+=1,_tsdp_machine_parser_header_V_actions[__acts-1]){case 1:n.i_version=tsk_ragel_parser_get_int(_,s,e)}if(_trigger_goto)continue}if(f>=h)break}return 5>t?(tsk_utils_log_error('Failed to parse "v=" header: '+_),null):n},tsdp_message.prototype.__s_o_username_default="webrtc",tsdp_message.prototype.__i_o_session_ver_default=2301,tsdp_message.prototype.__i_o_session_id_default=1983,tsdp_message.prototype.__s_s_value_default="-",tsdp_message.prototype.get_media_type=function(){var _=this.has_media("audio"),e=this.has_media("video"),t=this.has_media("message");return _&&e?tmedia_type_e.AUDIO_VIDEO:_?tmedia_type_e.AUDIO:e?tmedia_type_e.VIDEO:t?tmedia_type_e.MSRP:tmedia_type_e.NONE},tsdp_message.prototype.add_headers=function(){for(var _=0;_<arguments.length;++_)arguments[_]&&this.ao_headers.push(arguments[_]);this.ao_headers.sort(tsdp_header_compare_by_rank)},tsdp_message.prototype.add_header=function(_){this.add_headers(_)},tsdp_message.prototype.remove_header=function(_){for(var e=0;e<this.ao_headers.length;)this.ao_headers[e].e_type!=_?++e:this.ao_headers.splice(e,1)},tsdp_message.prototype.get_header_at=function(_,e){for(var t=0,s=0;s<this.ao_headers.length;++s)if(this.ao_headers[s].e_type==_&&t++>=e)return this.ao_headers[s];return null},tsdp_message.prototype.get_header=function(_){return this.get_header_at(_,0)},tsdp_message.prototype.get_header_by_name=function(_){for(var e=0;e<this.ao_headers.length;++e)if(this.ao_headers[e].get_name()==_)return _;return null},tsdp_message.prototype.get_header_a_at=function(_,e){if(!_||0>e)return tsk_utils_log_error("Invalid argument"),null;for(var t=0,s=0;s<this.ao_headers.length;++s)if(this.ao_headers[s].e_type==tsdp_header_type_e.A&&this.ao_headers[s].s_field==_&&t++>=e)return this.ao_headers[s];return null},tsdp_message.prototype.get_header_a=function(_){return this.get_header_a_at(_,0)},tsdp_message.prototype.add_media=function(_,e,t){this.add_headers(new tsdp_header_M(_,e,t))},tsdp_message.prototype.remove_media=function(_){for(var e=0;e<this.ao_headers.length;++e)this.ao_headers[e].e_type==tsdp_header_type_e.M&&this.ao_headers[e].s_media==_&&this.ao_headers.splice(e,1)},tsdp_message.prototype.get_header_m_by_name=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),null;for(var e=0;e<this.ao_headers.length;++e)if(this.ao_headers[e].e_type==tsdp_header_type_e.M&&tsk_string_iequals(this.ao_headers[e].s_media,_))return this.ao_headers[e];return null},tsdp_message.prototype.has_media=function(_){return null!=this.get_header_m_by_name(_)},tsdp_message.prototype.hold=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var e=this.get_header_m_by_name(_);return e&&e.hold(!0),0},tsdp_message.prototype.resume=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var e=this.get_header_m_by_name(_);return e&&e.resume(!0),0},tsdp_message.prototype.toString=function(_){var e="";_||(_="\r\n");for(var t=0;t<this.ao_headers.length;++t)e+=this.ao_headers[t].tostring_full(!1,_);return e},window.__b_release_mode||tsdp_api_add_js_scripts("head","src/tinySDP/src/tsdp_parser_message.js"),_tsdp_machine_message_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9,1,10,1,11,1,12,1,13,1,14,1,15,1,16],_tsdp_machine_message_key_offsets=[0,0,2,5,6,8,11,13,16,18,21,23,26,28,31,33,36,38,41,43,46,48,51,53,56,58,61,63,66,68,71,73,76,78,81],_tsdp_machine_message_trans_keys=[32,61,13,0,65535,10,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,32,61,13,0,65535,65,66,67,69,73,75,77,79,80,82,83,84,85,86,90,97,98,99,101,105,107,109,111,112,114,115,116,117,118,122,68,89,100,121,0],_tsdp_machine_message_single_lengths=[0,2,1,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,30],_tsdp_machine_message_range_lengths=[0,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,2],_tsdp_machine_message_index_offsets=[0,0,3,6,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83,86,89,92,95,98],_tsdp_machine_message_trans_targs=[1,2,0,3,2,0,34,0,4,5,0,3,5,0,6,7,0,3,7,0,8,9,0,3,9,0,10,11,0,3,11,0,12,13,0,3,13,0,14,15,0,3,15,0,16,17,0,3,17,0,18,19,0,3,19,0,20,21,0,3,21,0,22,23,0,3,23,0,24,25,0,3,25,0,26,27,0,3,27,0,28,29,0,3,29,0,30,31,0,3,31,0,32,33,0,3,33,0,1,4,6,10,12,14,16,18,20,22,24,26,28,30,32,1,4,6,10,12,14,16,18,20,22,24,26,28,30,32,8,8,0,0],_tsdp_machine_message_trans_actions=[0,0,0,3,0,0,0,0,0,0,0,5,0,0,0,0,0,7,0,0,0,0,0,9,0,0,0,0,0,11,0,0,0,0,0,13,0,0,0,0,0,15,0,0,0,0,0,17,0,0,0,0,0,19,0,0,0,0,0,21,0,0,0,0,0,23,0,0,0,0,0,25,0,0,0,0,0,27,0,0,0,0,0,29,0,0,0,0,0,31,0,0,0,0,0,33,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],tsdp_machine_message_start=34,tsdp_machine_message_first_final=34,tsdp_machine_message_error=0,tsdp_machine_message_en_main=34,tsdp_message.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsdp_message,n=null,o=null,p=null;t=tsdp_machine_message_start;var c,d,l,h,u,m,g,y,f,E,k;for(c=d=l=h=u=null,m=0,g=10,y=15,f=20,E=30,k=40;;){if(_trigger_goto=!1,0>=m){if(s==i){m=E;continue}if(0==t){m=k;continue}}if(g>=m){l=_tsdp_machine_message_key_offsets[t],d=_tsdp_machine_message_index_offsets[t],c=_tsdp_machine_message_single_lengths[t],_break_match=!1;do{if(c>0){for(_lower=l,_upper=l+c-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsdp_machine_message_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsdp_machine_message_trans_keys[_mid])){d+=_mid-l,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;l+=c,d+=c}if(c=_tsdp_machine_message_range_lengths[t],c>0){for(_lower=l,_upper=l+(c<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsdp_machine_message_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsdp_machine_message_trans_keys[_mid+1])){d+=_mid-l>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;d+=c}}while(!1);if(t=_tsdp_machine_message_trans_targs[d],0!=_tsdp_machine_message_trans_actions[d])for(h=_tsdp_machine_message_trans_actions[d],u=_tsdp_machine_message_actions[h],h+=1;u>0;)switch(u-=1,h+=1,_tsdp_machine_message_actions[h-1]){case 0:e=s;break;case 1:p?(n=tsdp_header_A.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&p.ao_hdr_A.push(n):(n=tsdp_header_A.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 2:p?(n=tsdp_header_B.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&p.ao_hdr_B.push(n):(n=tsdp_header_B.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 3:p&&!p.o_hdr_C?p.o_hdr_C=tsdp_header_C.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)):(n=tsdp_header_C.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 4:(n=tsdp_header_Dummy.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&(p?p.ao_hdr_Dummy.push(n):a.add_header(n));break;case 5:(n=tsdp_header_E.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 6:p&&!p.o_hdr_I?p.o_hdr_I=tsdp_header_I.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)):(n=tsdp_header_I.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 7:p&&!p.o_hdr_K?p.o_hdr_K=tsdp_header_K.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)):(n=tsdp_header_K.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 8:(p=tsdp_header_M.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(p);break;case 9:(n=tsdp_header_O.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 10:(n=tsdp_header_P.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 11:(n=tsdp_header_R.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&(o?o.ao_hdr_R.push(n):a.add_header(n));break;case 12:(n=tsdp_header_S.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 13:(o=tsdp_header_T.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&(a.add_header(o),o=null);break;case 14:(n=tsdp_header_U.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 15:(n=tsdp_header_V.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n);break;case 16:(n=tsdp_header_Z.prototype.Parse(tsk_ragel_parser_get_string(_,s,e)))&&a.add_header(n)}if(_trigger_goto)continue}if(f>=m){if(0==t){m=k;continue}if(s+=1,s!=i){m=g;continue}}if(k>=m)break}return 34>t?(tsk_utils_log_error("Failed to parse sdp message: "+_),null):a};var tsip_action_type_common_e={ACCEPT:1e3,CANCEL:1001,HANGUP:1002,REJECT:1002,SHUTDOWN:1003},tsip_action_type_e={NONE:-1,CONFIG:0,DTMF_SEND:1,REGISTER:10,UNREGISTER:tsip_action_type_common_e.HANGUP,SUBSCRIBE:20,UNSUBSCRIBE:tsip_action_type_common_e.HANGUP,MESSAGE:30,INFO:40,PUBLISH:50,UNPUBLISH:tsip_action_type_common_e.HANGUP,OPTIONS:60,INVITE:70,HOLD:71,RESUME:72,ECT:73,ECT_ACCEPT:74,ECT_REJECT:75,ECT_NOTIFY:76,LARGE_MESSAGE:77,ACCEPT:tsip_action_type_common_e.ACCEPT,CANCEL:tsip_action_type_common_e.CANCEL,HANGUP:tsip_action_type_common_e.HANGUP,REJECT:tsip_action_type_common_e.REJECT,SHUTDOWN:tsip_action_type_common_e.SHUTDOWN};tsip_action.prototype.set_line_resp=function(_,e){this.line_resp.i_code=_,this.line_resp.s_phrase=e},tsip_action.prototype.set_content=function(_){this.o_content=_},tsip_action.prototype.get_content=function(){return this.o_content},tsip_action.prototype.add_headers=function(){for(var _=0;_<arguments.length;++_)arguments[_]&&this.ao_headers.push(arguments[_])};var tsip_event_type_e={NONE:-1,INVITE:0,MESSAGE:1,INFO:2,OPTIONS:3,PUBLISH:4,REGISTER:5,SUBSCRIBE:6,DIALOG:20,STACK:21},tsip_event_code_e={DIALOG_TRANSPORT_ERROR:702,DIALOG_GLOBAL_ERROR:703,DIALOG_MESSAGE_ERROR:704,DIALOG_WEBRTC_ERROR:705,DIALOG_REQUEST_INCOMING:800,DIALOG_REQUEST_OUTGOING:802,DIALOG_REQUEST_CANCELLED:803,DIALOG_REQUEST_SENT:804,DIALOG_MEDIA_ADDED:805,DIALOG_MEDIA_REMOVED:806,DIALOG_MEDIA_LOCAL_REQUESTED:807,DIALOG_MEDIA_LOCAL_ACCEPTED:808,DIALOG_MEDIA_LOCAL_REFUSED:809,DIALOG_CONNECTING:900,DIALOG_CONNECTED:901,DIALOG_TERMINATING:902,DIALOG_TERMINATED:903,STACK_STARTING:950,
STACK_STARTED:951,STACK_STOPPING:952,STACK_STOPPED:953,STACK_FAILED_TO_START:954,STACK_FAILED_TO_STOP:955};tsip_event.prototype.init=function(_,e,t,s,i){return this.o_session=_,this.o_usr_data=null,this.i_code=e,this.s_phrase=t,this.o_message=s,this.e_type=i,0},tsip_event.prototype.get_session=function(){return this.o_session},tsip_event.prototype.get_message=function(){return this.o_message},tsip_event.prototype.get_code=function(){return this.i_code},tsip_event.prototype.get_phrase=function(){return this.s_phrase},tsip_event.prototype.set_usr_data=function(_){this.o_usr_data=_},tsip_event.prototype.is_type_session=function(){switch(this.e_type){case tsip_event_type_e.INVITE:case tsip_event_type_e.MESSAGE:case tsip_event_type_e.INFO:case tsip_event_type_e.OPTIONS:case tsip_event_type_e.PUBLISH:case tsip_event_type_e.REGISTER:case tsip_event_type_e.SUBSCRIBE:case tsip_event_type_e.DIALOG:return!0}return!1},tsip_event.prototype.is_type_stack=function(){return this.e_type==tsip_event_type_e.STACK},tsip_event.prototype.signal=function(){var _=this;switch(this.o_session.on_event&&this.is_type_session()&&setTimeout(function(){_.o_session.on_event(_)},1),this.e_type){case tsip_event_type_e.DIALOG:_.o_session.o_stack.on_event_dialog&&setTimeout(function(){_.o_session.o_stack.on_event_dialog(_)},1);break;case tsip_event_type_e.STACK:_.o_session.o_stack.on_event_stack&&setTimeout(function(){_.o_session.o_stack.on_event_stack(_)},1);case tsip_event_type_e.INVITE:_.o_session.o_stack.on_event_invite&&setTimeout(function(){_.o_session.o_stack.on_event_invite(_)},1);break;case tsip_event_type_e.MESSAGE:_.o_session.o_stack.on_event_message&&setTimeout(function(){_.o_session.o_stack.on_event_message(_)},1);break;case tsip_event_type_e.PUBLISH:_.o_session.o_stack.on_event_publish&&setTimeout(function(){_.o_session.o_stack.on_event_publish(_)},1);break;case tsip_event_type_e.SUBSCRIBE:_.o_session.o_stack.on_event_subscribe&&setTimeout(function(){_.o_session.o_stack.on_event_subscribe(_)},1)}return 0},tsip_event.prototype.Signal=function(_,e,t,s,i){if(!e||!e.o_stack)return tsk_utils_log_error("Invalid argument"),-1;var r=new tsip_event(e,t,s,i,_);return r.signal()},tsip_response.prototype=Object.create(tsip_message.prototype),tsip_request.prototype=Object.create(tsip_message.prototype),tsip_message.prototype.__s_version_10="SIP/1.0",tsip_message.prototype.__s_version_20="SIP/2.0",tsip_message.prototype.__s_version_default=tsip_message.prototype.__s_version_20;var tsip_message_type_e={UNKNOWN:0,REQUEST:1,RESPONSE:2},tsip_request_type_e={NONE:{i_id:-1,s_name:"NONE"},ACK:{i_id:0,s_name:"ACK"},BYE:{i_id:1,s_name:"BYE"},CANCEL:{i_id:2,s_name:"CANCEL"},INVITE:{i_id:3,s_name:"INVITE"},OPTIONS:{i_id:4,s_name:"OPTIONS"},REGISTER:{i_id:5,s_name:"REGISTER"},SUBSCRIBE:{i_id:6,s_name:"SUBSCRIBE"},NOTIFY:{i_id:7,s_name:"NOTIFY"},REFER:{i_id:8,s_name:"REFER"},INFO:{i_id:9,s_name:"INFO"},UPDATE:{i_id:10,s_name:"UPDATE"},MESSAGE:{i_id:11,s_name:"MESSAGE"},PUBLISH:{i_id:12,s_name:"PUBLISH"},PRACK:{i_id:13,s_name:"PRACK"}};tsip_message.prototype.add_header=function(_,e){if(!_)return tsk_utils_log_error("Invalid argument"),-1;switch(_.e_type){case tsip_header_type_e.Via:if(!this.o_hdr_firstVia)return this.o_hdr_firstVia=_,0;break;case tsip_header_type_e.From:if(!this.o_hdr_From)return this.o_hdr_From=_,0;break;case tsip_header_type_e.To:if(!this.o_hdr_To)return this.o_hdr_To=_,0;break;case tsip_header_type_e.Contact:if(!this.o_hdr_Contact)return this.o_hdr_Contact=_,0;break;case tsip_header_type_e.Call_ID:if(!this.o_hdr_Call_ID)return this.o_hdr_Call_ID=_,0;break;case tsip_header_type_e.CSeq:if(!this.o_hdr_CSeq)return this.o_hdr_CSeq=_,0;break;case tsip_header_type_e.Expires:if(!this.o_hdr_Expires)return this.o_hdr_Expires=_,0;break;case tsip_header_type_e.Content_Type:if(!this.o_hdr_Content_Type)return this.o_hdr_Content_Type=_,0;break;case tsip_header_type_e.Content_Length:if(!this.o_hdr_Content_Length)return this.o_hdr_Content_Length=_,0}return e?this.ao_headers.unshift(_):this.ao_headers.push(_),0},tsip_message.prototype.add_headers=function(){for(var _=0;_<arguments.length;++_)arguments[_]&&this.add_header(arguments[_]);return 0},tsip_message.prototype.get_header_at=function(_,e){var t=0;switch(_){case tsip_header_type_e.Via:if(0==e)return this.o_hdr_firstVia;++t;break;case tsip_header_type_e.From:if(0==e)return this.o_hdr_From;++t;break;case tsip_header_type_e.To:if(0==e)return this.o_hdr_To;++t;break;case tsip_header_type_e.Contact:if(0==e)return this.o_hdr_Contact;++t;break;case tsip_header_type_e.Call_ID:if(0==e)return this.o_hdr_Call_ID;++t;break;case tsip_header_type_e.CSeq:if(0==e)return this.o_hdr_CSeq;++t;break;case tsip_header_type_e.Expires:if(0==e)return this.o_hdr_Expires;++t;break;case tsip_header_type_e.Content_Type:if(0==e)return this.o_hdr_Content_Type;++t;break;case tsip_header_type_e.Content_Length:if(0==e)return this.o_hdr_Content_Length;++t}for(var s=0;s<this.ao_headers.length;++s)if(this.ao_headers[s].e_type==_&&t++>=e)return this.ao_headers[s];return null},tsip_message.prototype.get_header=function(_){return this.get_header_at(_,0)},tsip_message.prototype.get_response_code=function(){return this.is_response()?this.line.response.i_status_code:0},tsip_message.prototype.get_response_phrase=function(){return this.is_response()?this.line.response.s_reason_phrase:null},tsip_message.prototype.is_allowed=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),!1;for(var e,t=0;e=this.get_header_at(tsip_header_type_e.Allow,t++);)if(e.has_value(_))return!0;return!1},tsip_message.prototype.is_supported=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),!1;for(var e,t=0;e=this.get_header_at(tsip_header_type_e.Supported,t++);)if(e.has_value(_))return!0;return!1},tsip_message.prototype.is_required=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),!1;for(var e,t=0;e=this.get_header_at(tsip_header_type_e.Require,t++);)if(e.has_value(_))return!0;return!1},tsip_message.prototype.get_expires=function(){return this.o_hdr_Expires?this.o_hdr_Expires.i_value:this.o_hdr_Contact?this.o_hdr_Contact.i_expires:-1},tsip_message.prototype.has_content=function(){return this.get_content_length()>0&&this.o_content},tsip_message.prototype.get_content_length=function(){return this.o_hdr_Content_Length?this.o_hdr_Content_Length.i_value:0},tsip_message.prototype.get_content_type=function(){return this.o_hdr_Content_Type?this.o_hdr_Content_Type.s_type:null},tsip_message.prototype.get_content=function(){return this.o_content},tsip_message.prototype.get_content_as_string=function(){return this.o_content&&this.o_content instanceof Array?tsk_buff_u8b2utf8(this.o_content):this.o_content?this.o_content.toString():null},tsip_message.prototype.add_content=function(_,e,t){e&&(this.o_hdr_Content_Type=new tsip_header_Content_Type(e)),_&&"undefined"==typeof t&&(_ instanceof String||"string"==typeof _?t=unescape(encodeURIComponent(_)).length:_.byteLength?t=_.byteLength:_.length?t=_.length:(tsk_utils_log_error("cannot stat content-length"),t=0)),this.o_hdr_Content_Length=new tsip_header_Content_Length(t),this.o_content=_},tsip_message.prototype.toString=function(){var _=null;_=this.e_type==tsip_message_type_e.REQUEST?tsk_string_format("{0} {1} {2}\r\n",this.line.request.s_method,tsip_uri_tostring(this.line.request.o_uri,!0,!1),this.s_version):tsk_string_format("{0} {1} {2}\r\n",this.s_version,this.line.response.i_status_code,this.line.response.s_reason_phrase),this.o_hdr_firstVia&&(_+=this.o_hdr_firstVia.tostring_full()),this.o_hdr_From&&(_+=this.o_hdr_From.tostring_full()),this.o_hdr_To&&(_+=this.o_hdr_To.tostring_full()),this.o_hdr_Contact&&(_+=this.o_hdr_Contact.tostring_full()),this.o_hdr_Call_ID&&(_+=this.o_hdr_Call_ID.tostring_full()),this.o_hdr_CSeq&&(_+=this.o_hdr_CSeq.tostring_full()),this.o_hdr_Expires&&(_+=this.o_hdr_Expires.tostring_full()),this.o_hdr_Content_Type&&(_+=this.o_hdr_Content_Type.tostring_full()),this.o_hdr_Content_Length&&(_+=this.o_hdr_Content_Length.tostring_full());for(var e=0;e<this.ao_headers.length;++e)_+=this.ao_headers[e].tostring_full();return _+="\r\n",this.has_content()&&(_+=this.get_content_as_string()),_},tsip_message.prototype.is_request=function(){return this.e_type==tsip_message_type_e.REQUEST},tsip_message.prototype.is_response=function(){return this.e_type==tsip_message_type_e.RESPONSE},tsip_message.prototype.is_req_type=function(_){return this.is_request()&&this.line.request.e_type==_},tsip_message.prototype.is_ack=function(){return this.is_req_type(tsip_request_type_e.ACK)},tsip_message.prototype.is_bye=function(){return this.is_req_type(tsip_request_type_e.BYE)},tsip_message.prototype.is_cancel=function(){return this.is_req_type(tsip_request_type_e.CANCEL)},tsip_message.prototype.is_invite=function(){return this.is_req_type(tsip_request_type_e.INVITE)},tsip_message.prototype.is_options=function(){return this.is_req_type(tsip_request_type_e.OPTIONS)},tsip_message.prototype.is_register=function(){return this.is_req_type(tsip_request_type_e.REGISTER)},tsip_message.prototype.is_subscribe=function(){return this.is_req_type(tsip_request_type_e.SUBSCRIBE)},tsip_message.prototype.is_notify=function(){return this.is_req_type(tsip_request_type_e.NOTIFY)},tsip_message.prototype.is_update=function(){return this.is_req_type(tsip_request_type_e.UPDATE)},tsip_message.prototype.is_message=function(){return this.is_req_type(tsip_request_type_e.MESSAGE)},tsip_message.prototype.is_publish=function(){return this.is_req_type(tsip_request_type_e.PUBLISH)},tsip_message.prototype.is_prack=function(){return this.is_req_type(tsip_request_type_e.PRACK)},tsip_message.prototype.is_refer=function(){return this.is_req_type(tsip_request_type_e.REFER)},tsip_message.prototype.is_info=function(){return this.is_req_type(tsip_request_type_e.INFO)},tsip_message.prototype.is_response_to=function(_){return this.is_response()&&this.o_hdr_CSeq&&this.o_hdr_CSeq.e_req_type==_},tsip_message.prototype.is_response_to_ack=function(){return this.is_response_to(tsip_request_type_e.ACK)},tsip_message.prototype.is_response_to_bye=function(){return this.is_response_to(tsip_request_type_e.BYE)},tsip_message.prototype.is_response_to_cancel=function(){return this.is_response_to(tsip_request_type_e.CANCEL)},tsip_message.prototype.is_response_to_invite=function(){return this.is_response_to(tsip_request_type_e.INVITE)},tsip_message.prototype.is_response_to_options=function(){return this.is_response_to(tsip_request_type_e.OPTIONS)},tsip_message.prototype.is_response_to_register=function(){return this.is_response_to(tsip_request_type_e.REGISTER)},tsip_message.prototype.is_response_to_subscribe=function(){return this.is_response_to(tsip_request_type_e.SUBSCRIBE)},tsip_message.prototype.is_response_to_notify=function(){return this.is_response_to(tsip_request_type_e.NOTIFY)},tsip_message.prototype.is_response_to_update=function(){return this.is_response_to(tsip_request_type_e.UPDATE)},tsip_message.prototype.is_response_to_message=function(){return this.is_response_to(tsip_request_type_e.MESSAGE)},tsip_message.prototype.is_response_to_publish=function(){return this.is_response_to(tsip_request_type_e.PUBLISH)},tsip_message.prototype.is_response_to_prack=function(){return this.is_response_to(tsip_request_type_e.PRACK)},tsip_message.prototype.is_response_to_refer=function(){return this.is_response_to(tsip_request_type_e.REFER)},tsip_message.prototype.is_response_to_info=function(){return this.is_response_to(tsip_request_type_e.INFO)},tsip_message.prototype.is_response_nxx=function(_){return this.is_response()&&100*_<=this.get_response_code()&&this.get_response_code()<=100*_+99},tsip_message.prototype.is_response_xxx=function(_){return this.is_response()&&this.get_response_code()==_},tsip_message.prototype.is_1xx=function(){return this.is_response_nxx(1)},tsip_message.prototype.is_2xx=function(){return this.is_response_nxx(2)},tsip_message.prototype.is_3xx=function(){return this.is_response_nxx(3)},tsip_message.prototype.is_4xx=function(){return this.is_response_nxx(4)},tsip_message.prototype.is_5xx=function(){return this.is_response_nxx(5)},tsip_message.prototype.is_6xx=function(){return this.is_response_nxx(6)},tsip_message.prototype.is_23456=function(){return this.is_response()&&200<=this.get_response_code()&&this.get_response_code()<=699},tsip_message.prototype.is_3456=function(){return this.is_response()&&300<=this.get_response_code()&&this.get_response_code()<=699},tsip_message.prototype.GetRequestType=function(_){if(_){var e=_.toUpperCase();if(e==tsip_request_type_e.ACK.s_name)return tsip_request_type_e.ACK;if(e==tsip_request_type_e.BYE.s_name)return tsip_request_type_e.BYE;if(e==tsip_request_type_e.CANCEL.s_name)return tsip_request_type_e.CANCEL;if(e==tsip_request_type_e.INVITE.s_name)return tsip_request_type_e.INVITE;if(e==tsip_request_type_e.OPTIONS.s_name)return tsip_request_type_e.OPTIONS;if(e==tsip_request_type_e.REGISTER.s_name)return tsip_request_type_e.REGISTER;if(e==tsip_request_type_e.SUBSCRIBE.s_name)return tsip_request_type_e.SUBSCRIBE;if(e==tsip_request_type_e.NOTIFY.s_name)return tsip_request_type_e.NOTIFY;if(e==tsip_request_type_e.REFER.s_name)return tsip_request_type_e.REFER;if(e==tsip_request_type_e.INFO.s_name)return tsip_request_type_e.INFO;if(e==tsip_request_type_e.UPDATE.s_name)return tsip_request_type_e.UPDATE;if(e==tsip_request_type_e.MESSAGE.s_name)return tsip_request_type_e.MESSAGE;if(e==tsip_request_type_e.PUBLISH.s_name)return tsip_request_type_e.PUBLISH;if(e==tsip_request_type_e.PRACK.s_name)return tsip_request_type_e.PRACK}return tsip_request_type_e.NONE},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/parsers/tsip_parser_message.js"),_tsip_machine_parser_message_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,2,0,5,2,6,0],_tsip_machine_parser_message_key_offsets=[0,0,16,31,35,47,50,52,55,57,59,61,62,64,67,69,72,73,88,89,106,109,114,117,121,142,146,147,149,166,183,197,199,202,204,207,209,211,213,214,230,246,252,258,260,281,284,288],_tsip_machine_parser_message_trans_keys=[33,37,39,83,115,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,65,90,97,122,9,32,43,58,45,46,48,57,65,90,97,122,9,32,58,0,65535,32,0,65535,83,115,73,105,80,112,47,48,57,46,48,57,48,57,13,48,57,10,13,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,13,0,65535,13,33,37,39,44,47,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,10,13,0,65535,10,9,32,32,33,37,39,73,105,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,80,112,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,47,126,42,43,45,57,65,90,95,122,48,57,46,48,57,48,57,32,48,57,48,57,48,57,48,57,32,9,13,37,61,95,126,32,33,36,59,63,90,97,122,128,255,9,13,37,61,95,126,32,33,36,59,63,90,97,122,128,255,48,57,65,70,97,102,48,57,65,70,97,102,0,65535,13,33,37,39,44,47,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,13,0,65535,10,13,0,65535,10,13,0,65535,0],_tsip_machine_parser_message_single_lengths=[0,6,5,0,4,3,0,1,2,2,2,1,0,1,0,1,1,5,1,7,3,3,1,2,7,2,1,2,7,7,6,0,1,0,1,0,0,0,1,6,6,0,0,0,7,1,2,2],_tsip_machine_parser_message_range_lengths=[0,5,5,2,4,0,1,1,0,0,0,0,1,1,1,1,0,5,0,5,0,1,1,1,7,1,0,0,5,5,4,1,1,1,1,1,1,1,0,5,5,3,3,1,7,1,1,1],_tsip_machine_parser_message_index_offsets=[0,0,12,23,26,35,39,41,44,47,50,53,55,57,60,62,65,67,78,80,93,97,102,105,109,124,128,130,133,146,159,170,172,175,177,180,182,184,186,188,200,212,216,220,222,237,240,244],_tsip_machine_parser_message_indicies=[0,0,0,2,2,0,0,0,0,0,0,1,3,4,4,4,4,4,4,4,4,4,1,5,5,1,6,6,7,8,7,7,7,7,1,6,6,8,1,9,1,10,9,1,11,11,1,12,12,1,13,13,1,14,1,15,1,16,15,1,17,1,18,17,1,19,1,20,21,21,21,21,21,21,21,21,21,1,22,1,23,23,24,24,24,25,24,24,24,24,24,24,1,23,23,25,1,25,27,25,26,1,28,26,1,29,28,26,1,30,31,31,31,26,26,31,26,31,26,31,26,31,26,1,32,28,26,1,33,1,26,26,1,3,4,4,4,34,34,4,4,4,4,4,4,1,3,4,4,4,35,35,4,4,4,4,4,4,1,3,4,4,4,36,4,4,4,4,4,1,37,1,38,37,1,39,1,40,39,1,41,1,42,1,43,1,44,1,45,46,47,45,45,45,45,45,45,45,45,1,48,49,50,48,48,48,48,48,48,48,48,1,51,51,51,1,48,48,48,1,52,1,54,55,55,55,53,53,55,53,55,53,55,53,55,53,1,56,53,1,57,56,53,1,32,56,53,1,0],_tsip_machine_parser_message_trans_targs=[2,0,28,3,2,4,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,43,20,19,21,22,26,23,24,25,22,44,27,29,30,31,32,33,34,35,36,37,38,39,40,16,41,40,16,41,42,43,45,47,45,46,44],_tsip_machine_parser_message_trans_actions=[1,0,1,3,0,1,0,0,0,0,5,1,0,0,0,0,0,0,7,0,0,1,15,0,0,0,0,0,0,0,13,20,15,0,0,0,0,0,0,0,7,1,0,0,9,1,17,1,0,11,0,0,0,0,13,20,0,0],tsip_machine_parser_message_start=1,tsip_machine_parser_message_first_final=43,tsip_machine_parser_message_error=0,tsip_machine_parser_message_en_main=1,tsip_message.prototype.Parse=function(_,e){var t=null;return _&&_.o_data?(t=new tsip_message(tsip_message_type_e.UNKNOWN),tsip_message_parser_init(_),tsip_message_parser_execute(_,t,e),_.i_cs<43?(tsk_utils_log_error("Failed to parse message: "+_.s_data),null):t):null},tsip_session.prototype.__i_expires_default=18e5,tsip_session.prototype.__i_session_id=0,tsip_session.prototype.__i_session_id_invalid=-1,tsip_session.prototype.on_event=null;var tsip_session_param_type_e={HEADER:0,CAPS:1,USR_DATA:2,TO_STR:3,from_STR:3,TO_URI:4,FROM_URI:5,NO_CONTACT:6,EXPIRES:7,SILENT_HANGUP:8,SIGCOMP_ID:9,PARENT_ID:10,BANDWIDTH:20,VIDEO_SIZE:21,AUDIO_CONSTRAINTS:22,INITIAL_MSG:50,MEDIA:100};tsip_session.prototype.get_id=function(){return this.i_id},tsip_session.prototype.set=function(){return this.__set(arguments)},tsip_session.prototype.get_stack=function(){return this.o_stack},tsip_session.prototype.is_connected=function(){var _;return(_=this.o_stack.o_layer_dialog.find_by_ss(this))?_.e_state==tsip_dialog_state_e.ESTABLISHED:!1},tsip_session.prototype.__set=function(_){for(var e,t=0;t<_.length;++t)if(e=_[t])switch(e.e_type){case tsip_session_param_type_e.HEADER:this.ao_headers.push(new tsip_header_Dummy(e.ao_values[0],e.ao_values[1]));break;case tsip_session_param_type_e.CAPS:this.ao_caps.push(tsk_param_create(e.ao_values[0],e.ao_values[1]));break;case tsip_session_param_type_e.USR_DATA:this.o_usr_data=e.ao_values[0];break;case tsip_session_param_type_e.TO_STR:this.o_uri_to=tsip_uri_make_valid(e.ao_values[0],this.o_stack.network.o_uri_realm.s_host);break;case tsip_session_param_type_e.FROM_STR:this.o_uri_from=tsip_uri_make_valid(e.ao_values[0],this.o_stack.network.o_uri_realm.s_host);break;case tsip_session_param_type_e.TO_URI:!e.ao_values[0]||e.ao_values[0]instanceof tsip_uri?this.o_uri_to=e.ao_values[0]:tsk_utils_log_error("Not a valid uri object");break;case tsip_session_param_type_e.FROM_URI:!e.ao_values[0]||e.ao_values[0]instanceof tsip_uri?this.o_uri_from=e.ao_values[0]:tsk_utils_log_error("Not a valid uri object");break;case tsip_session_param_type_e.NO_CONTACT:this.b_no_contact=e.ao_values[0];break;case tsip_session_param_type_e.EXPIRES:this.i_expires=1e3*e.ao_values[0];break;case tsip_session_param_type_e.SILENT_HANGUP:break;case tsip_session_param_type_e.SIGCOMP_ID:break;case tsip_session_param_type_e.PARENT_ID:break;case tsip_session_param_type_e.BANDWIDTH:this.media.o_bandwidth=e.ao_values[0];break;case tsip_session_param_type_e.VIDEO_SIZE:this.media.o_video_size=e.ao_values[0];break;case tsip_session_param_type_e.AUDIO_CONSTRAINTS:this.media.o_audio_constraints=e.ao_values[0];break;case tsip_session_param_type_e.INITIAL_MSG:var s;(s=e.ao_values[0])&&(s.o_hdr_From&&s.o_hdr_From.o_uri&&(this.o_uri_from=s.o_hdr_From.o_uri.clone(!1,!1)),s.o_hdr_To&&s.o_hdr_To.o_uri&&(this.o_uri_to=s.o_hdr_To.o_uri.clone(!1,!1)),this.b_server=!0)}},tsip_session.prototype.SetHeader=function(_,e){return tsip_session.prototype.SetAny(tsip_session_param_type_e.HEADER,_,e)},tsip_session.prototype.SetExpires=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.EXPIRES,_)},tsip_session.prototype.SetUsrData=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.USR_DATA,_)},tsip_session.prototype.SetCaps=function(_,e){return tsip_session.prototype.SetAny(tsip_session_param_type_e.CAPS,_,e)},tsip_session.prototype.SetToStr=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.TO_STR,_)},tsip_session.prototype.SetToUri=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.TO_URI,_)},tsip_session.prototype.SetFromStr=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.FROM_STR,_)},tsip_session.prototype.SetInitialMessage=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.INITIAL_MSG,_)},tsip_session.prototype.SetBandwidth=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.BANDWIDTH,_)},tsip_session.prototype.SetVideoSize=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.VIDEO_SIZE,_)},tsip_session.prototype.SetAudioConstraints=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.AUDIO_CONSTRAINTS,_)},tsip_session.prototype.SetInitialMessage=function(_){return tsip_session.prototype.SetAny(tsip_session_param_type_e.INITIAL_MSG,_)},tsip_session.prototype.SetAny=function(_){var e=new Object;return e.e_type=_,e.ao_values=Array.prototype.slice.call(arguments,1),e},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/api/tsip_api_common.js","src/tinySIP/src/api/tsip_api_info.js","src/tinySIP/src/api/tsip_api_invite.js","src/tinySIP/src/api/tsip_api_message.js","src/tinySIP/src/api/tsip_api_options.js","src/tinySIP/src/api/tsip_api_publish.js","src/tinySIP/src/api/tsip_api_register.js","src/tinySIP/src/api/tsip_api_subscribe.js"),tsip_session.prototype.__action_handle=function(_){var e=-1;if(this.o_stack&&_){var t;if(t=this.o_stack.o_layer_dialog.find_by_ss(this))switch(_.e_type){case tsip_action_type_e.HANGUP:e=t.hangup(_);break;default:e=t.fsm_act(_.e_type,null,_)}else tsk_utils_log_error("Failed to find dialog with this opid ["+this.i_id+"]")}else tsk_utils_log_error("Invalid argument");return e},tsip_session.prototype.__action_any=function(_){if(!this.o_stack)return tsk_utils_log_error("Invalid stack"),-1;if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var e=new tsip_action(_);return this.__action_handle(e)},tsip_session.prototype.reject=function(){return this.__action_any(tsip_action_type_e.REJECT)},tsip_session.prototype.hangup=function(){return this.__action_any(tsip_action_type_e.HANGUP)},tsip_session.prototype.accept=function(){return this.__action_any(tsip_action_type_e.ACCEPT)},tsip_session.prototype.cancel=function(){return this.__action_any(tsip_action_type_e.CANCEL)},tsip_event_info.prototype=Object.create(tsip_event.prototype);var tsip_event_info_type_e={I_INFO:0,AO_INFO:1};tsip_session_invite.prototype=Object.create(tsip_session.prototype),tsip_event_invite.prototype=Object.create(tsip_event.prototype),tsip_session_invite.prototype.o_stream_local=null,tsip_session_invite.prototype.o_stream_remote=null;var tsip_event_invite_type_e={I_NEW_CALL:0,I_REQUEST:100,I_AO_REQUEST:101,O_ECT_TRYING:200,O_ECT_ACCEPTED:201,O_ECT_COMPLETED:202,O_ECT_FAILED:203,O_ECT_NOTIFY:204,I_ECT_REQUESTED:205,I_ECT_NEW_CALL:206,I_ECT_COMPLETED:207,I_ECT_FAILED:208,I_ECT_NOTIFY:209,M_EARLY_MEDIA:300,M_UPDATING:301,M_UPDATED:302,M_STREAM_CONNECTING:303,M_STREAM_CONNECTED:304,M_STREAM_LOCAL_REQUESTED:305,M_STREAM_LOCAL_ACCEPTED:306,M_STREAM_LOCAL_REFUSED:307,M_STREAM_LOCAL_ADDED:308,M_STREAM_LOCAL_REMOVED:309,M_STREAM_REMOTE_ADDED:310,M_STREAM_REMOTE_REMOVED:311,M_LOCAL_HOLD_OK:400,M_LOCAL_HOLD_NOK:401,M_LOCAL_RESUME_OK:402,M_LOCAL_RESUME_NOK:403,M_REMOTE_HOLD:404,M_REMOTE_RESUME:405};tsip_session_invite.prototype.get_url_local=function(){return this.o_url_local},tsip_session_invite.prototype.get_stream_local=function(){return this.o_stream_local},tsip_session_invite.prototype.get_url_remote=function(){return this.o_url_remote},tsip_session_invite.prototype.get_stream_remote=function(){return this.o_stream_remote},tsip_session_invite.prototype.__set_stream_local=function(_){this.o_url_local&&window.nativeURL.revokeObjectURL(this.o_url_local),this.o_stream_local=_,this.o_url_local=_?window.nativeURL.createObjectURL(_):void 0},tsip_session_invite.prototype.__set_stream_remote=function(_){this.o_url_remote&&window.nativeURL.revokeObjectURL(this.o_url_remote),this.o_stream_remote=_,this.o_url_remote=this.o_stream_remote?window.nativeURL.createObjectURL(this.o_stream_remote):void 0},tsip_session_invite.prototype.call=function(_){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var e=-1,t=new tsip_action(tsip_action_type_e.INVITE);if(t){var s=!1;t.media.e_type=_;var i=this.o_stack.o_layer_dialog.find_by_ss(this);i||(s=!0,i=this.o_stack.o_layer_dialog.dialog_new(tsip_dialog_type_e.INVITE,this)),0==(e=i.fsm_act(t.e_type,null,t))&&s&&(this.media.e_type=_)}return e},tsip_session_invite.prototype.hold=function(_){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var e=-1,t=new tsip_action(tsip_action_type_e.HOLD);return t&&(t.media.e_type=_,e=this.__action_handle(t)),e},tsip_session_invite.prototype.resume=function(_){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var e=-1,t=new tsip_action(tsip_action_type_e.RESUME);return t&&(t.media.e_type=_,e=this.__action_handle(t)),e},tsip_session_invite.prototype.info=function(_,e){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var t=-1,s=new tsip_action(tsip_action_type_e.INFO);return s&&(e&&s.add_headers(new tsip_header_Content_Type(e)),s.set_content(_),t=this.__action_handle(s)),t},tsip_session_invite.prototype.dtmf=function(_){return _?this.info(tsk_string_format("Signal={0}\r\nDuration={1}",_,120),"application/dtmf-relay"):(tsk_utils_log_error("Invalid parameter"),-1)},tsip_session_invite.prototype.transfer=function(_){if(!_)return tsk_utils_log_error("Invalid parameter"),-1;if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var e=tsip_uri_make_valid(_,this.o_stack.network.o_uri_realm.s_host);if(!e)return tsk_utils_log_error("%s is not a valid SIP Uri",_),-3;var t=-1,s=new tsip_action(tsip_action_type_e.ECT);return s&&(s.ect.s_to=tsip_uri_tostring(e,!1,!1),t=this.__action_handle(s)),t},tsip_session_invite.prototype.transfer_accept=function(){return this.__action_any(tsip_action_type_e.ECT_ACCEPT)},tsip_session_invite.prototype.transfer_reject=function(){return this.__action_any(tsip_action_type_e.ECT_REJECT)},tsip_session_message.prototype=Object.create(tsip_session.prototype);var tsip_event_message_type_e={I_MESSAGE:0,AO_MESSAGE:1};tsip_session_message.prototype.send=function(_,e){if(!_)return tsk_utils_log_error("Invalid argument"),-1;if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var t=-1,s=new tsip_action(tsip_action_type_e.MESSAGE);if(s){var i=this.o_stack.o_layer_dialog.dialog_new(tsip_dialog_type_e.MESSAGE,this);i&&(s.set_content(_),e&&s.add_headers(new tsip_header_Content_Type(e)),0==(t=i.fsm_act(s.e_type,null,s)))}return t};var tsip_event_options_type_e={I_OPTIONS:0,AO_OPTIONS:1};tsip_session_publish.prototype=Object.create(tsip_session.prototype),tsip_event_publish.prototype=Object.create(tsip_event.prototype);var tsip_event_publish_type_e={I_PUBLISH:0,AO_PUBLISH:1,I_UNPUBLISH:10,AO_UNPUBLISH:11};tsip_session_publish.prototype.publish=function(_,e){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var t=-1,s=new tsip_action(tsip_action_type_e.PUBLISH);if(s){var i=this.o_stack.o_layer_dialog.find_by_ss(this);i||(i=this.o_stack.o_layer_dialog.dialog_new(tsip_dialog_type_e.PUBLISH,this)),s.set_content(_),e&&s.add_headers(new tsip_header_Content_Type(e)),t=i.fsm_act(s.e_type,null,s)}return t},tsip_session_publish.prototype.unpublish=function(){return this.__action_any(tsip_action_type_e.UNPUBLISH)},tsip_session_register.prototype=Object.create(tsip_session.prototype),tsip_event_register.prototype=Object.create(tsip_event.prototype);var tsip_event_register_type_e={I_NEW_REGISTER:0,I_REGISTER:10,AO_REGISTER:11,I_UNREGISTER:20,AO_UNREGISTER:21};tsip_session_register.prototype.register=function(){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var _=-1,e=new tsip_action(tsip_action_type_e.REGISTER);if(e){var t=this.o_stack.o_layer_dialog.find_by_ss(this);t||(t=this.o_stack.o_layer_dialog.dialog_new(tsip_dialog_type_e.REGISTER,this)),_=t.fsm_act(e.e_type,null,e)}return _},tsip_session_register.prototype.unregister=function(){return this.__action_any(tsip_action_type_e.UNREGISTER)},tsip_session_subscribe.prototype=Object.create(tsip_session.prototype),tsip_event_subscribe.prototype=Object.create(tsip_event.prototype);var tsip_event_subscribe_type_e={I_SUBSCRIBE:0,AO_SUBSCRIBE:1,I_UNSUBSRIBE:10,AO_UNSUBSCRIBE:11,I_NOTIFY:20,AO_NOTIFY:21};tsip_session_subscribe.prototype.subscribe=function(){if(this.o_stack.e_state!=tsip_transport_state_e.STARTED)return tsk_utils_log_error("Stack not started"),-2;var _=-1,e=new tsip_action(tsip_action_type_e.SUBSCRIBE);if(e){var t=this.o_stack.o_layer_dialog.find_by_ss(this);t||(t=this.o_stack.o_layer_dialog.dialog_new(tsip_dialog_type_e.SUBSCRIBE,this)),_=t.fsm_act(e.e_type,null,e)}return _},tsip_session_subscribe.prototype.unsubscribe=function(){return this.__action_any(tsip_action_type_e.UNSUBSCRIBE)},tsip_stack.prototype.on_event_stack=null,tsip_stack.prototype.on_event_dialog=null,tsip_stack.prototype.on_event_invite=null,tsip_stack.prototype.on_event_message=null,tsip_stack.prototype.on_event_publish=null,tsip_stack.prototype.on_event_subscribe=null;var tsip_stack_param_type_e={DISPLAY_NAME:0,IMPU:1,PREFERRED_ID:2,IMPI:3,PASSWORD:4,DIGEST:5,SIGCOMP:10,SIGCOMP_ADD_COMPARTMENT:11,SIGCOMP_REMOVE_COMPARTMENT:12,REALM:20,LOCAL_IP:21,LOCAL_PORT:22,AOR:23,DISCOVERY_NAPTR:24,DISCOVERY_DHCP:25,PROXY_CSCF:26,DNSSERVER:27,MODE_SERVER:28,PROXY_OUTBOUND:30,WEBSOCKET_SERVER_URL:31,ICE_SERVERS:32,ENABLE_RTCWEB_BREAKER:33,ENABLE_CLICK2CALL:34,ENABLE_SECURE_TRANSPORT:35,EARLY_IMS:40,SECAGREE_IPSEC:41,SECAGREE_TLS:42,AMF:43,OPERATOR_ID:44,TLS_CERTS:45,IPSEC_PARAMS:46,HEADER:50,STUN_SERVER:60,STUN_CRED:61,CACHE_MEDIA_STREAM:70,BANDWIDTH:71,VIDEO_SIZE:72,AUDIO_CONSTRAINTS:73,USERDATA:80},tsip_transport_state_e={NONE:-1,STARTING:0,STARTED:1,STOPPING:3,STOPPED:4};tsip_stack.prototype.start=function(){return this.e_state==tsip_transport_state_e.STARTED?(tsk_utils_log_warn("Already started"),0):(this.e_state==tsip_transport_state_e.STARTING&&this.stop(),this.network.s_proxy_cscf_host?(tsk_utils_log_info("SIP stack start: proxy='"+this.network.s_proxy_cscf_host+":"+this.network.i_proxy_cscf_port+"', realm='"+this.network.o_uri_realm+"', impi='"+this.identity.s_impi+"', impu='"+this.identity.o_uri_impu+"'"),this.network.o_transport=this.o_layer_transport.transport_new(this.network.e_proxy_cscf_type,this.network.s_proxy_cscf_host,this.network.i_proxy_cscf_port,"SIP Transport",__tsip_stack_transport_callback),this.network.o_transport?(this.e_state=tsip_transport_state_e.STARTING,this.signal(tsip_event_code_e.STACK_STARTING,"Stack starting"),this.network.o_transport.start()):(tsk_utils_log_error("Failed to create transport with type= "+this.network.e_proxy_cscf_type),-2)):(tsk_utils_log_error("'"+this.network.s_proxy_cscf_host+"' not valid as proxy host"),-2))},tsip_stack.prototype.stop=function(_){var e=this;return setTimeout(function(){switch(e.e_state){case tsip_transport_state_e.STOPPED:case tsip_transport_state_e.STOPPING:case tsip_transport_state_e.NONE:return 0}"undefined"==typeof _&&(_=tsip_dialog.prototype.__i_timer_shutdown);for(var t,s=0,i=!1,r=!1,a=(_<<1)/3,n=n=new Date,o=0;o<e.o_layer_dialog.ao_dialogs.length;++o)e.o_layer_dialog.ao_dialogs[o].e_type!=tsip_dialog_type_e.REGISTER?0==(t=e.o_layer_dialog.ao_dialogs[o].shutdown())&&(i=!0):++s;
var p=function(){if(i)do{if(e.o_layer_dialog.ao_dialogs.length<=s)return void setTimeout(c,1);if(new Date-n>=a)return void setTimeout(c,1)}while(!1);setTimeout(p,1)},c=function(){if(!r){if(s>0){s=0;for(var i=0;i<e.o_layer_dialog.ao_dialogs.length;++i)e.o_layer_dialog.ao_dialogs[i].e_type==tsip_dialog_type_e.REGISTER&&0==(t=e.o_layer_dialog.ao_dialogs[i].shutdown())&&++s}r=!0}do if(0==e.o_layer_dialog.ao_dialogs.length||new Date-n>=_)return void setTimeout(d,1);while(!1);setTimeout(c,1)},d=function(){e.o_layer_transport&&e.o_layer_transport.stop(),e.signal(tsip_event_code_e.STACK_STOPPED,"Stack stopped")};i?p():s?c():d()},1),0},tsip_stack.prototype.set=function(){return this.__set(arguments)},tsip_stack.prototype.SetDisplayName=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.DISPLAY_NAME,_)},tsip_stack.prototype.SetPassword=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.PASSWORD,_)},tsip_stack.prototype.SetDigest=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.DIGEST,_)},tsip_stack.prototype.SetProxyCSCF=function(_,e,t){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.PROXY_CSCF,_,e,t)},tsip_stack.prototype.SetProxyOutBound=function(_,e,t){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.PROXY_OUTBOUND,_,e,t)},tsip_stack.prototype.SetProxyOutBoundUrl=function(_){if(!_)return tsip_stack.prototype.SetProxyOutBound(null,5060,tsip_transport_type_e.UDP);var e=tsk_string_parse_url(_);if(!e||e.length<3)return tsk_utils_log_error(_+" not valid as outbound proxy url"),null;var t;switch(e[0]){case"udp":default:t=tsip_transport_type_e.UDP;break;case"tcp":t=tsip_transport_type_e.TCP;break;case"tls":t=tsip_transport_type_e.TLS;break;case"dtls":t=tsip_transport_type_e.DTLS;break;case"sctp":t=tsip_transport_type_e.SCTP;break;case"ws":t=tsip_transport_type_e.WS;break;case"wss":t=tsip_transport_type_e.WSS}return tsip_stack.prototype.SetProxyOutBound(e[1],e[2],t)},tsip_stack.prototype.SetWebsocketServerUrl=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.WEBSOCKET_SERVER_URL,_)},tsip_stack.prototype.SetIceServers=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.ICE_SERVERS,_)},tsip_stack.prototype.SetMediaStreamCacheEnabled=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.CACHE_MEDIA_STREAM,_)},tsip_stack.prototype.SetBandwidth=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.BANDWIDTH,_)},tsip_stack.prototype.SetVideoSize=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.VIDEO_SIZE,_)},tsip_stack.prototype.SetAudioConstraints=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.AUDIO_CONSTRAINTS,_)},tsip_stack.prototype.SetRTCWebBreakerEnabled=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.ENABLE_RTCWEB_BREAKER,_)},tsip_stack.prototype.SetClick2CallEnabled=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.ENABLE_CLICK2CALL,_)},tsip_stack.prototype.SetSecureTransportEnabled=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.ENABLE_SECURE_TRANSPORT,_)},tsip_stack.prototype.SetEarlyIMSEnabled=function(_){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.EARLY_IMS,_)},tsip_stack.prototype.SetHeader=function(_,e){return tsip_stack.prototype.SetAny(tsip_stack_param_type_e.HEADER,_,e)},tsip_stack.prototype.__set=function(ao_params){for(var o_curr,i=0;i<ao_params.length;++i)if(o_curr=ao_params[i])switch(o_curr.e_type){case tsip_stack_param_type_e.DISPLAY_NAME:this.identity.s_display_name=o_curr.ao_values[0],this.identity.o_uri_impu&&(this.identity.o_uri_impu.s_display_name=this.identity.s_display_name);break;case tsip_stack_param_type_e.PASSWORD:this.identity.s_password=o_curr.ao_values[0];break;case tsip_stack_param_type_e.DIGEST:this.identity.s_digest=o_curr.ao_values[0];break;case tsip_stack_param_type_e.PROXY_CSCF:this.network.s_proxy_cscf_host=o_curr.ao_values[0],this.network.i_proxy_cscf_port=o_curr.ao_values[1],this.network.e_proxy_cscf_type=o_curr.ao_values[2];break;case tsip_stack_param_type_e.PROXY_OUTBOUND:this.network.s_proxy_outbound_host=o_curr.ao_values[0],this.network.i_proxy_outbound_port=o_curr.ao_values[1],this.network.e_proxy_outbound_type=o_curr.ao_values[2];break;case tsip_stack_param_type_e.WEBSOCKET_SERVER_URL:this.network.s_websocket_server_url=o_curr.ao_values[0],this.network.s_websocket_server_url&&(0==this.network.s_websocket_server_url.indexOf("wss://")?this.network.e_proxy_cscf_type=tsip_transport_type_e.WSS:0==this.network.s_websocket_server_url.indexOf("ws://")&&(this.network.e_proxy_cscf_type=tsip_transport_type_e.WS));break;case tsip_stack_param_type_e.ICE_SERVERS:if(!tsk_string_is_null_or_empty(o_curr.ao_values[0]))try{o_curr.ao_values[0]instanceof String||"string"==typeof o_curr.ao_values[0]?eval("this.network.ao_ice_servers = "+o_curr.ao_values[0]+";"):o_curr.ao_values[0]instanceof Array||"array"==typeof o_curr.ao_values[0]?this.network.ao_ice_servers=o_curr.ao_values[0]:tsk_utils_log_warn(o_curr.ao_values[0]+" not valid as ICE servers")}catch(e){tsk_utils_log_error("Failed to set ICE servers:"+e)}break;case tsip_stack_param_type_e.ENABLE_RTCWEB_BREAKER:this.network.b_rtcweb_enabled=!!o_curr.ao_values[0];break;case tsip_stack_param_type_e.ENABLE_CLICK2CALL:this.network.b_click2call_enabled=!!o_curr.ao_values[0];break;case tsip_stack_param_type_e.ENABLE_SECURE_TRANSPORT:o_curr.ao_values[0]&&this.network.e_proxy_cscf_type==tsip_transport_type_e.WS&&(this.network.e_proxy_cscf_type=tsip_transport_type_e.WSS);break;case tsip_stack_param_type_e.EARLY_IMS:this.security.b_earlyIMS=!!o_curr.ao_values[0];break;case tsip_stack_param_type_e.CACHE_MEDIA_STREAM:this.media.b_cache_stream=!!o_curr.ao_values[0];break;case tsip_stack_param_type_e.BANDWIDTH:this.media.o_bandwidth=o_curr.ao_values[0];break;case tsip_stack_param_type_e.VIDEO_SIZE:this.media.o_video_size=o_curr.ao_values[0];break;case tsip_stack_param_type_e.AUDIO_CONSTRAINTS:this.media.o_audio_constraints=o_curr.ao_values[0];break;case tsip_stack_param_type_e.HEADER:if(o_curr.ao_values[1])this.ao_headers.push(new tsip_header_Dummy(o_curr.ao_values[0],o_curr.ao_values[1]));else{var i_index=tsip_header.prototype.IndexOfByName(this.ao_headers,o_curr.ao_values[0]);-1!=i_index&&this.ao_headers.splice(i_index,1)}}return 0},tsip_stack.prototype.__get_contact_uri=function(_){for(var e=0;e<this.o_layer_transport.ao_transports.length;++e){var t=this.o_layer_transport.ao_transports[e].get_uri(!1);if(t)return t.s_user_name=this.identity.o_uri_impu.s_user_name,t}return null},tsip_stack.prototype.__get_proxy_outbound_uri_string=function(){if(this.network.s_proxy_outbound_host){var _;switch(this.network.e_proxy_outbound_type){case tsip_transport_type_e.TCP:_="tcp";break;case tsip_transport_type_e.TLS:_="tls";break;case tsip_transport_type_e.SCTP:_="sctp";break;case tsip_transport_type_e.DTLS:_="dtls";break;case tsip_transport_type_e.WS:_="ws";break;case tsip_transport_type_e.WSS:_="wss";break;case tsip_transport_type_e.UDP:default:_="udp"}return tsk_string_format("<sip:{0}:{1};lr;sipml5-outbound;transport={2}>",this.network.s_proxy_outbound_host,this.network.i_proxy_outbound_port,_)}return null},tsip_stack.prototype.SetAny=function(_){var e=new Object;return e.e_type=_,e.ao_values=Array.prototype.slice.call(arguments,1),e},tsip_stack.prototype.signal=function(_,e){if(this.on_event_stack){var t=this.on_event_stack,s=new tsip_event(null,_,e,null,tsip_event_type_e.STACK);s.o_stack=this,setTimeout(function(){t(s)},1)}return 0},tsip_timers.prototype.TIMER_T1=500,tsip_timers.prototype.TIMER_T4=5e3;var tsip_timers_e={T1:tsip_timers.prototype.TIMER_T1,T2:4e3,T4:tsip_timers.prototype.TIMER_T4,A:tsip_timers.prototype.TIMER_T1,B:64*tsip_timers.prototype.TIMER_T1,C:3e5,D:5e4,E:tsip_timers.prototype.TIMER_T1,F:64*tsip_timers.prototype.TIMER_T1,G:tsip_timers.prototype.TIMER_T1,H:64*tsip_timers.prototype.TIMER_T1,I:tsip_timers.prototype.TIMER_T4,J:64*tsip_timers.prototype.TIMER_T1,K:tsip_timers.prototype.TIMER_T4,L:64*tsip_timers.prototype.TIMER_T1,M:64*tsip_timers.prototype.TIMER_T1};tsip_timers.prototype.getA=function(){return this.A},tsip_timers.prototype.getB=function(){return this.B},tsip_timers.prototype.getC=function(){return this.C},tsip_timers.prototype.getD=function(){return this.D},tsip_timers.prototype.getE=function(){return this.E},tsip_timers.prototype.getF=function(){return this.F},tsip_timers.prototype.getG=function(){return this.G},tsip_timers.prototype.getH=function(){return this.H},tsip_timers.prototype.getI=function(){return this.I},tsip_timers.prototype.getJ=function(){return this.J},tsip_timers.prototype.getK=function(){return this.K},tsip_timers.prototype.getL=function(){return this.L},tsip_timers.prototype.getM=function(){return this.M},tsip_timers.prototype.getT1=function(){return this.T1},tsip_timers.prototype.getT2=function(){return this.T2},tsip_timers.prototype.getT4=function(){return this.T4},tsip_timers.prototype.setT1=function(_){this.T1=_,this.A=this.E=this.G=this.T1,this.B=this.F=this.H=this.J=64*this.T1},tsip_timers.prototype.setT2=function(_){this.T2=_},tsip_timers.prototype.setT4=function(_){this.T4=_,this.I=this.K=this.T4},tsip_timers.prototype.setA=function(_){this.A=_},tsip_timers.prototype.setB=function(_){this&&(this.B=_)},tsip_timers.prototype.setC=function(_){this.C=_},tsip_timers.prototype.setD=function(_){this.D=_},tsip_timers.prototype.setE=function(_){this.E=_},tsip_timers.prototype.setF=function(_){this.F=_},tsip_timers.prototype.setG=function(_){this.G=_},tsip_timers.prototype.setI=function(_){this.I=_},tsip_timers.prototype.setJ=function(_){this.J=_},tsip_timers.prototype.setK=function(_){this.K=_},tsip_timers.prototype.setL=function(_){this.L=_},tsip_timers.prototype.setM=function(_){this.M=_};var tsip_uri_type_e={unknown:{i_id:0,s_scheme:"unknown"},sip:{i_id:1,s_scheme:"sip"},sips:{i_id:2,s_scheme:"sips"},tel:{i_id:3,s_scheme:"tel"}},tsip_host_type_e={unknown:{i_id:0,s_name:"unknown"},hostname:{i_id:1,s_name:"hostname"},ipv4:{i_id:2,s_name:"ipv4"},ipv6:{i_id:3,s_name:"ipv6"}};tsip_uri.prototype.tostring=function(_,e){return tsip_uri_tostring(this,_,e)},tsip_uri.prototype.compare=function(_){tsip_uri_compare(this,_)},tsip_uri.prototype.clone=function(_,e){var t=tsip_uri_tostring(this,_,e);return t?tsip_uri.prototype.Parse(t):null},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/parsers/tsip_parser_uri.js"),_tsip_machine_parser_uri_actions=[0,1,0,1,5,1,7,1,9,1,11,1,12,1,13,1,14,1,17,1,18,1,20,1,21,1,22,1,23,2,1,15,2,2,15,2,4,6,2,7,10,2,7,16,2,8,10,2,9,16,2,9,19,2,13,0,2,13,6,3,0,8,10,3,13,0,6,3,13,3,0],_tsip_machine_parser_uri_key_offsets=[0,0,7,15,22,28,34,40,53,66,72,78,80,93,99,105,118,124,130,143,156,162,168,182,196,202,208,229,231,247,262,278,292,300,306,320,336,350,366,380,388,396,404,420,436,452,468,484,500,506,508,525,540,554,568,582,592,602,613,613,622,622,632,642,651,654,669,683,698,714,730,746,750,765,782,788,795,801,808,814,821,828,831,838,841,848,851,868,885,901,917,933,949,953,967,984,1001,1018,1024,1031,1038,1041,1044],_tsip_machine_parser_uri_trans_keys=[45,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,48,57,65,90,97,122,48,57,65,90,97,122,48,57,65,70,97,102,48,57,65,70,97,102,33,37,93,95,126,36,43,45,58,65,91,97,122,33,37,93,95,126,36,43,45,58,65,91,97,122,48,57,65,70,97,102,48,57,65,70,97,102,0,65535,33,37,93,95,126,36,43,45,58,65,91,97,122,48,57,65,70,97,102,48,57,65,70,97,102,33,37,93,95,126,36,43,45,58,65,91,97,122,48,57,65,70,97,102,48,57,65,70,97,102,33,37,59,61,63,95,126,35,57,65,90,97,122,33,37,58,61,64,95,126,35,59,63,90,97,122,48,57,65,70,97,102,48,57,65,70,97,102,33,37,61,64,95,126,36,46,48,57,65,90,97,122,33,37,61,64,95,126,36,46,48,57,65,90,97,122,48,57,65,70,97,102,48,57,65,70,97,102,58,59,83,84,91,115,116,0,47,48,57,60,64,65,90,92,96,97,122,123,65535,0,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,48,57,65,90,97,122,48,57,65,90,97,122,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,45,46,0,47,48,57,58,64,65,90,91,96,97,122,123,65535,0,47,48,57,58,65535,48,57,33,37,44,92,94,96,126,0,35,36,58,59,64,65,122,123,65535,33,37,59,61,93,95,126,36,43,45,58,65,91,97,122,33,37,59,93,95,126,36,43,45,58,65,91,97,122,0,47,48,57,58,64,65,70,71,96,97,102,103,65535,0,47,48,57,58,64,65,70,71,96,97,102,103,65535,45,46,73,105,48,57,65,90,97,122,45,46,80,112,48,57,65,90,97,122,45,46,58,83,115,48,57,65,90,97,122,45,46,58,48,57,65,90,97,122,45,46,69,101,48,57,65,90,97,122,45,46,76,108,48,57,65,90,97,122,45,46,58,48,57,65,90,97,122,59,0,65535,33,37,59,61,93,95,126,36,43,45,58,65,91,97,122,33,37,59,93,95,126,36,43,45,58,65,91,97,122,58,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,65535,58,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,0,47,48,57,58,65535,46,0,47,48,57,58,65535,0,47,48,57,58,65535,46,0,47,48,57,58,65535,0,47,48,57,58,65535,93,0,47,48,57,58,65535,93,0,47,48,57,58,65535,93,0,65535,46,0,47,48,57,58,65535,46,0,65535,46,0,47,48,57,58,65535,46,0,65535,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,58,93,0,65535,0,47,48,57,58,64,65,70,71,96,97,102,103,65535,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,0,47,48,57,58,65535,46,0,47,48,57,58,65535,46,0,47,48,57,58,65535,46,0,65535,58,0,65535,0],_tsip_machine_parser_uri_single_lengths=[0,1,2,1,0,0,0,5,5,0,0,0,5,0,0,5,0,0,7,7,0,0,6,6,0,0,7,0,2,1,2,0,2,0,0,2,0,2,0,2,2,2,2,2,2,2,2,2,0,0,7,7,6,0,0,4,4,5,0,3,0,4,4,3,1,7,6,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,0],_tsip_machine_parser_uri_range_lengths=[0,3,3,3,3,3,3,4,4,3,3,1,4,3,3,4,3,3,3,3,3,3,4,4,3,3,7,1,7,7,7,7,3,3,7,7,7,7,7,3,3,3,7,7,7,7,7,7,3,1,5,4,4,7,7,3,3,3,0,3,0,3,3,3,1,4,4,7,7,7,7,1,7,7,3,3,3,3,3,3,3,1,3,1,3,1,7,7,7,7,7,7,1,7,7,7,7,3,3,3,1,1,0],_tsip_machine_parser_uri_index_offsets=[0,0,5,11,16,20,24,28,38,48,52,56,58,68,72,76,86,90,94,105,116,120,124,135,146,150,154,169,171,181,190,200,208,214,218,226,236,244,254,262,268,274,280,290,300,310,320,330,340,344,346,359,371,382,390,398,406,414,423,424,431,432,440,448,455,458,470,481,490,500,510,520,524,533,544,548,553,557,562,566,571,576,579,584,587,592,595,606,617,627,637,647,657,661,669,680,691,702,706,711,716,719,722],_tsip_machine_parser_uri_indicies=[1,2,2,2,0,3,4,5,5,5,0,3,5,5,5,0,5,2,2,0,7,7,7,6,8,8,8,6,9,10,9,9,9,9,9,9,9,6,11,12,11,11,11,11,11,11,11,6,13,13,13,6,11,11,11,6,14,0,16,17,16,16,16,16,16,16,16,15,18,18,18,15,19,19,19,15,20,21,20,20,20,20,20,20,20,15,22,22,22,15,20,20,20,15,23,25,23,23,23,23,23,23,23,23,24,26,27,28,26,29,26,26,26,26,26,24,30,30,30,24,26,26,26,24,31,32,31,33,31,31,31,31,31,31,24,34,35,34,36,34,34,34,34,34,34,24,37,37,37,24,34,34,34,24,40,41,43,44,45,43,44,38,39,38,42,38,42,38,24,38,46,47,48,38,49,38,50,38,50,38,46,47,38,50,38,50,38,50,38,46,47,51,38,50,38,50,38,50,38,46,38,50,38,2,38,2,38,46,1,53,2,2,2,52,5,2,2,52,38,54,38,2,38,2,38,46,47,55,38,56,38,50,38,50,38,46,38,57,38,2,38,2,38,46,47,58,38,59,38,50,38,50,38,46,38,60,38,2,38,2,38,46,3,4,61,5,5,52,3,4,62,5,5,52,3,4,5,5,5,52,47,58,38,63,38,50,38,50,38,46,47,58,38,50,38,50,38,50,38,46,47,55,38,64,38,50,38,50,38,46,47,55,38,50,38,50,38,50,38,46,47,48,38,65,38,50,38,50,38,46,47,48,38,50,38,50,38,50,38,46,38,66,38,46,66,67,9,68,38,38,38,38,9,38,9,38,9,38,46,8,70,71,72,8,8,8,8,8,8,8,69,11,12,71,11,11,11,11,11,11,11,69,38,73,38,73,38,73,38,46,38,8,38,8,38,8,38,46,1,53,74,74,2,2,2,52,1,53,75,75,2,2,2,52,1,53,76,77,77,2,2,2,52,78,1,53,79,2,2,2,52,80,1,53,81,81,2,2,2,52,1,53,82,82,2,2,2,52,1,53,83,2,2,2,52,86,85,84,19,88,89,90,19,19,19,19,19,19,19,87,20,21,89,20,20,20,20,20,20,20,87,92,38,91,38,91,38,91,38,46,94,95,38,93,38,93,38,93,38,46,94,95,38,96,38,96,38,96,38,46,94,95,38,97,38,97,38,97,38,46,94,95,38,46,99,38,98,38,91,38,91,38,46,100,94,95,38,101,38,93,38,93,38,46,38,102,38,46,103,38,104,38,46,38,105,38,46,106,38,107,38,46,38,108,38,46,95,38,109,38,46,95,38,110,38,46,95,38,46,106,38,111,38,46,106,38,46,103,38,112,38,46,103,38,46,100,94,95,38,113,38,96,38,96,38,46,100,94,95,38,97,38,97,38,97,38,46,115,95,38,114,38,114,38,114,38,46,117,95,38,116,38,116,38,116,38,46,117,95,38,118,38,118,38,118,38,46,117,95,38,119,38,119,38,119,38,46,117,95,38,46,38,120,38,114,38,114,38,46,100,117,95,38,121,38,116,38,116,38,46,100,117,95,38,122,38,118,38,118,38,46,100,117,95,38,119,38,119,38,119,38,46,38,123,38,46,100,38,124,38,46,100,38,125,38,46,100,38,46,99,38,46,24,0],_tsip_machine_parser_uri_trans_targs=[26,1,32,3,4,2,26,6,51,51,5,52,9,10,64,26,65,13,14,65,66,16,17,19,0,20,19,20,22,102,21,23,24,102,23,24,102,25,27,28,48,50,32,55,61,67,26,29,34,46,30,31,26,33,35,36,44,37,38,42,39,40,41,43,45,47,49,26,53,26,5,7,8,54,56,57,58,59,26,60,26,62,63,11,26,64,12,26,13,12,15,68,101,69,72,26,70,71,73,88,74,86,75,76,84,77,78,82,79,80,81,83,85,87,89,97,90,93,91,92,94,95,96,98,99,100],_tsip_machine_parser_uri_trans_actions=[25,0,13,0,0,0,27,0,13,53,1,13,0,0,67,23,53,1,0,13,13,0,0,1,0,1,0,0,5,38,0,1,1,59,0,0,44,0,0,35,0,0,56,63,56,3,21,0,0,0,0,0,17,13,0,0,0,0,0,0,13,13,13,0,0,0,0,19,1,50,0,7,0,0,13,13,0,13,29,0,32,13,13,0,41,13,5,47,0,7,0,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_uri_to_state_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_uri_from_state_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_uri_eof_trans=[0,1,1,1,1,7,7,7,7,7,7,1,16,16,16,16,16,16,0,0,0,0,0,0,0,0,0,47,47,47,47,47,53,53,47,47,47,47,47,53,53,53,47,47,47,47,47,47,47,68,47,70,70,47,47,53,53,53,79,53,81,53,53,53,85,88,88,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,0],tsip_machine_parser_uri_start=26,tsip_machine_parser_uri_first_final=26,tsip_machine_parser_uri_error=0,tsip_machine_parser_uri_en_sip_usrinfo=18,tsip_machine_parser_uri_en_main=26,tsip_uri.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=i,a=tsk_buff_str2ib(_),n=new tsip_uri(tsip_uri_type_e.unknown);t=tsip_machine_parser_uri_start,ts=null,te=null,act=0;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){for(d=_tsip_machine_parser_uri_from_state_actions[t],l=_tsip_machine_parser_uri_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsip_machine_parser_uri_actions[d-1]){case 12:ts=s}if(_trigger_goto)continue;c=_tsip_machine_parser_uri_key_offsets[t],p=_tsip_machine_parser_uri_index_offsets[t],o=_tsip_machine_parser_uri_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[s]<_tsip_machine_parser_uri_trans_keys[_mid])_upper=_mid-1;else{if(!(a[s]>_tsip_machine_parser_uri_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsip_machine_parser_uri_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[s]<_tsip_machine_parser_uri_trans_keys[_mid])_upper=_mid-2;else{if(!(a[s]>_tsip_machine_parser_uri_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);p=_tsip_machine_parser_uri_indicies[p]}if(m>=h){if(t=_tsip_machine_parser_uri_trans_targs[p],0!=_tsip_machine_parser_uri_trans_actions[p])for(d=_tsip_machine_parser_uri_trans_actions[p],l=_tsip_machine_parser_uri_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsip_machine_parser_uri_actions[d-1]){case 0:e=s;break;case 1:n.e_type=tsip_uri_type_e.sip,n.s_scheme=n.e_type.s_scheme;break;case 2:n.e_type=tsip_uri_type_e.sips,n.s_scheme=n.e_type.s_scheme;break;case 3:n.e_type=tsip_uri_type_e.tel,n.s_scheme=n.e_type.s_scheme;break;case 4:n.e_host_type=tsip_host_type_e.ipv4;break;case 5:n.e_host_type=tsip_host_type_e.ipv6;break;case 6:n.e_host_type=tsip_host_type_e.hostname;break;case 7:n.s_user_name=tsk_ragel_parser_get_string(_,s,e);break;case 8:n.s_password=tsk_ragel_parser_get_string(_,s,e);break;case 9:var E=tsk_ragel_parser_get_param(_,s,e);E&&n.ao_params.push(E);break;case 10:t=26,_trigger_goto=!0,h=g;break;case 13:te=s+1;break;case 14:te=s+1,n.s_host=tsk_ragel_scanner_get_string(_,ts,te),n.e_host_type.i_id==tsip_host_type_e.ipv6.i_id&&(n.s_host=tsk_string_unquote(n.s_host,"[","]"));break;case 15:if(te=s,s-=1,tsk_string_contains(_.substring(te),i-te,"@")){t=18,_trigger_goto=!0,h=g;break}break;case 16:te=s,s-=1;break;case 17:te=s,s-=1,n.s_host=tsk_ragel_scanner_get_string(_,ts,te),n.e_host_type.i_id==tsip_host_type_e.ipv6.i_id&&(n.s_host=tsk_string_unquote(n.s_host,"[","]"));break;case 18:te=s,s-=1,ts++,n.i_port=tsk_ragel_scanner_get_int(_,ts,te);break;case 19:te=s,s-=1;break;case 20:te=s,s-=1;break;case 21:s=te-1;break;case 22:s=te-1,n.s_host=tsk_ragel_scanner_get_string(_,ts,te),n.e_host_type.i_id==tsip_host_type_e.ipv6.i_id&&(n.s_host=tsk_string_unquote(n.s_host,"[","]"));break;case 23:s=te-1}if(_trigger_goto)continue}if(g>=h){for(d=_tsip_machine_parser_uri_to_state_actions[t],l=_tsip_machine_parser_uri_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsip_machine_parser_uri_actions[d-1]){case 11:ts=null}if(_trigger_goto)continue;if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(y>=h&&s==r&&_tsip_machine_parser_uri_eof_trans[t]>0)p=_tsip_machine_parser_uri_eof_trans[t]-1,h=m;else if(f>=h)break}return 26>t?(tsk_utils_log_error("Failed to parse SIP/SIPS/TEL URI: "+_),null):n},tsip_challenge.prototype.get_username=function(){return this.o_stack.identity.s_impi},tsip_challenge.prototype.get_password=function(){return this.o_stack.identity.s_password},tsip_challenge.prototype.get_digest=function(){return this.o_stack.identity.s_digest},tsip_challenge.prototype.reset_cnonce=function(){this.s_qop&&(this.s_cnonce=MD5.hexdigest(tsk_string_random(21)),this.i_nc=1)},tsip_challenge.prototype.get_response=function(_,e,t){if(tsk_string_iequals(this.s_scheme,"Digest")){var s="",i=this.get_digest()||tsip_auth_digest_HA1(this.get_username(),this.s_realm,this.get_password()),r=tsip_auth_digest_HA2(_,e,t,this.s_qop);this.i_nc&&(s=tsip_challenge.prototype.Ncount2String(this.i_nc));var a=tsip_auth_digest_response(i,this.s_nonce,s,this.s_cnonce,this.s_qop,r);return this.s_qop&&++this.i_nc,a}return null},tsip_challenge.prototype.update=function(_,e,t,s,i,r){var a=!tsk_string_iequals(this.s_nonce,t);return this.s_scheme=_,this.s_realm=e,this.s_nonce=t,this.s_opaque=s,this.s_algorithm=i,r&&(this.s_qop=tsk_string_contains(r,r.length,"auth-int")?"auth-int":tsk_string_contains(r,r.length,"auth")?"auth":null),a&&this.s_qop&&this.reset_cnonce(),0},tsip_challenge.prototype.create_header_authorization=function(_){var e=null,t=null,s=null;if(!(t=tsip_uri_tostring(_.line.request.o_uri,!0,!1)))return tsk_utils_log_error("Failed to parse URI: "+_.line.request.o_uri),null;this.i_nc&&(e=tsip_challenge.prototype.Ncount2String(this.i_nc));var i=this.get_response(_.line.request.s_method,t,_.o_content);return s=new tsip_header_Authorization,s.e_type=this.b_isproxy?tsip_header_type_e.Proxy_Authorization:tsip_header_type_e.Authorization,s.s_scheme=this.s_scheme,s.s_username=this.get_username(),s.s_realm=this.s_realm,s.s_nonce=this.s_nonce,s.s_uri=t,s.s_response=i,s.s_algorithm=this.s_algorithm?this.s_algorithm:"MD5",s.s_cnonce=this.i_nc?this.s_cnonce:null,s.s_opaque=this.s_opaque,s.s_qop=this.s_qop,s.s_nc=e,s},tsip_challenge.prototype.CreateEmptyHeaderAuthorization=function(_,e,t){var s=new tsip_header_Authorization;return s&&(s.e_type=tsip_header_type_e.Authorization,s.s_scheme="Digest",s.s_username=_,s.s_realm=e,s.s_nonce="",s.s_response="",s.s_uri=t),s},tsip_challenge.prototype.Ncount2String=function(_){var e=7,t="";do t+="0123456789abcdef"[_>>4*e&15];while(e--);return t},tsip_dialog.prototype.__i_timer_shutdown=3e3;var tsip_dialog_type_e={UNKNOWN:{i_id:0,s_name:"Unknown"},INVITE:{i_id:1,s_name:"INVITE"},MESSAGE:{i_id:2,s_name:"MESSAGE"},INFO:{i_id:3,s_name:"INFO"},OPTIONS:{i_id:4,s_name:"OPTIONS"},PUBLISH:{i_id:5,s_name:"PUBLISH"},REGISTER:{i_id:6,s_name:"REGISTER"},SUBSCRIBE:{i_id:7,s_name:"SUBSCRIBE"}},tsip_dialog_state_e={INITIAL:{i_id:0,s_name:"Initial"},EARLY:{i_id:1,s_name:"Early"},ESTABLISHED:{i_id:2,s_name:"Established"},TERMINATED:{i_id:3,s_name:"Terminated"}},tsip_dialog_event_type_e={I_MSG:{i_id:0,s_name:"I_MSG"},O_MSG:{i_id:1,s_name:"O_MSG"},TRANSAC_OK:{i_id:2,s_name:"TRANSAC_OK"},CANCELED:{i_id:3,s_name:"CANCELED"},TERMINATED:{i_id:4,s_name:"TERMINATED"},TIMEDOUT:{i_id:5,s_name:"TIMEDOUT"},ERROR:{i_id:6,s_name:"ERROR"},TRANSPORT_ERROR:{i_id:7,s_name:"TRANSPORT_ERROR"}};tsip_dialog.prototype.init=function(_,e,t,s,i){if(this.b_initialized)return tsk_utils_log_error("Dialog already initialized"),-2;this.e_state=tsip_dialog_state_e.INITIAL,this.e_type=_,this.ao_hdr_record_routes=new Array,this.ao_challenges=new Array,this.i_expires=tsip_session.prototype.__i_expires_default;var r=!tsk_string_is_null_or_empty(e);return this.s_callid=r?e:tsk_string_random_uuid(),(this.o_session=t)&&(this.i_expires=t.i_expires,this.o_uri_local=r?t.o_uri_to:t.o_uri_from,t.o_uri_to?(this.o_uri_remote=t.o_uri_to,this.o_uri_remote_target=t.o_uri_to):(this.o_uri_remote=t.o_uri_from,this.o_uri_remote_target=t.o_stack.network.o_uri_realm)),this.s_tag_local=tsk_string_random(20),this.s_tag_remote=null,this.i_cseq_value=Math.floor(65535*Math.random()),this.o_fsm=new tsk_fsm(s,i,null,this),this.b_initialized=!0,0},tsip_dialog.prototype.deinit=function(){return this.get_layer_dialog().dialog_remove(this),this.get_layer_transac().cancel_by_dialog(this),this.b_initialized=!1,0},tsip_dialog.prototype.compare=function(_){return tsip_dialog_compare(this,_)},tsip_dialog.prototype.request_new=function(_){if(!this.o_session||!this.o_session.o_stack||!_)return tsk_utils_log_error("Invalid argument"),null;var e=null,t=null,s=null,i=null,r=-1,a=null,n=this.o_session,o=n.o_stack;switch(a=this.s_callid,t=this.o_uri_remote,s=this.o_uri_local,this.ao_hdr_record_routes&&0!=this.ao_hdr_record_routes.length?(o_uri_first_route=this.ao_hdr_record_routes[0].o_uri,tsk_params_have_param(o_uri_first_route.ao_params,"lr")?(i=this.o_uri_remote_target,r=0):(i=o_uri_first_route,r=1)):i=this.o_uri_remote_target,e=new tsip_request(_,i,s,t,a,this.i_cseq_value),e.o_hdr_To.s_tag=this.s_tag_remote,e.o_hdr_From.s_tag=this.s_tag_local,e.b_update=!0,e.line.request.e_type){case tsip_request_type_e.MESSAGE:case tsip_request_type_e.PUBLISH:case tsip_request_type_e.BYE:e.line.request.e_type==tsip_request_type_e.PUBLISH&&e.add_header(new tsip_header_Expires(this.i_expires/1e3));for(var p=0;p<this.o_session.ao_caps.length;++p){var c=tsk_string_format("*;{0}",tsk_param_tostring(this.o_session.ao_caps[p]));c&&e.add_header(new tsip_header_Dummy("Accept-Contact",c))}break;default:var d=null,l=null;if(e.line.request.e_type==tsip_request_type_e.OPTIONS||e.line.request.e_type==tsip_request_type_e.PUBLISH||e.line.request.e_type==tsip_request_type_e.REGISTER?(d=tsk_string_format('m: "{1}"<{0}:{2}@{3}:{4};rtcweb-breaker={5}>;click2call={6};expires={7}\r\n',"sip",o.identity.s_display_name,s.s_user_name,"127.0.0.1",5060,o.network.b_rtcweb_enabled?"yes":"no",o.network.b_click2call_enabled?"yes":"no",Math.floor(this.i_expires/1e3)),e.line.request.e_type==tsip_request_type_e.REGISTER&&0==this.i_expires&&e.add_header(new tsip_header_Expires(0))):(e.line.request.e_type==tsip_request_type_e.SUBSCRIBE&&e.add_header(new tsip_header_Expires(this.i_expires/1e3)),d=tsk_string_format('m: "{1}"<{0}:{2}@{3}:{4};rtcweb-breaker={5};click2call={6}>',"sip",o.identity.s_display_name,s.s_user_name,"127.0.0.1",5060,o.network.b_rtcweb_enabled?"yes":"no",o.network.b_click2call_enabled?"yes":"no"),e.line.request.e_type==tsip_request_type_e.INVITE&&o.network.b_rtcweb_enabled&&(d+=";impi="+encodeURIComponent(o.identity.s_impi),d+=";ha1="+tsip_auth_digest_HA1(o.identity.s_impi,o.network.o_uri_realm.s_host,o.identity.s_password)),d+="\r\n"),l=tsip_header_Contact.prototype.Parse(d),l&&l.length>0&&(e.o_hdr_Contact=l[0]),e.o_hdr_Contact)for(var p=0;p<this.o_session.ao_caps.length;++p)tsk_params_add_param(e.o_hdr_Contact.ao_params,this.o_session.ao_caps[p])}if(this.e_state==tsip_dialog_state_e.INITIAL&&0==this.ao_challenges.length){if(e.is_register()&&!o.security.b_earlyIMS){var h=o.network.o_uri_realm?o.network.o_uri_realm.s_host:"(null)",u=tsip_uri_tostring(e.line.request.o_uri,!1,!1),m=tsip_challenge.prototype.CreateEmptyHeaderAuthorization(o.identity.s_impi,h,u);e.add_header(m)}}else if(this.ao_challenges.length>0)for(var p=0;p<this.ao_challenges.length;++p){var g=this.ao_challenges[p].create_header_authorization(e);g&&e.add_header(g)}if(e.is_ack()||e.is_cancel()||(e.o_hdr_CSeq.i_seq=++this.i_cseq_value),!e.is_register())if(-1!=r){if(this.e_state==tsip_dialog_state_e.EARLY||this.e_state==tsip_dialog_state_e.ESTABLISHED)for(var y=-1,p=0;p<this.ao_hdr_record_routes.length;++p){var f=this.ao_hdr_record_routes[p].o_uri,E=null;if(!(++y<r)&&f&&(E=new tsip_header_Route(f))){for(var k=0;k<this.ao_hdr_record_routes[p].ao_params.length;++k)E.ao_params.push(this.ao_hdr_record_routes[p].ao_params[k]);e.add_header(E)}}}else if(this.e_state==tsip_dialog_state_e.INITIAL||this.e_state==tsip_dialog_state_e.EARLY)for(var p=0;p<o.ao_uri_service_routes.length;++p)e.add_header(new tsip_header_Service_Route(o.ao_uri_service_routes[p]));if(o.network.e_proxy_cscf_type==tsip_transport_type_e.WS||o.network.e_proxy_cscf_type==tsip_transport_type_e.WSS){var v=o.__get_proxy_outbound_uri_string();v&&e.add_header(new tsip_header_Dummy("Route",v),!0)}for(var p=0;p<n.ao_headers.length;++p)e.add_header(n.ao_headers[p]);for(var p=0;p<o.ao_headers.length;++p)e.add_header(o.ao_headers[p]);return this.add_common_headers(e),n.s_sigcomp_id&&(e.s_sigcomp_id=n.s_sigcomp_id),e},tsip_dialog.prototype.response_new=function(_,e,t){var s;if(s=new tsip_response(_,e,t)){switch(t.line.request.e_type){case tsip_request_type_e.MESSAGE:case tsip_request_type_e.PUBLISH:break;default:if(s.o_hdr_To&&!s.o_hdr_To.s_tag&&(s.o_hdr_To.s_tag=this.s_tag_local),this.o_uri_local&&_>=101&&299>=_){var i,r=tsk_string_format("m: <{0}:{1}@{2}:{3}>\r\n","sip",this.o_uri_local.s_user_name,"127.0.0.1",5060),i=tsip_header_Contact.prototype.Parse(r);null!=i&&i.length>0&&(s.o_hdr_Contact=i[0],s.b_update=!0)}}this.get_session().s_sigcomp_id&&(s.s_sigcomp_id=this.get_session().s_sigcomp_id)}return s},tsip_dialog.prototype.response_send=function(_){var e=-1,t=this.get_layer_transac();if(t){var s=t.find_server(_);s?(setTimeout(function(){s.callback(tsip_transac_event_type_e.OUTGOING_MSG,_)},1),e=0):tsk_utils_log_error("Failed to find associated server transaction.");
}else tsk_utils_log_error("Invalid parameter");return e},tsip_dialog.prototype.get_session=function(){return this.o_session},tsip_dialog.prototype.get_stack=function(){return this.o_session?this.o_session.o_stack:null},tsip_dialog.prototype.get_layer_transac=function(){var _=this.get_stack();return _?_.o_layer_transac:null},tsip_dialog.prototype.get_layer_dialog=function(){var _=this.get_stack();return _?_.o_layer_dialog:null},tsip_dialog.prototype.get_layer_transport=function(){var _=this.get_stack();return _?_.o_layer_transport:null},tsip_dialog.prototype.request_send=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;if(_.is_ack())return this.get_layer_transport().send(null,_)>0?0:-2;var e=this.get_layer_transac();if(!e)return tsk_utils_log_error("Invalid transac layer"),-1;var t=-1,s=e.transac_new(!0,_,this);if(s)switch(s.e_type){case tsip_transac_type_e.ICT:case tsip_transac_type_e.NICT:t=s.start(_)}return t},tsip_dialog.prototype.add_common_headers=function(_){var e=!1,t=null,s=null,i=this.get_stack();if(!_||!i)return tsk_utils_log_error("Invalid argument"),-1;if(e=i.security.b_earlyIMS,t=i.identity.o_uri_pref)switch(_.line.request.e_type){case tsip_request_type_e.BYE:case tsip_request_type_e.INVITE:case tsip_request_type_e.OPTIONS:case tsip_request_type_e.SUBSCRIBE:case tsip_request_type_e.NOTIFY:case tsip_request_type_e.REFER:case tsip_request_type_e.MESSAGE:case tsip_request_type_e.PUBLISH:case tsip_request_type_e.REGISTER:(!e||e&&_.is_register())&&_.add_header(new tsip_header_P_Preferred_Identity(t))}if(s)switch(_.line.request.e_type){case tsip_request_type_e.BYE:case tsip_request_type_e.INVITE:case tsip_request_type_e.OPTIONS:case tsip_request_type_e.REGISTER:case tsip_request_type_e.SUBSCRIBE:case tsip_request_type_e.NOTIFY:case tsip_request_type_e.PRACK:case tsip_request_type_e.INFO:case tsip_request_type_e.UPDATE:case tsip_request_type_e.REFER:case tsip_request_type_e.MESSAGE:case tsip_request_type_e.PUBLISH:_.add_header(new tsip_header_P_Access_Network_Info(s))}return 0},tsip_dialog.prototype.get_action_curr=function(){return this.o_action_curr},tsip_dialog.prototype.set_action_curr=function(_){return this.o_action_curr=_,0},tsip_dialog.prototype.set_last_error=function(_,e,t){return this.last_error.i_code=_,this.last_error.s_phrase=e,this.last_error.o_message=t,0},tsip_dialog.prototype.signal=function(_,e,t){return tsip_event.prototype.Signal(tsip_event_type_e.DIALOG,this.o_session,_,e,t)},tsip_dialog.prototype.timer_schedule=function(T,N){this.timer_cancel(N);var This=this,s_code=tsk_string_format("This.o_timer{1} = setTimeout(function(){ __tsip_dialog_{0}_timer_callback(This, This.o_timer{1})}, This.i_timer{1});",T,N);eval(s_code)},tsip_dialog.prototype.timer_cancel=function(N){var s_code=tsk_string_format("if(this.o_timer{0}) { clearTimeout(this.o_timer{0}); this.o_timer{0} = null; }",N);eval(s_code)},tsip_dialog.prototype.callback=function(_,e){return this.fn_callback?this.fn_callback(this,_,e):(tsk_utils_log_error("Invalid callback function"),-1)},tsip_dialog.prototype.set_callback=function(_){this.fn_callback=_},tsip_dialog.prototype.fsm_act=function(_,e,t){return this.o_fsm?this.o_fsm.act(_,this.o_fsm.get_usr_data(),e,this.o_fsm.get_usr_data(),e,t):(tsk_utils_log_error("Invalid argument"),-1)},tsip_dialog.prototype.hangup=function(_){return this.e_state==tsip_dialog_state_e.ESTABLISHED||this.o_session&&this.o_session.b_server&&this.e_state==tsip_dialog_state_e.EARLY||this.e_type!=tsip_dialog_type_e.INVITE?this.fsm_act(tsip_action_type_e.HANGUP,null,_):this.fsm_act(tsip_action_type_e.CANCEL,null,_)},tsip_dialog.prototype.shutdown=function(_){return this.fsm_act(tsip_action_type_e.SHUTDOWN,null,_)},tsip_dialog.prototype.update_with_response=function(_){if(!_||!_.is_response()||!_.o_hdr_To)return tsk_utils_log_error("Invalid argument"),-1;var e=_.get_response_code(),t=_.o_hdr_To.s_tag;if(401==e||407==e||421==e||494==e){var s;return s=_.is_response_to_register()&&this.e_state==tsip_dialog_state_e.ESTABLISHED,this.update_challenges(_,s)}if(e>100&&300>e){var i=this.e_state;if(199>=e){if(tsk_string_is_null_or_empty(_.o_hdr_To.s_tag))return tsk_utils_log_error("Invalid tag  parameter"),-1;i=tsip_dialog_state_e.EARLY}else i=tsip_dialog_state_e.ESTABLISHED;!_.is_response_to_register()&&_.o_hdr_Contact&&_.o_hdr_Contact.o_uri&&(this.o_uri_remote_target=tsip_uri.prototype.Parse(tsip_uri_tostring(_.o_hdr_Contact.o_uri,!0,!1)));var r,a;for(this.ao_hdr_record_routes.splice(0,this.ao_hdr_record_routes.length),r=0;a=_.get_header_at(tsip_header_type_e.Record_Route,r);++r)this.ao_hdr_record_routes.push(a);return this.ao_hdr_record_routes.reverse(),this.e_state==tsip_dialog_state_e.ESTABLISHED&&tsk_string_iequals(this.s_tag_remote,t)?0:(_.is_response_to_register()||_.is_response_to_publish()||(this.s_tag_remote=t),this.e_state=i,0)}return 0},tsip_dialog.prototype.update_with_invite=function(_){if(!_)return tsk_utils_log_error("Invalid parameter"),-1;_.o_hdr_Contact&&_.o_hdr_Contact.o_uri&&(this.o_uri_remote_target=tsip_uri.prototype.Parse(tsip_uri_tostring(_.o_hdr_Contact.o_uri,!0,!1))),this.s_tag_remote=_.o_hdr_From?_.o_hdr_From.s_tag:"tag_doubango",_.o_hdr_From&&_.o_hdr_From.o_uri&&(this.o_uri_remote=_.o_hdr_From.o_uri);var e,t;for(this.ao_hdr_record_routes.splice(0,this.ao_hdr_record_routes.length),e=0;t=_.get_header_at(tsip_header_type_e.Record_Route,e);++e)this.ao_hdr_record_routes.push(t);return this.e_state=tsip_dialog_state_e.EARLY,0},tsip_dialog.prototype.update_challenges=function(_,e){for(var t,s,i,r=-1,a=0;s=_.get_header_at(tsip_header_type_e.WWW_Authenticate,a);a++){for(var n=!0,o=0;o<this.ao_challenges.length;++o)if(t=this.ao_challenges[o],!t.b_isproxy){if(!tsk_string_iequals(t.s_realm,s.s_realm)||!s.b_stale&&!e)return tsk_utils_log_error("Failed to handle new challenge"),-1;if(r=t.update(s.s_scheme,s.s_realm,s.s_nonce,s.s_opaque,s.s_algorithm,s.s_qop))return r;n=!1}if(n){if(!(t=new tsip_challenge(this.get_stack(),!1,s.s_scheme,s.s_realm,s.s_nonce,s.s_opaque,s.s_algorithm,s.s_qop)))return tsk_utils_log_error("Failed to handle new challenge"),-1;this.ao_challenges.push(t)}}for(var a=0;i=_.get_header_at(tsip_header_type_e.Proxy_Authenticate,a);a++){for(var n=!0,o=0;o<this.ao_challenges.length;++o)if(t=this.ao_challenges[o],t.b_isproxy){if(!tsk_string_iequals(t.s_realm,i.s_realm)||!i.b_stale&&!e)return tsk_utils_log_error("Failed to handle new challenge"),-1;if(r=t.update(i.s_scheme,i.s_realm,i.s_nonce,i.s_opaque,i.s_algorithm,i.s_qop))return r;n=!1}if(n){if(!(t=new tsip_challenge(this.get_stack(),!0,i.s_scheme,i.s_realm,i.s_nonce,i.s_opaque,i.s_algorithm,i.s_qop)))return tsk_utils_log_error("Failed to handle new challenge"),-1;this.ao_challenges.push(t)}}return 0},tsip_dialog.prototype.get_newdelay=function(_){var e,t,s=this.i_expires/1e3,i=s,r=!1;if(_.is_notify()){var a;(a=_.get_header(tsip_header_type_e.Subscription_State))&&a.i_expires>0&&(s=a.i_expires,r=!0)}for(!r&&(e=_.get_header(tsip_header_type_e.Expires))&&(s=e.i_value,r=!0),t=0;!r&&(e=_.get_header_at(tsip_header_type_e.Contact,t));++t){var n=e;if(n.o_uri){var o=tsk_param_get_value_by_name(n.o_uri.ao_params,"transport"),p=this.get_stack().__get_contact_uri(o?o:"udp");if(p&&tsk_string_equals(n.o_uri.s_user_name,p.s_user_name)&&tsk_string_equals(n.o_uri.s_host,p.s_host)&&n.o_uri.i_port==p.i_port&&n.i_expires>=0){s=n.i_expires,r=!1;break}}}return i=s>1200?s-600:s>>1,1e3*i},tsip_dialog.prototype.ApplyAction=function(_,e){if(!_||!e)return tsk_utils_log_error("Invalid argument"),-1;for(var t=0;t<e.ao_headers.length;++t)_.add_header(e.ao_headers[t]);return e.line_resp.i_code&&e.line_resp.s_phrase&&_.is_response()&&(_.line.response.i_status_code=e.line_resp.i_code,_.line.response.s_reason_phrase=e.line_resp.s_phrase),e.o_content&&_.add_content(e.o_content),0},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/dialogs/tsip_dialog_generic.js","src/tinySIP/src/dialogs/tsip_dialog_invite.js","src/tinySIP/src/dialogs/tsip_dialog_register.js"),tsip_dialog_generic.prototype=Object.create(tsip_dialog.prototype),tsip_dialog_generic.prototype.__b_debug_state_machine=!0;var tsip_dialog_generic_actions_e={ACCEPT:tsip_action_type_e.ACCEPT,REJECT:tsip_action_type_e.REJECT,HANGUP:tsip_action_type_e.HANGUP,CANCEL:tsip_action_type_e.CANCEL,SHUTDOWN:tsip_action_type_e.SHUTDOWN,O_SUBSCRIBE:tsip_action_type_e.SUBSCRIBE,O_OPTIONS:tsip_action_type_e.OPTIONS,O_MESSAGE:tsip_action_type_e.MESSAGE,O_INFO:tsip_action_type_e.INFO,O_PUBLISH:tsip_action_type_e.PUBLISH,O_UNPUBLISH:tsip_action_type_e.UNPUBLISH,I_SUBSCRIBE:1e4,I_MESSAGE:10001,I_OPTIONS:10002,I_INFO:10003,I_PUBLISH:10004,I_NOTIFY:10005,I_1XX:5e4,I_2XX:50001,I_401_407_421_494:50002,I_423:50003,I_300_to_699:50004,SHUTDOWN_TIMEDOUT:6e4,TRANSPORT_ERROR:60002,ERROR:60003},tsip_dialog_generic_states_e={STARTED:0,INPROGRESS:1,INCOMING:2,CONNECTED:3,TERMINATED:4};tsip_dialog_generic.prototype.signal_ao=function(_,e,t){var s;switch(this.e_type){case tsip_dialog_type_e.MESSAGE:var s=new tsip_event_message(this.get_session(),_,e,t,tsip_event_message_type_e.AO_MESSAGE);return s.signal();case tsip_dialog_type_e.PUBLISH:var s=new tsip_event_publish(this.get_session(),_,e,t,tsip_event_publish_type_e.AO_PUBLISH);return s.signal();case tsip_dialog_type_e.SUBSCRIBE:var s=new tsip_event_subscribe(this.get_session(),_,e,t,tsip_event_subscribe_type_e.AO_SUBSCRIBE);return s.signal()}return tsk_utils_log_error("not implemented"),-1},tsip_dialog_generic.prototype.signal_i=function(_,e,t){var s;switch(this.e_type){case tsip_dialog_type_e.MESSAGE:if(t.is_message()){var s=new tsip_event_message(this.get_session(),_,e,t,tsip_event_message_type_e.I_MESSAGE);return s.signal()}break;case tsip_dialog_type_e.SUBSCRIBE:if(t.is_notify()){var s=new tsip_event_subscribe(this.get_session(),_,e,t,tsip_event_subscribe_type_e.I_NOTIFY);return s.signal()}}return tsk_utils_log_error("not implemented"),-1},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/dialogs/tsip_dialog_generic__message.js","src/tinySIP/src/dialogs/tsip_dialog_generic__publish.js","src/tinySIP/src/dialogs/tsip_dialog_generic__subscribe.js"),tsip_dialog_generic.prototype.init_message=function(){this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.STARTED,tsip_dialog_generic_actions_e.O_MESSAGE,tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_Started_2_InProgress_X_oMessage,"tsip_dialog_generic_Started_2_InProgress_X_oMessage"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_generic_states_e.STARTED,tsip_dialog_generic_actions_e.I_MESSAGE,tsip_dialog_generic_states_e.INCOMING,tsip_dialog_generic_Started_2_Incoming_X_iMessage,"tsip_dialog_generic_Started_2_Incoming_X_iMessage"))},tsip_dialog_generic.prototype.send_message=function(){var _,e=-1;return(_=this.request_new("MESSAGE"))&&this.get_action_curr()&&0==(e=tsip_dialog.prototype.ApplyAction(_,this.get_action_curr()))&&(e=this.request_send(_)),e},tsip_dialog_generic.prototype.init_publish=function(){this.s_etag=null,this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.O_PUBLISH,tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_Any_2_InProgress_X_oPublish,"tsip_dialog_generic_Any_2_InProgress_X_oPublish"))},tsip_dialog_generic.prototype.send_publish=function(){var _,e=-1;if(this.b_disconnecting&&(this.i_expires=0),_=this.request_new("PUBLISH")){var t=this.get_action_curr();if(t&&(e=tsip_dialog.prototype.ApplyAction(_,t)))return e;this.s_etag&&_.add_header(new tsip_header_SIP_If_Match(this.s_etag)),e=this.request_send(_)}return e},tsip_dialog_generic.prototype.init_subscribe=function(){this.s_etag=null,this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.O_SUBSCRIBE,tsip_dialog_generic_states_e.INPROGRESS,tsip_dialog_generic_Any_2_InProgress_X_oSubscribe,"tsip_dialog_generic_Any_2_InProgress_X_oSubscribe"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_actions_e.I_NOTIFY,tsk_fsm.prototype.__i_state_any,tsip_dialog_generic_Any_2_Any_X_iNotify,"tsip_dialog_generic_Any_2_Any_X_iNotify"))},tsip_dialog_generic.prototype.send_subscribe=function(){var _,e=-1;if(this.b_disconnecting&&(this.i_expires=0),_=this.request_new("SUBSCRIBE")){var t=this.get_action_curr();if(t&&(e=tsip_dialog.prototype.ApplyAction(_,t)))return e;e=this.request_send(_)}return e},tsip_dialog_invite.prototype=Object.create(tsip_dialog.prototype),tsip_dialog_invite.prototype.__b_debug_state_machine=!0,tsip_dialog_invite.prototype.__i_lo_sdp_request_timeout=5e7;var tsip_dialog_invite_next_offer_type_e={NONE:0,INVITE:1,UPDATE:2,SUCCESS:3},tsip_dialog_invite_actions_e={ACCEPT:tsip_action_type_e.ACCEPT,REJECT:tsip_action_type_e.HANGUP,DTMF_SEND:tsip_action_type_e.DTMF_SEND,MSRP_SEND_MSG:tsip_action_type_e.LARGE_MESSAGE,O_INVITE:tsip_action_type_e.INVITE,O_CANCEL:tsip_action_type_e.CANCEL,O_HOLD:tsip_action_type_e.HOLD,O_RESUME:tsip_action_type_e.RESUME,O_ECT:tsip_action_type_e.ECT,I_ECT_ACCEPT:tsip_action_type_e.ECT_ACCEPT,I_ECT_REJECT:tsip_action_type_e.ECT_REJECT,I_ECT_LNOTIFY:tsip_action_type_e.ECT_NOTIFY,O_INFO:tsip_action_type_e.INFO,O_BYE:tsip_action_type_e.HANGUP,O_SHUTDOWN:tsip_action_type_e.SHUTDOWN,I_INVITE:10001,O_UPDATE:10002,I_UPDATE:10003,I_CANCEL:10004,I_PRACK:10005,O_PRACK:10006,I_ACK:10007,O_ACK:10008,I_OPTIONS:10009,O_OPTIONS:10010,I_BYE:10011,I_REFER:10012,I_INFO:10013,I_NOTIFY:10014,TIMER_100REL:20001,TIMER_REFRESH:20002,TIMER_RSVP:20003,TIMER_LO_SDP_REQUEST:20004,I_1XX:30001,I_2XX:30002,I_300_to_699:30003,I_401_407:30004,i_422:30005,SHUTDOWN_TIMEDOUT:40001,TRANSPORT_ERROR:40002,ERROR:40003},tsip_dialog_invite_states_e={STARTED:1,OUTGOING:2,INCOMING:3,TRYING:4,RINGING:5,CANCELLING:6,INPROGRESS:7,HOLDING:20,RESUMING:21,O_ECT_INPROGRESS:40,I_ECT_INPROGRESS:41,I_ECT_REQUESTED:42,CONNECTED:60,TERMINATED:61};tsip_dialog_invite.prototype.signal_invite=function(_,e,t,s){var i=new tsip_event_invite(this.get_session(),e,t,s,_);return i.signal()},tsip_dialog_invite.prototype.send_invite=function(_){return this.send_offer(!0,_)},tsip_dialog_invite.prototype.send_update=function(_){return this.send_offer(!1,_)},tsip_dialog_invite.prototype.send_offer=function(_,e){var t=-1,s=null,i=!1;if(!_&&e&&tsk_utils_log_warn("ACK is need to ensure the media session"),s=this.request_new(_?"INVITE":"UPDATE")){if(this.o_action_curr&&tsip_dialog.prototype.ApplyAction(s,this.o_action_curr),(e||_||this.o_msession_mgr&&this.o_msession_mgr.b_state_changed||this.e_state==tsip_dialog_state_e.INITIAL)&&(!this.o_action_curr||!this.o_action_curr.o_payload)){var r=this.o_msession_mgr.get_lo();if(i=null==r,r){var a=r.toString();s.add_content(new String(a),"application/sdp")}}this.stimers.i_timeout&&(this.require.b_timer?s.add_headers(new tsip_header_Session_Expires(this.stimers.i_timeout,!this.stimers.b_is_refresher),new tsip_header_Require("timer")):this.supported.b_timer&&s.add_headers(new tsip_header_Session_Expires(this.stimers.i_timeout,!this.stimers.b_is_refresher),new tsip_header_Supported("timer"))),this.stimers.i_minse&&s.add_headers(new tsip_header_Min_SE(this.stimers.i_minse)),this.require.b_100rel?s.add_headers(new tsip_header_Require("100rel")):this.supported.b_100rel&&s.add_headers(new tsip_header_Supported("100rel")),i?(t=0,this.o_wait_oMessage=s,this.timer_schedule("invite","LoSdpRequest")):(t=this.request_send(s),_&&0==t&&(this.o_last_oInvite=s))}return t},tsip_dialog_invite.prototype.send_ack=function(_){var e=-1,t=null,s=!1;if(t=this.request_new("ACK")){if(this.b_is_client&&this.o_last_oInvite&&!this.o_last_oInvite.has_content()){var i=this.o_msession_mgr.get_lo();if(s=null==i,i){var r=i.toString();t.add_content(new String(r),"application/sdp")}!this.o_msession_mgr.is_started()&&this.o_msession_mgr.has_lo()&&this.o_msession_mgr.has_ro()&&(e=this.o_msession_mgr.start())}return t.o_hdr_CSeq.i_seq=_.o_hdr_CSeq.i_seq,s?(this.o_wait_oMessage=t,this.timer_schedule("invite","LoSdpRequest"),0):this.request_send(t)}return e},tsip_dialog_invite.prototype.send_prack=function(_){if(!_||!_.o_hdr_CSeq)return tsk_utils_log_error("Invalid parameter"),-1;var e,t=null,s=!1;if(e=_.get_header(tsip_header_type_e.RSeq)){if(self.i_rseq&&e.i_value<=this.i_rseq)return tsk_utils_log_warn("1xx.RSeq value is not one higher than lastINVITE.RSeq"),0;this.i_rseq=e.i_value}if(!(t=this.request_new("PRACK")))return tsk_utils_log_error("Failed to create PRACK request"),-2;if(t.add_header(new tsip_header_RAck(this.i_rseq,_.o_hdr_CSeq.i_seq,_.o_hdr_CSeq.s_method)),this.b_is_client&&this.o_last_oInvite&&!this.o_last_oInvite.has_content()){var i=this.o_msession_mgr.get_lo();if(s=null==i,i){var r=i.toString();t.add_content(new String(r),"application/sdp")}}return s?(this.o_wait_oMessage=t,this.timer_schedule("invite","LoSdpRequest"),0):this.request_send(t)},tsip_dialog_invite.prototype.send_response=function(_,e,t,s){var i,r=-1,a=!1;if(i=this.response_new(e,t,_)){if(_.is_invite()||_.is_update()){if(this.require.b_timer?i.add_headers(new tsip_header_Require("timer"),new tsip_header_Session_Expires(this.stimers.i_timeout,tsk_string_iequals(this.stimers.s_refresher,"uas"))):this.supported.b_timer&&i.add_headers(new tsip_header_Supported("timer"),new tsip_header_Session_Expires(this.stimers.i_timeout,tsk_string_iequals(this.stimers.s_refresher,"uas"))),this.stimers.i_minse&&i.add_headers(new tsip_header_Min_SE(this.stimers.i_minse)),422==e&&i.add_headers(new tsip_header_Dummy("Reason",'SIP; cause=422; text="Session Interval Too Small"')),(180==e||183==e)&&this.require.b_100rel&&(0==this.i_rseq&&(this.i_rseq=Math.abs((rand()^rand())+1)),i.add_headers(new tsip_header_Require("100rel"),new tsip_header_RSeq(this.i_rseq)),this.o_last_o1xxrel=i,this.timer_cancel("100Rel"),this.i_timer100Rel=this.get_stack().o_timers.getA(),this.timer_schedule("invite","100Rel")),this.o_msession_mgr&&s){var n=this.o_msession_mgr.get_lo();if(a=null==n,n){var o=n.toString();i.add_content(new String(o),"application/sdp")}}i.add_headers(new tsip_header_Dummy("Allow",TSIP_HEADER_ALLOW_DEFAULT))}else _.is_refer()&&(this.require.b_norefersub&&i.add_headers(new tsip_header_Require("norefersub")),this.supported.b_norefersub&&i.add_headers(new tsip_header_Supported("norefersub")));return a?(this.o_wait_oMessage=i,this.timer_schedule("invite","LoSdpRequest"),0):this.response_send(i)}return r},tsip_dialog_invite.prototype.send_error=function(_,e,t,s){var i;return(i=this.response_new(e,t,_))?(i.add_headers(new tsip_header_Dummy("Reason",s)),this.response_send(i)):(tsk_utils_log_error("Failed to create new message"),-1)},tsip_dialog_invite.prototype.send_bye=function(){var _,e=-1;return(_=this.request_new("BYE"))&&(e=this.request_send(_)),e},tsip_dialog_invite.prototype.send_info=function(_,e){var t,s=-1;return(t=this.request_new("INFO"))&&(_&&e&&t.add_content(new String(_),e),s=this.request_send(t)),s},tsip_dialog_invite.prototype.send_cancel=function(){if(this.o_last_oInvite){var _,e;if(_=new tsip_request("CANCEL",this.o_last_oInvite.line.request.o_uri,null,null,this.o_last_oInvite.o_hdr_Call_ID.s_value,this.o_last_oInvite.o_hdr_CSeq.i_seq)){for(_.o_hdr_firstVia=this.o_last_oInvite.o_hdr_firstVia,_.o_hdr_From=this.o_last_oInvite.o_hdr_From,_.o_hdr_To=this.o_last_oInvite.o_hdr_To,e=0;e<this.o_last_oInvite.ao_headers.length;++e)switch(this.o_last_oInvite.ao_headers[e].e_type){case tsip_header_type_e.Route:case tsip_header_type_e.Proxy_Authorization:case tsip_header_type_e.Authorization:_.ao_headers.push(this.o_last_oInvite.ao_headers[e])}if(this.get_stack().network.e_proxy_cscf_type==tsip_transport_type_e.WS||this.get_stack().network.e_proxy_cscf_type==tsip_transport_type_e.WSS){var t=this.get_stack().__get_proxy_outbound_uri_string();t&&_.add_header(new tsip_header_Dummy("Route",t),!0)}return this.request_send(_)}return tsk_utils_log_error("Failed to create CANCEL request"),-2}return tsk_utils_log_warn("There is no INVITE request to cancel"),0},tsip_dialog_invite.prototype.notify_parent=function(_){var e=this.get_layer_dialog().find_by_ssid(this.get_session().i_id_parent);if(e){var t=new tsip_action(tsip_action_type_e.ECT_NOTIFY);if(t)return e.fsm_act(t.e_type,_,t)}else tsk_utils_log_error("Failed to find parent with id="+this.get_session().i_id_parent);return-1},tsip_dialog_invite.prototype.new_msession_mgr=function(_,e,t,s){var i=new tmedia_session_mgr(_,e,t,s,__tsip_dialog_invite_media_callback,this);return i.set(tmedia_session_mgr.prototype.SetParamSession(i.e_type,"ice-servers",this.get_stack().network.ao_ice_servers),tmedia_session_mgr.prototype.SetParamSession(i.e_type,"cache-stream",this.get_stack().media.b_cache_stream),tmedia_session_mgr.prototype.SetParamSession(i.e_type,"bandwidth",this.get_session().media.o_bandwidth),tmedia_session_mgr.prototype.SetParamSession(i.e_type,"video-size",this.get_session().media.o_video_size),tmedia_session_mgr.prototype.SetParamSession(i.e_type,"audio-constraints",this.get_session().media.o_audio_constraints)),i},tsip_dialog_invite.prototype.process_ro=function(_,e){var t,s,i,r=null,a=0;if(!_)return tsk_utils_log_error("Invalid parameter"),-1;if(_.has_content()){if(!tsk_string_iequals("application/sdp",_.get_content_type()))return tsk_utils_log_error("["+_.get_content_type()+"] content-type is not supportted"),-3;if(!(r=tsdp_message.prototype.Parse(_.get_content_as_string())))return tsk_utils_log_error("Failed to parse remote sdp message"),-2}else{if(this.e_state!=tsip_dialog_state_e.INITIAL||!_.is_invite())return 0;this.get_session().media.e_type=tmedia_defaults_get_media_type()}return i=null==this.o_msession_mgr,t=this.get_session().media.e_type,s=r?r.get_media_type():t,this.o_msession_mgr||(this.get_session().media.e_type=s,this.o_msession_mgr=this.new_msession_mgr(s,this.get_stack().network.s_local_ip,!1,null==r)),r&&(a=this.o_msession_mgr.set_ro(r,e))?(tsk_utils_log_error("Failed to set remote offer"),a):(!i&&t!=s&&this.o_msession_mgr.sdp.o_lo&&this.o_msession_mgr.sdp.o_ro&&(this.get_session().media.e_type=s,this.signal_invite(tsip_event_invite_type_e.M_UPDATED,_.get_response_code(),_.get_response_phrase(),_)),!this.o_msession_mgr.is_started()&&this.o_msession_mgr.has_lo()&&this.o_msession_mgr.has_ro()&&(a=this.o_msession_mgr.start(),0==a&&this.e_state==tsip_dialog_state_e.EARLY&&this.signal_invite(tsip_event_invite_type_e.M_EARLY_MEDIA,_.get_response_code(),_.get_response_phrase(),_)),a)},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/dialogs/tsip_dialog_invite__client.js","src/tinySIP/src/dialogs/tsip_dialog_invite__ect.js","src/tinySIP/src/dialogs/tsip_dialog_invite__hold.js","src/tinySIP/src/dialogs/tsip_dialog_invite__server.js","src/tinySIP/src/dialogs/tsip_dialog_invite__timers.js"),tsip_dialog_invite.prototype.init_client=function(){this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_actions_e.O_INVITE,tsip_dialog_invite_states_e.OUTGOING,c0000_Started_2_Outgoing_X_oINVITE,"c0000_Started_2_Outgoing_X_oINVITE"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.OUTGOING,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2invite,tsip_dialog_invite_states_e.CONNECTED,c0000_Outgoing_2_Connected_X_i2xxINVITE,"c0000_Outgoing_2_Connected_X_i2xxINVITE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.OUTGOING,tsip_dialog_invite_actions_e.I_INVITE,tsip_dialog_invite_states_e.OUTGOING,c0000_Outgoing_2_Outgoing_X_iINVITEorUPDATE,"c0000_Outgoing_2_Outgoing_X_iINVITEorUPDATE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.OUTGOING,tsip_dialog_invite_actions_e.I_UPDATE,tsip_dialog_invite_states_e.OUTGOING,c0000_Outgoing_2_Outgoing_X_iINVITEorUPDATE,"c0000_Outgoing_2_Outgoing_X_iINVITEorUPDATE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.OUTGOING,tsip_dialog_invite_actions_e.O_CANCEL,tsip_dialog_invite_states_e.CANCELLING,c0000_Outgoing_2_Cancelling_X_oCANCEL,"c0000_Outgoing_2_Cancelling_X_oCANCEL"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.CANCELLING,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2cancel,tsip_dialog_invite_states_e.TERMINATED,null,"c0000_Cancelling_2_Terminated_X_i300_to_699"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.CANCELLING,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2cancel,tsip_dialog_invite_states_e.CANCELLING,null,"c0000_Cancelling_2_Cancelling_X_i2xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.CANCELLING,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2invite,tsip_dialog_invite_states_e.TERMINATED,c0000_Cancelling_2_Terminated_X_i300_to_699,"c0000_Cancelling_2_Terminated_X_i300_to_699"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.OUTGOING,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2invite,tsip_dialog_invite_states_e.TERMINATED,c0000_Outgoing_2_Terminated_X_i300_to_i699INVITE,"c0000_Outgoing_2_Terminated_X_i300_to_i699INVITE"))};var x0400_Connected_2_Connected_X_fREFER=null;tsip_dialog_invite.prototype.init_ect=function(){this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.O_ECT,tsip_dialog_invite_states_e.O_ECT_INPROGRESS,x0400_Connected_2_oECTing_X_oECT,"x0400_Connected_2_oECTing_X_oECT"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.O_ECT_INPROGRESS,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2refer,tsip_dialog_invite_states_e.O_ECT_INPROGRESS,x0400_oECTing_2_oECTing_X_i2xx,"x0400_oECTing_2_oECTing_X_i2xx"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.O_ECT_INPROGRESS,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2refer,tsip_dialog_invite_states_e.CONNECTED,x0400_oECTing_2_Connected_X_i3456,"x0400_ECTing_2_Connected_X_i36"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.O_ECT_INPROGRESS,tsip_dialog_invite_actions_e.I_NOTIFY,__tsip_dialog_invite_cond_is_1xx_notify,tsip_dialog_invite_states_e.O_ECT_INPROGRESS,x0400_oECTing_2_oECTing_X_iNOTIFY,"x0400_oECTing_2_oECTing_X_iNOTIFY"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.O_ECT_INPROGRESS,tsip_dialog_invite_actions_e.I_NOTIFY,__tsip_dialog_invite_cond_is_23456_notify,tsip_dialog_invite_states_e.CONNECTED,x0400_oECTing_2_Connected_X_iNOTIFY,"x0400_oECTing_2_Connected_X_iNOTIFY"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.I_REFER,__tsip_dialog_invite_cond_is_f_refer,tsip_dialog_invite_states_e.CONNECTED,x0400_Connected_2_Connected_X_fREFER,"x0400_Connected_2_Connected_X_fREFER"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.I_REFER,tsip_dialog_invite_states_e.I_ECT_REQUESTED,x0400_Connected_2_iECTreq_X_iREFER,"x0400_Connected_2_iECTreq_X_iREFER"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.I_ECT_REQUESTED,tsip_dialog_invite_actions_e.I_ECT_REJECT,tsip_dialog_invite_states_e.CONNECTED,x0400_iECTreq_2_Connected_X_reject,"x0400_iECTreq_2_Connected_X_reject"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.I_ECT_REQUESTED,tsip_dialog_invite_actions_e.I_ECT_ACCEPT,tsip_dialog_invite_states_e.I_ECT_INPROGRESS,x0400_iECTreq_2_iECTing_X_accept,"x0400_iECTreq_2_iECTing_X_accept"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.I_ECT_INPROGRESS,tsip_dialog_invite_actions_e.I_ECT_LNOTIFY,__tsip_dialog_invite_cond_is_1xx_f_notify,tsip_dialog_invite_states_e.I_ECT_INPROGRESS,x0400_iECTing_2_iECTing_X_1xxfNOTIFY,"x0400_iECTing_2_iECTing_X_1xxfNOTIFY"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.I_ECT_INPROGRESS,tsip_dialog_invite_actions_e.I_ECT_LNOTIFY,__tsip_dialog_invite_cond_is_23456_f_notify,tsip_dialog_invite_states_e.CONNECTED,x0400_iECTing_2_Connected_X_23456fNOTIFY,"x0400_iECTing_2_Connected_X_23456fNOTIFY"))},tsip_dialog_invite.prototype.ect_send_notify=function(_,e){var t,s=-1;if(t=this.request_new("NOTIFY")){var i=tsk_string_format("{0} {1} {2}\r\n",tsip_message.prototype.__s_version_default,_,e);t.add_content(i,"message/sipfrag"),s=this.request_send(t),0==s&&this.signal_invite(tsip_event_invite_type_e.O_ECT_NOTIFY,_,e,t)}else tsk_utils_log_error("Failed to create request");return s},tsip_dialog_invite.prototype.ect_send_refer=function(_){var e,t,s=0;if(!_)return tsk_utils_log_error("Invalid parameter"),-1;if(!(t=tsip_uri.prototype.Parse(_)))return tsk_utils_log_error("Failed to parse "+_),-1;if(e=this.request_new("REFER")){var i=new tsip_header_Referred_By(this.get_stack().identity.o_uri_impu);i.add_param("cid",tsk_string_random(11)),e.add_headers(new tsip_header_Refer_To(t),i,new tsip_header_Refer_Sub(this.supported.b_refer_sub)),this.supported.b_norefsub&&e.add_headers(new tsip_header_Supported("norefersub")),s=this.request_send(e)}return s};var x0400_oECTing_2_Connected_X_iNOTIFY=x0400_oECTing_2_oECTing_X_iNOTIFY;tsip_dialog_invite.prototype.init_hold=function(){this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.O_HOLD,tsip_dialog_invite_states_e.HOLDING,x0100_Connected_2_Holding_X_oHold,"x0100_Connected_2_Holding_X_oHold"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.HOLDING,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2invite_or_update,tsip_dialog_invite_states_e.CONNECTED,x0101_Holding_2_Connected_X_ixxx,"x0101_Holding_2_Connected_X_ixxx"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.HOLDING,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2invite_or_update,tsip_dialog_invite_states_e.CONNECTED,x0101_Holding_2_Connected_X_ixxx,"x0101_Holding_2_Connected_X_ixxx"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.CONNECTED,tsip_dialog_invite_actions_e.O_RESUME,tsip_dialog_invite_states_e.RESUMING,x0102_Connected_2_Resuming_X_oResume,"x0102_Connected_2_Resuming_X_oResume"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.RESUMING,tsip_dialog_invite_actions_e.I_2XX,__tsip_dialog_invite_cond_is_resp2invite_or_update,tsip_dialog_invite_states_e.CONNECTED,x0103_Resuming_2_Connected_X_ixxx,"x0103_Resuming_2_Connected_X_ixxx"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.RESUMING,tsip_dialog_invite_actions_e.I_300_to_699,__tsip_dialog_invite_cond_is_resp2invite_or_update,tsip_dialog_invite_states_e.CONNECTED,x0103_Resuming_2_Connected_X_ixxx,"x0103_Resuming_2_Connected_X_ixxx"))},tsip_dialog_invite.prototype.hold_handle=function(_){if(!_||!this.o_msession_mgr||!_.is_invite()&&!_.is_update())return tsk_utils_log_error("Invalid parameter"),-1;var e,t,s=0;return e=this.o_msession_mgr.is_held(this.o_msession_mgr.e_type,!1),t=!_.has_content()&&_.is_invite(),t&&e&&0==(s=this.o_msession_mgr.resume(this.o_msession_mgr.e_type,!1))&&(e=!1),0==s&&e!=this.hold.b_remote&&(this.hold.b_remote=e,this.signal_invite(this.hold.b_remote?tsip_event_invite_type_e.M_REMOTE_HOLD:tsip_event_invite_type_e.M_REMOTE_RESUME,tsip_event_invite_type_e.DIALOG_REQUEST_INCOMING,"Hold/Resume state changed",_)),s},tsip_dialog_invite.prototype.__ao_supported_options=["100rel","timer"],tsip_dialog_invite.prototype.init_server=function(){this.o_fsm.set(tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_actions_e.I_INVITE,__tsip_dialog_invite_cond_is_bad_extension,tsip_dialog_invite_states_e.TERMINATED,s0000_Started_2_Terminated_X_iINVITE,"s0000_Started_2_Terminated_X_iINVITE"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_actions_e.I_INVITE,__tsip_dialog_invite_cond_is_bad_content,tsip_dialog_invite_states_e.TERMINATED,s0000_Started_2_Terminated_X_iINVITE,"s0000_Started_2_Terminated_X_iINVITE"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_actions_e.I_INVITE,__tsip_dialog_invite_cond_is_toosmall,tsip_dialog_invite_states_e.STARTED,s0000_Started_2_Started_X_iINVITE,"s0000_Started_2_Started_X_iINVITE"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_actions_e.I_INVITE,__tsip_dialog_invite_cond_enable_100rel,tsip_dialog_invite_states_e.INPROGRESS,s0000_Started_2_InProgress_X_iINVITE,"s0000_Started_2_InProgress_X_iINVITE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.STARTED,tsip_dialog_invite_actions_e.I_INVITE,tsip_dialog_invite_states_e.RINGING,s0000_Started_2_Ringing_X_iINVITE,"s0000_Started_2_Ringing_X_iINVITE"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.INPROGRESS,tsip_dialog_invite_actions_e.I_PRACK,__tsip_dialog_invite_cond_prack_matched,tsip_dialog_invite_states_e.RINGING,s0000_InProgress_2_Ringing_X_iPRACK,"s0000_InProgress_2_Ringing_X_iPRACK"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.INPROGRESS,tsip_dialog_invite_actions_e.I_UPDATE,tsip_dialog_invite_states_e.INPROGRESS,s0000_InProgress_2_InProgress_X_iUPDATE,"s0000_InProgress_2_InProgress_X_iUPDATE"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.INPROGRESS,tsip_dialog_invite_actions_e.I_CANCEL,tsip_dialog_invite_states_e.TERMINATED,s0000_Inprogress_2_Terminated_X_iCANCEL,"s0000_Inprogress_2_Terminated_X_iCANCEL"),tsk_fsm_entry.prototype.Create(tsip_dialog_invite_states_e.RINGING,tsip_dialog_invite_actions_e.I_PRACK,__tsip_dialog_invite_cond_prack_matched,tsip_dialog_invite_states_e.RINGING,s0000_Ringing_2_Ringing_X_iPRACK,"s0000_Ringing_2_Ringing_X_iPRACK"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.RINGING,tsip_dialog_invite_actions_e.ACCEPT,tsip_dialog_invite_states_e.CONNECTED,s0000_Ringing_2_Connected_X_Accept,"s0000_Ringing_2_Connected_X_Accept"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.RINGING,tsip_dialog_invite_actions_e.REJECT,tsip_dialog_invite_states_e.TERMINATED,s0000_Ringing_2_Terminated_X_Reject,"s0000_Ringing_2_Terminated_X_Reject"),tsk_fsm_entry.prototype.CreateAlways(tsip_dialog_invite_states_e.RINGING,tsip_dialog_invite_actions_e.I_CANCEL,tsip_dialog_invite_states_e.TERMINATED,s0000_Ringing_2_Terminated_X_iCANCEL,"s0000_Ringing_2_Terminated_X_iCANCEL"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_dialog_invite_actions_e.TIMER_100REL,tsk_fsm.prototype.__i_state_any,s0000_Any_2_Any_X_timer100rel,"s0000_Any_2_Any_X_timer100rel"));
},tsip_dialog_register.prototype=Object.create(tsip_dialog.prototype),tsip_dialog_register.prototype.__b_debug_state_machine=!0;var tsip_dialog_register_actions_e={ACCEPT:tsip_action_type_e.ACCEPT,REJECT:tsip_action_type_e.REJECT,HANGUP:tsip_action_type_e.HANGUP,O_REGISTER:tsip_action_type_e.REGISTER,CANCEL:tsip_action_type_e.CANCEL,SHUTDOWN:tsip_action_type_e.SHUTDOWN,I_1XX:10001,I_2XX:10002,I_401_407_421_494:10003,I_423:10004,I_300_to_699:10005,I_REGISTER:2e4,SHUTDOWN_TIMEDOUT:3e4,TRANSPORT_ERROR:30001,ERROR:30002},tsip_dialog_register_states_e={STARTED:0,INPROGRESS:1,INCOMING:2,CONNECTED:3,TERMINATED:4};tsip_dialog_register.prototype.signal_register=function(_,e,t,s){var i=new tsip_event_register(this.get_session(),e,t,s,_);return i.signal()},tsip_dialog_register.prototype.send_register=function(_){var e=null,t=-1;return this.b_unregistering&&(this.i_expires=0),(e=this.request_new("REGISTER"))&&(this.e_state==tsip_dialog_state_e.INITIAL&&e.add_header(new tsip_header_Supported("path")),this.o_action_curr&&tsip_dialog.prototype.ApplyAction(e,this.o_action_curr),0==(t=this.request_send(e))?this.signal(tsip_event_code_e.DIALOG_REQUEST_SENT,tsk_string_format("{0}REGISTER request successfully sent",this.b_unregistering?"un":"")):this.signal(tsip_event_code_e.DIALOG_TRANSPORT_ERROR,"Transport error")),t},tsip_dialog_layer.prototype.find_by_ss=function(_){return _?this.find_by_ssid(_.i_id):(tsk_utils_log_error("Invalid argument"),null)},tsip_dialog_layer.prototype.find_by_ssid=function(_){for(var e=null;this.b_locked;);this.b_locked=!0;for(var t=0;t<this.ao_dialogs.length;++t)if(this.ao_dialogs[t].o_session&&this.ao_dialogs[t].o_session.i_id==_){e=this.ao_dialogs[t];break}return this.b_locked=!1,e},tsip_dialog_layer.prototype.find=function(_,e,t,s){for(var i,r=null,a=!1;this.b_locked;);this.b_locked=!0;for(var n=0;n<this.ao_dialogs.length;++n)if(i=this.ao_dialogs[n],tsk_string_equals(i.s_callid,_)){var o=s==tsip_request_type_e.CANCEL,p=s==tsip_request_type_e.REGISTER,c=s==tsip_request_type_e.NOTIFY;if(a=!0,(o||tsk_string_equals(i.s_tag_local,t))&&(!i.s_tag_remote||tsk_string_equals(i.s_tag_remote,e))){r=i;break}if(p){r=i;break}if(c){r=i;break}}return this.b_locked=!1,new tsip_dialog_layer_find_result(r,a)},tsip_dialog_layer.prototype.dialog_new=function(_,e){for(var t=null;this.b_locked;);switch(this.b_locked=!0,_){case tsip_dialog_type_e.REGISTER:(t=new tsip_dialog_register(e,null))&&this.ao_dialogs.push(t);break;case tsip_dialog_type_e.INVITE:(t=new tsip_dialog_invite(e,null))&&this.ao_dialogs.push(t);break;case tsip_dialog_type_e.MESSAGE:case tsip_dialog_type_e.INFO:case tsip_dialog_type_e.OPTIONS:case tsip_dialog_type_e.PUBLISH:case tsip_dialog_type_e.SUBSCRIBE:default:(t=new tsip_dialog_generic(_,e,null))&&this.ao_dialogs.push(t)}return this.b_locked=!1,t},tsip_dialog_layer.prototype.dialog_remove=function(_){if(_){for(;this.b_locked;);this.b_locked=!0;for(var e=0;e<this.ao_dialogs.length;++e)if(this.ao_dialogs[e]==_){this.ao_dialogs.splice(e,1);break}this.b_locked=!1}},tsip_dialog_layer.prototype.handle_incoming_message=function(_){var e=-1,t=null,s=this.o_stack.o_layer_transac,i=this.find(_.o_hdr_Call_ID.s_value,_.is_response()?_.o_hdr_To.s_tag:_.o_hdr_From.s_tag,_.is_response()?_.o_hdr_From.s_tag:_.o_hdr_To.s_tag,_.is_request()?_.line.request.e_type:tsip_request_type_e.NONE),r=i.b_cid_matched,a=i.o_dialog;if(a){if(_.is_cancel()||_.is_ack())return a.callback(tsip_dialog_event_type_e.I_MSG,_);t=s.transac_new(!1,_,a)}else if(_.is_request()){var n=null,o=null;switch(_.line.request.e_type){case tsip_request_type_e.MESSAGE:(n=new tsip_session_message(this.o_stack,tsip_session.prototype.SetInitialMessage(_)))&&(o=new tsip_dialog_generic(tsip_dialog_type_e.MESSAGE,n,_.o_hdr_Call_ID?_.o_hdr_Call_ID.s_value:null));break;case tsip_request_type_e.INFO:tsk_utils_log_warn("Not implemented");break;case tsip_request_type_e.OPTIONS:break;case tsip_request_type_e.REGISTER:tsk_utils_log_error("Not implemented");break;case tsip_request_type_e.INVITE:(n=new tsip_session_invite(this.o_stack,tsip_session.prototype.SetInitialMessage(_)))&&(o=new tsip_dialog_invite(n,_.o_hdr_Call_ID?_.o_hdr_Call_ID.s_value:null))}o&&(t=s.transac_new(!1,_,o),this.ao_dialogs.push(o))}if(t)e=t.start(_);else if(_.is_request()){var p=this.o_stack.o_layer_transport,c=null;if(p){if(r)c=new tsip_response(482,"Loop Detected (Check your iFCs)",_),c&&!c.o_hdr_To.s_tag&&(c.o_hdr_To.s_tag="tag_doubango");else switch(_.line.request.e_type){case tsip_request_type_e.OPTIONS:c=new tsip_response(200,"OK",_);break;case tsip_request_type_e.INFO:c=new tsip_response(405,"Method Not Allowed",_);break;default:c=new tsip_response(481,"Dialog/Transaction Does Not Exist",_)}c&&(e=p.send(c.o_hdr_firstVia?c.o_hdr_firstVia.s_branch:"no-branch",c))}}return e};var tsip_header_type_e={Accept:{i_id:0,s_name:"Accept"},Accept_Contact:{i_id:1,s_name:"Accept-Contact"},Accept_Encoding:{i_id:2,s_name:"Accept-Encoding"},Accept_Language:{i_id:3,s_name:"Accept-Language"},Accept_Resource_Priority:{i_id:4,s_name:"Accept-Resource-Priority"},Alert_Info:{i_id:5,s_name:"Alert-Info"},Allow:{i_id:6,s_name:"Allow"},Allow_Events:{i_id:7,s_name:"Allow-Events"},Authentication_Info:{i_id:8,s_name:"Authentication-Info"},Authorization:{i_id:9,s_name:"Authorization"},Call_ID:{i_id:10,s_name:"Call-ID"},Call_Info:{i_id:11,s_name:"Call-Info"},Contact:{i_id:12,s_name:"Contact"},Content_Disposition:{i_id:13,s_name:"Content-Disposition"},Content_Encoding:{i_id:14,s_name:"Content-Encoding"},Content_Language:{i_id:15,s_name:"Content-Language"},Content_Length:{i_id:16,s_name:"Content-Length"},Content_Type:{i_id:17,s_name:"Content-Type"},CSeq:{i_id:18,s_name:"CSeq"},Date:{i_id:19,s_name:"Date"},Dummy:{i_id:20,s_name:null},Error_Info:{i_id:21,s_name:"Error-Info"},Event:{i_id:22,s_name:"Event"},Expires:{i_id:23,s_name:"Expires"},From:{i_id:24,s_name:"From"},History_Info:{i_id:25,s_name:"History-Info"},Identity:{i_id:26,s_name:"Identity"},Identity_Info:{i_id:27,s_name:"Identity-Info"},In_Reply_To:{i_id:28,s_name:"In-Reply-To"},Join:{i_id:29,s_name:"Join"},Max_Forwards:{i_id:30,s_name:"Max-Forwards"},MIME_Version:{i_id:31,s_name:"MIME-Version"},Min_Expires:{i_id:32,s_name:"Min-Expires"},Min_SE:{i_id:33,s_name:"Min-SE"},Organization:{i_id:34,s_name:"Organization"},Path:{i_id:35,s_name:"Path"},Priority:{i_id:36,s_name:"Priority"},Privacy:{i_id:37,s_name:"Privacy"},Proxy_Authenticate:{i_id:38,s_name:"Proxy-Authenticate"},Proxy_Authorization:{i_id:39,s_name:"Proxy-Authorization"},Proxy_Require:{i_id:40,s_name:"Proxy-Require"},RAck:{i_id:41,s_name:"RAck"},Reason:{i_id:42,s_name:"Reason"},Record_Route:{i_id:43,s_name:"Record-Route"},Refer_Sub:{i_id:44,s_name:"Refer-Sub"},Refer_To:{i_id:45,s_name:"Refer-To"},Referred_By:{i_id:46,s_name:"Referred-By"},Reject_Contact:{i_id:47,s_name:"Reject-Contact"},Replaces:{i_id:48,s_name:"Replaces"},Reply_To:{i_id:49,s_name:"Reply-To"},Request_Disposition:{i_id:50,s_name:"Request-Disposition"},Require:{i_id:51,s_name:"Require"},Resource_Priority:{i_id:52,s_name:"Resource-Priority"},Retry_After:{i_id:53,s_name:"Retry-After"},Route:{i_id:54,s_name:"Route"},RSeq:{i_id:55,s_name:"RSeq"},Security_Client:{i_id:56,s_name:"Security-Client"},Security_Server:{i_id:57,s_name:"Security-Server"},Security_Verify:{i_id:58,s_name:"Security-Verify"},Server:{i_id:59,s_name:"Server"},Service_Route:{i_id:60,s_name:"Service-Route"},Session_Expires:{i_id:61,s_name:"Session-Expires"},SIP_ETag:{i_id:62,s_name:"SIP-ETag"},SIP_If_Match:{i_id:63,s_name:"SIP-If-Match"},Subject:{i_id:64,s_name:"Subject"},Subscription_State:{i_id:65,s_name:"Subscription-State"},Supported:{i_id:66,s_name:"Supported"},Target_Dialog:{i_id:67,s_name:"Target-Dialog"},Timestamp:{i_id:68,s_name:"Timestamp"},To:{i_id:69,s_name:"To"},Unsupported:{i_id:70,s_name:"Unsupported"},User_Agent:{i_id:71,s_name:"User-Agent"},Via:{i_id:72,s_name:"Via"},Warning:{i_id:73,s_name:"Warning "},WWW_Authenticate:{i_id:74,s_name:"WWW-Authenticate"},P_Access_Network_Info:{i_id:75,s_name:"P-Access-Network-Info"},P_Answer_State:{i_id:76,s_name:"P-Answer-State"},P_Asserted_Identity:{i_id:77,s_name:"P-Asserted-Identity"},P_Associated_URI:{i_id:78,s_name:"P-Associated-URI"},P_Called_Party_ID:{i_id:79,s_name:"P-Called-Party-ID"},P_Charging_Function_Addresses:{i_id:80,s_name:"P-Charging-Function-Addresses"},P_Charging_Vector:{i_id:81,s_name:"P-Charging-Vector"},P_DCS_Billing_Info:{i_id:82,s_name:"P-DCS-Billing-Info"},P_DCS_LAES:{i_id:83,s_name:"P-DCS-LAES"},P_DCS_OSPS:{i_id:84,s_name:"P-DCS-OSPS"},P_DCS_Redirect:{i_id:85,s_name:"P-DCS-Redirect"},P_DCS_Trace_Party_ID:{i_id:86,s_name:"P-DCS-Trace-Party-ID"},P_Early_Media:{i_id:87,s_name:"P-Early-Media"},P_Media_Authorization:{i_id:88,s_name:"P-Media-Authorization"},P_Preferred_Identity:{i_id:89,s_name:"P-Preferred-Identity"},P_Profile_Key:{i_id:90,s_name:"P-Profile-Key"},P_User_Database:{i_id:91,s_name:"P-User-Database"},P_Visited_Network_ID:{i_id:92,s_name:"P-Visited-Network-ID"}};tsip_header.prototype.get_name=function(){return this.e_type.i_id==tsip_header_type_e.Dummy.i_id?this.s_name:this.e_type.s_name},tsip_header.prototype.get_param_separator=function(){switch(this.e_type){case tsip_header_type_e.Authorization:case tsip_header_type_e.Proxy_Authorization:case tsip_header_type_e.Proxy_Authenticate:case tsip_header_type_e.WWW_Authenticate:return",";default:return";"}},tsip_header.prototype.add_param=function(_,e){tsk_params_add(this.ao_params,_,e)},tsip_header.prototype.tostring_full=function(){var _,e=tsk_string_format("{0}: ",this.get_name());e+=this;for(var t=0;t<this.ao_params.length;++t)_=this.get_param_separator(),e+=tsk_string_format("{0}{1}",_,tsk_param_tostring(this.ao_params[t]));return e+="\r\n"},tsip_header.prototype.IndexOfByType=function(_,e){if(_)for(var t=0;t<_.length;++t)if(_[t].e_type.i_id==e.i_id)return t;return-1},tsip_header.prototype.IndexOfByName=function(_,e){if(_&&e)for(var t=e.toLowerCase(),s=0;s<_.length;++s){var i=_[s].get_name();if(i&&i.toLowerCase()==t)return s}return-1},tsip_header.prototype.FindByType=function(_,e){if(_)for(var t=0;t<_.length;++t)if(_[t].e_type.i_id==e.i_id)return _[t];return null},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/headers/tsip_header_Int.js","src/tinySIP/src/headers/tsip_header_NameAddr.js","src/tinySIP/src/headers/tsip_header_Str.js","src/tinySIP/src/headers/tsip_header_StrArray.js","src/tinySIP/src/headers/tsip_header_Authorization.js","src/tinySIP/src/headers/tsip_header_Contact.js","src/tinySIP/src/headers/tsip_header_Content_Type.js","src/tinySIP/src/headers/tsip_header_CSeq.js","src/tinySIP/src/headers/tsip_header_RAck.js","src/tinySIP/src/headers/tsip_header_Refer_Sub.js","src/tinySIP/src/headers/tsip_header_Session_Expires.js","src/tinySIP/src/headers/tsip_header_Subscription_State.js","src/tinySIP/src/headers/tsip_header_Via.js","src/tinySIP/src/headers/tsip_header_WWW_Authenticate.js");var TSIP_HEADER_MAX_FORWARDS_DEFAULT=70;tsip_header_Int.prototype=Object.create(tsip_header.prototype),tsip_header_Content_Length.prototype=Object.create(tsip_header_Int.prototype),tsip_header_Expires.prototype=Object.create(tsip_header_Int.prototype),tsip_header_Max_Forwards.prototype=Object.create(tsip_header_Int.prototype),tsip_header_Min_Expires.prototype=Object.create(tsip_header_Int.prototype),tsip_header_Min_SE.prototype=Object.create(tsip_header_Int.prototype),tsip_header_RSeq.prototype=Object.create(tsip_header_Int.prototype),_tsip_machine_parser_header_Int_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9],_tsip_machine_parser_header_Int_key_offsets=[0,0,10,12,14,16,18,20,22,23,25,27,29,31,33,35,38,41,46,47,49,53,60,65,66,68,72,89,90,92,108,126,132,133,135,140,159,160,162,181,182,184,187,195,196,198,203,204,210,227,234,242,250,258,260,267,276,278,281,283,286,288,291,294,295,298,299,302,303,312,321,329,337,345,353,355,361,370,379,388,390,393,396,397,398,400,402,404,406,408,410,413,417,419,420,422,424,426,428,430,432,434,436,439,441,442,446,448,450,452,454,456,458,461,463,466,468,470,472,475],_tsip_machine_parser_header_Int_trans_keys=[67,69,76,77,82,99,101,108,109,114,79,111,78,110,84,116,69,101,78,110,84,116,45,76,108,69,101,78,110,71,103,84,116,72,104,9,32,58,9,32,58,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,44,59,48,57,9,13,32,44,59,10,9,32,9,32,44,59,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,44,59,10,0,9,11,12,14,127,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,88,120,80,112,73,105,82,114,69,101,83,115,9,32,58,65,73,97,105,88,120,45,70,102,79,111,82,114,87,119,65,97,82,114,68,100,83,115,9,32,58,78,110,45,69,83,101,115,88,120,80,112,73,105,82,114,69,101,83,115,9,32,58,69,101,9,32,58,83,115,69,101,81,113,9,32,58,0],_tsip_machine_parser_header_Int_single_lengths=[0,10,2,2,2,2,2,2,1,2,2,2,2,2,2,3,3,3,1,2,2,5,5,1,2,4,7,1,2,6,10,6,1,2,5,9,1,2,9,1,2,3,4,1,2,5,1,0,9,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,2,2,2,2,2,2,3,4,2,1,2,2,2,2,2,2,2,2,3,2,1,4,2,2,2,2,2,2,3,2,3,2,2,2,3,0],_tsip_machine_parser_header_Int_range_lengths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,5,0,0,5,4,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,4,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_header_Int_index_offsets=[0,0,11,14,17,20,23,26,29,31,34,37,40,43,46,49,53,57,62,64,67,71,78,84,86,89,94,107,109,112,124,139,146,148,151,157,172,174,177,192,194,197,201,208,210,213,219,221,225,239,244,250,256,262,265,270,277,279,282,284,287,289,292,295,297,300,302,305,307,314,321,327,333,339,345,348,352,359,366,373,375,378,381,383,385,388,391,394,397,400,403,407,412,415,417,420,423,426,429,432,435,438,441,445,448,450,455,458,461,464,467,470,473,477,480,484,487,490,493,497],_tsip_machine_parser_header_Int_indicies=[0,2,3,4,5,0,2,3,4,5,1,6,6,1,7,7,1,8,8,1,9,9,1,10,10,1,11,11,1,12,1,13,13,1,14,14,1,15,15,1,16,16,1,17,17,1,3,3,1,18,18,19,1,20,20,21,1,21,22,21,23,1,24,1,25,25,1,25,25,23,1,26,27,26,28,28,29,1,30,31,30,32,32,1,33,1,34,34,1,34,34,32,32,1,32,35,32,36,36,36,36,36,36,36,36,36,1,37,1,38,38,1,38,38,36,36,36,36,36,36,36,36,36,1,39,40,39,41,41,41,42,42,43,41,41,41,41,41,1,44,45,44,32,32,43,1,46,1,47,47,1,47,47,32,32,43,1,43,48,43,49,50,49,49,51,49,49,49,49,49,49,1,52,1,53,53,1,53,54,53,49,50,49,49,51,49,49,49,49,49,49,1,55,1,56,56,1,56,56,50,1,50,57,58,59,50,50,1,60,1,50,50,1,61,40,61,42,42,1,62,1,50,50,50,1,61,40,61,49,49,49,42,42,49,49,49,49,49,1,64,63,63,63,1,66,58,65,65,65,1,66,58,67,67,67,1,66,58,68,68,68,1,66,58,1,70,69,63,63,1,71,66,58,72,65,65,1,73,1,74,75,1,76,1,77,78,1,79,1,58,80,1,58,81,1,58,1,77,82,1,77,1,74,83,1,74,1,71,66,58,84,67,67,1,71,66,58,68,68,68,1,86,58,85,85,85,1,88,58,87,87,87,1,88,58,89,89,89,1,88,58,90,90,90,1,88,58,1,91,85,85,1,71,88,58,92,87,87,1,71,88,58,93,89,89,1,71,88,58,90,90,90,1,94,1,71,95,1,71,96,1,71,1,70,1,97,97,1,98,98,1,99,99,1,100,100,1,101,101,1,102,102,1,103,103,104,1,105,106,105,106,1,107,107,1,108,1,109,109,1,110,110,1,111,111,1,112,112,1,113,113,1,114,114,1,115,115,1,116,116,1,117,117,118,1,119,119,1,120,1,121,122,121,122,1,123,123,1,124,124,1,125,125,1,126,126,1,127,127,1,128,128,1,129,129,130,1,131,131,1,132,132,133,1,134,134,1,135,135,1,136,136,1,137,137,138,1,1,0],_tsip_machine_parser_header_Int_trans_targs=[2,0,84,15,91,115,3,4,5,6,7,8,9,10,11,12,13,14,16,17,16,17,18,21,19,20,22,46,26,21,22,23,26,24,25,27,30,28,29,31,46,30,26,35,31,32,33,34,36,48,42,49,37,38,39,40,41,43,45,47,44,22,119,50,83,51,54,52,53,55,70,56,68,57,58,66,59,60,64,61,62,63,65,67,69,71,79,72,75,73,74,76,77,78,80,81,82,85,86,87,88,89,90,16,17,92,103,93,94,95,96,97,98,99,100,101,102,16,17,104,105,106,113,107,108,109,110,111,112,16,17,114,16,17,116,117,118,16,17],_tsip_machine_parser_header_Int_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,0,0,0,1,0,0,3,3,3,0,0,0,0,0,0,0,1,0,0,5,5,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0,0,0,0,0,0,0,0,13,13,0,15,15,0,0,0,17,17],tsip_machine_parser_header_Int_start=1,tsip_machine_parser_header_Int_first_final=119,tsip_machine_parser_header_Int_error=0,tsip_machine_parser_header_Int_en_main=1,tsip_header_Int.prototype.toString=function(){return"undefined"==typeof this.i_value?null:this.i_value.toString()},tsip_header_Int.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=null;t=tsip_machine_parser_header_Int_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Int_key_offsets[t],o=_tsip_machine_parser_header_Int_index_offsets[t],n=_tsip_machine_parser_header_Int_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Int_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Int_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Int_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Int_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Int_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Int_indicies[o],t=_tsip_machine_parser_header_Int_trans_targs[o],0!=_tsip_machine_parser_header_Int_trans_actions[o])for(c=_tsip_machine_parser_header_Int_trans_actions[o],d=_tsip_machine_parser_header_Int_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Int_actions[c-1]){case 0:e=s;break;case 1:a&&(a.i_value=tsk_ragel_parser_get_int(_,s,e));break;case 2:a&&tsk_ragel_add_param(_,s,e,a.ao_params);break;case 3:a=new tsip_header_Content_Length;break;case 4:a=new tsip_header_Expires;break;case 5:a=new tsip_header_Max_Forwards;break;case 6:a=new tsip_header_Min_Expires;break;case 7:a=new tsip_header_Min_SE;break;case 8:a=new tsip_header_RSeq;break;case 9:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 119>t?(tsk_utils_log_error("Failed to parse header: "+_),null):a},tsip_header_NameAddr.prototype=Object.create(tsip_header.prototype),tsip_header_NameAddr.prototype.s_display_name=null,tsip_header_NameAddr.prototype.o_uri=null,tsip_header_NameAddr.prototype.s_tag=null,tsip_header_From.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_To.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_Refer_To.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_Referred_By.prototype=Object.create(tsip_header_NameAddr.prototype),_tsip_machine_parser_header_NameAddr_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9],_tsip_machine_parser_header_NameAddr_key_offsets=[0,0,8,11,14,35,36,38,59,60,62,65,69,81,84,86,89,93,97,98,100,103,122,123,125,143,162,167,168,170,174,193,194,196,215,216,218,221,229,230,232,236,237,243,261,268,276,284,292,294,301,310,312,315,317,320,322,325,328,329,332,333,336,337,346,355,363,371,379,387,389,395,404,413,422,424,427,430,431,432,453,474,493,498,499,501,505,524,525,527,546,564,581,599,603,604,606,614,615,617,621,627,647,666,671,673,679,684,686,688,691,696,698,700,702,705,707,709,712,714,716,717,719,721,726,729],_tsip_machine_parser_header_NameAddr_trans_keys=[66,70,82,84,98,102,114,116,9,32,58,9,32,58,9,13,32,33,34,37,39,60,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,13,32,33,34,37,39,60,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,32,60,65,90,97,122,9,32,43,58,45,46,48,57,65,90,97,122,9,32,58,0,65535,62,0,65535,9,13,32,59,9,13,32,59,10,9,32,9,32,59,9,13,32,33,37,39,84,116,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,84,116,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,59,10,0,9,11,12,14,127,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,59,61,65,97,126,42,43,45,46,48,57,66,90,95,122,9,13,32,33,37,39,59,61,71,103,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,60,10,9,32,9,13,34,92,32,126,128,255,10,9,32,9,13,32,60,0,9,11,12,14,127,9,13,32,33,37,39,42,43,58,126,45,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,58,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,58,60,0,65535,9,13,32,59,0,65535,9,32,58,82,114,79,111,77,109,9,32,58,9,32,58,69,101,70,102,69,101,82,114,45,82,114,84,116,79,111,9,32,58,69,101,68,100,45,66,98,89,121,9,32,58,79,111,9,32,58,0],_tsip_machine_parser_header_NameAddr_single_lengths=[0,8,3,3,9,1,2,9,1,2,3,0,4,3,0,1,4,4,1,2,3,9,1,2,8,9,5,1,2,4,9,1,2,9,1,2,3,4,1,2,4,1,0,8,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,11,11,9,5,1,2,4,9,1,2,9,8,7,8,4,1,2,4,1,2,4,0,10,9,5,0,4,5,2,2,3,5,2,2,2,3,2,2,3,2,2,1,2,2,5,3,0],_tsip_machine_parser_header_NameAddr_range_lengths=[0,0,0,0,6,0,0,6,0,0,0,2,4,0,1,1,0,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,5,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,5,5,5,0,0,0,0,5,0,0,5,5,5,5,0,0,0,2,0,0,0,3,5,5,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_header_NameAddr_index_offsets=[0,0,9,13,17,33,35,38,54,56,59,63,66,75,79,81,84,89,94,96,99,103,118,120,123,137,152,158,160,163,168,183,185,188,203,205,208,212,219,221,224,229,231,235,249,254,260,266,272,275,280,287,289,292,294,297,299,302,305,307,310,312,315,317,324,331,337,343,349,355,358,362,369,376,383,385,388,391,393,395,412,429,444,450,452,455,460,475,477,480,495,509,522,536,541,543,546,553,555,558,563,567,583,598,604,606,612,618,621,624,628,634,637,640,643,647,650,653,657,660,663,665,668,671,677,681],_tsip_machine_parser_header_NameAddr_indicies=[0,2,3,4,0,2,3,4,1,5,5,6,1,7,7,8,1,8,9,8,10,11,10,10,12,10,10,10,10,13,10,13,1,14,1,15,15,1,15,16,15,10,11,10,10,12,10,10,10,10,13,10,13,1,17,1,18,18,1,18,18,12,1,19,19,1,20,20,21,22,21,21,21,21,1,20,20,22,1,23,1,24,23,1,25,26,25,27,1,25,28,25,27,1,29,1,30,30,1,30,30,27,1,27,31,27,32,32,32,33,33,32,32,32,32,32,32,1,34,1,35,35,1,35,35,32,32,32,33,33,32,32,32,32,32,32,1,36,37,36,38,38,38,39,40,38,38,38,38,38,38,1,41,42,41,27,40,1,43,1,44,44,1,44,44,27,40,1,40,45,40,46,47,46,46,48,46,46,46,46,46,46,1,49,1,50,50,1,50,51,50,46,47,46,46,48,46,46,46,46,46,46,1,52,1,53,53,1,53,53,47,1,47,54,55,56,47,47,1,57,1,47,47,1,58,37,58,39,1,59,1,47,47,47,1,58,37,58,46,46,46,39,46,46,46,46,46,46,1,61,60,60,60,1,63,55,62,62,62,1,63,55,64,64,64,1,63,55,65,65,65,1,63,55,1,67,66,60,60,1,68,63,55,69,62,62,1,70,1,71,72,1,73,1,74,75,1,76,1,55,77,1,55,78,1,55,1,74,79,1,74,1,71,80,1,71,1,68,63,55,81,64,64,1,68,63,55,65,65,65,1,83,55,82,82,82,1,85,55,84,84,84,1,85,55,86,86,86,1,85,55,87,87,87,1,85,55,1,88,82,82,1,68,85,55,89,84,84,1,68,85,55,90,86,86,1,68,85,55,87,87,87,1,91,1,68,92,1,68,93,1,68,1,67,1,36,37,36,38,38,38,39,40,94,94,38,38,38,38,38,38,1,36,37,36,38,38,38,39,40,95,95,38,38,38,38,38,38,1,96,37,96,38,38,38,39,97,38,38,38,38,38,38,1,98,99,98,27,97,1,100,1,101,101,1,101,101,27,97,1,97,102,97,103,47,103,103,48,103,103,103,103,103,103,1,104,1,105,105,1,105,51,105,103,47,103,103,48,103,103,103,103,103,103,1,106,107,106,108,108,108,109,108,108,108,108,108,108,1,110,111,110,112,112,112,112,112,112,112,112,112,1,113,114,113,112,112,112,115,112,112,112,112,112,112,1,116,16,116,12,1,117,1,110,110,1,118,119,120,121,118,118,1,122,1,118,118,1,113,114,113,115,1,118,118,118,1,123,111,123,112,112,112,112,124,125,112,124,124,124,112,124,1,126,114,126,112,112,112,125,115,112,112,112,112,112,112,1,127,16,127,125,12,1,128,1,129,130,129,131,128,1,132,132,133,134,134,1,135,135,1,136,136,1,132,132,133,1,137,137,138,139,139,1,140,140,1,141,141,1,142,142,1,143,144,144,1,145,145,1,146,146,1,137,137,138,1,147,147,1,148,148,1,149,1,150,150,1,0,0,1,151,151,152,153,153,1,151,151,152,1,1,0],_tsip_machine_parser_header_NameAddr_trans_targs=[2,0,106,110,123,3,4,3,4,5,91,96,11,101,6,7,8,9,10,12,13,12,14,15,16,17,41,21,18,19,20,22,25,79,23,24,26,41,25,21,30,26,27,28,29,31,43,37,44,32,33,34,35,36,38,40,42,39,17,125,45,78,46,49,47,48,50,65,51,63,52,53,61,54,55,59,56,57,58,60,62,64,66,74,67,70,68,69,71,72,73,75,76,77,80,81,82,86,82,83,84,85,87,90,88,89,17,41,90,21,92,94,91,93,8,11,93,95,96,97,99,100,98,102,101,104,103,103,105,17,41,21,3,4,107,108,109,3,4,111,112,113,114,115,118,116,117,119,120,121,122,3,4,124],_tsip_machine_parser_header_NameAddr_trans_actions=[0,0,0,0,0,17,17,0,0,0,1,1,0,1,0,0,0,0,0,1,0,0,0,0,3,0,0,0,0,0,0,0,1,1,0,0,9,9,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,1,0,0,7,7,0,7,0,0,0,5,5,5,0,0,0,0,0,0,0,0,0,0,5,0,0,3,3,3,11,11,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,13,13,0],tsip_machine_parser_header_NameAddr_start=1,tsip_machine_parser_header_NameAddr_first_final=125,tsip_machine_parser_header_NameAddr_error=0,tsip_machine_parser_header_NameAddr_en_main=1,tsip_header_NameAddr.prototype.toString=function(){var _=tsip_uri_tostring(this.o_uri,!0,!0);return _&&this.s_tag&&(_+=tsk_string_format(";tag={0}",this.s_tag)),_},tsip_header_NameAddr.prototype.Parse=function(_){var e,t,s=0,i=0,r=_.length,a=tsk_buff_str2ib(_);s=tsip_machine_parser_header_NameAddr_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(i==r){l=g;continue}if(0==s){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_NameAddr_key_offsets[s],o=_tsip_machine_parser_header_NameAddr_index_offsets[s],n=_tsip_machine_parser_header_NameAddr_single_lengths[s],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),a[i]<_tsip_machine_parser_header_NameAddr_trans_keys[_mid])_upper=_mid-1;else{if(!(a[i]>_tsip_machine_parser_header_NameAddr_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_NameAddr_range_lengths[s],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),a[i]<_tsip_machine_parser_header_NameAddr_trans_keys[_mid])_upper=_mid-2;else{if(!(a[i]>_tsip_machine_parser_header_NameAddr_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_NameAddr_indicies[o],s=_tsip_machine_parser_header_NameAddr_trans_targs[o],0!=_tsip_machine_parser_header_NameAddr_trans_actions[o])for(c=_tsip_machine_parser_header_NameAddr_trans_actions[o],d=_tsip_machine_parser_header_NameAddr_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_NameAddr_actions[c-1]){case 0:e=i;break;case 1:if(t&&!t.o_uri){var f=tsk_ragel_parser_get_string(_,i,e);(t.o_uri=tsip_uri.prototype.Parse(f))&&t.s_display_name&&(t.o_uri.s_display_name=tsk_strdup(t.s_display_name))}break;case 2:t&&(t.s_display_name=tsk_ragel_parser_get_string(_,i,e),t.s_display_name=tsk_string_unquote_2(t.s_display_name));break;case 3:t&&(t.s_tag=tsk_ragel_parser_get_string(_,i,e));break;case 4:tsk_ragel_add_param(_,i,e,t.ao_params);break;case 5:t=new tsip_header_From;break;case 6:t=new tsip_header_To;break;case 7:t=new tsip_header_Refer_To;break;case 8:t=new tsip_header_Referred_By;break;case 9:}if(_trigger_goto)continue}if(m>=l){if(0==s){l=y;continue}if(i+=1,i!=r){l=h;continue}}if(y>=l)break}return 125>s?(tsk_utils_log_error("Failed to parse header: "+_),null):t},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/headers/tsip_header_NameAddrArray.js"),tsip_header_P_Asserted_Identity.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_P_Associated_URI.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_P_Preferred_Identity.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_Path.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_Record_Route.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_Route.prototype=Object.create(tsip_header_NameAddr.prototype),tsip_header_Service_Route.prototype=Object.create(tsip_header_NameAddr.prototype),_tsip_machine_parser_header_NameAddrArray_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9,1,10,1,11,1,12,1,13,2,1,0,2,3,5],_tsip_machine_parser_header_NameAddrArray_key_offsets=[0,0,6,9,13,15,17,21,23,25,27,29,30,32,34,36,38,40,42,44,46,49,52,73,74,76,97,98,100,103,107,119,122,124,127,132,137,138,140,144,161,162,164,180,198,204,205,207,212,231,232,234,253,254,256,259,267,268,270,275,276,282,299,306,314,322,330,332,339,348,350,353,355,358,360,363,366,367,370,371,374,375,384,393,401,409,417,425,427,433,442,451,460,462,465,468,469,470,487,505,509,510,512,520,521,523,527,533,553,572,577,579,586,588,590,592,594,596,598,599,601,603,605,608,610,612,614,616,618,620,622,624,625,627,629,631,633,635,637,639,641,644,646,648,651,655,657,659,661,663,664,666,668,670,672,674,677,679,681,683,686,688,690,692,694,696,698,699,701,703,705,707,709,712],_tsip_machine_parser_header_NameAddrArray_trans_keys=[80,82,83,112,114,115,45,65,97,65,80,97,112,83,115,83,115,69,79,101,111,82,114,84,116,69,101,68,100,45,73,105,68,100,69,101,78,110,84,116,73,105,84,116,89,121,9,32,58,9,32,58,9,13,32,33,34,37,39,60,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,13,32,33,34,37,39,60,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,32,60,65,90,97,122,9,32,43,58,45,46,48,57,65,90,97,122,9,32,58,0,65535,62,0,65535,9,13,32,44,59,9,13,32,44,59,10,9,32,9,32,44,59,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,44,59,10,0,9,11,12,14,127,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,60,10,9,32,9,13,34,92,32,126,128,255,10,9,32,9,13,32,60,0,9,11,12,14,127,9,13,32,33,37,39,42,43,58,126,45,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,58,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,58,60,0,65535,9,13,32,44,59,0,65535,67,99,73,105,65,97,84,116,69,101,68,100,45,85,117,82,114,73,105,9,32,58,82,114,69,101,70,102,69,101,82,114,82,114,69,101,68,100,45,73,105,68,100,69,101,78,110,84,116,73,105,84,116,89,121,9,32,58,84,116,72,104,9,32,58,69,79,101,111,67,99,79,111,82,114,68,100,45,82,114,79,111,85,117,84,116,69,101,9,32,58,85,117,84,116,69,101,9,32,58,69,101,82,114,86,118,73,105,67,99,69,101,45,82,114,79,111,85,117,84,116,69,101,9,32,58,0],
_tsip_machine_parser_header_NameAddrArray_single_lengths=[0,6,3,4,2,2,4,2,2,2,2,1,2,2,2,2,2,2,2,2,3,3,9,1,2,9,1,2,3,0,4,3,0,1,5,5,1,2,4,7,1,2,6,10,6,1,2,5,9,1,2,9,1,2,3,4,1,2,5,1,0,9,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,7,8,4,1,2,4,1,2,4,0,10,9,5,0,5,2,2,2,2,2,2,1,2,2,2,3,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,3,2,2,3,4,2,2,2,2,1,2,2,2,2,2,3,2,2,2,3,2,2,2,2,2,2,1,2,2,2,2,2,3,0],_tsip_machine_parser_header_NameAddrArray_range_lengths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,0,0,0,2,4,0,1,1,0,0,0,0,0,5,0,0,5,4,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,4,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,5,5,0,0,0,2,0,0,0,3,5,5,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_header_NameAddrArray_index_offsets=[0,0,7,11,16,19,22,27,30,33,36,39,41,44,47,50,53,56,59,62,65,69,73,89,91,94,110,112,115,119,122,131,135,137,140,146,152,154,157,162,175,177,180,192,207,214,216,219,225,240,242,245,260,262,265,269,276,278,281,287,289,293,307,312,318,324,330,333,338,345,347,350,352,355,357,360,363,365,368,370,373,375,382,389,395,401,407,413,416,420,427,434,441,443,446,449,451,453,466,480,485,487,490,497,499,502,507,511,527,542,548,550,557,560,563,566,569,572,575,577,580,583,586,590,593,596,599,602,605,608,611,614,616,619,622,625,628,631,634,637,640,644,647,650,654,659,662,665,668,671,673,676,679,682,685,688,692,695,698,701,705,708,711,714,717,720,723,725,728,731,734,737,740,744],_tsip_machine_parser_header_NameAddrArray_indicies=[0,2,3,0,2,3,1,4,5,5,1,6,7,6,7,1,8,8,1,9,9,1,10,11,10,11,1,12,12,1,13,13,1,14,14,1,15,15,1,16,1,17,17,1,18,18,1,19,19,1,20,20,1,21,21,1,22,22,1,23,23,1,24,24,1,25,25,26,1,27,27,28,1,29,30,29,31,32,31,31,33,31,31,31,31,34,31,34,1,35,1,36,36,1,37,38,37,31,32,31,31,33,31,31,31,31,34,31,34,1,39,1,40,40,1,40,40,41,1,42,42,1,43,43,44,45,44,44,44,44,1,43,43,45,1,46,1,47,46,1,48,49,48,50,51,1,52,53,52,28,54,1,55,1,56,56,1,56,56,28,54,1,54,57,54,58,58,58,58,58,58,58,58,58,1,59,1,60,60,1,60,60,58,58,58,58,58,58,58,58,58,1,61,62,61,63,63,63,64,65,66,63,63,63,63,63,1,67,68,67,28,54,66,1,69,1,70,70,1,70,70,28,54,66,1,66,71,66,72,73,72,72,74,72,72,72,72,72,72,1,75,1,76,76,1,76,77,76,72,73,72,72,74,72,72,72,72,72,72,1,78,1,79,79,1,79,79,73,1,73,80,81,82,73,73,1,83,1,73,73,1,84,62,84,64,65,1,85,1,73,73,73,1,84,62,84,72,72,72,64,65,72,72,72,72,72,1,87,86,86,86,1,89,81,88,88,88,1,89,81,90,90,90,1,89,81,91,91,91,1,89,81,1,93,92,86,86,1,94,89,81,95,88,88,1,96,1,97,98,1,99,1,100,101,1,102,1,81,103,1,81,104,1,81,1,100,105,1,100,1,97,106,1,97,1,94,89,81,107,90,90,1,94,89,81,91,91,91,1,109,81,108,108,108,1,111,81,110,110,110,1,111,81,112,112,112,1,111,81,113,113,113,1,111,81,1,114,108,108,1,94,111,81,115,110,110,1,94,111,81,116,112,112,1,94,111,81,113,113,113,1,117,1,94,118,1,94,119,1,94,1,93,1,120,121,120,122,122,122,122,122,122,122,122,122,1,123,124,123,122,122,122,125,122,122,122,122,122,122,1,126,127,126,41,1,128,1,120,120,1,129,130,131,132,129,129,1,133,1,129,129,1,123,124,123,125,1,129,129,129,1,134,121,134,122,122,122,122,135,136,122,135,135,135,122,135,1,137,124,137,122,122,122,136,125,122,122,122,122,122,122,1,138,127,138,136,41,1,139,1,140,141,140,142,143,139,1,144,144,1,145,145,1,146,146,1,147,147,1,148,148,1,149,149,1,150,1,151,151,1,152,152,1,153,153,1,154,154,155,1,156,156,1,157,157,1,158,158,1,159,159,1,160,160,1,161,161,1,162,162,1,163,163,1,164,1,165,165,1,166,166,1,167,167,1,168,168,1,169,169,1,170,170,1,171,171,1,172,172,1,173,173,174,1,175,175,1,176,176,1,177,177,178,1,179,180,179,180,1,181,181,1,182,182,1,183,183,1,184,184,1,185,1,186,186,1,187,187,1,188,188,1,189,189,1,190,190,1,191,191,192,1,193,193,1,194,194,1,195,195,1,196,196,197,1,198,198,1,199,199,1,200,200,1,201,201,1,202,202,1,203,203,1,204,1,205,205,1,206,206,1,207,207,1,208,208,1,209,209,1,210,210,211,1,1,0],_tsip_machine_parser_header_NameAddrArray_trans_targs=[2,0,144,160,3,141,4,123,5,6,7,112,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,21,22,22,23,97,102,29,107,24,25,25,26,27,28,29,30,31,30,32,33,34,35,59,22,39,35,36,39,37,38,40,43,41,42,44,59,43,22,39,48,44,45,46,47,49,61,55,62,50,51,52,53,54,56,58,60,57,35,173,63,96,64,67,65,66,68,83,69,81,70,71,79,72,73,77,74,75,76,78,80,82,84,92,85,88,86,87,89,90,91,93,94,95,98,100,97,99,26,29,99,26,101,102,103,105,106,104,108,107,110,109,109,111,35,59,22,39,113,114,115,116,117,118,119,120,121,122,21,22,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,21,22,142,143,21,22,145,156,146,147,148,149,150,151,152,153,154,155,21,22,157,158,159,21,22,161,162,163,164,165,166,167,168,169,170,171,172,21,22],_tsip_machine_parser_header_NameAddrArray_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,13,0,0,3,3,29,29,3,29,0,0,3,3,0,0,0,1,0,0,0,0,7,11,11,11,11,0,0,0,0,0,0,1,0,0,9,9,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,0,0,0,0,0,0,0,0,0,0,0,5,0,0,32,32,32,32,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,19,19,0,0,0,0,0,0,0,0,0,0,0,0,21,21,0,0,0,23,23,0,0,0,0,0,0,0,0,0,0,0,0,25,25],tsip_machine_parser_header_NameAddrArray_start=1,tsip_machine_parser_header_NameAddrArray_first_final=173,tsip_machine_parser_header_NameAddrArray_error=0,tsip_machine_parser_header_NameAddrArray_en_main=1,tsip_header_P_Asserted_Identity.prototype.Parse=tsip_header_P_Associated_URI.prototype.Parse=tsip_header_P_Preferred_Identity.prototype.Parse=tsip_header_Path.prototype.Parse=tsip_header_Record_Route.prototype.Parse=tsip_header_Route.prototype.Parse=tsip_header_Service_Route.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new Array,n=null,o=null;t=tsip_machine_parser_header_NameAddrArray_start;var p,c,d,l,h,u,m,g,y,f,E;for(p=c=d=l=h=null,u=0,m=10,g=15,y=20,f=30,E=40;;){if(_trigger_goto=!1,0>=u){if(s==i){u=f;continue}if(0==t){u=E;continue}}if(m>=u){d=_tsip_machine_parser_header_NameAddrArray_key_offsets[t],c=_tsip_machine_parser_header_NameAddrArray_index_offsets[t],p=_tsip_machine_parser_header_NameAddrArray_single_lengths[t],_break_match=!1;do{if(p>0){for(_lower=d,_upper=d+p-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_NameAddrArray_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_NameAddrArray_trans_keys[_mid])){c+=_mid-d,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;d+=p,c+=p}if(p=_tsip_machine_parser_header_NameAddrArray_range_lengths[t],p>0){for(_lower=d,_upper=d+(p<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_NameAddrArray_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_NameAddrArray_trans_keys[_mid+1])){c+=_mid-d>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;c+=p}}while(!1);if(c=_tsip_machine_parser_header_NameAddrArray_indicies[c],t=_tsip_machine_parser_header_NameAddrArray_trans_targs[c],0!=_tsip_machine_parser_header_NameAddrArray_trans_actions[c])for(l=_tsip_machine_parser_header_NameAddrArray_trans_actions[c],h=_tsip_machine_parser_header_NameAddrArray_actions[l],l+=1;h>0;)switch(h-=1,l+=1,_tsip_machine_parser_header_NameAddrArray_actions[l-1]){case 0:e=s;break;case 1:n||(n=new o);break;case 2:n&&(n.s_display_name=tsk_ragel_parser_get_string(_,s,e),n.s_display_name=tsk_string_unquote_2(n.s_display_name));break;case 3:if(n&&!n.o_uri){var k=tsk_ragel_parser_get_string(_,s,e);(n.o_uri=tsip_uri.prototype.Parse(k))&&n.s_display_name&&(n.o_uri.s_display_name=tsk_strdup(n.s_display_name))}break;case 4:n&&tsk_ragel_add_param(_,s,e,n.ao_params);break;case 5:n&&(a.push(n),n=null);break;case 6:o=tsip_header_P_Asserted_Identity;break;case 7:o=tsip_header_P_Associated_URI;break;case 8:o=tsip_header_P_Preferred_Identity;break;case 9:o=tsip_header_Path;break;case 10:o=tsip_header_Record_Route;break;case 11:o=tsip_header_Route;break;case 12:o=tsip_header_Service_Route;break;case 13:}if(_trigger_goto)continue}if(y>=u){if(0==t){u=E;continue}if(s+=1,s!=i){u=m;continue}}if(E>=u)break}return 173>t?(tsk_utils_log_error("Failed to parse header: "+_),null):a},tsip_header_Str.prototype=Object.create(tsip_header.prototype),tsip_header_Call_ID.prototype=Object.create(tsip_header_Str.prototype),tsip_header_Date.prototype=Object.create(tsip_header_Str.prototype),tsip_header_Event.prototype=Object.create(tsip_header_Str.prototype),tsip_header_Organization.prototype=Object.create(tsip_header_Str.prototype),tsip_header_P_Access_Network_Info.prototype=Object.create(tsip_header_Str.prototype),tsip_header_P_Charging_Function_Addresses.prototype=Object.create(tsip_header_Str.prototype),tsip_header_Server.prototype=Object.create(tsip_header_Str.prototype),tsip_header_SIP_ETag.prototype=Object.create(tsip_header_Str.prototype),tsip_header_SIP_If_Match.prototype=Object.create(tsip_header_Str.prototype),tsip_header_User_Agent.prototype=Object.create(tsip_header_Str.prototype),tsip_header_Warning.prototype=Object.create(tsip_header_Str.prototype),tsip_header_Dummy.prototype=Object.create(tsip_header_Str.prototype),_tsip_machine_parser_header_Str_actions=[0,1,0,1,14,1,16,2,0,14,2,1,13,2,2,13,2,3,13,2,4,13,2,5,13,2,6,13,2,7,13,2,8,13,2,9,13,2,10,13,2,11,13,2,12,13,2,14,15,3,0,12,13],_tsip_machine_parser_header_Str_key_offsets=[0,0,23,28,31,38,45,46,70,95,103,129,153,167,174,205,237,252,284,315,325,339,366,394,422,450,466,493,522,540,559,577,596,614,633,652,667,686,701,720,735,764,793,821,849,877,905,921,947,976,1005,1034,1052,1071,1090,1105,1120,1140,1161,1182,1203,1212,1232,1254,1265,1277,1288,1300,1311,1323,1335,1343,1355,1363,1375,1383,1405,1427,1448,1469,1490,1511,1520,1539,1561,1583,1605,1616,1628,1640,1648,1656,1657,1659,1666,1673,1680,1687,1693,1700,1707,1710,1717,1724,1731,1734,1741,1748,1755,1762,1765,1770,1772,1774,1776,1778,1780,1782,1784,1786,1788,1790,1793,1799,1808,1815,1822,1829,1836,1843,1849,1856,1863,1870,1877,1884,1891,1898,1904,1911,1918,1925,1932,1935,1942,1949,1956,1963,1970,1977,1984,1990,1997,2004,2011,2018,2025,2032,2039,2046,2052,2059,2066,2073,2080,2087,2094,2101,2108,2115,2118,2127,2134,2141,2148,2155,2158,2165,2171,2180,2187,2194,2201,2204,2211,2217,2224,2231,2238,2245,2252,2255,2262,2269,2276,2282,2289,2296,2303,2310,2317,2320,2327,2334,2341,2348,2355,2362,2365],_tsip_machine_parser_header_Str_trans_keys=[9,32,58,67,68,69,73,79,80,83,85,87,99,100,101,105,111,112,115,117,119,0,65535,9,32,58,0,65535,9,32,58,9,13,32,44,59,0,65535,9,13,32,44,59,0,65535,10,9,13,32,33,37,39,44,47,59,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,59,61,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,44,59,61,0,65535,9,13,32,33,34,37,39,44,47,59,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,9,13,32,33,37,39,44,47,59,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,34,44,59,92,127,0,31,33,255,256,65535,9,13,32,44,59,0,65535,9,13,32,33,34,37,39,44,47,59,92,126,127,0,31,35,41,42,57,58,64,65,90,91,94,95,122,123,255,256,65535,9,13,32,33,34,37,39,44,47,59,61,92,126,127,0,31,35,41,42,57,58,64,65,90,91,94,95,122,123,255,256,65535,9,13,32,34,44,59,61,92,127,0,31,33,255,256,65535,9,13,32,33,34,37,39,44,47,59,91,92,126,127,0,31,35,41,42,57,58,64,65,90,93,94,95,122,123,255,256,65535,9,13,32,33,34,37,39,44,47,59,92,126,127,0,31,35,41,42,57,58,64,65,90,91,94,95,122,123,255,256,65535,9,10,13,32,44,59,0,127,128,65535,9,13,32,34,44,59,92,127,0,31,33,255,256,65535,9,13,32,34,44,58,59,92,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,255,256,65535,9,13,32,34,44,58,59,92,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,46,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,59,92,93,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,59,92,93,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,59,92,93,127,0,31,33,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,255,256,65535,9,13,32,34,44,46,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,46,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,58,59,92,93,127,0,31,33,255,256,65535,9,13,32,34,44,59,92,127,0,31,33,47,48,57,58,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,46,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,46,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,46,58,59,92,93,127,0,31,33,47,48,57,60,64,65,70,71,96,97,102,103,255,256,65535,9,13,32,34,44,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,47,48,57,58,255,256,65535,9,13,32,34,44,46,59,92,127,0,31,33,255,256,65535,9,13,32,34,44,58,59,92,127,0,31,33,255,256,65535,9,13,32,44,58,59,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,65535,9,13,32,44,58,59,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,46,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,47,48,57,58,65535,9,13,32,44,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,47,48,57,58,65535,9,13,32,44,59,0,47,48,57,58,65535,9,13,32,44,59,93,0,47,48,57,58,65535,9,13,32,44,59,93,0,47,48,57,58,65535,9,13,32,44,59,93,0,65535,9,13,32,44,46,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,65535,9,13,32,44,46,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,65535,9,13,32,44,46,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,46,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,58,59,93,0,65535,9,13,32,44,59,0,47,48,57,58,64,65,70,71,96,97,102,103,65535,9,13,32,44,46,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,46,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,46,58,59,93,0,47,48,57,60,64,65,70,71,96,97,102,103,65535,9,13,32,44,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,47,48,57,58,65535,9,13,32,44,46,59,0,65535,9,13,32,44,58,59,0,65535,10,9,32,9,13,32,44,59,0,65535,9,32,58,65,97,0,65535,9,32,58,76,108,0,65535,9,32,58,76,108,0,65535,9,32,45,58,0,65535,9,32,58,73,105,0,65535,9,32,58,68,100,0,65535,9,32,58,9,32,58,65,97,0,65535,9,32,58,84,116,0,65535,9,32,58,69,101,0,65535,9,32,58,9,32,58,86,118,0,65535,9,32,58,69,101,0,65535,9,32,58,78,110,0,65535,9,32,58,84,116,0,65535,9,32,58,9,32,58,82,114,71,103,65,97,78,110,73,105,90,122,65,97,84,116,73,105,79,111,78,110,9,32,58,9,32,45,58,0,65535,9,32,58,65,67,97,99,0,65535,9,32,58,67,99,0,65535,9,32,58,67,99,0,65535,9,32,58,69,101,0,65535,9,32,58,83,115,0,65535,9,32,58,83,115,0,65535,9,32,45,58,0,65535,9,32,58,78,110,0,65535,9,32,58,69,101,0,65535,9,32,58,84,116,0,65535,9,32,58,87,119,0,65535,9,32,58,79,111,0,65535,9,32,58,82,114,0,65535,9,32,58,75,107,0,65535,9,32,45,58,0,65535,9,32,58,73,105,0,65535,9,32,58,78,110,0,65535,9,32,58,70,102,0,65535,9,32,58,79,111,0,65535,9,32,58,9,32,58,72,104,0,65535,9,32,58,65,97,0,65535,9,32,58,82,114,0,65535,9,32,58,71,103,0,65535,9,32,58,73,105,0,65535,9,32,58,78,110,0,65535,9,32,58,71,103,0,65535,9,32,45,58,0,65535,9,32,58,70,102,0,65535,9,32,58,85,117,0,65535,9,32,58,78,110,0,65535,9,32,58,67,99,0,65535,9,32,58,84,116,0,65535,9,32,58,73,105,0,65535,9,32,58,79,111,0,65535,9,32,58,78,110,0,65535,9,32,45,58,0,65535,9,32,58,65,97,0,65535,9,32,58,68,100,0,65535,9,32,58,68,100,0,65535,9,32,58,82,114,0,65535,9,32,58,69,101,0,65535,9,32,58,83,115,0,65535,9,32,58,83,115,0,65535,9,32,58,69,101,0,65535,9,32,58,83,115,0,65535,9,32,58,9,32,58,69,73,101,105,0,65535,9,32,58,82,114,0,65535,9,32,58,86,118,0,65535,9,32,58,69,101,0,65535,9,32,58,82,114,0,65535,9,32,58,9,32,58,80,112,0,65535,9,32,45,58,0,65535,9,32,58,69,73,101,105,0,65535,9,32,58,84,116,0,65535,9,32,58,65,97,0,65535,9,32,58,71,103,0,65535,9,32,58,9,32,58,70,102,0,65535,9,32,45,58,0,65535,9,32,58,77,109,0,65535,9,32,58,65,97,0,65535,9,32,58,84,116,0,65535,9,32,58,67,99,0,65535,9,32,58,72,104,0,65535,9,32,58,9,32,58,83,115,0,65535,9,32,58,69,101,0,65535,9,32,58,82,114,0,65535,9,32,45,58,0,65535,9,32,58,65,97,0,65535,9,32,58,71,103,0,65535,9,32,58,69,101,0,65535,9,32,58,78,110,0,65535,9,32,58,84,116,0,65535,9,32,58,9,32,58,65,97,0,65535,9,32,58,82,114,0,65535,9,32,58,78,110,0,65535,9,32,58,73,105,0,65535,9,32,58,78,110,0,65535,9,32,58,71,103,0,65535,9,32,58,0],_tsip_machine_parser_header_Str_single_lengths=[0,21,3,3,5,5,1,10,11,6,12,10,8,5,13,14,9,14,13,6,8,9,10,10,10,10,9,11,8,9,8,9,8,9,9,9,9,9,9,9,11,11,10,10,10,10,10,8,11,11,11,8,9,9,9,9,6,7,7,7,7,6,8,5,6,5,6,5,6,6,6,6,6,6,6,8,8,7,7,7,7,7,5,8,8,8,5,6,6,6,6,1,2,5,5,5,5,4,5,5,3,5,5,5,3,5,5,5,5,3,5,2,2,2,2,2,2,2,2,2,2,3,4,7,5,5,5,5,5,4,5,5,5,5,5,5,5,4,5,5,5,5,3,5,5,5,5,5,5,5,4,5,5,5,5,5,5,5,5,4,5,5,5,5,5,5,5,5,5,3,7,5,5,5,5,3,5,4,7,5,5,5,3,5,4,5,5,5,5,5,3,5,5,5,4,5,5,5,5,5,3,5,5,5,5,5,5,3,0],_tsip_machine_parser_header_Str_range_lengths=[0,1,1,0,1,1,0,7,7,1,7,7,3,1,9,9,3,9,9,2,3,9,9,9,9,3,9,9,5,5,5,5,5,5,5,3,5,3,5,3,9,9,9,9,9,9,3,9,9,9,9,5,5,5,3,3,7,7,7,7,1,7,7,3,3,3,3,3,3,3,1,3,1,3,1,7,7,7,7,7,7,1,7,7,7,7,3,3,3,1,1,0,0,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0],_tsip_machine_parser_header_Str_index_offsets=[0,0,23,28,32,39,46,48,66,85,93,113,131,143,150,173,197,210,234,257,266,278,297,317,337,357,371,390,411,425,440,454,469,483,498,513,526,541,554,569,582,603,624,644,664,684,704,718,736,757,778,799,813,828,843,856,869,883,898,913,928,937,951,967,976,986,995,1005,1014,1024,1034,1042,1052,1060,1070,1078,1094,1110,1125,1140,1155,1170,1179,1192,1208,1224,1240,1249,1259,1269,1277,1285,1287,1290,1297,1304,1311,1318,1324,1331,1338,1342,1349,1356,1363,1367,1374,1381,1388,1395,1399,1405,1408,1411,1414,1417,1420,1423,1426,1429,1432,1435,1439,1445,1454,1461,1468,1475,1482,1489,1495,1502,1509,1516,1523,1530,1537,1544,1550,1557,1564,1571,1578,1582,1589,1596,1603,1610,1617,1624,1631,1637,1644,1651,1658,1665,1672,1679,1686,1693,1699,1706,1713,1720,1727,1734,1741,1748,1755,1762,1766,1775,1782,1789,1796,1803,1807,1814,1820,1829,1836,1843,1850,1854,1861,1867,1874,1881,1888,1895,1902,1906,1913,1920,1927,1933,1940,1947,1954,1961,1968,1972,1979,1986,1993,2e3,2007,2014,2018],_tsip_machine_parser_header_Str_indicies=[2,2,3,4,5,6,7,8,9,10,11,12,4,5,6,7,8,9,10,11,12,0,1,14,14,15,13,1,16,16,17,1,17,19,17,20,20,18,1,22,23,22,24,24,21,1,25,1,24,23,24,26,26,26,24,21,24,26,21,26,21,26,21,26,21,1,27,28,27,29,29,29,30,21,30,31,29,21,29,21,29,21,29,21,1,32,23,32,24,24,31,21,1,33,23,33,34,35,34,34,24,21,24,36,34,21,34,21,34,21,34,21,1,37,28,37,34,34,34,30,21,30,34,21,34,21,34,21,34,21,1,38,23,38,39,40,40,41,21,21,35,21,1,37,28,37,30,30,21,1,40,23,40,42,39,42,42,40,35,40,41,42,21,21,35,42,35,42,35,42,35,21,1,43,28,43,44,39,44,44,45,35,45,46,41,44,21,21,35,44,35,44,35,44,35,21,1,47,23,47,39,40,40,46,41,21,21,35,21,1,48,23,48,49,50,49,49,40,35,40,51,41,49,21,21,35,49,35,49,35,49,35,21,1,52,28,52,49,39,49,49,45,35,45,41,49,21,21,35,49,35,49,35,49,35,21,1,38,21,23,38,40,40,35,21,1,52,28,52,39,45,45,41,21,21,35,21,1,38,23,38,39,40,54,40,41,21,21,35,53,35,53,35,53,35,21,1,38,23,38,39,40,56,40,41,50,21,21,35,55,35,55,35,55,35,21,1,38,23,38,39,40,56,40,41,50,21,21,35,57,35,57,35,57,35,21,1,38,23,38,39,40,56,40,41,50,21,21,35,58,35,58,35,58,35,21,1,38,23,38,39,40,56,40,41,50,21,21,35,21,1,38,23,38,39,40,60,40,41,21,21,35,59,35,53,35,53,35,21,1,38,23,38,39,40,61,56,40,41,50,21,21,35,62,35,55,35,55,35,21,1,38,23,38,39,40,40,41,21,21,35,63,35,21,1,38,23,38,39,40,64,40,41,21,21,35,65,35,21,1,38,23,38,39,40,40,41,21,21,35,66,35,21,1,38,23,38,39,40,67,40,41,21,21,35,68,35,21,1,38,23,38,39,40,40,41,21,21,35,69,35,21,1,38,23,38,39,40,40,41,50,21,21,35,70,35,21,1,38,23,38,39,40,40,41,50,21,21,35,71,35,21,1,38,23,38,39,40,40,41,50,21,21,35,21,1,38,23,38,39,40,67,40,41,21,21,35,72,35,21,1,38,23,38,39,40,67,40,41,21,21,35,21,1,38,23,38,39,40,64,40,41,21,21,35,73,35,21,1,38,23,38,39,40,64,40,41,21,21,35,21,1,38,23,38,39,40,61,56,40,41,50,21,21,35,74,35,57,35,57,35,21,1,38,23,38,39,40,61,56,40,41,50,21,21,35,58,35,58,35,58,35,21,1,38,23,38,39,40,76,40,41,50,21,21,35,75,35,75,35,75,35,21,1,38,23,38,39,40,78,40,41,50,21,21,35,77,35,77,35,77,35,21,1,38,23,38,39,40,78,40,41,50,21,21,35,79,35,79,35,79,35,21,1,38,23,38,39,40,78,40,41,50,21,21,35,80,35,80,35,80,35,21,1,38,23,38,39,40,78,40,41,50,21,21,35,21,1,38,23,38,39,40,40,41,21,21,35,81,35,75,35,75,35,21,1,38,23,38,39,40,61,78,40,41,50,21,21,35,82,35,77,35,77,35,21,1,38,23,38,39,40,61,78,40,41,50,21,21,35,83,35,79,35,79,35,21,1,38,23,38,39,40,61,78,40,41,50,21,21,35,80,35,80,35,80,35,21,1,38,23,38,39,40,40,41,21,21,35,84,35,21,1,38,23,38,39,40,61,40,41,21,21,35,85,35,21,1,38,23,38,39,40,61,40,41,21,21,35,86,35,21,1,38,23,38,39,40,61,40,41,21,21,35,21,1,38,23,38,39,40,60,40,41,21,21,35,21,1,22,23,22,24,88,24,21,87,21,87,21,87,21,1,22,23,22,24,90,24,39,21,89,21,89,21,89,21,1,22,23,22,24,90,24,39,21,91,21,91,21,91,21,1,22,23,22,24,90,24,39,21,92,21,92,21,92,21,1,22,23,22,24,90,24,39,21,1,22,23,22,24,94,24,21,93,21,87,21,87,21,1,22,23,22,24,95,90,24,39,21,96,21,89,21,89,21,1,22,23,22,24,24,21,97,21,1,22,23,22,24,98,24,21,99,21,1,22,23,22,24,24,21,100,21,1,22,23,22,24,101,24,21,102,21,1,22,23,22,24,24,21,103,21,1,22,23,22,24,24,39,21,104,21,1,22,23,22,24,24,39,21,105,21,1,22,23,22,24,24,39,21,1,22,23,22,24,101,24,21,106,21,1,22,23,22,24,101,24,21,1,22,23,22,24,98,24,21,107,21,1,22,23,22,24,98,24,21,1,22,23,22,24,95,90,24,39,21,108,21,91,21,91,21,1,22,23,22,24,95,90,24,39,21,92,21,92,21,92,21,1,22,23,22,24,110,24,39,21,109,21,109,21,109,21,1,22,23,22,24,112,24,39,21,111,21,111,21,111,21,1,22,23,22,24,112,24,39,21,113,21,113,21,113,21,1,22,23,22,24,112,24,39,21,114,21,114,21,114,21,1,22,23,22,24,112,24,39,21,1,22,23,22,24,24,21,115,21,109,21,109,21,1,22,23,22,24,95,112,24,39,21,116,21,111,21,111,21,1,22,23,22,24,95,112,24,39,21,117,21,113,21,113,21,1,22,23,22,24,95,112,24,39,21,114,21,114,21,114,21,1,22,23,22,24,24,21,118,21,1,22,23,22,24,95,24,21,119,21,1,22,23,22,24,95,24,21,120,21,1,22,23,22,24,95,24,21,1,22,23,22,24,94,24,21,1,121,1,122,122,1,122,123,122,20,20,18,1,14,14,15,124,124,13,1,14,14,15,125,125,13,1,14,14,15,126,126,13,1,14,14,127,15,13,1,14,14,15,128,128,13,1,14,14,15,129,129,13,1,130,130,131,1,14,14,15,132,132,13,1,14,14,15,133,133,13,1,14,14,15,134,134,13,1,135,135,136,1,14,14,15,137,137,13,1,14,14,15,138,138,13,1,14,14,15,139,139,13,1,14,14,15,140,140,13,1,141,141,142,1,141,141,142,143,143,1,144,144,1,145,145,1,146,146,1,147,147,1,148,148,1,149,149,1,150,150,1,151,151,1,152,152,1,153,153,1,154,154,155,1,14,14,156,15,13,1,14,14,15,157,158,157,158,13,1,14,14,15,159,159,13,1,14,14,15,160,160,13,1,14,14,15,161,161,13,1,14,14,15,162,162,13,1,14,14,15,163,163,13,1,14,14,164,15,13,1,14,14,15,165,165,13,1,14,14,15,166,166,13,1,14,14,15,167,167,13,1,14,14,15,168,168,13,1,14,14,15,169,169,13,1,14,14,15,170,170,13,1,14,14,15,171,171,13,1,14,14,172,15,13,1,14,14,15,173,173,13,1,14,14,15,174,174,13,1,14,14,15,175,175,13,1,14,14,15,176,176,13,1,177,177,178,1,14,14,15,179,179,13,1,14,14,15,180,180,13,1,14,14,15,181,181,13,1,14,14,15,182,182,13,1,14,14,15,183,183,13,1,14,14,15,184,184,13,1,14,14,15,185,185,13,1,14,14,186,15,13,1,14,14,15,187,187,13,1,14,14,15,188,188,13,1,14,14,15,189,189,13,1,14,14,15,190,190,13,1,14,14,15,191,191,13,1,14,14,15,192,192,13,1,14,14,15,193,193,13,1,14,14,15,194,194,13,1,14,14,195,15,13,1,14,14,15,196,196,13,1,14,14,15,197,197,13,1,14,14,15,198,198,13,1,14,14,15,199,199,13,1,14,14,15,200,200,13,1,14,14,15,201,201,13,1,14,14,15,202,202,13,1,14,14,15,203,203,13,1,14,14,15,204,204,13,1,205,205,206,1,14,14,15,207,208,207,208,13,1,14,14,15,209,209,13,1,14,14,15,210,210,13,1,14,14,15,211,211,13,1,14,14,15,212,212,13,1,213,213,214,1,14,14,15,215,215,13,1,14,14,216,15,13,1,14,14,15,217,218,217,218,13,1,14,14,15,219,219,13,1,14,14,15,220,220,13,1,14,14,15,221,221,13,1,222,222,223,1,14,14,15,224,224,13,1,14,14,225,15,13,1,14,14,15,226,226,13,1,14,14,15,227,227,13,1,14,14,15,228,228,13,1,14,14,15,229,229,13,1,14,14,15,230,230,13,1,231,231,232,1,14,14,15,233,233,13,1,14,14,15,234,234,13,1,14,14,15,235,235,13,1,14,14,236,15,13,1,14,14,15,237,237,13,1,14,14,15,238,238,13,1,14,14,15,239,239,13,1,14,14,15,240,240,13,1,14,14,15,241,241,13,1,242,242,243,1,14,14,15,244,244,13,1,14,14,15,245,245,13,1,14,14,15,246,246,13,1,14,14,15,247,247,13,1,14,14,15,248,248,13,1,14,14,15,249,249,13,1,250,250,251,1,1,0],_tsip_machine_parser_header_Str_trans_targs=[2,0,3,4,94,101,105,100,110,122,170,191,201,2,3,4,3,4,5,91,7,5,5,6,7,208,8,9,6,8,7,10,9,10,11,12,56,5,12,13,14,19,15,16,15,14,17,16,17,18,20,21,12,22,55,23,26,24,25,27,42,28,40,29,30,38,31,32,36,33,34,35,37,39,41,43,51,44,47,45,46,48,49,50,52,53,54,57,90,58,61,59,60,62,77,63,75,64,65,73,66,67,71,68,69,70,72,74,76,78,86,79,82,80,81,83,84,85,87,88,89,92,93,6,95,96,97,98,99,100,3,4,102,103,104,3,4,106,107,108,109,3,4,111,112,113,114,115,116,117,118,119,120,121,3,4,123,124,143,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,3,4,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,3,4,171,176,172,173,174,175,3,4,177,178,179,183,180,181,182,3,4,184,185,186,187,188,189,190,3,4,192,193,194,195,196,197,198,199,200,3,4,202,203,204,205,206,207,3,4],_tsip_machine_parser_header_Str_trans_actions=[1,0,49,49,1,1,1,1,1,1,1,1,1,0,43,43,0,0,1,0,7,0,3,3,3,5,1,46,46,0,46,0,3,3,0,0,0,46,3,0,3,0,1,46,0,46,0,3,3,0,0,0,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,10,10,0,0,0,13,13,0,0,0,0,16,16,0,0,0,0,0,0,0,0,0,0,0,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,25,0,0,0,0,0,0,28,28,0,0,0,0,0,0,0,31,31,0,0,0,0,0,0,0,34,34,0,0,0,0,0,0,0,0,0,37,37,0,0,0,0,0,0,40,40],tsip_machine_parser_header_Str_start=1,tsip_machine_parser_header_Str_first_final=208,tsip_machine_parser_header_Str_error=0,tsip_machine_parser_header_Str_en_main=1,tsip_header_Str.prototype.toString=function(){return this.s_value},tsip_header_Str.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=null;t=tsip_machine_parser_header_Str_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Str_key_offsets[t],o=_tsip_machine_parser_header_Str_index_offsets[t],n=_tsip_machine_parser_header_Str_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Str_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Str_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Str_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Str_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Str_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Str_indicies[o],t=_tsip_machine_parser_header_Str_trans_targs[o],0!=_tsip_machine_parser_header_Str_trans_actions[o])for(c=_tsip_machine_parser_header_Str_trans_actions[o],d=_tsip_machine_parser_header_Str_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Str_actions[c-1]){case 0:e=s;break;case 1:a=new tsip_header_Call_ID;break;case 2:a=new tsip_header_Date;break;case 3:a=new tsip_header_Event;break;case 4:a=new tsip_header_Organization;break;case 5:a=new tsip_header_P_Access_Network_Info;break;case 6:a=new tsip_header_P_Charging_Function_Addresses;break;case 7:a=new tsip_header_Server;break;case 8:a=new tsip_header_SIP_ETag;break;case 9:a=new tsip_header_SIP_If_Match;break;case 10:a=new tsip_header_User_Agent;break;case 11:a=new tsip_header_Warning;break;case 12:a=new tsip_header_Dummy;break;case 13:a&&(a.s_name=tsk_ragel_parser_get_string(_,s,e));break;case 14:a&&(a.s_value=tsk_ragel_parser_get_string(_,s,e));break;case 15:a&&tsk_ragel_add_param(_,s,e,a.ao_params);break;case 16:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 208>t?(tsk_utils_log_error("Failed to parse header: "+_),null):a};var TSIP_HEADER_ALLOW_DEFAULT="ACK, BYE, CANCEL, INVITE, MESSAGE, NOTIFY, OPTIONS, PRACK, REFER, UPDATE";tsip_header_StrArray.prototype=Object.create(tsip_header.prototype),tsip_header_StrArray.prototype.as_values=null,tsip_header_Allow.prototype=Object.create(tsip_header_StrArray.prototype),tsip_header_Allow_Events.prototype=Object.create(tsip_header_StrArray.prototype),tsip_header_Privacy.prototype=Object.create(tsip_header_StrArray.prototype),tsip_header_Require.prototype=Object.create(tsip_header_StrArray.prototype),tsip_header_Supported.prototype=Object.create(tsip_header_StrArray.prototype),_tsip_machine_parser_header_Allow_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7],_tsip_machine_parser_header_Allow_key_offsets=[0,0,12,14,16,18,20,24,27,44,45,61,65,66,68,71,88,89,91,107,109,111,113,115,117,119,122,125,141,142,144,159,176,180,181,183,186,199,202,204,206,208,210,212,214,217,220,249,250,252,280,296,322,340,358,376,394,412,430,448,450,470,488,506,524,542,560,578,596,614,632,650,668,686,704,722,740,758,776,794,812,830,832,834,836,838,840,842,845,848,850,852,854,856,858,860,862,864],_tsip_machine_parser_header_Allow_trans_keys=[65,75,80,82,83,85,97,107,112,114,115,117,76,108,76,108,79,111,87,119,9,32,45,58,9,32,58,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,13,32,33,37,39,44,126,42,46,48,57,65,90,95,122,9,13,32,44,10,9,32,9,32,44,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,69,101,86,118,69,101,78,110,84,116,83,115,9,32,58,9,32,58,9,13,32,33,37,39,45,126,42,43,48,57,65,90,95,122,10,9,32,9,32,33,37,39,45,126,42,43,48,57,65,90,95,122,9,13,32,33,37,39,44,46,126,42,45,48,57,65,90,95,122,9,13,32,44,10,9,32,9,32,44,33,37,39,45,126,42,43,48,57,65,90,95,122,9,32,58,82,114,73,105,86,118,65,97,67,99,89,121,9,32,58,9,32,58,9,13,32,33,37,39,67,72,73,78,83,85,99,104,105,110,115,117,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,67,72,73,78,83,85,99,104,105,110,115,117,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,33,37,39,67,72,73,78,83,85,99,104,105,110,115,117,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,82,114,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,73,105,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,84,116,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,73,105,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,67,99,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,65,97,126,42,43,45,46,48,57,66,90,95,122,13,33,37,39,59,76,108,126,42,43,45,46,48,57,65,90,95,122,13,59,13,33,37,39,59,69,73,101,105,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,65,97,126,42,43,45,46,48,57,66,90,95,122,13,33,37,39,59,68,100,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,69,101,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,82,114,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,83,115,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,84,116,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,79,111,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,82,114,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,89,121,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,68,100,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,79,111,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,78,110,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,69,101,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,69,101,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,83,115,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,83,115,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,73,105,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,79,111,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,78,110,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,59,83,115,126,42,43,45,46,48,57,65,90,95,122,69,101,81,113,85,117,73,105,82,114,69,101,9,32,58,9,32,58,85,117,80,112,80,112,79,111,82,114,84,116,69,101,68,100,0],
_tsip_machine_parser_header_Allow_single_lengths=[0,12,2,2,2,2,4,3,7,1,8,4,1,2,3,7,1,2,6,2,2,2,2,2,2,3,3,8,1,2,7,9,4,1,2,3,5,3,2,2,2,2,2,2,3,3,19,1,2,18,6,16,8,8,8,8,8,8,8,2,10,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,2,2,2,2,2,2,3,3,2,2,2,2,2,2,2,2,0],_tsip_machine_parser_header_Allow_range_lengths=[0,0,0,0,0,0,0,0,5,0,4,0,0,0,0,5,0,0,5,0,0,0,0,0,0,0,0,4,0,0,4,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,5,0,0,5,5,5,5,5,5,5,5,5,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_header_Allow_index_offsets=[0,0,13,16,19,22,25,30,34,47,49,62,67,69,72,76,89,91,94,106,109,112,115,118,121,124,128,132,145,147,150,162,176,181,183,186,190,200,204,207,210,213,216,219,222,226,230,255,257,260,284,296,318,332,346,360,374,388,402,416,419,435,449,463,477,491,505,519,533,547,561,575,589,603,617,631,645,659,673,687,701,715,718,721,724,727,730,733,737,741,744,747,750,753,756,759,762,765],_tsip_machine_parser_header_Allow_indicies=[0,2,3,4,5,6,0,2,3,4,5,6,1,7,7,1,8,8,1,9,9,1,10,10,1,11,11,12,13,1,14,14,15,1,15,16,15,17,17,17,17,17,17,17,17,17,1,18,1,19,20,19,21,21,21,22,21,21,21,21,21,1,23,24,23,25,1,26,1,27,27,1,27,27,25,1,25,28,25,17,17,17,17,17,17,17,17,17,1,29,1,30,30,1,30,30,17,17,17,17,17,17,17,17,17,1,31,31,1,32,32,1,33,33,1,34,34,1,35,35,1,6,6,1,36,36,37,1,38,38,39,1,39,40,39,41,41,41,41,41,41,41,41,41,1,42,1,43,43,1,43,43,41,41,41,41,41,41,41,41,41,1,44,20,44,45,45,45,46,47,45,45,45,45,45,1,48,49,48,39,1,50,1,51,51,1,51,51,39,1,45,45,45,45,45,45,45,45,45,1,52,52,53,1,54,54,1,55,55,1,56,56,1,57,57,1,58,58,1,59,59,1,60,60,61,1,62,62,63,1,63,64,63,65,65,65,66,67,68,69,70,71,66,67,68,69,70,71,65,65,65,65,65,65,1,72,1,73,73,1,73,73,65,65,65,66,67,68,69,70,71,66,67,68,69,70,71,65,65,65,65,65,65,1,20,74,74,74,75,74,74,74,74,74,74,1,65,65,65,66,67,68,69,70,71,66,67,68,69,70,71,65,65,65,65,65,65,1,20,74,74,74,75,76,76,74,74,74,74,74,74,1,20,74,74,74,75,77,77,74,74,74,74,74,74,1,20,74,74,74,75,78,78,74,74,74,74,74,74,1,20,74,74,74,75,79,79,74,74,74,74,74,74,1,20,74,74,74,75,80,80,74,74,74,74,74,74,1,20,74,74,74,75,81,81,74,74,74,74,74,74,1,20,74,74,74,75,82,82,74,74,74,74,74,74,1,20,75,1,20,74,74,74,75,83,84,83,84,74,74,74,74,74,74,1,20,74,74,74,75,85,85,74,74,74,74,74,74,1,20,74,74,74,75,86,86,74,74,74,74,74,74,1,20,74,74,74,75,87,87,74,74,74,74,74,74,1,20,74,74,74,75,82,82,74,74,74,74,74,74,1,20,74,74,74,75,88,88,74,74,74,74,74,74,1,20,74,74,74,75,89,89,74,74,74,74,74,74,1,20,74,74,74,75,90,90,74,74,74,74,74,74,1,20,74,74,74,75,91,91,74,74,74,74,74,74,1,20,74,74,74,75,82,82,74,74,74,74,74,74,1,20,74,74,74,75,82,82,74,74,74,74,74,74,1,20,74,74,74,75,92,92,74,74,74,74,74,74,1,20,74,74,74,75,93,93,74,74,74,74,74,74,1,20,74,74,74,75,82,82,74,74,74,74,74,74,1,20,74,74,74,75,94,94,74,74,74,74,74,74,1,20,74,74,74,75,95,95,74,74,74,74,74,74,1,20,74,74,74,75,96,96,74,74,74,74,74,74,1,20,74,74,74,75,97,97,74,74,74,74,74,74,1,20,74,74,74,75,98,98,74,74,74,74,74,74,1,20,74,74,74,75,82,82,74,74,74,74,74,74,1,20,74,74,74,75,86,86,74,74,74,74,74,74,1,99,99,1,100,100,1,101,101,1,102,102,1,103,103,1,104,104,1,105,105,106,1,107,107,25,1,108,108,1,109,109,1,110,110,1,111,111,1,112,112,1,113,113,1,114,114,1,2,2,1,1,0],_tsip_machine_parser_header_Allow_trans_targs=[2,0,37,38,81,89,25,3,4,5,6,7,19,8,7,8,9,10,97,11,9,10,15,11,12,15,13,14,16,17,18,20,21,22,23,24,26,27,26,27,28,31,29,30,32,31,27,36,32,33,34,35,7,8,39,40,41,42,43,44,45,46,45,46,47,50,52,60,70,71,74,80,48,49,50,51,53,54,55,56,57,58,59,61,65,62,63,64,66,67,68,69,72,73,75,76,77,78,79,82,83,84,85,86,87,88,15,88,90,91,92,93,94,95,96],_tsip_machine_parser_header_Allow_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,5,0,5,0,0,0,1,15,3,3,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,0,0,0,1,0,0,3,0,3,0,0,0,0,0,13,13,0,0,0,0,0,0,9,9,0,0,0,1,1,1,1,1,1,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0,0,0,0,0,0],tsip_machine_parser_header_Allow_start=1,tsip_machine_parser_header_Allow_first_final=97,tsip_machine_parser_header_Allow_error=0,tsip_machine_parser_header_Allow_en_main=1,tsip_header_StrArray.prototype.toString=function(){var _,e=null;switch(this.e_type){case tsip_header_type_e.Privacy:_=";";break;default:_=","}for(var t=0;t<this.as_values.length;++t)0==t?e=this.as_values[t]:e+=tsk_string_format("{0}{1}",_,this.as_values[t]);return e},tsip_header_StrArray.prototype.has_value=function(_){if(this.as_values&&_)for(var e=_.toLowerCase(),t=0;t<this.as_values.length;++t)if(this.as_values[t].toLowerCase()==e)return!0;return!1},tsip_header_StrArray.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=null;t=tsip_machine_parser_header_Allow_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Allow_key_offsets[t],o=_tsip_machine_parser_header_Allow_index_offsets[t],n=_tsip_machine_parser_header_Allow_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Allow_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Allow_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Allow_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Allow_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Allow_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Allow_indicies[o],t=_tsip_machine_parser_header_Allow_trans_targs[o],0!=_tsip_machine_parser_header_Allow_trans_actions[o])for(c=_tsip_machine_parser_header_Allow_trans_actions[o],d=_tsip_machine_parser_header_Allow_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Allow_actions[c-1]){case 0:e=s;break;case 1:a&&tsk_ragel_parser_add_string(_,s,e,a.as_values);break;case 2:a=new tsip_header_Allow;break;case 3:a=new tsip_header_Allow_Events;break;case 4:a=new tsip_header_Privacy;break;case 5:a=new tsip_header_Require;break;case 6:a=new tsip_header_Supported;break;case 7:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 97>t?(tsk_utils_log_error("Failed to parse header: "+_),null):a},tsip_header_Authorization.prototype=Object.create(tsip_header.prototype),tsip_header_Authorization.prototype.toString=function(){return tsk_string_iequals(this.s_scheme,"Basic")?tsk_string_format("{0} {1}",this.s_scheme,this.s_response):tsk_string_format("{0} {1}{2}{3}{4}{5}{6}{7}{8}{9}{10}{11}{12}{13}{14}{15}{16}{17}{18}{19}{20}{21}{22}{23}{24}{25}{26}{27}",this.s_scheme,this.s_username?'username="':"",this.s_username?this.s_username:"",this.s_username?'"':"",this.s_realm?',realm="':"",this.s_realm?this.s_realm:"",this.s_realm?'"':"",this.s_nonce||""===this.s_nonce?',nonce="':"",this.s_nonce||""===this.s_nonce?this.s_nonce:"",this.s_nonce||""===this.s_nonce?'"':"",this.s_uri?',uri="':"",this.s_uri?this.s_uri:"",this.s_uri?'"':"",this.s_response||""===this.s_response?',response="':"",this.s_response||""===this.s_response?this.s_response:"",this.s_response||""===this.s_response?'"':"",this.s_algorithm?",algorithm=":"",this.s_algorithm?this.s_algorithm:"",this.s_cnonce?',cnonce="':"",this.s_cnonce?this.s_cnonce:"",this.s_cnonce?'"':"",this.s_opaque?',opaque="':"",this.s_opaque?this.s_opaque:"",this.s_opaque?'"':"",this.s_qop?",qop=":"",this.s_qop?this.s_qop:"",this.s_nc?",nc=":"",this.s_nc?this.s_nc:"")},tsip_header_Contact.prototype=Object.create(tsip_header.prototype),_tsip_machine_parser_header_Contact_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,2,1,0,2,3,6,2,4,6,2,5,6],_tsip_machine_parser_header_Contact_key_offsets=[0,0,4,6,8,10,12,14,16,19,40,41,43,64,65,67,71,74,75,79,91,94,96,99,104,109,110,112,116,137,138,140,161,162,164,167,184,202,206,207,209,217,218,220,224,230,250,269,274,276,283,302,303,305,323,341,347,348,350,355,374,375,377,396,397,399,402,410,411,413,418,424,441,448,456,464,472,474,481,490,492,495,497,500,502,505,508,509,512,513,516,517,526,535,543,551,559,567,569,575,584,593,602,604,607,610,611,612,632,652,672,692,712,732,750,756,757,759,764,783,784,786,805,812,829,847,851],_tsip_machine_parser_header_Contact_trans_keys=[67,77,99,109,79,111,78,110,84,116,65,97,67,99,84,116,9,32,58,9,13,32,33,34,37,39,42,43,60,126,45,46,48,57,65,90,95,96,97,122,10,9,32,9,13,32,33,34,37,39,42,43,60,126,45,46,48,57,65,90,95,96,97,122,10,9,32,9,32,42,60,9,13,32,10,65,90,97,122,9,32,43,58,45,46,48,57,65,90,97,122,9,32,58,0,65535,62,0,65535,9,13,32,44,59,9,13,32,44,59,10,9,32,9,32,44,59,9,13,32,33,34,37,39,60,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,13,32,33,34,37,39,60,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,32,60,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,60,10,9,32,9,13,34,92,32,126,128,255,10,9,32,9,13,32,60,0,9,11,12,14,127,9,13,32,33,37,39,42,43,58,126,45,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,58,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,58,60,0,65535,9,13,32,44,59,0,65535,9,13,32,33,37,39,69,101,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,44,59,0,9,11,12,14,127,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,44,59,61,88,120,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,80,112,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,73,105,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,82,114,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,69,101,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,83,115,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,44,59,48,57,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,60,126,42,43,45,46,48,57,65,90,95,122,9,13,32,60,0],_tsip_machine_parser_header_Contact_single_lengths=[0,4,2,2,2,2,2,2,3,11,1,2,11,1,2,4,3,1,0,4,3,0,1,5,5,1,2,4,9,1,2,9,1,2,3,7,8,4,1,2,4,1,2,4,0,10,9,5,0,5,9,1,2,8,10,6,1,2,5,9,1,2,9,1,2,3,4,1,2,5,0,9,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,12,12,12,12,12,12,10,6,1,2,5,9,1,2,9,5,7,8,4,0],_tsip_machine_parser_header_Contact_range_lengths=[0,0,0,0,0,0,0,0,0,5,0,0,5,0,0,0,0,0,2,4,0,1,1,0,0,0,0,0,6,0,0,6,0,0,0,5,5,0,0,0,2,0,0,0,3,5,5,0,1,1,5,0,0,5,4,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,3,4,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,4,4,4,4,4,4,4,0,0,0,0,5,0,0,5,1,5,5,0,0],_tsip_machine_parser_header_Contact_index_offsets=[0,0,5,8,11,14,17,20,23,27,44,46,49,66,68,71,76,80,82,85,94,98,100,103,109,115,117,120,125,141,143,146,162,164,167,171,184,198,203,205,208,215,217,220,225,229,245,260,266,268,275,290,292,295,309,324,331,333,336,342,357,359,362,377,379,382,386,393,395,398,404,408,422,427,433,439,445,448,453,460,462,465,467,470,472,475,478,480,483,485,488,490,497,504,510,516,522,528,531,535,542,549,556,558,561,564,566,568,585,602,619,636,653,670,685,692,694,697,703,718,720,723,738,745,758,772,777],_tsip_machine_parser_header_Contact_indicies=[0,2,0,2,1,3,3,1,4,4,1,5,5,1,6,6,1,7,7,1,2,2,1,2,2,8,1,9,10,9,11,12,11,11,13,11,14,11,11,11,15,11,15,1,16,1,17,17,1,18,19,18,11,12,11,11,13,11,14,11,11,11,15,11,15,1,20,1,21,21,1,21,21,22,23,1,22,24,22,1,25,1,26,26,1,27,27,28,29,28,28,28,28,1,27,27,29,1,30,1,31,30,1,32,33,32,34,35,1,36,37,36,38,35,1,39,1,40,40,1,40,40,38,35,1,41,42,41,11,12,11,11,14,11,11,11,11,15,11,15,1,43,1,44,44,1,45,46,45,11,12,11,11,14,11,11,11,11,15,11,15,1,47,1,48,48,1,48,48,23,1,49,50,49,51,51,51,51,51,51,51,51,51,1,52,53,52,51,51,51,54,51,51,51,51,51,51,1,55,56,55,23,1,57,1,49,49,1,58,59,60,61,58,58,1,62,1,58,58,1,52,53,52,54,1,58,58,58,1,63,50,63,51,51,51,51,64,65,51,64,64,64,51,64,1,66,53,66,51,51,51,65,54,51,51,51,51,51,51,1,67,56,67,65,23,1,68,1,69,70,69,71,72,68,1,35,73,35,74,74,74,75,75,74,74,74,74,74,74,1,76,1,77,77,1,77,77,74,74,74,75,75,74,74,74,74,74,74,1,78,79,78,80,80,80,81,82,83,80,80,80,80,80,1,84,85,84,38,35,83,1,86,1,87,87,1,87,87,38,35,83,1,83,88,83,89,90,89,89,91,89,89,89,89,89,89,1,92,1,93,93,1,93,94,93,89,90,89,89,91,89,89,89,89,89,89,1,95,1,96,96,1,96,96,90,1,90,97,98,99,90,90,1,100,1,90,90,1,101,79,101,81,82,1,90,90,90,1,101,79,101,89,89,89,81,82,89,89,89,89,89,1,103,102,102,102,1,105,98,104,104,104,1,105,98,106,106,106,1,105,98,107,107,107,1,105,98,1,109,108,102,102,1,110,105,98,111,104,104,1,112,1,113,114,1,115,1,116,117,1,118,1,98,119,1,98,120,1,98,1,116,121,1,116,1,113,122,1,113,1,110,105,98,123,106,106,1,110,105,98,107,107,107,1,125,98,124,124,124,1,127,98,126,126,126,1,127,98,128,128,128,1,127,98,129,129,129,1,127,98,1,130,124,124,1,110,127,98,131,126,126,1,110,127,98,132,128,128,1,110,127,98,129,129,129,1,133,1,110,134,1,110,135,1,110,1,109,1,78,79,78,80,80,80,81,82,83,136,136,80,80,80,80,80,1,78,79,78,80,80,80,81,82,83,137,137,80,80,80,80,80,1,78,79,78,80,80,80,81,82,83,138,138,80,80,80,80,80,1,78,79,78,80,80,80,81,82,83,139,139,80,80,80,80,80,1,78,79,78,80,80,80,81,82,83,140,140,80,80,80,80,80,1,78,79,78,80,80,80,81,82,83,141,141,80,80,80,80,80,1,142,79,142,80,80,80,81,82,143,80,80,80,80,80,1,144,145,144,38,35,143,1,146,1,147,147,1,147,147,38,35,143,1,143,148,143,89,90,89,89,91,89,89,89,149,89,89,1,150,1,151,151,1,151,94,151,89,90,89,89,91,89,89,89,149,89,89,1,152,153,152,154,156,155,1,157,24,157,51,51,51,51,51,51,51,51,51,1,158,24,158,51,51,51,54,51,51,51,51,51,51,1,159,24,159,23,1,1,0],_tsip_machine_parser_header_Contact_trans_targs=[2,0,8,3,4,5,6,7,9,9,10,35,40,123,18,45,11,12,12,13,14,15,16,18,17,126,19,20,19,21,22,23,24,17,28,50,24,25,28,26,27,28,29,30,31,31,32,33,34,36,38,35,37,32,18,37,32,39,40,41,43,44,42,46,45,48,47,47,49,24,17,28,50,51,54,107,52,53,55,17,54,28,50,59,55,56,57,58,60,71,66,72,61,62,63,64,65,67,69,70,68,24,73,106,74,77,75,76,78,93,79,91,80,81,89,82,83,87,84,85,86,88,90,92,94,102,95,98,96,97,99,100,101,103,104,105,108,109,110,111,112,113,114,118,114,115,116,117,119,122,120,121,24,17,28,122,50,124,125,125],_tsip_machine_parser_header_Contact_trans_actions=[0,0,0,0,0,0,0,0,0,3,3,17,17,17,3,17,0,0,3,3,0,0,0,0,0,15,1,0,0,0,0,7,13,13,13,0,0,0,0,0,0,3,3,0,0,3,3,0,0,0,0,0,5,5,5,0,0,0,0,0,0,0,0,0,0,0,5,0,0,20,20,20,7,0,1,1,0,0,26,26,0,26,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,0,0,0,0,0,0,1,0,0,23,23,23,0,9,0,5,0],tsip_machine_parser_header_Contact_start=1,tsip_machine_parser_header_Contact_first_final=126,tsip_machine_parser_header_Contact_error=0,tsip_machine_parser_header_Contact_en_main=1,tsip_header_Contact.prototype.toString=function(){var _=tsip_uri_tostring(this.o_uri,!0,!0);return _&&this.i_expires>=0&&(_+=tsk_string_format(";expires={0}",this.i_expires)),_},tsip_header_Contact.prototype.Parse=function(_){var e=0,t=0,s=_.length,i=tsk_buff_str2ib(_),r=new Array,a=null;e=tsip_machine_parser_header_Contact_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(t==s){l=g;continue}if(0==e){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Contact_key_offsets[e],o=_tsip_machine_parser_header_Contact_index_offsets[e],n=_tsip_machine_parser_header_Contact_single_lengths[e],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),i[t]<_tsip_machine_parser_header_Contact_trans_keys[_mid])_upper=_mid-1;else{if(!(i[t]>_tsip_machine_parser_header_Contact_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Contact_range_lengths[e],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),i[t]<_tsip_machine_parser_header_Contact_trans_keys[_mid])_upper=_mid-2;else{if(!(i[t]>_tsip_machine_parser_header_Contact_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Contact_indicies[o],e=_tsip_machine_parser_header_Contact_trans_targs[o],0!=_tsip_machine_parser_header_Contact_trans_actions[o])for(c=_tsip_machine_parser_header_Contact_trans_actions[o],d=_tsip_machine_parser_header_Contact_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Contact_actions[c-1]){case 0:i_tag_start=t;break;case 1:a||(a=new tsip_header_Contact);break;case 2:a&&(a.s_display_name=tsk_ragel_parser_get_string(_,t,i_tag_start),a.s_display_name=tsk_string_unquote_2(a.s_display_name));break;case 3:if(a&&!a.o_uri){var f=tsk_ragel_parser_get_string(_,t,i_tag_start);(a.o_uri=tsip_uri.prototype.Parse(f))&&a.s_display_name&&(a.o_uri.s_display_name=tsk_strdup(a.s_display_name))}break;case 4:a&&(a.i_expires=tsk_ragel_parser_get_int(_,t,i_tag_start));break;case 5:a&&tsk_ragel_add_param(_,t,i_tag_start,a.ao_params);break;case 6:a&&(r.push(a),a=null);break;case 7:}if(_trigger_goto)continue}if(m>=l){if(0==e){l=y;continue}if(t+=1,t!=s){l=h;continue}}if(y>=l)break}return 126>e?(tsk_utils_log_error("Failed to parse 'Contact' header: "+_),null):r},tsip_header_Content_Type.prototype=Object.create(tsip_header.prototype),_tsip_machine_parser_header_Content_Type_actions=[0,1,0,1,1,1,2,1,3],_tsip_machine_parser_header_Content_Type_key_offsets=[0,0,2,7,10,27,28,30,46,62,66,67,69,72,89,90,92,108,126,130,131,133,136,153,154,156,172,190,194,195,197,200,218,219,221,239,240,242,245,253,254,256,260,261,267,285,287,289,291,293,295,296,298,300,302,304],_tsip_machine_parser_header_Content_Type_trans_keys=[67,99,9,32,58,79,111,9,32,58,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,47,126,42,43,45,57,65,90,95,122,9,13,32,47,10,9,32,9,32,47,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,10,9,32,9,32,59,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,61,10,9,32,9,32,61,9,13,32,33,34,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,59,10,0,9,11,12,14,127,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,78,110,84,116,69,101,78,110,84,116,45,84,116,89,121,80,112,69,101,0],_tsip_machine_parser_header_Content_Type_single_lengths=[0,2,5,3,7,1,2,6,8,4,1,2,3,7,1,2,6,8,4,1,2,3,7,1,2,6,8,4,1,2,3,8,1,2,8,1,2,3,4,1,2,4,1,0,8,2,2,2,2,2,1,2,2,2,2,0],_tsip_machine_parser_header_Content_Type_range_lengths=[0,0,0,0,5,0,0,5,4,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,5,0,0,0,0,0,0,0,0,0,0,0],_tsip_machine_parser_header_Content_Type_index_offsets=[0,0,3,9,13,26,28,31,43,56,61,63,66,70,83,85,88,100,114,119,121,124,128,141,143,146,158,172,177,179,182,186,200,202,205,219,221,224,228,235,237,240,245,247,251,265,268,271,274,277,280,282,285,288,291,294],_tsip_machine_parser_header_Content_Type_indicies=[0,0,1,2,2,3,4,4,1,2,2,3,1,3,5,3,6,6,6,6,6,6,6,6,6,1,7,1,8,8,1,8,8,6,6,6,6,6,6,6,6,6,1,9,10,9,11,11,11,12,11,11,11,11,11,1,9,10,9,12,1,13,1,14,14,1,14,14,12,1,12,15,12,16,16,16,16,16,16,16,16,16,1,17,1,18,18,1,18,18,16,16,16,16,16,16,16,16,16,1,19,20,19,16,16,16,21,16,16,16,16,16,16,1,22,23,22,24,1,25,1,26,26,1,26,26,24,1,24,27,24,28,28,28,28,28,28,28,28,28,1,29,1,30,30,1,30,30,28,28,28,28,28,28,28,28,28,1,31,32,31,33,33,33,34,33,33,33,33,33,33,1,31,32,31,34,1,35,1,36,36,1,36,36,34,1,34,37,34,38,39,38,38,38,38,38,38,38,38,1,40,1,41,41,1,41,42,41,38,39,38,38,38,38,38,38,38,38,1,43,1,44,44,1,44,44,39,1,39,45,46,47,39,39,1,48,1,39,39,1,49,50,49,51,1,52,1,39,39,39,1,49,50,49,38,38,38,51,38,38,38,38,38,38,1,53,53,1,54,54,1,55,55,1,56,56,1,57,57,1,58,1,59,59,1,60,60,1,61,61,1,2,2,1,1,0],_tsip_machine_parser_header_Content_Type_trans_targs=[2,0,3,4,45,5,8,6,7,9,10,8,13,11,12,14,17,15,16,18,42,22,18,19,22,20,21,23,26,24,25,27,28,26,31,29,30,32,44,38,33,34,35,36,37,39,41,43,40,18,42,22,55,46,47,48,49,50,51,52,53,54],_tsip_machine_parser_header_Content_Type_trans_actions=[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,7,0,0,0,0,0,0,0,0,0],tsip_machine_parser_header_Content_Type_start=1,tsip_machine_parser_header_Content_Type_first_final=55,tsip_machine_parser_header_Content_Type_error=0,tsip_machine_parser_header_Content_Type_en_main=1,tsip_header_Content_Type.prototype.toString=function(){return this.s_type},tsip_header_Content_Type.prototype.Parse=function(_){var e=0,t=0,s=_.length,i=tsk_buff_str2ib(_),r=new tsip_header_Content_Type(null);e=tsip_machine_parser_header_Content_Type_start;var a,n,o,p,c,d,l,h,u,m,g;for(a=n=o=p=c=null,d=0,l=10,h=15,u=20,m=30,g=40;;){if(_trigger_goto=!1,0>=d){if(t==s){d=m;continue}if(0==e){d=g;continue}}if(l>=d){o=_tsip_machine_parser_header_Content_Type_key_offsets[e],n=_tsip_machine_parser_header_Content_Type_index_offsets[e],a=_tsip_machine_parser_header_Content_Type_single_lengths[e],_break_match=!1;do{if(a>0){for(_lower=o,_upper=o+a-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),i[t]<_tsip_machine_parser_header_Content_Type_trans_keys[_mid])_upper=_mid-1;else{if(!(i[t]>_tsip_machine_parser_header_Content_Type_trans_keys[_mid])){n+=_mid-o,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;o+=a,n+=a}if(a=_tsip_machine_parser_header_Content_Type_range_lengths[e],a>0){for(_lower=o,_upper=o+(a<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),i[t]<_tsip_machine_parser_header_Content_Type_trans_keys[_mid])_upper=_mid-2;else{if(!(i[t]>_tsip_machine_parser_header_Content_Type_trans_keys[_mid+1])){n+=_mid-o>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;n+=a}}while(!1);if(n=_tsip_machine_parser_header_Content_Type_indicies[n],e=_tsip_machine_parser_header_Content_Type_trans_targs[n],0!=_tsip_machine_parser_header_Content_Type_trans_actions[n])for(p=_tsip_machine_parser_header_Content_Type_trans_actions[n],c=_tsip_machine_parser_header_Content_Type_actions[p],p+=1;c>0;)switch(c-=1,p+=1,_tsip_machine_parser_header_Content_Type_actions[p-1]){case 0:i_tag_start=t;break;case 1:r.s_type=tsk_ragel_parser_get_string(_,t,i_tag_start);break;case 2:tsk_ragel_add_param(_,t,i_tag_start,r.ao_params);break;case 3:}if(_trigger_goto)continue}if(u>=d){if(0==e){d=g;continue}if(t+=1,t!=s){d=l;continue}}if(g>=d)break}return 55>e?(tsk_utils_log_error("Failed to parse 'Content-Type' header: "+_),null):r},tsip_header_CSeq.prototype=Object.create(tsip_header.prototype);var TSIP_HEADER_CSEQ_NONE=0,TSIP_HEADER_CSEQ_DEFAULT=1;_tsip_machine_parser_header_CSeq_actions=[0,1,0,1,1,1,2,1,3],_tsip_machine_parser_header_CSeq_key_offsets=[0,0,2,4,6,8,11,16,17,19,23,28,45,46,48,64,79,80],_tsip_machine_parser_header_CSeq_trans_keys=[67,99,83,115,69,101,81,113,9,32,58,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,48,57,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,0],_tsip_machine_parser_header_CSeq_single_lengths=[0,2,2,2,2,3,3,1,2,2,3,7,1,2,6,5,1,0],_tsip_machine_parser_header_CSeq_range_lengths=[0,0,0,0,0,0,1,0,0,1,1,5,0,0,5,5,0,0],_tsip_machine_parser_header_CSeq_index_offsets=[0,0,3,6,9,12,16,21,23,26,30,35,48,50,53,65,76,78],_tsip_machine_parser_header_CSeq_indicies=[0,0,1,2,2,1,3,3,1,4,4,1,4,4,5,1,5,6,5,7,1,8,1,9,9,1,9,9,7,1,10,11,10,12,1,13,14,13,15,15,15,15,15,15,15,15,15,1,16,1,17,17,1,17,17,15,15,15,15,15,15,15,15,15,1,18,19,19,19,19,19,19,19,19,19,1,20,1,1,0],_tsip_machine_parser_header_CSeq_trans_targs=[2,0,3,4,5,6,7,10,8,9,11,12,10,11,12,15,13,14,16,15,17],_tsip_machine_parser_header_CSeq_trans_actions=[0,0,0,0,0,0,0,1,0,0,5,5,0,0,0,1,0,0,3,0,7],tsip_machine_parser_header_CSeq_start=1,tsip_machine_parser_header_CSeq_first_final=17,tsip_machine_parser_header_CSeq_error=0,tsip_machine_parser_header_CSeq_en_main=1,tsip_header_CSeq.prototype.toString=function(){return tsk_string_format("{0} {1}",this.i_seq,this.s_method)},tsip_header_CSeq.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsip_header_CSeq(TSIP_HEADER_CSEQ_NONE);t=tsip_machine_parser_header_CSeq_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_CSeq_key_offsets[t],o=_tsip_machine_parser_header_CSeq_index_offsets[t],n=_tsip_machine_parser_header_CSeq_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_CSeq_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_CSeq_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_CSeq_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_CSeq_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_CSeq_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_CSeq_indicies[o],t=_tsip_machine_parser_header_CSeq_trans_targs[o],0!=_tsip_machine_parser_header_CSeq_trans_actions[o])for(c=_tsip_machine_parser_header_CSeq_trans_actions[o],d=_tsip_machine_parser_header_CSeq_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_CSeq_actions[c-1]){case 0:e=s;break;case 1:a.s_method=tsk_ragel_parser_get_string(_,s,e),a.e_req_type=tsip_message.prototype.GetRequestType(a.s_method);break;case 2:a.i_seq=tsk_ragel_parser_get_int(_,s,e);break;case 3:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 17>t?(tsk_utils_log_error("Failed to parse 'CSeq' header: "+_),null):a},tsip_header_RAck.prototype=Object.create(tsip_header.prototype),_tsip_machine_parser_header_RAck_actions=[0,1,0,1,1,1,2,1,3,1,4],_tsip_machine_parser_header_RAck_key_offsets=[0,0,2,4,6,8,11,16,17,19,23,28,33,34,36,40,45,62,63,65,81,96,97],_tsip_machine_parser_header_RAck_trans_keys=[82,114,65,97,67,99,75,107,9,32,58,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,48,57,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,48,57,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,13,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,0],_tsip_machine_parser_header_RAck_single_lengths=[0,2,2,2,2,3,3,1,2,2,3,3,1,2,2,3,7,1,2,6,5,1,0],_tsip_machine_parser_header_RAck_range_lengths=[0,0,0,0,0,0,1,0,0,1,1,1,0,0,1,1,5,0,0,5,5,0,0],_tsip_machine_parser_header_RAck_index_offsets=[0,0,3,6,9,12,16,21,23,26,30,35,40,42,45,49,54,67,69,72,84,95,97],_tsip_machine_parser_header_RAck_indicies=[0,0,1,2,2,1,3,3,1,4,4,1,4,4,5,1,5,6,5,7,1,8,1,9,9,1,9,9,7,1,10,11,10,12,1,13,14,13,15,1,16,1,17,17,1,17,17,15,1,18,19,18,20,1,21,22,21,23,23,23,23,23,23,23,23,23,1,24,1,25,25,1,25,25,23,23,23,23,23,23,23,23,23,1,26,27,27,27,27,27,27,27,27,27,1,28,1,1,0],_tsip_machine_parser_header_RAck_trans_targs=[2,0,3,4,5,6,7,10,8,9,11,12,10,11,12,15,13,14,16,17,15,16,17,20,18,19,21,20,22],_tsip_machine_parser_header_RAck_trans_actions=[0,0,0,0,0,0,0,1,0,0,3,3,0,0,0,1,0,0,5,5,0,0,0,1,0,0,7,0,9],tsip_machine_parser_header_RAck_start=1,tsip_machine_parser_header_RAck_first_final=22,tsip_machine_parser_header_RAck_error=0,tsip_machine_parser_header_RAck_en_main=1,tsip_header_RAck.prototype.toString=function(){return tsk_string_format("{0} {1} {2}",this.i_seq,this.i_cseq,this.s_method)},tsip_header_RAck.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsip_header_RAck(0,0,null);t=tsip_machine_parser_header_RAck_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_RAck_key_offsets[t],o=_tsip_machine_parser_header_RAck_index_offsets[t],n=_tsip_machine_parser_header_RAck_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_RAck_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_RAck_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_RAck_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_RAck_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_RAck_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_RAck_indicies[o],t=_tsip_machine_parser_header_RAck_trans_targs[o],0!=_tsip_machine_parser_header_RAck_trans_actions[o])for(c=_tsip_machine_parser_header_RAck_trans_actions[o],d=_tsip_machine_parser_header_RAck_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_RAck_actions[c-1]){case 0:e=s;break;case 1:a.i_seq=tsk_ragel_parser_get_int(_,s,e);break;case 2:a.i_cseq=tsk_ragel_parser_get_int(_,s,e);break;case 3:a.s_method=tsk_ragel_parser_get_string(_,s,e);break;case 4:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 22>t?(tsk_utils_log_error("Failed to parse 'RAck' header: "+_),null):a},tsip_header_Refer_Sub.prototype=Object.create(tsip_header.prototype),_tsip_machine_parser_header_Refer_Sub_actions=[0,1,0,1,1,1,2,1,3,1,4],_tsip_machine_parser_header_Refer_Sub_key_offsets=[0,0,2,4,6,8,10,11,13,15,17,20,27,28,30,36,38,40,42,44,48,52,53,55,58,75,76,78,94,113,118,119,121,125,144,145,147,166,167,169,172,180,181,183,187,188,194,212,219,227,235,243,245,252,261,263,266,268,271,273,276,279,280,283,284,287,288,297,306,314,322,330,338,340,346,355,364,373,375,378,381,382,383,385,387,389,393],_tsip_machine_parser_header_Refer_Sub_trans_keys=[82,114,69,101,70,102,69,101,82,114,45,83,115,85,117,66,98,9,32,58,9,13,32,70,84,102,116,10,9,32,9,32,70,84,102,116,65,97,76,108,83,115,69,101,9,13,32,59,9,13,32,59,10,9,32,9,32,59,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,59,10,0,9,11,12,14,127,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,82,114,85,117,69,101,9,13,32,59,0],
_tsip_machine_parser_header_Refer_Sub_single_lengths=[0,2,2,2,2,2,1,2,2,2,3,7,1,2,6,2,2,2,2,4,4,1,2,3,7,1,2,6,9,5,1,2,4,9,1,2,9,1,2,3,4,1,2,4,1,0,8,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,2,2,2,4,0],_tsip_machine_parser_header_Refer_Sub_range_lengths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,5,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,0,0,0,0,0],_tsip_machine_parser_header_Refer_Sub_index_offsets=[0,0,3,6,9,12,15,17,20,23,26,30,38,40,43,50,53,56,59,62,67,72,74,77,81,94,96,99,111,126,132,134,137,142,157,159,162,177,179,182,186,193,195,198,203,205,209,223,228,234,240,246,249,254,261,263,266,268,271,273,276,279,281,284,286,289,291,298,305,311,317,323,329,332,336,343,350,357,359,362,365,367,369,372,375,378,383],_tsip_machine_parser_header_Refer_Sub_indicies=[0,0,1,2,2,1,3,3,1,4,4,1,5,5,1,6,1,7,7,1,8,8,1,9,9,1,9,9,10,1,10,11,10,12,13,12,13,1,14,1,15,15,1,15,15,12,13,12,13,1,16,16,1,17,17,1,18,18,1,19,19,1,20,21,20,22,1,23,24,23,25,1,26,1,27,27,1,27,27,25,1,25,28,25,29,29,29,29,29,29,29,29,29,1,30,1,31,31,1,31,31,29,29,29,29,29,29,29,29,29,1,32,33,32,34,34,34,35,36,34,34,34,34,34,34,1,37,38,37,25,36,1,39,1,40,40,1,40,40,25,36,1,36,41,36,42,43,42,42,44,42,42,42,42,42,42,1,45,1,46,46,1,46,47,46,42,43,42,42,44,42,42,42,42,42,42,1,48,1,49,49,1,49,49,43,1,43,50,51,52,43,43,1,53,1,43,43,1,54,33,54,35,1,55,1,43,43,43,1,54,33,54,42,42,42,35,42,42,42,42,42,42,1,57,56,56,56,1,59,51,58,58,58,1,59,51,60,60,60,1,59,51,61,61,61,1,59,51,1,63,62,56,56,1,64,59,51,65,58,58,1,66,1,67,68,1,69,1,70,71,1,72,1,51,73,1,51,74,1,51,1,70,75,1,70,1,67,76,1,67,1,64,59,51,77,60,60,1,64,59,51,61,61,61,1,79,51,78,78,78,1,81,51,80,80,80,1,81,51,82,82,82,1,81,51,83,83,83,1,81,51,1,84,78,78,1,64,81,51,85,80,80,1,64,81,51,86,82,82,1,64,81,51,83,83,83,1,87,1,64,88,1,64,89,1,64,1,63,1,90,90,1,91,91,1,92,92,1,93,94,93,95,1,1,0],_tsip_machine_parser_header_Refer_Sub_trans_targs=[2,0,3,4,5,6,7,8,9,10,11,12,15,82,13,14,16,17,18,19,20,44,24,20,21,24,22,23,25,28,26,27,29,44,28,24,33,29,30,31,32,34,46,40,47,35,36,37,38,39,41,43,45,42,20,86,48,81,49,52,50,51,53,68,54,66,55,56,64,57,58,62,59,60,61,63,65,67,69,77,70,73,71,72,74,75,76,78,79,80,83,84,85,20,44,24],_tsip_machine_parser_header_Refer_Sub_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,5,5,5,0,0,0,0,0,0,1,0,0,7,7,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3],tsip_machine_parser_header_Refer_Sub_start=1,tsip_machine_parser_header_Refer_Sub_first_final=86,tsip_machine_parser_header_Refer_Sub_error=0,tsip_machine_parser_header_Refer_Sub_en_main=1,tsip_header_Refer_Sub.prototype.toString=function(){return this.b_sub?"true":"false"},tsip_header_Refer_Sub.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsip_header_Refer_Sub(!0);t=tsip_machine_parser_header_Refer_Sub_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Refer_Sub_key_offsets[t],o=_tsip_machine_parser_header_Refer_Sub_index_offsets[t],n=_tsip_machine_parser_header_Refer_Sub_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Refer_Sub_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Refer_Sub_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Refer_Sub_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Refer_Sub_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Refer_Sub_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Refer_Sub_indicies[o],t=_tsip_machine_parser_header_Refer_Sub_trans_targs[o],0!=_tsip_machine_parser_header_Refer_Sub_trans_actions[o])for(c=_tsip_machine_parser_header_Refer_Sub_trans_actions[o],d=_tsip_machine_parser_header_Refer_Sub_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Refer_Sub_actions[c-1]){case 0:e=s;break;case 1:a.b_sub=!0;break;case 2:a.b_sub=!1;break;case 3:tsk_ragel_add_param(_,s,e,a.ao_params);break;case 4:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 86>t?(tsk_utils_log_error("Failed to parse 'Refer-Sub' header: "+_),null):a},tsip_header_Session_Expires.prototype=Object.create(tsip_header.prototype);var TSIP_SESSION_EXPIRES_DEFAULT_VALUE=1800;_tsip_machine_parser_header_Session_Expires_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5],_tsip_machine_parser_header_Session_Expires_key_offsets=[0,0,4,6,8,10,12,14,16,17,19,21,23,25,27,29,31,34,39,40,42,46,52,56,57,59,62,81,82,84,102,121,126,127,129,133,152,153,155,174,175,177,180,188,189,191,195,196,202,220,227,235,243,251,253,260,269,271,274,276,279,281,284,287,288,291,292,295,296,305,314,322,330,338,346,348,354,363,372,381,383,386,389,390,391,412,433,454,475,496,517,538,559,578,583,584,586,590,611,612,614,635,655,677,681,685],_tsip_machine_parser_header_Session_Expires_trans_keys=[83,88,115,120,69,101,83,115,83,115,73,105,79,111,78,110,45,69,101,88,120,80,112,73,105,82,114,69,101,83,115,9,32,58,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,59,48,57,9,13,32,59,10,9,32,9,32,59,9,13,32,33,37,39,82,114,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,82,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,59,10,0,9,11,12,14,127,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,59,61,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,70,102,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,82,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,83,115,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,72,104,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,82,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,85,91,117,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,85,91,117,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,65,97,126,42,43,45,46,48,57,66,90,95,122,9,13,32,33,37,39,59,67,83,99,115,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,9,13,32,59,0],_tsip_machine_parser_header_Session_Expires_single_lengths=[0,4,2,2,2,2,2,2,1,2,2,2,2,2,2,2,3,3,1,2,2,4,4,1,2,3,9,1,2,8,9,5,1,2,4,9,1,2,9,1,2,3,4,1,2,4,1,0,8,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,11,11,11,11,11,11,11,11,9,5,1,2,4,11,1,2,11,10,12,4,4,0],_tsip_machine_parser_header_Session_Expires_range_lengths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,5,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,5,5,5,5,5,5,5,5,5,0,0,0,0,5,0,0,5,5,5,0,0,0],_tsip_machine_parser_header_Session_Expires_index_offsets=[0,0,5,8,11,14,17,20,23,25,28,31,34,37,40,43,46,50,55,57,60,64,70,75,77,80,84,99,101,104,118,133,139,141,144,149,164,166,169,184,186,189,193,200,202,205,210,212,216,230,235,241,247,253,256,261,268,270,273,275,278,280,283,286,288,291,293,296,298,305,312,318,324,330,336,339,343,350,357,364,366,369,372,374,376,393,410,427,444,461,478,495,512,527,533,535,538,543,560,562,565,582,598,616,621,626],_tsip_machine_parser_header_Session_Expires_indicies=[0,2,0,2,1,3,3,1,4,4,1,5,5,1,6,6,1,7,7,1,8,8,1,9,1,10,10,1,11,11,1,12,12,1,13,13,1,14,14,1,15,15,1,2,2,1,2,2,16,1,16,17,16,18,1,19,1,20,20,1,20,20,18,1,21,22,21,24,23,1,25,26,25,27,1,28,1,29,29,1,29,29,27,1,27,30,27,31,31,31,32,32,31,31,31,31,31,31,1,33,1,34,34,1,34,34,31,31,31,32,32,31,31,31,31,31,31,1,35,36,35,37,37,37,38,39,37,37,37,37,37,37,1,40,41,40,27,39,1,42,1,43,43,1,43,43,27,39,1,39,44,39,45,46,45,45,47,45,45,45,45,45,45,1,48,1,49,49,1,49,50,49,45,46,45,45,47,45,45,45,45,45,45,1,51,1,52,52,1,52,52,46,1,46,53,54,55,46,46,1,56,1,46,46,1,57,36,57,38,1,58,1,46,46,46,1,57,36,57,45,45,45,38,45,45,45,45,45,45,1,60,59,59,59,1,62,54,61,61,61,1,62,54,63,63,63,1,62,54,64,64,64,1,62,54,1,66,65,59,59,1,67,62,54,68,61,61,1,69,1,70,71,1,72,1,73,74,1,75,1,54,76,1,54,77,1,54,1,73,78,1,73,1,70,79,1,70,1,67,62,54,80,63,63,1,67,62,54,64,64,64,1,82,54,81,81,81,1,84,54,83,83,83,1,84,54,85,85,85,1,84,54,86,86,86,1,84,54,1,87,81,81,1,67,84,54,88,83,83,1,67,84,54,89,85,85,1,67,84,54,86,86,86,1,90,1,67,91,1,67,92,1,67,1,66,1,35,36,35,37,37,37,38,39,93,93,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,94,94,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,95,95,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,96,96,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,97,97,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,98,98,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,99,99,37,37,37,37,37,37,1,35,36,35,37,37,37,38,39,100,100,37,37,37,37,37,37,1,101,36,101,37,37,37,38,102,37,37,37,37,37,37,1,103,104,103,27,102,1,105,1,106,106,1,106,106,27,102,1,102,107,102,45,46,45,45,108,47,108,45,45,45,45,45,45,1,109,1,110,110,1,110,50,110,45,46,45,45,108,47,108,45,45,45,45,45,45,1,57,36,57,45,45,45,38,111,111,45,45,45,45,45,45,1,57,36,57,45,45,45,38,112,113,112,113,45,45,45,45,45,45,1,114,115,114,116,1,117,118,117,119,1,1,0],_tsip_machine_parser_header_Session_Expires_trans_targs=[2,0,16,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,21,19,20,22,46,21,26,22,23,26,24,25,27,30,84,28,29,31,46,30,26,35,31,32,33,34,36,48,42,49,37,38,39,40,41,43,45,47,44,22,105,50,83,51,54,52,53,55,70,56,68,57,58,66,59,60,64,61,62,63,65,67,69,71,79,72,75,73,74,76,77,78,80,81,82,85,86,87,88,89,90,91,92,93,97,93,94,95,96,98,101,99,100,102,103,104,22,46,26,22,46,26],_tsip_machine_parser_header_Session_Expires_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,3,0,3,0,0,0,0,0,0,1,1,0,0,9,9,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,1,0,0,0,0,0,7,7,7,5,5,5],tsip_machine_parser_header_Session_Expires_start=1,tsip_machine_parser_header_Session_Expires_first_final=105,tsip_machine_parser_header_Session_Expires_error=0,tsip_machine_parser_header_Session_Expires_en_main=1,tsip_header_Session_Expires.prototype.toString=function(){return this.i_delta_seconds>=0?tsk_string_format("{0};refresher={1}",this.i_delta_seconds,this.b_refresher_uas?"uas":"uac"):null},tsip_header_Session_Expires.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsip_header_Session_Expires(TSIP_SESSION_EXPIRES_DEFAULT_VALUE,!1);t=tsip_machine_parser_header_Session_Expires_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Session_Expires_key_offsets[t],o=_tsip_machine_parser_header_Session_Expires_index_offsets[t],n=_tsip_machine_parser_header_Session_Expires_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Session_Expires_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Session_Expires_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Session_Expires_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Session_Expires_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Session_Expires_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Session_Expires_indicies[o],t=_tsip_machine_parser_header_Session_Expires_trans_targs[o],0!=_tsip_machine_parser_header_Session_Expires_trans_actions[o])for(c=_tsip_machine_parser_header_Session_Expires_trans_actions[o],d=_tsip_machine_parser_header_Session_Expires_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Session_Expires_actions[c-1]){case 0:e=s;break;case 1:a.i_delta_seconds=tsk_ragel_parser_get_int(_,s,e);break;case 2:a.b_refresher_uas=!0;break;case 3:a.b_refresher_uas=!1;break;case 4:tsk_ragel_add_param(_,s,e,a.ao_params);break;case 5:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 105>t?(tsk_utils_log_error("Failed to parse 'Session-Expires' header: "+_),null):a},tsip_header_Subscription_State.prototype=Object.create(tsip_header.prototype),_tsip_machine_parser_header_Subscription_State_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6],_tsip_machine_parser_header_Subscription_State_key_offsets=[0,0,2,4,6,8,10,12,14,16,18,20,22,24,25,27,29,31,33,35,38,55,56,58,74,92,96,97,99,102,123,124,126,146,165,170,171,173,177,196,197,199,218,219,221,224,232,233,235,239,240,246,264,271,279,287,295,297,304,313,315,318,320,323,325,328,331,332,335,336,339,340,349,358,366,374,382,390,392,398,407,416,425,427,430,433,434,435,456,477,498,519,540,561,580,585,586,588,592,611,612,614,633,639,660,683,704,725,746,765,770,771,773,777,796,797,799,818,836,857,878,897,918,939,960,981,1002,1021,1026,1027,1029,1033,1052,1053,1055,1074,1080],_tsip_machine_parser_header_Subscription_State_trans_keys=[83,115,85,117,66,98,83,115,67,99,82,114,73,105,80,112,84,116,73,105,79,111,78,110,45,83,115,84,116,65,97,84,116,69,101,9,32,58,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,10,9,32,9,32,59,9,13,32,33,37,39,69,82,101,114,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,69,82,101,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,59,10,0,9,11,12,14,127,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,59,61,88,120,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,80,112,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,73,105,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,82,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,83,115,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,48,57,9,13,32,33,37,39,59,61,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,65,84,97,116,126,42,43,45,46,48,57,66,90,95,122,9,13,32,33,37,39,59,61,83,115,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,79,111,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,78,110,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,82,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,89,121,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,45,46,59,61,126,42,43,48,57,65,90,95,122,9,13,32,33,37,39,59,61,65,97,126,42,43,45,46,48,57,66,90,95,122,9,13,32,33,37,39,59,61,70,102,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,84,116,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,69,101,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,82,114,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,59,61,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,61,10,9,32,9,32,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,59,48,57,0],_tsip_machine_parser_header_Subscription_State_single_lengths=[0,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,3,7,1,2,6,8,4,1,2,3,11,1,2,10,9,5,1,2,4,9,1,2,9,1,2,3,4,1,2,4,1,0,8,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,11,11,11,11,11,11,9,5,1,2,4,9,1,2,9,4,11,13,11,11,11,9,5,1,2,4,9,1,2,9,8,11,11,11,11,11,11,11,11,9,5,1,2,4,9,1,2,9,4,0],_tsip_machine_parser_header_Subscription_State_range_lengths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,5,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,5,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,5,5,5,5,5,5,5,0,0,0,0,5,0,0,5,1,5,5,5,5,5,5,0,0,0,0,5,0,0,5,5,5,5,4,5,5,5,5,5,5,0,0,0,0,5,0,0,5,1,0],_tsip_machine_parser_header_Subscription_State_index_offsets=[0,0,3,6,9,12,15,18,21,24,27,30,33,36,38,41,44,47,50,53,57,70,72,75,87,101,106,108,111,115,132,134,137,153,168,174,176,179,184,199,201,204,219,221,224,228,235,237,240,245,247,251,265,270,276,282,288,291,296,303,305,308,310,313,315,318,321,323,326,328,331,333,340,347,353,359,365,371,374,378,385,392,399,401,404,407,409,411,428,445,462,479,496,513,528,534,536,539,544,559,561,564,579,585,602,621,638,655,672,687,693,695,698,703,718,720,723,738,752,769,786,802,819,836,853,870,887,902,908,910,913,918,933,935,938,953,959],_tsip_machine_parser_header_Subscription_State_indicies=[0,0,1,2,2,1,3,3,1,4,4,1,5,5,1,6,6,1,7,7,1,8,8,1,9,9,1,10,10,1,11,11,1,12,12,1,13,1,14,14,1,15,15,1,16,16,1,17,17,1,18,18,1,18,18,19,1,19,20,19,21,21,21,21,21,21,21,21,21,1,22,1,23,23,1,23,23,21,21,21,21,21,21,21,21,21,1,24,25,24,26,26,26,27,26,26,26,26,26,26,1,28,29,28,30,1,31,1,32,32,1,32,32,30,1,30,33,30,34,34,34,35,36,35,36,34,34,34,34,34,34,1,37,1,38,38,1,38,38,34,34,34,35,36,35,36,34,34,34,34,34,34,1,39,40,39,41,41,41,42,43,41,41,41,41,41,41,1,44,45,44,30,43,1,46,1,47,47,1,47,47,30,43,1,43,48,43,49,50,49,49,51,49,49,49,49,49,49,1,52,1,53,53,1,53,54,53,49,50,49,49,51,49,49,49,49,49,49,1,55,1,56,56,1,56,56,50,1,50,57,58,59,50,50,1,60,1,50,50,1,61,40,61,42,1,62,1,50,50,50,1,61,40,61,49,49,49,42,49,49,49,49,49,49,1,64,63,63,63,1,66,58,65,65,65,1,66,58,67,67,67,1,66,58,68,68,68,1,66,58,1,70,69,63,63,1,71,66,58,72,65,65,1,73,1,74,75,1,76,1,77,78,1,79,1,58,80,1,58,81,1,58,1,77,82,1,77,1,74,83,1,74,1,71,66,58,84,67,67,1,71,66,58,68,68,68,1,86,58,85,85,85,1,88,58,87,87,87,1,88,58,89,89,89,1,88,58,90,90,90,1,88,58,1,91,85,85,1,71,88,58,92,87,87,1,71,88,58,93,89,89,1,71,88,58,90,90,90,1,94,1,71,95,1,71,96,1,71,1,70,1,39,40,39,41,41,41,42,43,97,97,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,98,98,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,99,99,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,100,100,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,101,101,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,102,102,41,41,41,41,41,41,1,103,40,103,41,41,41,42,104,41,41,41,41,41,41,1,105,106,105,30,104,1,107,1,108,108,1,108,108,30,104,1,104,109,104,49,50,49,49,51,49,49,49,110,49,49,1,111,1,112,112,1,112,54,112,49,50,49,49,51,49,49,49,110,49,49,1,113,114,113,116,115,1,39,40,39,41,41,41,42,43,117,117,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,118,119,118,119,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,120,120,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,121,121,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,122,122,41,41,41,41,41,41,1,123,40,123,41,41,41,42,124,41,41,41,41,41,41,1,125,126,125,30,124,1,127,1,128,128,1,128,128,30,124,1,124,129,124,130,50,130,130,51,130,130,130,130,130,130,1,131,1,132,132,1,132,54,132,130,50,130,130,51,130,130,130,130,130,130,1,133,134,133,135,135,135,136,135,135,135,135,135,135,1,39,40,39,41,41,41,42,43,137,137,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,138,138,41,41,41,41,41,41,1,39,40,39,41,41,41,139,41,42,43,41,41,41,41,41,1,39,40,39,41,41,41,42,43,140,140,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,141,141,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,142,142,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,143,143,41,41,41,41,41,41,1,39,40,39,41,41,41,42,43,144,144,41,41,41,41,41,41,1,145,40,145,41,41,41,42,146,41,41,41,41,41,41,1,147,148,147,30,146,1,149,1,150,150,1,150,150,30,146,1,146,151,146,49,50,49,49,51,49,49,49,152,49,49,1,153,1,154,154,1,154,54,154,49,50,49,49,51,49,49,49,152,49,49,1,155,156,155,158,157,1,1,0],_tsip_machine_parser_header_Subscription_State_trans_targs=[2,0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,24,22,23,25,49,24,29,25,26,29,27,28,30,33,87,103,31,32,34,49,33,29,38,34,35,36,37,39,51,45,52,40,41,42,43,44,46,48,50,47,25,136,53,86,54,57,55,56,58,73,59,71,60,61,69,62,63,67,64,65,66,68,70,72,74,82,75,78,76,77,79,80,81,83,84,85,88,89,90,91,92,93,94,98,94,95,96,97,99,102,100,101,25,49,102,29,104,105,118,106,107,108,109,113,109,110,111,112,114,117,115,116,25,49,117,29,119,120,121,122,123,124,125,126,127,131,127,128,129,130,132,135,133,134,25,49,135,29],_tsip_machine_parser_header_Subscription_State_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,3,0,3,0,0,0,0,0,0,1,1,1,0,0,11,11,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,1,0,0,7,7,0,7,0,0,0,0,0,0,11,0,0,0,0,0,0,1,0,0,5,5,0,5,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,1,0,0,9,9,0,9],tsip_machine_parser_header_Subscription_State_start=1,tsip_machine_parser_header_Subscription_State_first_final=136,tsip_machine_parser_header_Subscription_State_error=0,tsip_machine_parser_header_Subscription_State_en_main=1,tsip_header_Subscription_State.prototype.toString=function(){var _=tsk_string_format("{0}{1}{2}",this.s_state,this.s_reason?";reason=":"",this.s_reason?this.s_reason:"");return this.i_expires>=0&&(_+=tsk_string_format(";expires={0}",this.i_expires)),this.i_retry_after>=0&&(_+=tsk_string_format(";retry-after={0}",this.i_retry_after)),_},tsip_header_Subscription_State.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsip_header_Subscription_State(null,null,-1,-1);t=tsip_machine_parser_header_Subscription_State_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_Subscription_State_key_offsets[t],o=_tsip_machine_parser_header_Subscription_State_index_offsets[t],n=_tsip_machine_parser_header_Subscription_State_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Subscription_State_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Subscription_State_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_Subscription_State_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Subscription_State_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Subscription_State_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_Subscription_State_indicies[o],t=_tsip_machine_parser_header_Subscription_State_trans_targs[o],0!=_tsip_machine_parser_header_Subscription_State_trans_actions[o])for(c=_tsip_machine_parser_header_Subscription_State_trans_actions[o],d=_tsip_machine_parser_header_Subscription_State_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_Subscription_State_actions[c-1]){case 0:e=s;break;case 1:a.s_state=tsk_ragel_parser_get_string(_,s,e);break;case 2:a.s_reason=tsk_ragel_parser_get_string(_,s,e);break;case 3:a.i_expires=tsk_ragel_parser_get_int(_,s,e);break;case 4:a.i_retry_after=tsk_ragel_parser_get_int(_,s,e);break;case 5:tsk_ragel_add_param(_,s,e,a.ao_params);break;case 6:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 136>t?(tsk_utils_log_error("Failed to parse 'Subscription-State' header: "+_),null):a},tsip_header_Via.prototype=Object.create(tsip_header.prototype),tsip_header_Via.prototype.__s_proto_name_default="SIP",tsip_header_Via.prototype.__s_proto_version_default="2.0",_tsip_machine_parser_header_Via_actions=[0,1,0,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9,1,10,1,11,1,13,1,14,1,16,2,1,0,2,4,15,2,5,15,2,7,15,2,8,15,2,9,15,2,10,15,2,11,15,2,12,13,2,13,15,2,14,15,3,12,13,15],_tsip_machine_parser_header_Via_key_offsets=[0,0,2,7,10,27,28,30,46,62,66,67,69,72,89,90,92,108,124,128,129,131,134,151,152,154,170,187,197,198,200,209,217,224,232,238,252,258,259,261,266,271,272,274,278,285,290,291,293,297,324,325,327,353,371,377,378,380,385,404,405,407,426,427,429,432,440,441,443,448,449,455,472,479,487,495,503,505,512,521,523,526,528,531,533,536,539,540,543,544,547,548,557,566,574,582,590,598,600,606,615,624,633,635,638,641,642,643,663,683,703,723,743,761,767,768,770,775,794,795,797,816,833,853,873,893,911,917,918,920,925,944,945,947,966,983,1003,1023,1043,1063,1081,1087,1088,1090,1095,1116,1117,1119,1140,1161,1181,1202,1221,1234,1241,1252,1260,1267,1273,1292,1313,1332,1353,1372,1385,1398,1411,1432,1453,1474,1495,1516,1537,1544,1552,1560,1568,1570,1577,1586,1588,1591,1593,1596,1598,1601,1604,1605,1610,1613,1614,1617,1618,1627,1636,1644,1652,1660,1668,1670,1676,1685,1694,1703,1705,1708,1711,1712,1713,1735,1755,1775,1795,1815,1835,1855,1873,1879,1880,1882,1887,1913,1914,1916,1942,1955,1957,1960,1962,1965,1967,1974,1981,1986,1989,1990,1993,1994,2007,2020,2026,2033,2045,2057,2069,2081,2087,2093,2106,2119,2132,2134,2137,2140,2141,2153,2165,2177,2178,2198,2218,2238,2244,2250,2251,2253,2258,2263,2264,2266,2270,2277,2297,2317,2335,2341,2342,2344,2349,2368,2369,2371,2390,2397,2404,2409,2416,2428,2434,2442,2448,2456,2462,2476,2490,2504,2512,2520,2528,2536,2544,2552,2559,2567,2575,2583,2585,2592,2601,2603,2606,2608,2611,2613,2616,2619,2620,2626,2629,2630,2633,2634,2643,2652,2660,2668,2676,2684,2686,2692,2701,2710,2719,2721,2724,2727,2728,2729,2731],_tsip_machine_parser_header_Via_trans_keys=[86,118,9,32,58,73,105,9,32,58,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,47,126,42,43,45,57,65,90,95,122,9,13,32,47,10,9,32,9,32,47,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,47,126,42,43,45,57,65,90,95,122,9,13,32,47,10,9,32,9,32,47,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,9,13,32,91,48,57,65,90,97,122,10,9,32,9,32,91,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,48,57,65,90,97,122,45,46,48,57,65,90,97,122,48,57,65,90,97,122,9,13,32,44,45,46,58,59,48,57,65,90,97,122,9,13,32,44,58,59,10,9,32,9,32,44,58,59,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,44,59,48,57,9,13,32,44,59,10,9,32,9,32,44,59,9,13,32,33,37,39,66,67,77,82,84,98,99,109,114,116,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,33,37,39,66,67,77,82,84,98,99,109,114,116,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,32,34,9,13,34,92,32,126,128,255,10,9,32,9,13,32,44,59,10,0,9,11,12,14,127,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,44,59,61,82,114,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,65,97,126,42,46,48,57,66,90,95,122,9,13,32,33,37,39,44,59,61,78,110,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,67,99,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,72,104,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,79,111,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,77,109,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,80,112,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,65,97,126,42,46,48,57,66,90,95,122,9,13,32,33,37,39,44,59,61,68,100,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,68,100,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,82,114,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,96,97,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,59,126,42,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,96,97,122,9,13,32,44,45,46,59,48,57,65,90,97,122,45,48,57,65,90,97,122,9,13,32,44,59,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,48,57,65,90,97,122,48,57,65,90,97,122,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,59,126,42,46,48,57,65,90,95,96,97,122,9,13,32,44,45,46,59,48,57,65,90,97,122,9,13,32,44,45,46,59,48,57,65,90,97,122,9,13,32,44,45,46,59,48,57,65,90,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,9,13,32,33,37,39,44,45,46,59,126,42,43,48,57,65,90,95,96,97,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,9,13,32,44,59,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,9,13,32,33,37,39,44,59,61,69,80,101,112,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,67,99,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,69,101,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,73,105,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,86,118,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,69,101,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,68,100,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,58,91,126,42,43,45,46,48,57,65,70,71,90,95,96,97,102,103,122,10,9,32,9,13,32,33,34,37,39,58,91,126,42,43,45,46,48,57,65,70,71,90,95,96,97,102,103,122,9,13,32,44,46,58,59,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,9,13,32,44,59,48,57,9,13,32,44,59,48,57,9,13,32,44,59,46,48,57,46,46,48,57,46,9,13,32,44,46,58,59,48,57,65,70,97,102,9,13,32,44,46,58,59,48,57,65,70,97,102,9,13,32,44,58,59,58,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,46,58,59,48,57,65,70,97,102,9,13,32,44,46,58,59,48,57,65,70,97,102,9,13,32,44,46,58,59,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,9,13,32,44,58,59,48,57,65,70,97,102,58,9,13,32,33,37,39,44,59,61,79,111,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,82,114,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,84,116,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,48,57,10,9,32,9,32,48,57,9,13,32,44,59,48,57,9,13,32,33,37,39,44,59,61,84,116,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,76,108,126,42,46,48,57,65,90,95,122,9,13,32,33,37,39,44,59,61,126,42,46,48,57,65,90,95,122,9,13,32,44,59,61,10,9,32,9,32,44,59,61,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,10,9,32,9,13,32,33,34,37,39,91,126,42,43,45,46,48,57,65,90,95,122,9,13,32,44,59,48,57,9,13,32,44,59,48,57,9,13,32,44,59,45,48,57,65,90,97,122,9,13,32,44,58,59,48,57,65,90,97,122,48,57,65,90,97,122,45,46,48,57,65,90,97,122,48,57,65,90,97,122,45,46,48,57,65,90,97,122,48,57,65,90,97,122,9,13,32,44,45,46,58,59,48,57,65,90,97,122,9,13,32,44,45,46,58,59,48,57,65,90,97,122,9,13,32,44,45,46,58,59,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,45,46,48,57,65,90,97,122,58,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,58,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,48,57,46,48,57,48,57,93,48,57,93,48,57,93,9,13,32,44,58,59,46,48,57,46,46,48,57,46,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,46,58,93,48,57,65,70,97,102,48,57,46,48,57,46,48,57,46,58,65,97,0],
_tsip_machine_parser_header_Via_single_lengths=[0,2,5,3,7,1,2,6,8,4,1,2,3,7,1,2,6,8,4,1,2,3,7,1,2,6,7,4,1,2,3,2,1,2,0,8,6,1,2,5,3,1,2,2,5,5,1,2,4,17,1,2,16,10,6,1,2,5,9,1,2,9,1,2,3,4,1,2,5,1,0,9,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,12,12,12,12,12,10,6,1,2,5,9,1,2,9,9,12,12,12,10,6,1,2,5,9,1,2,9,9,12,12,12,12,10,6,1,2,5,9,1,2,9,11,10,11,9,7,1,5,2,1,0,9,11,9,11,9,7,7,7,11,11,11,11,11,11,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,5,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,14,12,12,12,12,12,12,10,6,1,2,5,10,1,2,10,7,0,1,0,1,0,5,5,5,1,1,1,1,7,7,6,1,6,6,6,6,6,0,7,7,7,0,1,1,1,6,6,6,1,12,12,12,6,6,1,2,5,3,1,2,2,5,12,12,10,6,1,2,5,9,1,2,9,5,5,5,1,6,0,2,0,2,0,8,8,8,2,2,2,2,2,2,1,2,2,2,2,1,3,0,1,0,1,0,1,1,1,6,1,1,1,1,3,3,2,2,2,2,2,0,3,3,3,0,1,1,1,1,2,0],_tsip_machine_parser_header_Via_range_lengths=[0,0,0,0,5,0,0,5,4,0,0,0,0,5,0,0,5,4,0,0,0,0,5,0,0,5,5,3,0,0,3,3,3,3,3,3,0,0,0,0,1,0,0,1,1,0,0,0,0,5,0,0,5,4,0,0,0,0,5,0,0,5,0,0,0,2,0,0,0,0,3,4,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,4,4,4,4,4,4,0,0,0,0,5,0,0,5,4,4,4,4,4,0,0,0,0,5,0,0,5,4,4,4,4,4,4,0,0,0,0,6,0,0,6,5,5,5,5,3,3,3,3,3,3,5,5,5,5,5,3,3,3,5,5,5,5,5,5,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,4,4,4,4,4,4,4,4,0,0,0,0,8,0,0,8,3,1,1,1,1,1,1,1,0,1,0,1,0,3,3,0,3,3,3,3,3,0,3,3,3,3,1,1,1,0,3,3,3,0,4,4,4,0,0,0,0,0,1,0,0,1,1,4,4,4,0,0,0,0,5,0,0,5,1,1,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,3,3,1,1,1,1,1,1,1,0,0,1,0,1,0,3,3,3,3,3,3,0,3,3,3,3,1,1,1,0,0,0,0],_tsip_machine_parser_header_Via_index_offsets=[0,0,3,9,13,26,28,31,43,56,61,63,66,70,83,85,88,100,113,118,120,123,127,140,142,145,157,170,178,180,183,190,196,201,207,211,223,230,232,235,241,246,248,251,255,262,268,270,273,278,301,303,306,328,343,350,352,355,361,376,378,381,396,398,401,405,412,414,417,423,425,429,443,448,454,460,466,469,474,481,483,486,488,491,493,496,499,501,504,506,509,511,518,525,531,537,543,549,552,556,563,570,577,579,582,585,587,589,606,623,640,657,674,689,696,698,701,707,722,724,727,742,756,773,790,807,822,829,831,834,840,855,857,860,875,889,906,923,940,957,972,979,981,984,990,1006,1008,1011,1027,1044,1060,1077,1092,1103,1108,1117,1123,1128,1132,1147,1164,1179,1196,1211,1222,1233,1244,1261,1278,1295,1312,1329,1346,1351,1357,1363,1369,1372,1377,1384,1386,1389,1391,1394,1396,1399,1402,1404,1410,1413,1415,1418,1420,1427,1434,1440,1446,1452,1458,1461,1465,1472,1479,1486,1488,1491,1494,1496,1498,1517,1534,1551,1568,1585,1602,1619,1634,1641,1643,1646,1652,1671,1673,1676,1695,1706,1708,1711,1713,1716,1718,1725,1732,1738,1741,1743,1746,1748,1759,1770,1777,1782,1792,1802,1812,1822,1829,1833,1844,1855,1866,1868,1871,1874,1876,1886,1896,1906,1908,1925,1942,1959,1966,1973,1975,1978,1984,1989,1991,1994,1998,2005,2022,2039,2054,2061,2063,2066,2072,2087,2089,2092,2107,2114,2121,2127,2132,2142,2146,2152,2156,2162,2166,2178,2190,2202,2208,2214,2220,2226,2232,2238,2243,2249,2255,2261,2264,2269,2276,2278,2281,2283,2286,2288,2291,2294,2296,2303,2306,2308,2311,2313,2320,2327,2333,2339,2345,2351,2354,2358,2365,2372,2379,2381,2384,2387,2389,2391,2394],_tsip_machine_parser_header_Via_indicies=[0,0,1,2,2,3,4,4,1,2,2,3,1,3,5,3,6,6,6,6,6,6,6,6,6,1,7,1,8,8,1,8,8,6,6,6,6,6,6,6,6,6,1,9,10,9,11,11,11,12,11,11,11,11,11,1,13,14,13,15,1,16,1,17,17,1,17,17,15,1,15,18,15,19,19,19,19,19,19,19,19,19,1,20,1,21,21,1,21,21,19,19,19,19,19,19,19,19,19,1,22,23,22,24,24,24,25,24,24,24,24,24,1,26,27,26,28,1,29,1,30,30,1,30,30,28,1,28,31,28,32,32,32,32,32,32,32,32,32,1,33,1,34,34,1,34,34,32,32,32,32,32,32,32,32,32,1,35,36,35,37,37,37,37,37,37,37,37,37,1,38,39,38,42,40,41,41,1,43,1,44,44,1,44,44,42,40,41,41,1,45,46,47,48,48,1,45,48,48,48,1,45,49,48,48,48,1,48,50,50,1,51,52,51,53,54,55,56,57,50,50,50,1,58,59,58,3,60,61,1,62,1,63,63,1,63,63,3,60,61,1,60,64,60,65,1,66,1,67,67,1,67,67,65,1,68,69,68,70,72,71,1,73,74,73,3,61,1,75,1,76,76,1,76,76,3,61,1,61,77,61,78,78,78,79,80,81,82,83,79,80,81,82,83,78,78,78,78,78,78,1,84,1,85,85,1,85,85,78,78,78,79,80,81,82,83,79,80,81,82,83,78,78,78,78,78,78,1,86,87,86,88,88,88,89,90,91,88,88,88,88,88,1,92,93,92,3,61,91,1,94,1,95,95,1,95,95,3,61,91,1,91,96,91,97,98,97,97,99,97,97,97,97,97,97,1,100,1,101,101,1,101,102,101,97,98,97,97,99,97,97,97,97,97,97,1,103,1,104,104,1,104,104,98,1,98,105,106,107,98,98,1,108,1,98,98,1,109,87,109,89,90,1,110,1,98,98,98,1,109,87,109,97,97,97,89,90,97,97,97,97,97,1,112,111,111,111,1,114,106,113,113,113,1,114,106,115,115,115,1,114,106,116,116,116,1,114,106,1,118,117,111,111,1,119,114,106,120,113,113,1,121,1,122,123,1,124,1,125,126,1,127,1,106,128,1,106,129,1,106,1,125,130,1,125,1,122,131,1,122,1,119,114,106,132,115,115,1,119,114,106,116,116,116,1,134,106,133,133,133,1,136,106,135,135,135,1,136,106,137,137,137,1,136,106,138,138,138,1,136,106,1,139,133,133,1,119,136,106,140,135,135,1,119,136,106,141,137,137,1,119,136,106,138,138,138,1,142,1,119,143,1,119,144,1,119,1,118,1,86,87,86,88,88,88,89,90,91,145,145,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,146,146,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,147,147,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,148,148,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,149,149,88,88,88,88,88,1,150,87,150,88,88,88,89,90,151,88,88,88,88,88,1,152,153,152,3,61,151,1,154,1,155,155,1,155,155,3,61,151,1,151,156,151,157,98,157,157,99,157,157,157,157,157,157,1,158,1,159,159,1,159,102,159,157,98,157,157,99,157,157,157,157,157,157,1,160,161,160,162,162,162,163,164,162,162,162,162,162,1,86,87,86,88,88,88,89,90,91,165,165,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,166,166,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,167,167,88,88,88,88,88,1,168,87,168,88,88,88,89,90,169,88,88,88,88,88,1,170,171,170,3,61,169,1,172,1,173,173,1,173,173,3,61,169,1,169,174,169,175,98,175,175,99,175,175,175,175,175,175,1,176,1,177,177,1,177,102,177,175,98,175,175,99,175,175,175,175,175,175,1,178,179,178,180,180,180,181,182,180,180,180,180,180,1,86,87,86,88,88,88,89,90,91,183,183,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,184,184,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,185,185,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,186,186,88,88,88,88,88,1,187,87,187,88,88,88,89,90,188,88,88,88,88,88,1,189,190,189,3,61,188,1,191,1,192,192,1,192,192,3,61,188,1,188,193,188,97,98,97,97,196,97,97,97,194,195,97,195,1,197,1,198,198,1,198,102,198,97,98,97,97,196,97,97,97,194,195,97,195,1,109,87,109,97,97,97,89,199,200,90,97,97,201,202,97,202,1,109,87,109,97,97,97,89,199,90,97,97,202,202,97,202,1,109,87,109,97,97,97,89,199,203,90,97,97,202,202,97,202,1,109,87,109,97,97,97,89,90,97,97,202,204,97,204,1,205,206,205,207,208,209,210,204,204,204,1,208,204,204,204,1,205,206,205,207,210,211,204,204,1,212,213,211,211,211,1,212,211,211,211,1,211,204,204,1,109,87,109,97,97,97,89,90,97,97,214,204,97,204,1,109,87,109,97,97,97,89,199,215,90,97,97,216,202,97,202,1,109,87,109,97,97,97,89,90,97,97,217,204,97,204,1,109,87,109,97,97,97,89,199,218,90,97,97,219,202,97,202,1,109,87,109,97,97,97,89,90,97,97,220,204,97,204,1,205,206,205,207,212,213,210,221,211,211,1,205,206,205,207,212,213,210,222,211,211,1,205,206,205,207,212,213,210,211,211,211,1,109,87,109,97,97,97,89,199,218,90,97,97,223,202,97,202,1,109,87,109,97,97,97,89,199,218,90,97,97,202,202,97,202,1,109,87,109,97,97,97,89,199,215,90,97,97,224,202,97,202,1,109,87,109,97,97,97,89,199,215,90,97,97,202,202,97,202,1,109,87,109,97,97,97,89,199,200,90,97,97,225,202,97,202,1,109,87,109,97,97,97,89,199,200,90,97,97,202,202,97,202,1,227,226,226,226,1,229,230,228,228,228,1,229,230,231,231,231,1,229,230,232,232,232,1,229,230,1,234,233,226,226,1,235,229,230,236,228,228,1,237,1,238,239,1,240,1,241,242,1,243,1,230,244,1,230,245,1,230,1,205,206,205,207,210,1,241,246,1,241,1,238,247,1,238,1,235,229,230,248,231,231,1,235,229,230,232,232,232,1,250,230,249,249,249,1,252,230,251,251,251,1,252,230,253,253,253,1,252,230,254,254,254,1,252,230,1,255,249,249,1,235,252,230,256,251,251,1,235,252,230,257,253,253,1,235,252,230,254,254,254,1,258,1,235,259,1,235,260,1,235,1,234,1,86,87,86,88,88,88,89,90,91,261,262,261,262,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,263,263,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,264,264,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,265,265,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,266,266,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,267,267,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,268,268,88,88,88,88,88,1,269,87,269,88,88,88,89,90,270,88,88,88,88,88,1,271,272,271,3,61,270,1,273,1,274,274,1,274,274,3,61,270,1,270,275,270,97,98,97,97,277,99,97,97,97,276,278,97,97,278,97,1,279,1,280,280,1,280,102,280,97,98,97,97,277,99,97,97,97,276,278,97,97,278,97,1,281,282,281,283,284,286,287,285,288,288,1,289,1,290,291,1,292,1,293,294,1,295,1,281,282,281,283,287,296,1,281,282,281,283,287,297,1,281,282,281,283,287,1,293,298,1,293,1,290,299,1,290,1,281,282,281,283,284,286,287,300,301,301,1,281,282,281,283,284,286,287,302,302,302,1,281,282,281,283,286,287,1,304,303,305,305,1,281,282,281,283,307,287,306,306,306,1,281,282,281,283,309,287,308,308,308,1,281,282,281,283,309,287,310,310,310,1,281,282,281,283,309,287,311,311,311,1,281,282,281,283,309,287,1,312,306,306,1,281,282,281,283,284,309,287,313,308,308,1,281,282,281,283,284,309,287,314,310,310,1,281,282,281,283,284,309,287,311,311,311,1,315,1,284,316,1,284,317,1,284,1,281,282,281,283,286,287,288,288,288,1,281,282,281,283,286,287,301,301,301,1,281,282,281,283,286,287,302,302,302,1,304,1,86,87,86,88,88,88,89,90,91,318,318,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,319,319,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,320,320,88,88,88,88,88,1,321,322,321,323,324,325,1,326,327,326,3,61,325,1,328,1,329,329,1,329,329,3,61,325,1,325,330,325,331,1,332,1,333,333,1,333,333,331,1,334,335,334,336,338,337,1,86,87,86,88,88,88,89,90,91,339,339,88,88,88,88,88,1,86,87,86,88,88,88,89,90,91,340,340,88,88,88,88,88,1,341,87,341,88,88,88,89,90,342,88,88,88,88,88,1,343,344,343,3,61,342,1,345,1,346,346,1,346,346,3,61,342,1,342,347,342,97,98,97,97,99,97,97,97,348,97,97,1,349,1,350,350,1,350,102,350,97,98,97,97,99,97,97,97,348,97,97,1,351,352,351,353,355,354,1,351,352,351,353,355,356,1,351,352,351,353,355,1,54,50,50,50,1,51,52,51,53,56,57,48,50,50,1,357,50,50,1,45,358,359,48,48,1,360,50,50,1,45,361,362,48,48,1,363,50,50,1,51,52,51,53,45,49,56,57,364,48,48,1,51,52,51,53,45,49,56,57,365,48,48,1,51,52,51,53,45,49,56,57,48,48,48,1,45,361,366,48,48,1,45,361,48,48,48,1,45,358,367,48,48,1,45,358,48,48,48,1,45,46,368,48,48,1,45,46,48,48,48,1,370,369,369,369,1,372,373,371,371,371,1,372,373,374,374,374,1,372,373,375,375,375,1,372,373,1,377,376,369,369,1,378,372,373,379,371,371,1,380,1,381,382,1,383,1,384,385,1,386,1,373,387,1,373,388,1,373,1,51,52,51,53,56,57,1,384,389,1,384,1,381,390,1,381,1,378,372,373,391,374,374,1,378,372,373,375,375,375,1,393,373,392,392,392,1,395,373,394,394,394,1,395,373,396,396,396,1,395,373,397,397,397,1,395,373,1,398,392,392,1,378,395,373,399,394,394,1,378,395,373,400,396,396,1,378,395,373,397,397,397,1,401,1,378,402,1,378,403,1,378,1,377,1,2,2,1,1,0],_tsip_machine_parser_header_Via_trans_targs=[2,0,3,4,337,5,8,6,7,9,10,8,13,9,10,13,11,12,14,17,15,16,18,19,17,22,18,19,22,20,21,23,26,24,25,27,28,26,27,28,31,35,301,29,30,32,287,299,33,34,35,36,69,4,285,286,40,49,36,37,40,49,38,39,41,44,42,43,45,69,4,44,49,45,46,47,48,50,53,107,122,135,208,271,51,52,54,69,53,4,49,58,54,55,56,57,59,71,65,72,60,61,62,63,64,66,68,70,67,45,338,73,106,74,77,75,76,78,93,79,91,80,81,89,82,83,87,84,85,86,88,90,92,94,102,95,98,96,97,99,100,101,103,104,105,108,109,110,111,112,113,117,113,114,115,116,118,121,119,120,45,69,121,4,49,123,124,125,126,130,126,127,128,129,131,134,132,133,45,69,134,4,49,136,137,138,139,140,144,140,141,142,143,145,148,152,172,146,147,149,158,170,150,151,152,45,69,4,153,154,49,155,156,157,159,160,168,161,162,166,163,164,165,167,169,171,173,207,174,177,187,175,176,178,194,179,192,180,181,190,182,183,188,184,185,186,189,191,193,195,203,196,199,197,198,200,201,202,204,205,206,209,258,210,211,212,213,214,215,216,220,216,217,218,219,221,224,257,254,222,223,45,69,4,225,237,240,49,255,226,227,235,228,229,233,230,231,232,234,236,238,256,239,224,241,254,242,250,243,246,244,245,247,248,249,251,252,253,259,260,261,262,69,4,49,266,262,263,264,265,267,270,268,269,45,69,4,270,49,272,273,274,278,274,275,276,277,279,282,280,281,45,69,4,283,49,284,288,289,297,290,291,295,292,293,294,296,298,300,302,336,303,306,316,304,305,307,323,308,321,309,310,319,311,312,317,313,314,315,318,320,322,324,332,325,328,326,327,329,330,331,333,334,335],_tsip_machine_parser_header_Via_trans_actions=[0,0,0,0,0,0,29,0,0,3,3,0,3,0,0,0,0,0,0,1,0,0,5,5,0,5,0,0,0,0,0,0,1,0,0,11,11,0,0,0,1,1,1,0,0,0,0,0,0,0,0,32,32,32,0,0,7,7,0,0,0,0,0,0,0,1,0,0,35,35,35,0,9,0,0,0,0,0,1,1,1,1,1,1,0,0,59,59,0,59,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,0,0,0,0,0,0,1,0,0,47,47,0,47,19,0,0,0,59,0,0,0,0,0,0,1,0,0,50,50,0,50,21,0,0,0,0,59,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,41,41,41,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,0,0,0,0,0,0,1,1,1,0,0,44,44,44,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,56,56,23,0,0,0,0,0,0,1,0,0,62,62,62,0,53,0,0,59,0,0,0,0,0,0,1,0,0,38,38,38,0,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tsip_machine_parser_header_Via_start=1,tsip_machine_parser_header_Via_first_final=338,tsip_machine_parser_header_Via_error=0,tsip_machine_parser_header_Via_en_main=1,tsip_header_Via.prototype.toString=function(){var _=this.s_host&&tsk_string_contains(this.s_host,this.s_host.length,":");return tsk_string_format("{0}/{1}/{2} {3}{4}{5}{6}{7}{8}{9}{10}{11}{12}{13}{14}{15}{16}{17}{18}{19}{20}{21}",this.s_proto_name?this.s_proto_name:"SIP",this.s_proto_version?this.s_proto_version:"2.0",this.s_transport?this.s_transport:"UDP",_?"[":"",this.s_host?this.s_host:"127.0.0.1",_?"]":"",this.i_port>0?":":"",this.i_port>0?this.i_port:"",this.s_maddr?";maddr=":"",this.s_maddr?this.s_maddr:"",this.s_sigcomp_id?";sigcomp-id=":"",this.s_sigcomp_id?this.s_sigcomp_id:"",this.s_comp?";comp=":"",this.s_comp?this.s_comp:"",this.i_rport>=0?this.i_rport>0?";rport=":";rport":"",this.i_rport>0?this.i_rport:"",this.i_ttl>=0?this.i_ttl>0?";ttl=":";ttl":"",this.i_ttl>0?this.i_ttl:"",this.s_received?";received=":"",this.s_received?this.s_received:"",this.s_branch?";branch=":"",this.s_branch?this.s_branch:"")},tsip_header_Via.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new Array,n=null;t=tsip_machine_parser_header_Via_start;var o,p,c,d,l,h,u,m,g,y,f;for(o=p=c=d=l=null,h=0,u=10,m=15,g=20,y=30,f=40;;){if(_trigger_goto=!1,0>=h){if(s==i){h=y;continue}if(0==t){h=f;continue}}if(u>=h){c=_tsip_machine_parser_header_Via_key_offsets[t],p=_tsip_machine_parser_header_Via_index_offsets[t],o=_tsip_machine_parser_header_Via_single_lengths[t],_break_match=!1;do{if(o>0){for(_lower=c,_upper=c+o-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_Via_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_Via_trans_keys[_mid])){p+=_mid-c,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;c+=o,p+=o}if(o=_tsip_machine_parser_header_Via_range_lengths[t],o>0){for(_lower=c,_upper=c+(o<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_Via_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_Via_trans_keys[_mid+1])){p+=_mid-c>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;p+=o}}while(!1);if(p=_tsip_machine_parser_header_Via_indicies[p],t=_tsip_machine_parser_header_Via_trans_targs[p],0!=_tsip_machine_parser_header_Via_trans_actions[p])for(d=_tsip_machine_parser_header_Via_trans_actions[p],l=_tsip_machine_parser_header_Via_actions[d],d+=1;l>0;)switch(l-=1,d+=1,_tsip_machine_parser_header_Via_actions[d-1]){case 0:e=s;break;case 1:n||(n=new tsip_header_Via(null,null,null,null,0));break;case 2:n.s_proto_name=tsk_ragel_parser_get_string(_,s,e);break;case 3:n.s_proto_version=tsk_ragel_parser_get_string(_,s,e);break;case 4:n.s_host=tsk_ragel_parser_get_string(_,s,e),n.s_host=tsk_string_unquote(n.s_host,"[","]");break;case 5:n.i_port=tsk_ragel_parser_get_int(_,s,e);break;case 6:n.s_transport=tsk_ragel_parser_get_string(_,s,e);break;case 7:n.i_ttl=tsk_ragel_parser_get_int(_,s,e);break;case 8:n.s_maddr=tsk_ragel_parser_get_string(_,s,e);break;case 9:n.s_received=tsk_ragel_parser_get_string(_,s,e);break;case 10:n.s_branch=tsk_ragel_parser_get_string(_,s,e);break;case 11:n.s_comp=tsk_ragel_parser_get_string(_,s,e);break;case 12:n.i_rport=tsk_ragel_parser_get_int(_,s,e);break;case 13:n.i_rport<0&&(n.i_rport=0);break;case 14:n&&tsk_ragel_add_param(_,s,e,n.ao_params);break;case 15:n&&(a.push(n),n=null);break;case 16:}if(_trigger_goto)continue}if(g>=h){if(0==t){h=f;continue}if(s+=1,s!=i){h=u;continue}}if(f>=h)break}return 338>t?(tsk_utils_log_error("Failed to parse 'Via' header: "+_),null):a},tsip_header_WWW_Authenticate.prototype=Object.create(tsip_header.prototype),_tsip_machine_parser_header_WWW_Authenticate_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7],_tsip_machine_parser_header_WWW_Authenticate_key_offsets=[0,0,2,4,6,7,9,11,13,15,17,19,21,23,25,27,29,31,34,41,44,48,55,59,66,71,76,81,86,91,96,125,129,158,182,189,193,200,225,229,254,258,264,275,279,285,291,295,301,305,331,335,361,387,413,439,463,470,474,481,506,510,535,539,545,556,560,566,572,595,611,628,645,662,667,683,701,708,716,723,731,738,746,754,758,766,770,778,782,800,818,835,852,869,886,891,906,924,942,960,967,975,983,987,991,995,1021,1047,1073,1099,1123,1130,1134,1141,1166,1170,1195,1199,1205,1216,1220,1226,1232,1236,1262,1288,1314,1340,1366,1392,1418,1442,1449,1453,1460,1485,1489,1514,1537,1541,1547,1551,1556,1559,1564,1569,1574,1579,1584,1589,1594,1623,1652,1657,1662,1667,1672,1701,1706,1711,1716,1721,1750,1755,1760],_tsip_machine_parser_header_WWW_Authenticate_trans_keys=[87,119,87,119,87,119,45,65,97,85,117,84,116,72,104,69,101,78,110,84,116,73,105,67,99,65,97,84,116,69,101,9,32,58,9,13,32,68,100,0,65535,13,0,65535,10,13,0,65535,9,13,32,68,100,0,65535,10,13,0,65535,9,13,32,68,100,0,65535,13,73,105,0,65535,13,71,103,0,65535,13,69,101,0,65535,13,83,115,0,65535,13,84,116,0,65535,9,13,32,0,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,10,13,0,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,44,61,0,65535,10,13,0,65535,9,13,32,44,61,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,34,0,65535,9,13,34,92,127,0,31,32,255,256,65535,10,13,0,65535,9,13,32,44,0,65535,9,13,32,44,0,65535,10,13,0,65535,9,13,32,44,0,65535,10,13,0,65535,9,13,32,33,37,39,44,47,61,76,108,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,10,13,0,65535,9,13,32,33,37,39,44,47,61,79,111,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,78,110,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,67,99,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,69,101,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,44,61,0,65535,10,13,0,65535,9,13,32,44,61,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,34,0,65535,9,13,34,92,127,0,31,32,255,256,65535,10,13,0,65535,9,13,32,44,0,65535,10,13,0,127,128,65535,9,13,32,33,37,39,44,47,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,13,58,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,65535,13,58,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,0,47,48,57,58,65535,13,46,0,47,48,57,58,65535,13,0,47,48,57,58,65535,13,46,0,47,48,57,58,65535,13,0,47,48,57,58,65535,13,93,0,47,48,57,58,65535,13,93,0,47,48,57,58,65535,13,93,0,65535,13,46,0,47,48,57,58,65535,13,46,0,65535,13,46,0,47,48,57,58,65535,13,46,0,65535,13,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,58,93,0,65535,13,0,47,48,57,58,64,65,70,71,96,97,102,103,65535,13,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,46,58,93,0,47,48,57,59,64,65,70,71,96,97,102,103,65535,13,0,47,48,57,58,65535,13,46,0,47,48,57,58,65535,13,46,0,47,48,57,58,65535,13,46,0,65535,13,58,0,65535,10,13,0,65535,9,13,32,33,37,39,44,47,61,69,101,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,65,97,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,76,108,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,77,109,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,44,61,0,65535,10,13,0,65535,9,13,32,44,61,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,34,0,65535,9,13,34,92,127,0,31,32,255,256,65535,10,13,0,65535,9,13,32,44,0,65535,10,13,0,127,128,65535,10,13,0,65535,9,13,32,33,37,39,44,47,61,71,103,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,79,111,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,82,114,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,73,105,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,84,116,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,72,104,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,77,109,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,61,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,9,13,32,44,61,0,65535,10,13,0,65535,9,13,32,44,61,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,10,13,0,65535,9,13,32,33,34,37,39,44,47,91,126,0,41,42,57,58,64,65,90,92,94,95,122,123,65535,9,13,32,33,37,39,44,47,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,10,13,0,65535,10,13,0,127,128,65535,10,13,0,65535,9,13,32,0,65535,13,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,9,13,32,0,65535,9,13,32,0,65535,9,13,32,33,37,39,44,47,65,78,82,97,110,114,126,0,41,42,57,58,64,66,90,91,94,95,122,123,65535,0],_tsip_machine_parser_header_WWW_Authenticate_single_lengths=[0,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,3,5,1,2,5,2,5,3,3,3,3,3,3,15,2,15,10,5,2,5,11,2,11,2,4,5,2,4,4,2,4,2,12,2,12,12,12,12,10,5,2,5,11,2,11,2,4,5,2,4,2,9,2,3,3,3,3,2,4,1,2,1,2,1,2,2,2,2,2,2,2,4,4,3,3,3,3,3,1,4,4,4,1,2,2,2,2,2,12,12,12,12,10,5,2,5,11,2,11,2,4,5,2,4,2,2,12,12,12,12,12,12,12,10,5,2,5,11,2,11,9,2,2,2,3,1,3,3,3,3,3,3,3,15,15,3,3,3,3,15,3,3,3,3,15,3,3,15],_tsip_machine_parser_header_WWW_Authenticate_range_lengths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,7,1,7,7,1,1,1,7,1,7,1,1,3,1,1,1,1,1,1,7,1,7,7,7,7,7,1,1,1,7,1,7,1,1,3,1,1,2,7,7,7,7,7,1,7,7,3,3,3,3,3,3,3,1,3,1,3,1,7,7,7,7,7,7,1,7,7,7,7,3,3,3,1,1,1,7,7,7,7,7,1,1,1,7,1,7,1,1,3,1,1,2,1,7,7,7,7,7,7,7,7,1,1,1,7,1,7,7,1,2,1,1,1,1,1,1,1,1,1,1,7,7,1,1,1,1,7,1,1,1,1,7,1,1,7],_tsip_machine_parser_header_WWW_Authenticate_index_offsets=[0,0,3,6,9,11,14,17,20,23,26,29,32,35,38,41,44,47,51,58,61,65,72,76,83,88,93,98,103,108,113,136,140,163,181,188,192,199,218,222,241,245,251,260,264,270,276,280,286,290,310,314,334,354,374,394,412,419,423,430,449,453,472,476,482,491,495,501,506,523,533,544,555,566,571,581,593,598,604,609,615,620,626,632,636,642,646,652,656,668,680,691,702,713,724,729,738,750,762,774,779,785,791,795,799,803,823,843,863,883,901,908,912,919,938,942,961,965,971,980,984,990,995,999,1019,1039,1059,1079,1099,1119,1139,1157,1164,1168,1175,1194,1198,1217,1234,1238,1243,1247,1252,1255,1260,1265,1270,1275,1280,1285,1290,1313,1336,1341,1346,1351,1356,1379,1384,1389,1394,1399,1422,1427,1432],_tsip_machine_parser_header_WWW_Authenticate_indicies=[0,0,1,2,2,1,3,3,1,4,1,5,5,1,6,6,1,7,7,1,8,8,1,9,9,1,10,10,1,11,11,1,12,12,1,13,13,1,14,14,1,15,15,1,16,16,1,16,16,17,1,19,20,19,21,21,18,1,22,18,1,23,22,18,1,19,24,19,21,21,18,1,25,22,18,1,26,22,26,21,21,18,1,22,27,27,18,1,22,28,28,18,1,22,29,29,18,1,22,30,30,18,1,22,31,31,18,1,32,33,32,18,1,34,35,34,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,40,22,18,1,41,22,41,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,42,43,42,44,44,44,45,18,46,44,18,44,18,44,18,44,18,1,47,48,47,34,46,18,1,49,22,18,1,50,22,50,34,46,18,1,46,51,46,52,53,52,52,18,18,54,52,18,52,18,52,18,52,18,1,55,22,18,1,56,57,56,52,53,52,52,18,18,54,52,18,52,18,52,18,52,18,1,58,22,18,1,59,22,59,53,18,1,53,60,61,62,18,18,53,18,1,63,22,18,1,64,65,64,45,18,1,66,67,66,34,18,1,68,22,18,1,69,22,69,34,18,1,70,22,18,1,42,43,42,44,44,44,45,18,46,71,71,44,18,44,18,44,18,44,18,1,72,22,18,1,42,43,42,44,44,44,45,18,46,73,73,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,74,74,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,75,75,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,76,76,44,18,44,18,44,18,44,18,1,77,78,77,44,44,44,45,18,79,44,18,44,18,44,18,44,18,1,80,81,80,34,79,18,1,82,22,18,1,83,22,83,34,79,18,1,84,85,84,52,86,52,52,18,18,54,52,18,52,18,52,18,52,18,1,87,22,18,1,88,89,88,52,86,52,52,18,18,54,52,18,52,18,52,18,52,18,1,90,22,18,1,91,22,91,92,18,1,92,93,94,95,18,18,92,18,1,96,22,18,1,97,98,97,99,18,1,18,22,92,18,1,64,65,64,52,52,52,45,18,52,18,52,18,52,18,52,18,1,22,101,18,100,18,100,18,100,18,1,22,103,61,18,102,18,102,18,102,18,1,22,103,61,18,104,18,104,18,104,18,1,22,103,61,18,105,18,105,18,105,18,1,22,103,61,18,1,22,107,18,106,18,100,18,100,18,1,22,108,103,61,18,109,18,102,18,102,18,1,22,18,110,18,1,22,111,18,112,18,1,22,18,113,18,1,22,114,18,115,18,1,22,18,116,18,1,22,61,18,117,18,1,22,61,18,118,18,1,22,61,18,1,22,114,18,119,18,1,22,114,18,1,22,111,18,120,18,1,22,111,18,1,22,108,103,61,18,121,18,104,18,104,18,1,22,108,103,61,18,105,18,105,18,105,18,1,22,123,61,18,122,18,122,18,122,18,1,22,125,61,18,124,18,124,18,124,18,1,22,125,61,18,126,18,126,18,126,18,1,22,125,61,18,127,18,127,18,127,18,1,22,125,61,18,1,22,18,128,18,122,18,122,18,1,22,108,125,61,18,129,18,124,18,124,18,1,22,108,125,61,18,130,18,126,18,126,18,1,22,108,125,61,18,127,18,127,18,127,18,1,22,18,131,18,1,22,108,18,132,18,1,22,108,18,133,18,1,22,108,18,1,22,107,18,1,134,22,18,1,42,43,42,44,44,44,45,18,46,135,135,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,136,136,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,137,137,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,138,138,44,18,44,18,44,18,44,18,1,139,140,139,44,44,44,45,18,141,44,18,44,18,44,18,44,18,1,142,143,142,34,141,18,1,144,22,18,1,145,22,145,34,141,18,1,146,147,146,52,148,52,52,18,18,54,52,18,52,18,52,18,52,18,1,149,22,18,1,150,151,150,52,148,52,52,18,18,54,52,18,52,18,52,18,52,18,1,152,22,18,1,153,22,153,154,18,1,154,155,156,157,18,18,154,18,1,158,22,18,1,159,160,159,161,18,1,18,22,154,18,1,162,22,18,1,42,43,42,44,44,44,45,18,46,163,163,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,164,164,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,165,165,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,166,166,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,167,167,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,168,168,44,18,44,18,44,18,44,18,1,42,43,42,44,44,44,45,18,46,169,169,44,18,44,18,44,18,44,18,1,170,171,170,44,44,44,45,18,172,44,18,44,18,44,18,44,18,1,173,174,173,34,172,18,1,175,22,18,1,176,22,176,34,172,18,1,172,177,172,178,53,178,178,18,18,54,178,18,178,18,178,18,178,18,1,179,22,18,1,180,57,180,178,53,178,178,18,18,54,178,18,178,18,178,18,178,18,1,181,182,181,183,183,183,184,18,183,18,183,18,183,18,183,18,1,185,22,18,1,18,22,53,18,1,186,22,18,1,26,22,26,18,1,22,18,1,26,22,26,18,1,41,22,41,18,1,50,22,50,18,1,56,22,56,18,1,59,22,59,18,1,53,22,53,18,1,69,22,69,18,1,69,22,69,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,50,22,50,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,83,22,83,18,1,187,22,187,18,1,91,22,91,18,1,92,22,92,18,1,83,22,83,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,145,22,145,18,1,188,22,188,18,1,153,22,153,18,1,154,22,154,18,1,145,22,145,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,176,22,176,18,1,180,22,180,18,1,176,22,176,36,36,36,18,18,37,38,39,37,38,39,36,18,36,18,36,18,36,18,1,0],_tsip_machine_parser_header_WWW_Authenticate_trans_targs=[2,0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,140,24,20,142,22,143,23,25,26,27,28,29,30,31,30,31,33,49,51,105,144,32,34,50,33,30,37,34,35,145,36,38,68,42,69,146,39,40,147,41,43,44,139,148,45,48,45,46,149,47,150,123,151,52,53,54,55,56,104,59,56,57,152,58,59,60,64,153,61,62,154,63,64,65,66,67,155,45,48,30,70,103,71,74,72,73,75,90,76,88,77,78,86,79,80,84,81,82,83,85,87,89,91,99,92,95,93,94,96,97,98,100,101,102,156,106,107,108,109,110,122,113,110,111,157,112,113,114,118,158,115,116,159,117,118,119,120,121,160,45,48,30,161,124,125,126,127,128,129,130,131,138,134,131,132,162,133,135,137,163,136,45,48,137,30,164,141,61,115],_tsip_machine_parser_header_WWW_Authenticate_trans_actions=[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,15,0,0,0,0,0,0,3,3,0,0,1,1,1,1,15,0,13,13,0,13,0,0,0,15,0,0,0,0,0,15,0,0,15,0,0,0,0,15,13,13,0,0,15,0,15,0,15,0,0,0,0,13,13,0,0,0,15,0,1,1,1,15,1,1,15,0,0,0,0,0,15,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,13,13,0,0,0,15,0,1,1,1,15,1,1,15,0,0,0,0,0,15,7,7,7,15,0,0,0,0,0,0,0,13,13,0,0,0,15,0,0,1,15,0,11,11,0,11,15,0,0,0],tsip_machine_parser_header_WWW_Authenticate_start=1,tsip_machine_parser_header_WWW_Authenticate_first_final=142,tsip_machine_parser_header_WWW_Authenticate_error=0,tsip_machine_parser_header_WWW_Authenticate_en_main=1,tsip_header_WWW_Authenticate.prototype.toString=function(){return tsk_string_format('{0} realm="{1}"{2}{3}{4}{5}{6}{7}{8}{9}{10}{11}{12}{13},stale={14}{15}{16}',this.s_scheme,this.s_realm?this.s_realm:"",this.s_domain?',domain="':"",this.s_domain?this.s_domain:"",this.s_domain?'"':"",this.s_qop?',qop="':"",this.s_qop?this.s_qop:"",this.s_qop?'"':"",this.s_nonce?',nonce="':"",this.s_nonce?this.s_nonce:"",this.s_nonce?'"':"",this.s_opaque?',opaque="':"",this.s_opaque?this.s_opaque:"",this.s_opaque?'"':"",this.b_stale?"TRUE":"FALSE",this.s_algorithm?",algorithm=":"",this.s_algorithm?this.s_algorithm:"")},tsip_header_WWW_Authenticate.prototype.Parse=function(_){var e,t=0,s=0,i=_.length,r=tsk_buff_str2ib(_),a=new tsip_header_WWW_Authenticate;t=tsip_machine_parser_header_WWW_Authenticate_start;var n,o,p,c,d,l,h,u,m,g,y;for(n=o=p=c=d=null,l=0,h=10,u=15,m=20,g=30,y=40;;){if(_trigger_goto=!1,
0>=l){if(s==i){l=g;continue}if(0==t){l=y;continue}}if(h>=l){p=_tsip_machine_parser_header_WWW_Authenticate_key_offsets[t],o=_tsip_machine_parser_header_WWW_Authenticate_index_offsets[t],n=_tsip_machine_parser_header_WWW_Authenticate_single_lengths[t],_break_match=!1;do{if(n>0){for(_lower=p,_upper=p+n-1;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1),r[s]<_tsip_machine_parser_header_WWW_Authenticate_trans_keys[_mid])_upper=_mid-1;else{if(!(r[s]>_tsip_machine_parser_header_WWW_Authenticate_trans_keys[_mid])){o+=_mid-p,_break_match=!0;break}_lower=_mid+1}}if(_break_match)break;p+=n,o+=n}if(n=_tsip_machine_parser_header_WWW_Authenticate_range_lengths[t],n>0){for(_lower=p,_upper=p+(n<<1)-2;;){if(_upper<_lower)break;if(_mid=_lower+(_upper-_lower>>1&-2),r[s]<_tsip_machine_parser_header_WWW_Authenticate_trans_keys[_mid])_upper=_mid-2;else{if(!(r[s]>_tsip_machine_parser_header_WWW_Authenticate_trans_keys[_mid+1])){o+=_mid-p>>1,_break_match=!0;break}_lower=_mid+2}}if(_break_match)break;o+=n}}while(!1);if(o=_tsip_machine_parser_header_WWW_Authenticate_indicies[o],t=_tsip_machine_parser_header_WWW_Authenticate_trans_targs[o],0!=_tsip_machine_parser_header_WWW_Authenticate_trans_actions[o])for(c=_tsip_machine_parser_header_WWW_Authenticate_trans_actions[o],d=_tsip_machine_parser_header_WWW_Authenticate_actions[c],c+=1;d>0;)switch(d-=1,c+=1,_tsip_machine_parser_header_WWW_Authenticate_actions[c-1]){case 0:e=s;break;case 1:a.s_scheme="Digest";break;case 2:tsip_header.call(a,tsip_header_type_e.WWW_Authenticate);break;case 3:a.s_realm=tsk_string_unquote_2(tsk_ragel_parser_get_string(_,s,e));break;case 4:a.s_nonce=tsk_string_unquote_2(tsk_ragel_parser_get_string(_,s,e));break;case 5:a.s_algorithm=tsk_ragel_parser_get_string(_,s,e);break;case 6:tsk_ragel_add_param(_,s,e,a.ao_params);break;case 7:}if(_trigger_goto)continue}if(m>=l){if(0==t){l=y;continue}if(s+=1,s!=i){l=h;continue}}if(y>=l)break}return 142>t?(tsk_utils_log_error("Failed to parse 'WWW-Authenticate' header: "+_),null):a},_tsip_machine_parser_headers_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9,1,10,1,11,1,12,1,13,1,14,1,15,1,16,1,17,1,18,1,19,1,20,1,21,1,22,1,23,1,24,1,25,1,26,1,27,1,28,1,29,1,30,1,31],_tsip_machine_parser_headers_key_offsets=[0,0,44,61,64,69,72,73,74,76,99,118,137,156,175,192,195,200,203,204,205,207,226,245,264,281,284,289,292,293,294,296,315,334,353,372,391,410,429,448,467,486,505,522,525,530,533,534,535,537,560,579,598,615,634,655,672,675,680,683,684,685,687,706,725,742,745,750,753,754,755,757,776,795,816,835,854,871,874,879,882,883,884,886,905,924,941,962,981,1e3,1019,1038,1057,1074,1077,1082,1085,1086,1087,1089,1108,1127,1146,1163,1166,1171,1174,1175,1176,1178,1197,1216,1233,1236,1241,1244,1245,1246,1248,1269,1288,1307,1326,1343,1346,1351,1354,1355,1356,1358,1377,1396,1415,1434,1453,1470,1473,1478,1481,1482,1483,1485,1504,1523,1542,1559,1562,1567,1570,1571,1572,1574,1593,1612,1629,1648,1667,1686,1705,1724,1743,1762,1781,1798,1801,1806,1809,1810,1811,1813,1832,1851,1870,1889,1906,1925,1944,1963,1982,2003,2022,2041,2060,2079,2098,2117,2136,2153,2156,2161,2164,2168,2169,2171,2190,2209,2228,2247,2266,2285,2304,2323,2340,2343,2348,2351,2352,2353,2355,2378,2405,2424,2443,2462,2479,2482,2487,2490,2491,2492,2494,2513,2532,2551,2568,2587,2606,2625,2644,2663,2680,2683,2688,2691,2692,2693,2695,2714,2733,2752,2771,2790,2807,2810,2815,2818,2819,2820,2822,2841,2860,2877,2896,2915,2932,2935,2940,2943,2944,2945,2947,2966,2985,3004,3023,3042,3059,3062,3067,3070,3071,3072,3074,3093,3112,3131,3150,3167,3170,3175,3178,3179,3180,3182,3201,3220,3239,3256,3259,3264,3267,3268,3269,3271,3290,3309,3326,3329,3334,3337,3338,3339,3341,3360,3363,3368,3371,3372,3373,3375,3396,3415,3434,3453,3472,3489,3508,3527,3546,3565,3584,3603,3620,3623,3628,3631,3632,3633,3635,3656,3675,3694,3713,3732,3751,3770,3789,3806,3809,3814,3817,3818,3819,3821,3838,3841,3846,3849,3850,3851,3853,3874,3893,3912,3931,3950,3969,3988,4007,4026,4045,4062,4065,4070,4073,4074,4075,4077,4096,4115,4132,4151,4170,4189,4208,4227,4244,4247,4252,4255,4256,4257,4259,4278,4297,4314,4317,4322,4325,4326,4327,4329,4348,4367,4384,4403,4422,4441,4460,4479,4498,4517,4536,4555,4574,4593,4612,4629,4632,4637,4640,4644,4645,4647,4670,4689,4708,4731,4752,4771,4771,4774],_tsip_machine_parser_headers_trans_keys=[33,37,39,65,67,69,70,77,79,80,82,83,84,85,86,87,97,98,99,101,102,105,107,108,109,111,112,114,115,116,117,118,119,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,67,76,85,99,108,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,67,99,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,76,108,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,87,119,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,72,104,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,90,122,126,42,43,45,46,48,57,65,89,95,121,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,65,79,83,97,111,115,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,76,108,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,76,108,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,68,78,100,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,70,102,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,69,97,101,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,67,99,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,76,84,108,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,71,103,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,72,104,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,89,121,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,81,113,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,86,88,118,120,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,83,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,77,109,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,88,120,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,70,102,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,87,119,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,68,100,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,83,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,88,120,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,89,121,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,72,104,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,79,101,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,67,99,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,13,0,65535,10,9,32,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,90,122,126,42,43,45,46,48,57,65,89,95,121,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,69,79,83,101,111,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,67,70,80,81,97,99,102,112,113,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,83,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,68,100,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,82,114,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,68,100,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,66,98,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,89,121,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,76,108,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,67,99,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,83,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,81,113,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,66,80,98,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,74,106,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,67,99,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,68,100,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,73,79,105,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,77,109,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,83,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,77,109,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,78,83,110,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,83,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,80,112,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,79,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,68,100,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,71,103,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,10,9,32,9,32,33,37,39,58,87,119,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,87,119,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,45,46,58,126,42,43,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,85,117,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,72,104,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,78,110,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,67,99,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,84,116,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,69,101,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,13,0,65535,10,9,32,9,32,33,37,39,58,65,79,83,97,111,115,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,82,114,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,65,97,126,42,43,45,46,48,57,66,90,95,122,9,32,33,37,39,58,69,79,83,101,111,115,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,79,105,111,126,42,43,45,46,48,57,65,90,95,122,9,32,33,37,39,58,73,105,126,42,43,45,46,48,57,65,90,95,122,13,0,65535,13,0,65535,0],_tsip_machine_parser_headers_single_lengths=[0,34,7,3,3,1,1,1,2,13,9,9,9,9,7,3,3,1,1,1,2,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,9,9,9,9,9,9,7,3,3,1,1,1,2,13,9,9,9,9,11,7,3,3,1,1,1,2,9,9,7,3,3,1,1,1,2,9,9,11,9,9,7,3,3,1,1,1,2,9,9,9,11,9,9,9,9,9,7,3,3,1,1,1,2,9,9,9,7,3,3,1,1,1,2,9,9,7,3,3,1,1,1,2,11,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,7,3,3,1,1,1,2,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,9,9,9,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,9,9,9,9,11,9,9,9,9,9,9,9,7,3,3,1,2,1,2,9,9,9,9,9,9,9,9,7,3,3,1,1,1,2,13,17,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,9,9,9,9,7,3,3,1,1,1,2,9,9,11,9,9,7,3,3,1,1,1,2,9,9,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,7,3,3,1,1,1,2,9,9,9,9,7,3,3,1,1,1,2,9,9,9,7,3,3,1,1,1,2,9,9,7,3,3,1,1,1,2,9,3,3,1,1,1,2,11,9,9,9,9,7,9,9,9,9,9,9,7,3,3,1,1,1,2,11,9,9,9,9,9,9,9,7,3,3,1,1,1,2,7,3,3,1,1,1,2,11,9,9,9,9,9,9,9,9,9,7,3,3,1,1,1,2,9,9,9,9,9,9,9,9,7,3,3,1,1,1,2,9,9,7,3,3,1,1,1,2,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,3,3,1,2,1,2,13,9,9,13,11,9,0,1,1],_tsip_machine_parser_headers_range_lengths=[0,5,5,0,1,1,0,0,0,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,0,1,1,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,4,5,5,5,0,1,1,0,0,0,5,5,5,0,1,1,0,0,0,5,5,5,5,5,5,0,1,1,0,0,0,5,5,4,5,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,0,1,1,0,0,0,5,5,5,0,1,1,0,0,0,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,0,1,1,0,0,0,5,5,4,5,5,5,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,0,1,1,1,0,0,5,5,5,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,4,5,5,5,5,5,5,0,1,1,0,0,0,5,5,4,5,5,5,0,1,1,0,0,0,5,5,4,5,5,5,0,1,1,0,0,0,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,0,1,1,0,0,0,5,5,5,0,1,1,0,0,0,5,0,1,1,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,5,5,5,5,5,5,0,1,1,0,0,0,5,0,1,1,0,0,0,5,5,5,5,5,5,5,5,5,5,5,0,1,1,0,0,0,5,5,4,5,5,5,5,5,5,0,1,1,0,0,0,5,5,5,0,1,1,0,0,0,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,0,1,1,1,0,0,5,5,5,5,5,5,0,1,1],_tsip_machine_parser_headers_index_offsets=[0,0,40,53,57,62,65,67,69,72,91,106,121,136,151,164,168,173,176,178,180,183,198,213,228,241,245,250,253,255,257,260,275,290,305,320,335,350,365,380,395,410,425,438,442,447,450,452,454,457,476,491,506,520,535,552,565,569,574,577,579,581,584,599,614,627,631,636,639,641,643,646,661,676,693,708,723,736,740,745,748,750,752,755,770,785,799,816,831,846,861,876,891,904,908,913,916,918,920,923,938,953,968,981,985,990,993,995,997,1e3,1015,1030,1043,1047,1052,1055,1057,1059,1062,1079,1094,1109,1124,1137,1141,1146,1149,1151,1153,1156,1171,1186,1201,1216,1231,1244,1248,1253,1256,1258,1260,1263,1278,1293,1308,1321,1325,1330,1333,1335,1337,1340,1355,1370,1384,1399,1414,1429,1444,1459,1474,1489,1504,1517,1521,1526,1529,1531,1533,1536,1551,1566,1581,1596,1610,1625,1640,1655,1670,1687,1702,1717,1732,1747,1762,1777,1792,1805,1809,1814,1817,1821,1823,1826,1841,1856,1871,1886,1901,1916,1931,1946,1959,1963,1968,1971,1973,1975,1978,1997,2020,2035,2050,2065,2078,2082,2087,2090,2092,2094,2097,2112,2127,2142,2156,2171,2186,2201,2216,2231,2244,2248,2253,2256,2258,2260,2263,2278,2293,2309,2324,2339,2352,2356,2361,2364,2366,2368,2371,2386,2401,2415,2430,2445,2458,2462,2467,2470,2472,2474,2477,2492,2507,2522,2537,2552,2565,2569,2574,2577,2579,2581,2584,2599,2614,2629,2644,2657,2661,2666,2669,2671,2673,2676,2691,2706,2721,2734,2738,2743,2746,2748,2750,2753,2768,2783,2796,2800,2805,2808,2810,2812,2815,2830,2834,2839,2842,2844,2846,2849,2866,2881,2896,2911,2926,2939,2954,2969,2984,2999,3014,3029,3042,3046,3051,3054,3056,3058,3061,3078,3093,3108,3123,3138,3153,3168,3183,3196,3200,3205,3208,3210,3212,3215,3228,3232,3237,3240,3242,3244,3247,3264,3279,3294,3309,3324,3339,3354,3369,3384,3399,3412,3416,3421,3424,3426,3428,3431,3446,3461,3475,3490,3505,3520,3535,3550,3563,3567,3572,3575,3577,3579,3582,3597,3612,3625,3629,3634,3637,3639,3641,3644,3659,3674,3688,3703,3718,3733,3748,3763,3778,3793,3808,3823,3838,3853,3868,3881,3885,3890,3893,3897,3899,3902,3921,3936,3951,3970,3987,4002,4003,4006],_tsip_machine_parser_headers_indicies=[0,0,0,2,3,4,5,6,7,8,9,10,11,12,13,14,2,15,16,4,17,18,19,20,21,7,8,22,10,23,12,24,14,0,0,0,0,0,0,1,25,25,0,0,0,26,0,0,0,0,0,0,1,25,25,26,1,26,28,26,27,1,29,27,1,30,1,31,1,27,27,1,25,25,0,0,0,26,32,33,34,32,33,34,0,0,0,0,0,0,1,25,25,0,0,0,26,35,35,0,0,0,0,0,0,1,25,25,0,0,0,26,36,36,0,0,0,0,0,0,1,25,25,0,0,0,26,37,37,0,0,0,0,0,0,1,25,25,0,0,0,26,38,38,0,0,0,0,0,0,1,39,39,0,0,0,40,0,0,0,0,0,0,1,39,39,40,1,40,42,40,41,1,43,41,1,44,1,45,1,41,41,1,25,25,0,0,0,26,46,46,0,0,0,0,0,0,1,25,25,0,0,0,26,47,47,0,0,0,0,0,0,1,25,25,0,0,0,26,48,48,0,0,0,0,0,0,1,49,49,0,0,0,50,0,0,0,0,0,0,1,49,49,50,1,50,52,50,51,1,53,51,1,54,1,55,1,51,51,1,25,25,0,0,0,26,56,56,0,0,0,0,0,0,1,25,25,0,0,0,26,57,57,0,0,0,0,0,0,1,25,25,0,0,0,26,58,58,0,0,0,0,0,0,1,25,25,0,0,0,26,59,59,0,0,0,0,0,0,1,25,25,0,0,0,26,60,60,0,0,0,0,0,0,1,25,25,0,0,0,26,61,61,0,0,0,0,0,0,1,25,25,0,0,0,26,62,62,0,0,0,0,0,0,1,25,25,0,0,0,26,63,63,0,0,0,0,0,0,1,25,25,0,0,0,26,64,64,0,0,0,0,0,0,1,25,25,0,0,0,26,65,65,0,0,0,0,0,0,1,25,25,0,0,0,26,66,66,0,0,0,0,0,0,1,67,67,0,0,0,68,0,0,0,0,0,0,1,67,67,68,1,68,70,68,69,1,71,69,1,72,1,73,1,69,69,1,25,25,0,0,0,26,74,75,76,74,75,76,0,0,0,0,0,0,1,25,25,0,0,0,26,77,77,0,0,0,0,0,0,1,25,25,0,0,0,26,78,78,0,0,0,0,0,0,1,25,25,0,0,0,79,0,26,0,0,0,0,0,1,25,25,0,0,0,26,80,80,0,0,0,0,0,0,1,25,25,0,0,0,26,18,81,18,81,0,0,0,0,0,0,1,82,82,0,0,0,83,0,0,0,0,0,0,1,82,82,83,1,83,85,83,84,1,86,84,1,87,1,88,1,84,84,1,25,25,0,0,0,26,89,89,0,0,0,0,0,0,1,25,25,0,0,0,26,90,90,0,0,0,0,0,0,1,91,91,0,0,0,92,0,0,0,0,0,0,1,91,91,92,1,92,94,92,93,1,95,93,1,96,1,97,1,93,93,1,25,25,0,0,0,26,98,98,0,0,0,0,0,0,1,25,25,0,0,0,26,99,99,0,0,0,0,0,0,1,25,25,0,0,0,26,100,101,100,101,0,0,0,0,0,0,1,25,25,0,0,0,26,102,102,0,0,0,0,0,0,1,25,25,0,0,0,26,103,103,0,0,0,0,0,0,1,104,104,0,0,0,105,0,0,0,0,0,0,1,104,104,105,1,105,107,105,106,1,108,106,1,109,1,110,1,106,106,1,25,25,0,0,0,26,111,111,0,0,0,0,0,0,1,25,25,0,0,0,26,112,112,0,0,0,0,0,0,1,25,25,0,0,0,113,0,26,0,0,0,0,0,1,25,25,0,0,0,26,114,115,114,115,0,0,0,0,0,0,1,25,25,0,0,0,26,116,116,0,0,0,0,0,0,1,25,25,0,0,0,26,117,117,0,0,0,0,0,0,1,25,25,0,0,0,26,118,118,0,0,0,0,0,0,1,25,25,0,0,0,26,119,119,0,0,0,0,0,0,1,25,25,0,0,0,26,20,20,0,0,0,0,0,0,1,120,120,0,0,0,121,0,0,0,0,0,0,1,120,120,121,1,121,123,121,122,1,124,122,1,125,1,126,1,122,122,1,25,25,0,0,0,26,127,127,0,0,0,0,0,0,1,25,25,0,0,0,26,128,128,0,0,0,0,0,0,1,25,25,0,0,0,26,129,129,0,0,0,0,0,0,1,130,130,0,0,0,131,0,0,0,0,0,0,1,130,130,131,1,131,133,131,132,1,134,132,1,135,1,136,1,132,132,1,25,25,0,0,0,26,137,137,0,0,0,0,0,0,1,25,25,0,0,0,26,138,138,0,0,0,0,0,0,1,139,139,0,0,0,140,0,0,0,0,0,0,1,139,139,140,1,140,142,140,141,1,143,141,1,144,1,145,1,141,141,1,25,25,0,0,0,26,146,147,146,147,0,0,0,0,0,0,1,25,25,0,0,0,26,148,148,0,0,0,0,0,0,1,25,25,0,0,0,26,149,149,0,0,0,0,0,0,1,25,25,0,0,0,26,7,7,0,0,0,0,0,0,1,150,150,0,0,0,151,0,0,0,0,0,0,1,150,150,151,1,151,153,151,152,1,154,152,1,155,1,156,1,152,152,1,25,25,0,0,0,26,157,157,0,0,0,0,0,0,1,25,25,0,0,0,26,158,158,0,0,0,0,0,0,1,25,25,0,0,0,26,159,159,0,0,0,0,0,0,1,25,25,0,0,0,26,160,160,0,0,0,0,0,0,1,25,25,0,0,0,26,161,161,0,0,0,0,0,0,1,162,162,0,0,0,163,0,0,0,0,0,0,1,162,162,163,1,163,165,163,164,1,166,164,1,167,1,168,1,164,164,1,25,25,0,0,0,26,169,169,0,0,0,0,0,0,1,25,25,0,0,0,26,170,170,0,0,0,0,0,0,1,25,25,0,0,0,26,171,171,0,0,0,0,0,0,1,172,172,0,0,0,173,0,0,0,0,0,0,1,172,172,173,1,173,175,173,174,1,176,174,1,177,1,178,1,174,174,1,25,25,0,0,0,26,179,179,0,0,0,0,0,0,1,25,25,0,0,0,26,180,180,0,0,0,0,0,0,1,25,25,0,0,0,181,0,26,0,0,0,0,0,1,25,25,0,0,0,26,182,182,0,0,0,0,0,0,1,25,25,0,0,0,26,183,183,0,0,0,0,0,0,1,25,25,0,0,0,26,184,184,0,0,0,0,0,0,1,25,25,0,0,0,26,185,185,0,0,0,0,0,0,1,25,25,0,0,0,26,186,186,0,0,0,0,0,0,1,25,25,0,0,0,26,187,187,0,0,0,0,0,0,1,25,25,0,0,0,26,188,188,0,0,0,0,0,0,1,25,25,0,0,0,26,189,189,0,0,0,0,0,0,1,190,190,0,0,0,191,0,0,0,0,0,0,1,190,190,191,1,191,193,191,192,1,194,192,1,195,1,196,1,192,192,1,25,25,0,0,0,26,197,197,0,0,0,0,0,0,1,25,25,0,0,0,26,198,198,0,0,0,0,0,0,1,25,25,0,0,0,26,199,199,0,0,0,0,0,0,1,25,25,0,0,0,26,200,200,0,0,0,0,0,0,1,25,25,0,0,0,201,0,26,0,0,0,0,0,1,25,25,0,0,0,26,202,202,0,0,0,0,0,0,1,25,25,0,0,0,26,203,203,0,0,0,0,0,0,1,25,25,0,0,0,26,204,204,0,0,0,0,0,0,1,25,25,0,0,0,26,205,205,0,0,0,0,0,0,1,25,25,0,0,0,26,206,207,206,207,0,0,0,0,0,0,1,25,25,0,0,0,26,208,208,0,0,0,0,0,0,1,25,25,0,0,0,26,209,209,0,0,0,0,0,0,1,25,25,0,0,0,26,210,210,0,0,0,0,0,0,1,25,25,0,0,0,26,211,211,0,0,0,0,0,0,1,25,25,0,0,0,26,212,212,0,0,0,0,0,0,1,25,25,0,0,0,26,213,213,0,0,0,0,0,0,1,25,25,0,0,0,26,214,214,0,0,0,0,0,0,1,215,215,0,0,0,216,0,0,0,0,0,0,1,215,215,216,1,216,218,216,217,1,219,217,1,220,219,217,1,221,1,217,217,1,25,25,0,0,0,26,222,222,0,0,0,0,0,0,1,25,25,0,0,0,26,223,223,0,0,0,0,0,0,1,25,25,0,0,0,26,224,224,0,0,0,0,0,0,1,25,25,0,0,0,26,225,225,0,0,0,0,0,0,1,25,25,0,0,0,26,226,226,0,0,0,0,0,0,1,25,25,0,0,0,26,227,227,0,0,0,0,0,0,1,25,25,0,0,0,26,228,228,0,0,0,0,0,0,1,25,25,0,0,0,26,229,229,0,0,0,0,0,0,1,230,230,0,0,0,231,0,0,0,0,0,0,1,230,230,231,1,231,233,231,232,1,234,232,1,235,1,236,1,232,232,1,25,25,0,0,0,26,237,238,239,237,238,239,0,0,0,0,0,0,1,25,25,0,0,0,26,240,241,242,243,244,240,241,242,243,244,0,0,0,0,0,0,1,25,25,0,0,0,26,245,245,0,0,0,0,0,0,1,25,25,0,0,0,26,246,246,0,0,0,0,0,0,1,25,25,0,0,0,26,247,247,0,0,0,0,0,0,1,248,248,0,0,0,249,0,0,0,0,0,0,1,248,248,249,1,249,251,249,250,1,252,250,1,253,1,254,1,250,250,1,25,25,0,0,0,26,255,255,0,0,0,0,0,0,1,25,25,0,0,0,26,256,256,0,0,0,0,0,0,1,25,25,0,0,0,26,257,257,0,0,0,0,0,0,1,25,25,0,0,0,258,0,26,0,0,0,0,0,1,25,25,0,0,0,26,259,259,0,0,0,0,0,0,1,25,25,0,0,0,26,260,260,0,0,0,0,0,0,1,25,25,0,0,0,26,261,261,0,0,0,0,0,0,1,25,25,0,0,0,26,262,262,0,0,0,0,0,0,1,25,25,0,0,0,26,263,263,0,0,0,0,0,0,1,264,264,0,0,0,265,0,0,0,0,0,0,1,264,264,265,1,265,267,265,266,1,268,266,1,269,1,270,1,266,266,1,25,25,0,0,0,26,271,271,0,0,0,0,0,0,1,25,25,0,0,0,26,272,272,0,0,0,0,0,0,1,25,25,0,0,0,273,0,26,274,274,0,0,0,0,0,1,25,25,0,0,0,26,275,275,0,0,0,0,0,0,1,25,25,0,0,0,26,276,276,0,0,0,0,0,0,1,277,277,0,0,0,278,0,0,0,0,0,0,1,277,277,278,1,278,280,278,279,1,281,279,1,282,1,283,1,279,279,1,25,25,0,0,0,26,284,284,0,0,0,0,0,0,1,25,25,0,0,0,26,285,285,0,0,0,0,0,0,1,25,25,0,0,0,286,0,26,0,0,0,0,0,1,25,25,0,0,0,26,287,287,0,0,0,0,0,0,1,25,25,0,0,0,26,15,15,0,0,0,0,0,0,1,288,288,0,0,0,289,0,0,0,0,0,0,1,288,288,289,1,289,291,289,290,1,292,290,1,293,1,294,1,290,290,1,25,25,0,0,0,26,295,295,0,0,0,0,0,0,1,25,25,0,0,0,26,296,296,0,0,0,0,0,0,1,25,25,0,0,0,26,297,297,0,0,0,0,0,0,1,25,25,0,0,0,26,298,298,0,0,0,0,0,0,1,25,25,0,0,0,26,299,299,0,0,0,0,0,0,1,300,300,0,0,0,301,0,0,0,0,0,0,1,300,300,301,1,301,303,301,302,1,304,302,1,305,1,306,1,302,302,1,25,25,0,0,0,26,307,307,0,0,0,0,0,0,1,25,25,0,0,0,26,308,308,0,0,0,0,0,0,1,25,25,0,0,0,26,309,309,0,0,0,0,0,0,1,25,25,0,0,0,26,310,310,0,0,0,0,0,0,1,311,311,0,0,0,312,0,0,0,0,0,0,1,311,311,312,1,312,314,312,313,1,315,313,1,316,1,317,1,313,313,1,25,25,0,0,0,26,318,318,0,0,0,0,0,0,1,25,25,0,0,0,26,319,319,0,0,0,0,0,0,1,25,25,0,0,0,26,320,320,0,0,0,0,0,0,1,321,321,0,0,0,322,0,0,0,0,0,0,1,321,321,322,1,322,324,322,323,1,325,323,1,326,1,327,1,323,323,1,25,25,0,0,0,26,328,328,0,0,0,0,0,0,1,25,25,0,0,0,26,329,329,0,0,0,0,0,0,1,330,330,0,0,0,331,0,0,0,0,0,0,1,330,330,331,1,331,333,331,332,1,334,332,1,335,1,336,1,332,332,1,337,337,0,0,0,338,339,339,0,0,0,0,0,0,1,337,337,338,1,338,341,338,340,1,342,340,1,343,1,344,1,340,340,1,25,25,0,0,0,26,345,346,345,346,0,0,0,0,0,0,1,25,25,0,0,0,26,347,347,0,0,0,0,0,0,1,25,25,0,0,0,26,348,348,0,0,0,0,0,0,1,25,25,0,0,0,26,349,349,0,0,0,0,0,0,1,25,25,0,0,0,26,350,350,0,0,0,0,0,0,1,337,337,0,0,0,338,0,0,0,0,0,0,1,25,25,0,0,0,26,351,351,0,0,0,0,0,0,1,25,25,0,0,0,26,352,352,0,0,0,0,0,0,1,25,25,0,0,0,26,353,353,0,0,0,0,0,0,1,25,25,0,0,0,26,354,354,0,0,0,0,0,0,1,25,25,0,0,0,26,355,355,0,0,0,0,0,0,1,25,25,0,0,0,26,19,19,0,0,0,0,0,0,1,356,356,0,0,0,357,0,0,0,0,0,0,1,356,356,357,1,357,359,357,358,1,360,358,1,361,1,362,1,358,358,1,25,25,0,0,0,26,363,364,363,364,0,0,0,0,0,0,1,25,25,0,0,0,26,365,365,0,0,0,0,0,0,1,25,25,0,0,0,26,366,366,0,0,0,0,0,0,1,25,25,0,0,0,26,367,367,0,0,0,0,0,0,1,25,25,0,0,0,26,368,368,0,0,0,0,0,0,1,25,25,0,0,0,26,369,369,0,0,0,0,0,0,1,25,25,0,0,0,26,370,370,0,0,0,0,0,0,1,25,25,0,0,0,26,371,371,0,0,0,0,0,0,1,372,372,0,0,0,373,0,0,0,0,0,0,1,372,372,373,1,373,375,373,374,1,376,374,1,377,1,378,1,374,374,1,379,379,0,0,0,380,0,0,0,0,0,0,1,379,379,380,1,380,382,380,381,1,383,381,1,384,1,385,1,381,381,1,25,25,0,0,0,26,386,387,386,387,0,0,0,0,0,0,1,25,25,0,0,0,26,388,388,0,0,0,0,0,0,1,25,25,0,0,0,26,389,389,0,0,0,0,0,0,1,25,25,0,0,0,26,390,390,0,0,0,0,0,0,1,25,25,0,0,0,26,391,391,0,0,0,0,0,0,1,25,25,0,0,0,26,392,392,0,0,0,0,0,0,1,25,25,0,0,0,26,393,393,0,0,0,0,0,0,1,25,25,0,0,0,26,394,394,0,0,0,0,0,0,1,25,25,0,0,0,26,395,395,0,0,0,0,0,0,1,25,25,0,0,0,26,396,396,0,0,0,0,0,0,1,397,397,0,0,0,398,0,0,0,0,0,0,1,397,397,398,1,398,400,398,399,1,401,399,1,402,1,403,1,399,399,1,25,25,0,0,0,26,404,404,0,0,0,0,0,0,1,25,25,0,0,0,26,405,405,0,0,0,0,0,0,1,25,25,0,0,0,406,0,26,0,0,0,0,0,1,25,25,0,0,0,26,407,407,0,0,0,0,0,0,1,25,25,0,0,0,26,408,408,0,0,0,0,0,0,1,25,25,0,0,0,26,409,409,0,0,0,0,0,0,1,25,25,0,0,0,26,410,410,0,0,0,0,0,0,1,25,25,0,0,0,26,411,411,0,0,0,0,0,0,1,412,412,0,0,0,413,0,0,0,0,0,0,1,412,412,413,1,413,415,413,414,1,416,414,1,417,1,418,1,414,414,1,25,25,0,0,0,26,419,419,0,0,0,0,0,0,1,25,25,0,0,0,26,420,420,0,0,0,0,0,0,1,421,421,0,0,0,422,0,0,0,0,0,0,1,421,421,422,1,422,424,422,423,1,425,423,1,426,1,427,1,423,423,1,25,25,0,0,0,26,428,428,0,0,0,0,0,0,1,25,25,0,0,0,26,429,429,0,0,0,0,0,0,1,25,25,0,0,0,430,0,26,0,0,0,0,0,1,25,25,0,0,0,26,431,431,0,0,0,0,0,0,1,25,25,0,0,0,26,432,432,0,0,0,0,0,0,1,25,25,0,0,0,26,433,433,0,0,0,0,0,0,1,25,25,0,0,0,26,434,434,0,0,0,0,0,0,1,25,25,0,0,0,26,435,435,0,0,0,0,0,0,1,25,25,0,0,0,26,436,436,0,0,0,0,0,0,1,25,25,0,0,0,26,437,437,0,0,0,0,0,0,1,25,25,0,0,0,26,438,438,0,0,0,0,0,0,1,25,25,0,0,0,26,439,439,0,0,0,0,0,0,1,25,25,0,0,0,26,440,440,0,0,0,0,0,0,1,25,25,0,0,0,26,441,441,0,0,0,0,0,0,1,25,25,0,0,0,26,442,442,0,0,0,0,0,0,1,443,443,0,0,0,444,0,0,0,0,0,0,1,443,443,444,1,444,446,444,445,1,447,445,1,448,447,445,1,449,1,445,445,1,130,130,0,0,0,131,74,75,76,74,75,76,0,0,0,0,0,0,1,172,172,0,0,0,173,169,169,0,0,0,0,0,0,1,104,104,0,0,0,105,179,179,0,0,0,0,0,0,1,277,277,0,0,0,278,237,238,239,237,238,239,0,0,0,0,0,0,1,379,379,0,0,0,380,363,364,363,364,0,0,0,0,0,0,1,421,421,0,0,0,422,419,419,0,0,0,0,0,0,1,1,219,217,1,447,445,1,0],
_tsip_machine_parser_headers_trans_targs=[2,0,9,49,118,141,151,122,169,208,302,328,350,382,391,253,413,414,55,321,92,415,416,417,418,3,4,5,7,6,419,8,10,21,31,11,12,13,14,15,16,17,19,18,419,20,22,23,24,25,26,27,29,28,419,30,32,33,34,35,36,37,38,39,40,41,42,43,44,45,47,46,419,48,50,71,109,51,52,53,54,62,56,57,58,60,59,419,61,63,64,65,66,67,69,68,419,70,72,73,74,83,75,76,77,78,79,81,80,419,82,84,85,86,87,99,88,89,90,91,93,94,95,97,96,419,98,100,101,102,103,104,105,107,106,419,108,110,111,112,113,114,116,115,419,117,119,129,120,121,123,124,125,127,126,419,128,130,131,132,133,134,135,136,137,139,138,419,140,142,143,144,145,146,147,149,148,419,150,152,153,154,155,156,157,158,159,160,161,162,163,164,165,167,166,419,168,170,171,172,173,174,175,176,177,178,179,193,180,181,182,183,184,185,186,187,188,189,191,190,420,192,194,195,196,197,198,199,200,201,202,203,204,206,205,419,207,209,283,293,210,220,236,260,272,211,212,213,214,215,216,218,217,419,219,221,222,223,224,225,226,227,228,229,230,231,232,234,233,419,235,237,238,239,248,240,241,242,243,244,246,245,419,247,249,250,251,252,254,255,256,258,257,419,259,261,262,263,264,265,266,267,268,270,269,419,271,273,274,275,276,277,278,279,281,280,419,282,284,285,286,287,288,289,291,290,419,292,294,295,296,297,298,300,299,419,301,303,304,309,305,307,306,419,308,310,315,311,312,313,314,316,317,318,319,320,322,323,324,326,325,419,327,329,343,330,331,332,333,334,335,336,337,338,339,341,340,419,342,344,345,346,348,347,419,349,351,367,352,353,354,355,356,357,358,359,360,361,362,363,365,364,419,366,368,369,370,371,372,373,374,375,376,377,378,380,379,419,381,383,384,385,386,387,389,388,419,390,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,411,410,421,412],_tsip_machine_parser_headers_trans_actions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,21,0,0,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,33,0,0,0,0,0,0,0,0,0,0,0,0,35,0,0,0,0,0,0,0,0,0,0,37,0,0,0,0,0,0,0,0,0,0,0,39,0,0,0,0,0,0,0,0,0,0,41,0,0,0,0,0,0,0,0,0,43,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,51,0,0,0,0,0,0,53,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,57,0,0,0,0,0,0,0,0,59,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61,0],tsip_machine_parser_headers_start=1,tsip_machine_parser_headers_first_final=419,tsip_machine_parser_headers_error=0,tsip_machine_parser_headers_en_main=1,tsip_transac.prototype.__magic_cookie="z9hG4bK";var tsip_transac_event_type_e={INCOMING_MSG:0,OUTGOING_MSG:1,CANCELED:2,TERMINATED:3,TIMEDOUT:4,ERROR:5,TRANSPORT_ERROR:6},tsip_transac_type_e={NONE:-1,ICT:0,IST:1,NICT:2,NIST:3};tsip_transac.prototype.init=function(_,e,t,s,i,r,a,n){return this.b_initialized||(this.e_type=_,this.b_reliable=e,this.i_cseq_value=t,this.s_cseq_method=s,this.s_callid=i,this.o_dialog=r,this.o_fsm=new tsk_fsm(a,n,null,this),this.b_initialized=!0),0},tsip_transac.prototype.deinit=function(){return this.get_stack().o_layer_transac.remove(this),this.b_initialized=!1,0},tsip_transac.prototype.timer_schedule=function(T,N){this.timer_cancel(N);var This=this,s_code=tsk_string_format("This.o_timer{1} = setTimeout(function(){ __tsip_transac_{0}_timer_callback(This, This.o_timer{1})}, This.i_timer{1});",T,N);eval(s_code)},tsip_transac.prototype.timer_cancel=function(N){var s_code=tsk_string_format("if(this.o_timer{0}) { clearTimeout(this.o_timer{0}); this.o_timer{0} = null; }",N);eval(s_code)},tsip_transac.prototype.set_callback=function(_){this.fn_callback=_},tsip_transac.prototype.send=function(_,e){return this.get_stack().o_layer_transport.send(_,e)},tsip_transac.prototype.callback=function(_,e){return this.fn_callback?this.fn_callback(this,_,e):(tsk_utils_log_error("Invalid callback function"),-1)},tsip_transac.prototype.get_type=function(){return this.e_type},tsip_transac.prototype.get_fsm=function(){return this.o_fsm},tsip_transac.prototype.get_dialog=function(){return this.o_dialog},tsip_transac.prototype.get_session=function(){return this.o_dialog?this.o_dialog.o_session:null},tsip_transac.prototype.get_stack=function(){var _=this.get_session();return _?_.o_stack:null},tsip_transac.prototype.fsm_act=function(_,e){return this.o_fsm?this.o_fsm.act(_,this,e,this,e):(tsk_utils_log_error("Invalid argument"),-1)},tsip_transac.prototype.send=function(_,e){var t=this.get_stack();return t&&t.o_layer_transport?t.o_layer_transport.send(_,e):(tsk_utils_log_error("Invalid state"),-1)},tsip_transac.prototype.compare=function(_){return tsip_transac_compare(this,_)},window.__b_release_mode||tsip_api_add_js_scripts("head","src/tinySIP/src/transactions/tsip_transac_ict.js","src/tinySIP/src/transactions/tsip_transac_ist.js","src/tinySIP/src/transactions/tsip_transac_layer.js","src/tinySIP/src/transactions/tsip_transac_nict.js","src/tinySIP/src/transactions/tsip_transac_nist.js"),tsip_transac_ict.prototype=Object.create(tsip_transac.prototype),tsip_transac_ict.prototype.__b_debug_state_machine=!1;var tsip_transac_ict_actions_e={CANCEL:tsip_action_type_e.CANCEL,SEND:10001,TIMER_A:10002,TIMER_B:10003,TIMER_D:10004,TIMER_M:10005,I_1XX:10006,I_2XX:10007,I_300_to_699:10008,TRANSPOR_TERROR:10009,ERROR:10010},tsip_transac_ict_states_e={STARTED:0,CALLING:1,PROCEEDING:2,COMPLETED:3,ACCEPTED:4,TERMINATED:5};tsip_transac_ict.prototype.start=function(_){var e=-1;return _&&!this.b_running&&(this.s_branch=tsk_string_format("{0}{1}",tsip_transac.prototype.__magic_cookie,tsk_string_random(32)),this.b_running=!0,this.o_request=_,e=this.fsm_act(tsip_transac_ict_actions_e.SEND,_)),e},tsip_transac_ict.prototype.send_ack=function(_){if(!this.o_request||!_)return tsk_utils_log_error("Invalid state"),-1;if(!(this.o_request.o_hdr_firstVia&&this.o_request.o_hdr_From&&this.o_request.line.request.o_uri&&this.o_request.o_hdr_Call_ID&&this.o_request.o_hdr_CSeq))return tsk_utils_log_error("Invalid INVITE message"),-2;if(!_.o_hdr_To)return tsk_utils_log_error("Invalid response message"),-3;var e=-1,t=null;if(t=new tsip_request("ACK",this.o_request.line.request.o_uri,this.o_request.o_hdr_From.o_uri,_.o_hdr_To.o_uri,this.o_request.o_hdr_Call_ID.s_value,this.o_request.o_hdr_CSeq.i_seq)){if(t.o_hdr_firstVia=this.o_request.o_hdr_firstVia,t.o_hdr_From&&(t.o_hdr_From.s_tag=this.o_request.o_hdr_From.s_tag),t.o_hdr_To&&(t.o_hdr_To.s_tag=_.o_hdr_To.s_tag),this.get_stack().network.e_proxy_cscf_type==tsip_transport_type_e.WS||this.get_stack().network.e_proxy_cscf_type==tsip_transport_type_e.WSS){var s=this.get_stack().__get_proxy_outbound_uri_string();s&&t.add_header(new tsip_header_Dummy("Route",s),!0)}for(var i=0;i<this.o_request.ao_headers.length;++i)this.o_request.ao_headers[i].e_type==tsip_header_type_e.Route&&t.add_header(this.o_request.ao_headers[i]);t.s_sigcomp_id=this.get_session().s_sigcomp_id,e=this.send(t.o_hdr_firstVia.s_branch,t)}return e},tsip_transac_ist.prototype=Object.create(tsip_transac.prototype),tsip_transac_ist.prototype.__b_debug_state_machine=!0;var tsip_transac_ist_actions_e={CANCEL:tsip_action_type_e.CANCEL,RECV_INVITE:10001,RECV_ACK:10002,SEND_1XX:10003,SEND_2XX:10004,SEND_300_to_699:10005,SEND_NON1XX:10006,TIMER_H:10007,TIMER_I:10008,TIMER_G:10009,TIMER_L:10010,TIMER_X:10011,TRANSPORT_ERROR:10012,ERROR:10013},tsip_transac_ist_states_e={STARTED:0,PROCEEDING:1,COMPLETED:2,ACCEPTED:3,CONFIRMED:4,TERMINATED:5};tsip_transac_ist.prototype.start=function(_){var e=-1;return _&&!this.b_running&&(this.b_running=!0,e=this.fsm_act(tsip_transac_ist_actions_e.RECV_INVITE,_)),e},tsip_transac_ist.prototype.set_last_response=function(_){this.o_lastResponse=_},tsip_transac_layer.prototype.transac_new=function(_,e,t){if(!e||!e.o_hdr_CSeq||!e.o_hdr_Call_ID)return tsk_utils_log_error("Invalid argument"),null;for(var s=null;this.b_locked;);this.b_locked=!0;var i=!0;return this.o_stack.o_layer_transport.ao_transports.length>0&&(i=this.o_stack.o_layer_transport.ao_transports[0].is_reliable()),e&&e.is_request()&&(_?s=e.is_invite()?new tsip_transac_ict(i,e.o_hdr_CSeq.i_seq,e.o_hdr_Call_ID.s_value,t):new tsip_transac_nict(i,e.o_hdr_CSeq.i_seq,e.o_hdr_CSeq.s_method,e.o_hdr_Call_ID.s_value,t):(s=e.is_invite()?new tsip_transac_ist(i,e.o_hdr_CSeq.i_seq,e.o_hdr_Call_ID.s_value,t):new tsip_transac_nist(i,e.o_hdr_CSeq.i_seq,e.o_hdr_CSeq.s_method,e.o_hdr_Call_ID.s_value,t),s&&(s.s_branch=e.o_hdr_firstVia.s_branch)),s&&this.ao_transacs.push(s)),this.b_locked=!1,s},tsip_transac_layer.prototype.indexof=function(_){var e=-1;if(_){for(;this.b_locked;);this.b_locked=!0;for(var t=0;t<this.ao_transacs.length;++t)if(_==this.ao_transacs[t]){e=t;break}this.b_locked=!1}return e},tsip_transac_layer.prototype.remove=function(_){if(_){for(;this.b_locked;);this.b_locked=!0;for(var e=0;e<this.ao_transacs.length;++e)if(_==this.ao_transacs[e]){this.ao_transacs.splice(e,1);break}this.b_locked=!1}},tsip_transac_layer.prototype.cancel_by_dialog=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;for(var e=null;this.b_locked;);this.b_locked=!0;for(var t=0;t<this.ao_transacs.length;++t)e=this.ao_transacs[t],0==_.compare(e.get_dialog())&&setTimeout(function(){e.fsm_act(tsip_action_type_e.CANCEL,null)},1);return this.b_locked=!1,0},tsip_transac_layer.prototype.find_client=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),null;var e,t=null;if(!_.o_hdr_firstVia||!_.o_hdr_CSeq)return null;for(;this.b_locked;);this.b_locked=!0;for(var s=0;s<this.ao_transacs.length;++s)if(e=this.ao_transacs[s],e.s_branch==_.o_hdr_firstVia.s_branch&&e.s_cseq_method==_.o_hdr_CSeq.s_method){t=e;break}return this.b_locked=!1,t},tsip_transac_layer.prototype.find_server=function(_){var e,t=null;if(!_.o_hdr_firstVia||!_.o_hdr_CSeq||!_.o_hdr_Call_ID)return null;for(;this.b_locked;);this.b_locked=!0;for(var s=0;s<this.ao_transacs.length;++s)if(e=this.ao_transacs[s],_.is_ack()&&e.s_callid==_.o_hdr_Call_ID.s_value){if(tsk_string_iequals(e.s_cseq_method,"INVITE")&&_.o_hdr_CSeq.i_seq==e.i_cseq_value){t=e;break}}else if(tsk_string_equals(e.s_branch,_.o_hdr_firstVia.s_branch)){if(tsk_string_equals(e.s_cseq_method,_.o_hdr_CSeq.s_method)){t=e;break}if(_.is_cancel()||_.is_response_to_cancel()){t=e;break}}return this.b_locked=!1,t},tsip_transac_layer.prototype.handle_incoming_message=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),-1;var e=-1,t=null;return t=_.is_request()?this.find_server(_):this.find_client(_),t&&(e=t.callback(tsip_transac_event_type_e.INCOMING_MSG,_)),e},tsip_transac_nict.prototype=Object.create(tsip_transac.prototype),tsip_transac_nict.prototype.__b_debug_state_machine=!1;var tsip_transac_nict_actions_e={CANCEL:tsip_action_type_e.CANCEL,SEND:10001,TIMER_E:10002,TIMER_F:10003,TIMER_K:10004,I_1xx:10005,I_200_to_699:10006,TRANSPORT_ERROR:10007,ERROR:10008},tsip_transac_nict_states_e={STARTED:0,TRYING:1,PROCEEDING:2,COMPLETED:3,TERMINATED:4};tsip_transac_nict.prototype.start=function(_){var e=-1;return _&&!this.b_running&&(_.is_cancel()?this.s_branch=_.o_hdr_firstVia?_.o_hdr_firstVia.s_branch:"doubango":this.s_branch=tsk_string_format("{0}{1}",tsip_transac.prototype.__magic_cookie,tsk_string_random(32)),this.b_running=!0,this.o_request=_,e=this.fsm_act(tsip_transac_nict_actions_e.SEND,_)),e},tsip_transac_nist.prototype=Object.create(tsip_transac.prototype),tsip_transac_nist.prototype.__b_debug_state_machine=!1;var tsip_transac_nist_actions_e={CANCEL:tsip_action_type_e.CANCEL,RECV_REQUEST:10001,SEND_1XX:10002,SEND_200_to_699:10003,TIMER_J:10004,TRANSPORT_ERROR:10007,ERROR:10008},tsip_transac_nist_states_e={STARTED:0,TRYING:1,PROCEEDING:2,COMPLETED:3,TERMINATED:4};tsip_transac_nist.prototype.start=function(_){var e=-1;return _&&!this.b_running&&(this.b_running=!0,e=this.fsm_act(tsip_transac_nist_actions_e.RECV_REQUEST,_)),e};var tsip_transport_type_e={WS:0,WSS:1,TCP:2,TLS:3,UDP:4,SCTP:5,DTLS:6},tsip_transport_event_type_e={STARTED:0,STOPPED:1,ERROR:2};tsip_transport.prototype.get_layer=function(){return this.o_stack.o_layer_transport},tsip_transport.prototype.is_reliable=function(){return this.b_reliable},tsip_transport.prototype.start=function(){return this.b_started?(tsk_utils_log_warn("Already started"),0):this.__start()},tsip_transport.prototype.stop=function(){return this.b_started?this.__stop():(tsk_utils_log_warn("Not started"),0)},tsip_transport.prototype.get_local_ip=function(){return this.e_type==tsip_transport_type_e.WS||this.e_type==tsip_transport_type_e.WSS?"df7jal23ls0d.invalid":this.o_transport&&this.o_transport.localIP?this.o_transport.localIP:(tsk_utils_log_error("Not implemented"),"127.0.0.1")},tsip_transport.prototype.get_local_port=function(){return this.e_type==tsip_transport_type_e.WS||this.e_type==tsip_transport_type_e.WSS?-1:this.o_transport&&this.o_transport.localPort?this.o_transport.localPort:(tsk_utils_log_error("Not implemented"),5060)},tsip_transport.prototype.get_uri=function(_){var e=!1,t=tsk_string_format("{0}:{1}{2}{3}:{4};{5};transport={6}",this.s_scheme,e?"[":"",this.o_stack.network.aor.s_ip,e?"]":"",this.o_stack.network.aor.i_port,_?"lr":"",this.s_protocol),s=tsip_uri.prototype.Parse(t);return s&&(s.e_host_type=e?tsip_host_type_e.ipv6:tsip_host_type_e.ipv4),s},tsip_transport.prototype.have_socket=function(_){return this.__have_socket(_)},tsip_transport.prototype.send=function(_,e,t,s){var i=null;return!e.is_request()||e.is_ack()&&(!e.is_ack()||e.o_hdr_firstVia)||e.is_cancel()?e.is_response()&&(e.o_hdr_Contact&&this.message_update_aor(e),0==e.o_hdr_firstVia.i_rport&&(e.o_hdr_firstVia.i_rport=e.o_hdr_firstVia.i_port)):(this.message_addvia(_,e),this.message_update_aor(e),this.message_update(e)),i=e.toString(),tsk_utils_log_info("SEND: "+i),this.__send(i,i.length)},tsip_transport.prototype.signal=function(_,e,t){if(this.fn_callback){var s=this.fn_callback,i=new tsip_transport_event(this,_,e,t);setTimeout(function(){s(i)},1)}return 0},tsip_transport.prototype.message_addvia=function(_,e){return e.o_hdr_firstVia||(e.o_hdr_firstVia=new tsip_header_Via(tsip_header_Via.prototype.__s_proto_name_default,tsip_header_Via.prototype.__s_proto_version_default,this.s_via_protocol,this.get_local_ip(),this.get_local_port()),e.o_hdr_firstVia.add_param("rport",null)),_?e.o_hdr_firstVia.s_branch=_:e.o_hdr_firstVia.s_branch=tsk_string_format("{0}{1}",tsip_transac.prototype.__magic_cookie,tsk_string_random(20)),0},tsip_transport.prototype.message_update_aor=function(_){return _.b_update?(this.o_stack.network.aor.s_ip||this.o_stack.network.aor.i_port||(this.o_stack.network.aor.s_ip=this.get_local_ip(),this.o_stack.network.aor.i_port=this.get_local_port()),_.o_hdr_Contact&&_.o_hdr_Contact.o_uri&&(_.o_hdr_Contact.o_uri.s_scheme=this.s_scheme,_.o_hdr_Contact.o_uri.s_host=this.o_stack.network.aor.s_ip,_.o_hdr_Contact.o_uri.i_port=this.o_stack.network.aor.i_port,tsk_params_add(_.o_hdr_Contact.o_uri.ao_params,"transport",this.s_protocol)),0):0},tsip_transport.prototype.message_update=function(_){return _.b_update?(_.s_sigcomp_id&&(_.o_hdr_firstVia&&(_.o_hdr_firstVia.add_param("comp","sigcomp"),_.o_hdr_firstVia.add_param("sigcomp-id",tsk_string_format('"{0}"',_.s_sigcomp_id))),_.o_hdr_Contact&&_.o_hdr_Contact.o_uri&&tsk_params_add(_.o_hdr_Contact.o_uri.ao_params,"sigcomp-id",_.sigcomp_id)),_.b_update=!1,0):0},tsip_transport_layer.prototype.get_layer_transac=function(){return this.o_stack?this.o_stack.o_layer_transac:null},tsip_transport_layer.prototype.get_layer_dialog=function(){return this.o_stack?this.o_stack.o_layer_dialog:null},tsip_transport_layer.prototype.stop=function(){for(;this.b_locked;);this.b_locked=!0;for(var _=0;_<this.ao_transports.length;++_)this.ao_transports[_].stop();return this.b_locked=!1,0},tsip_transport_layer.prototype.send=function(_,e){var t=this.transport_find(e);return t&&t.o_transport?t.o_transport.send(_,e,t.s_dest_ip,t.i_dest_port):(tsk_utils_log_error("Failed to find transport"),0)},tsip_transport_layer.prototype.transport_new=function(_,e,t,s,i){for(var r=null;this.b_locked;);return this.b_locked=!0,r=new tsip_transport(_,this.o_stack,e,t,s,i),r&&this.ao_transports.push(r),this.b_locked=!1,r},tsip_transport_layer.prototype.transport_remove=function(_){if(_){for(;this.b_locked;);this.b_locked=!0;for(var e=0;e<this.ao_transports.length;++e)if(this.ao_transports[e]==_){this.ao_transports.splice(e,1);break}this.b_locked=!1}},tsip_transport_layer.prototype.transport_find=function(_){if(!_)return tsk_utils_log_error("Invalid argument"),null;var e=new tsip_transport_layer_find_result;if(e.s_dest_ip=this.o_stack.network.s_proxy_cscf_host,e.i_dest_port=this.o_stack.network.i_proxy_cscf_port,_.is_request()){for(var t=0;t<this.ao_transports.length;++t)if(this.ao_transports[t].e_type==this.o_stack.network.e_proxy_cscf_type){e.o_transport=this.ao_transports[t];break}}else if(_.o_hdr_firstVia){for(_.o_hdr_firstVia.is_transport_reliable()||_.o_hdr_firstVia.s_maddr||(_.o_hdr_firstVia.s_received?_.o_hdr_firstVia.i_rport>0?(e.s_dest_ip=_.o_hdr_firstVia.s_received,e.i_dest_port=_.o_hdr_firstVia.i_rport):(e.s_dest_ip=_.o_hdr_firstVia.s_received,e.i_dest_port=_.o_hdr_firstVia.i_port?_.o_hdr_firstVia.i_port:5060):_.o_hdr_firstVia.s_received||(e.s_dest_ip=_.o_hdr_firstVia.s_host,_.o_hdr_firstVia.i_port>0&&(e.i_dest_port=_.o_hdr_firstVia.i_port)));this.b_locked;);for(this.b_locked=!0,t=0;t<this.ao_transports.length;++t)if(this.ao_transports[t].have_socket(_.o_socket)){e.o_transport=this.ao_transports[t];break}this.b_locked=!1}return e},tsip_transport_layer.prototype.handle_incoming_message=function(_){if(_){var e=this.get_layer_transac();if(!e)return tsk_utils_log_error("Invalid transaction layer"),-1;var t;if(0!=(t=e.handle_incoming_message(_))){if(o_layer_dialog=this.get_layer_dialog(),!o_layer_dialog)return tsk_utils_log_error("Invalid dialog layer"),-1;t=o_layer_dialog.handle_incoming_message(_)}return t}return 0},SIPml={},SIPml.b_initialized=!1,SIPml.b_initializing=!1,SIPml.s_navigator_friendly_name="unknown",SIPml.b_navigator_outdated=!1,SIPml.s_navigator_version="unknown",SIPml.s_system_friendly_name="unknown",SIPml.b_webrtc4all_plugin_outdated=!1,SIPml.b_webrtc4all_supported=!1,SIPml.s_webrtc4all_version="unknown",SIPml.b_have_media_stream=!1,SIPml.b_webrtc_supported=!1,SIPml.setDebugLevel=function(_){tsk_utils_log_set_level("fatal"===_?1:"error"===_?2:"warn"===_?3:4)},SIPml.setWebRtcType=function(_){if(SIPml.isInitialized())throw new Error("ERR_ALREADY_INITIALIZED: Engine already initialized.");return WebRtc4all_SetType(_)},SIPml.getWebRtc4AllVersion=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.s_webrtc4all_version},SIPml.getNavigatorVersion=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.s_navigator_version},SIPml.getNavigatorFriendlyName=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.s_navigator_friendly_name},SIPml.getSystemFriendlyName=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.s_system_friendly_name},SIPml.isNavigatorOutdated=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.b_navigator_outdated},SIPml.isWebRtc4AllPluginOutdated=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.b_webrtc4all_plugin_outdated},SIPml.isWebRtc4AllSupported=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.b_webrtc4all_supported},SIPml.isScreenShareSupported=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return navigator.userAgent.match("Chrome")&&parseInt(navigator.userAgent.match(/Chrome\/(.*) /)[1])>=26},SIPml.isWebRtcSupported=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.b_webrtc_supported},SIPml.isWebSocketSupported=function(){return tsk_utils_have_websocket()},SIPml.haveMediaStream=function(){if(!SIPml.isInitialized())throw new Error("ERR_NOT_INITIALIZED: Engine not initialized yet. Please call 'SIPml.init()' first");return SIPml.b_have_media_stream},SIPml.isReady=function(){return SIPml.isInitialized()&&SIPml.isWebRtcSupported()&&SIPml.haveMediaStream()},SIPml.isInitialized=function(){return SIPml.b_initialized},SIPml.init=function(_,e){if(!SIPml.b_initialized&&!SIPml.b_initializing){if(SIPml.b_initializing=!0,tsk_utils_init_webrtc(),tsk_utils_log_info("User-Agent="+(navigator.userAgent||"unknown")),SIPml.b_have_media_stream=tsk_utils_have_stream(),SIPml.b_webrtc_supported=tsk_utils_have_webrtc(),SIPml.b_webrtc4all_supported=tsk_utils_have_webrtc4all(),SIPml.s_webrtc4all_version=tsk_utils_webrtc4all_get_version(),SIPml.s_navigator_friendly_name=tsk_utils_get_navigator_friendly_name(),SIPml.s_system_friendly_name=tsk_utils_get_system_friendly_name(),tsk_utils_log_info("WebSocket supported = "+(SIPml.isWebSocketSupported()?"yes":"no")),tsk_utils_have_webrtc4all()&&(tsk_utils_log_info("WebRTC type = "+WebRtc4all_GetType()+" version = "+tsk_utils_webrtc4all_get_version()),"1.35.981"!=SIPml.s_webrtc4all_version&&(SIPml.b_webrtc4all_plugin_outdated=!0)),tsk_utils_log_info("Navigator friendly name = "+SIPml.s_navigator_friendly_name),"ie"==SIPml.s_navigator_friendly_name){var t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=t.exec(navigator.userAgent)&&(SIPml.s_navigator_version=RegExp.$1)}if(tsk_utils_log_info("OS friendly name = "+SIPml.s_system_friendly_name),tsk_utils_log_info("Have WebRTC = "+(tsk_utils_have_webrtc()?"yes":"false")),tsk_utils_log_info("Have GUM = "+(tsk_utils_have_stream()?"yes":"false")),!tsk_utils_have_webrtc()){if("chrome"==SIPml.s_navigator_friendly_name)return void(SIPml.b_navigator_outdated=!0);if(("win"==SIPml.s_system_friendly_name||"windows"==SIPml.s_system_friendly_name)&&"ie"==SIPml.s_navigator_friendly_name){var s=-1,i=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(null!=t.exec(i)&&(s=parseFloat(RegExp.$1)),9>s)return void(SIPml.b_navigator_outdated=!0);if(!tsk_utils_have_webrtc4all())return}}if(SIPml.b_webrtc_supported&&SIPml.b_have_media_stream)SIPml.b_initialized=!0,SIPml.b_initializing=!1,tsk_utils_log_info("Engine initialized"),_&&_({});else if(e){var r=SIPml.b_webrtc_supported?SIPml.b_have_media_stream?"Internal error":"getUserMedia not supported":"WebRTC not supported";e({description:r})}}},SIPml.EventTarget=function(){this.ao_listeners=[]},SIPml.EventTarget.prototype.addEventListener=function(_,e){if(!e)throw new Error("ERR_INVALID_PARAMETER_VALUE: 'listener' must not be null");if(!_)throw new Error("ERR_INVALID_PARAMETER_VALUE: 'type' must not be null");if(!(_ instanceof String||"string"==typeof _||_ instanceof Array))throw new Error("ERR_INVALID_PARAMETER_TYPE: 'type' must be a string or array");if(_ instanceof Array){var t=this;_.forEach(function(_){!tsk_string_is_null_or_empty(_)&&tsk_string_is_string(_)&&(t.ao_listeners[_]=e)})}else this.ao_listeners[_]=e},SIPml.EventTarget.prototype.removeEventListener=function(_){tsk_string_is_string(_)&&!tsk_string_is_null_or_empty(_)&&(this.ao_listeners[_]=void 0)},SIPml.EventTarget.prototype.dispatchEvent=function(_){var e=this.ao_listeners[_.s_type]||this.ao_listeners["*"];e&&e.call(this,_.o_value)},SIPml.Event=function(_,e){this.type=_,this.description=e?e.s_phrase:_,this.o_event=e},SIPml.Event.prototype.getSipResponseCode=function(){var _=this.o_event?this.o_event.get_message():null;return _&&_.is_response()?_.get_response_code():-1},SIPml.Event.prototype.getContent=function(){var _=this.o_event?this.o_event.get_message():null;return _?_.get_content():null},SIPml.Event.prototype.getContentString=function(){var _=this.o_event?this.o_event.get_message():null;return _?_.get_content_as_string():null},SIPml.Event.prototype.getContentType=function(){var _=this.o_event?this.o_event.get_message():null;return _?_.get_content_type():null},SIPml.Stack=function(_){if(SIPml.init(),SIPml.EventTarget.call(this),!_)throw new Error("ERR_INVALID_PARAMETER_VALUE: null configuration value");if(tsk_string_is_null_or_empty(_.realm))throw new Error("ERR_INVALID_PARAMETER_VALUE: '"+_.realm+"' is not valid as realm value");if(tsk_string_is_null_or_empty(_.impi))throw new Error("ERR_INVALID_PARAMETER_VALUE: '"+_.impi+"' is not valid as impi value");if(tsk_string_is_null_or_empty(_.impu))throw new Error("ERR_INVALID_PARAMETER_VALUE: '"+_.impu+"' is not valid as impu value");var e=tsip_uri.prototype.Parse(_.impu);if(!e||!e.s_user_name||!e.s_host)throw new Error("ERR_INVALID_PARAMETER_VALUE: '"+_.impu+"' is not valid as SIP Uri");var t,s;SIPml.isWebSocketSupported()?(t=(_.enable_rtcweb_breaker?10062:10060)+(new Date).getTime()%5*1e3,s="ns313841.ovh.net"):(t=5060,s=_.realm),this.o_stack=new tsip_stack(_.realm,_.impi,_.impu,s,t),this.o_stack.oStack=this,this.setConfiguration(_),this.o_stack.on_event_stack=function(_){var e;switch(_.i_code){case tsip_event_code_e.STACK_STARTING:e="starting";break;case tsip_event_code_e.STACK_STARTED:e="started";break;case tsip_event_code_e.STACK_STOPPING:e="stopping";break;case tsip_event_code_e.STACK_STOPPED:e="stopped";break;case tsip_event_code_e.STACK_FAILED_TO_START:e="failed_to_start";break;case tsip_event_code_e.STACK_FAILED_TO_STOP:e="failed_to_stop"}e&&_.o_stack.oStack.dispatchEvent({s_type:e,o_value:new SIPml.Stack.Event(e,_)})},this.o_stack.on_event_dialog=function(_){var e=null,t=_.o_session.i_id,s=_.o_session.o_stack.oStack.ao_sessions[t];if(!s)return void tsk_utils_log_warn("Cannot find session with id = "+t);switch(_.i_code){case tsip_event_code_e.DIALOG_TRANSPORT_ERROR:e="transport_error";break;case tsip_event_code_e.DIALOG_GLOBAL_ERROR:e="global_error";break;case tsip_event_code_e.DIALOG_MESSAGE_ERROR:e="message_error";break;case tsip_event_code_e.DIALOG_WEBRTC_ERROR:e="webrtc_error";break;case tsip_event_code_e.DIALOG_REQUEST_INCOMING:e="i_request";break;case tsip_event_code_e.DIALOG_REQUEST_OUTGOING:e="o_request";break;case tsip_event_code_e.DIALOG_REQUEST_CANCELLED:e="cancelled_request";break;case tsip_event_code_e.DIALOG_REQUEST_SENT:e="sent_request";break;case tsip_event_code_e.DIALOG_MEDIA_ADDED:e="media_added";break;case tsip_event_code_e.DIALOG_MEDIA_REMOVED:e="media_removed";break;case tsip_event_code_e.DIALOG_CONNECTING:e="connecting";break;case tsip_event_code_e.DIALOG_CONNECTED:e="connected";break;case tsip_event_code_e.DIALOG_TERMINATING:e="terminating";break;case tsip_event_code_e.DIALOG_TERMINATED:e="terminated",_.o_session.o_stack.oStack.ao_sessions[t]=void 0}e&&s.dispatchEvent({s_type:e,o_value:new SIPml.Session.Event(s,e,_)})},this.o_stack.on_event_message=function(_){var e=null,t=_.o_session.i_id,s=_.o_session.o_stack.oStack.ao_sessions[t];switch(_.e_message_type){case tsip_event_message_type_e.I_MESSAGE:e="i_new_message";break;case tsip_event_message_type_e.AO_MESSAGE:e="i_ao_request"}if(e)if("i_new_message"==e){var i=new SIPml.Stack.Event(e,_);i.newSession=new SIPml.Session.Message(_.o_session),_.o_session.o_stack.oStack.ao_sessions[t]=i.newSession,_.o_session.o_stack.oStack.dispatchEvent({s_type:e,o_value:i})}else s?s.dispatchEvent({s_type:e,o_value:new SIPml.Session.Event(s,e,_)}):tsk_utils_log_warn("Cannot find session with id = "+t+" and event = "+_.e_invite_type)},this.o_stack.on_event_publish=function(_){var e=null,t=_.o_session.i_id,s=_.o_session.o_stack.oStack.ao_sessions[t];if(!s)return void tsk_utils_log_warn("Cannot find session with id = "+t+" and event = "+_.e_invite_type);switch(_.e_publish_type){case tsip_event_publish_type_e.I_PUBLISH:break;case tsip_event_publish_type_e.I_UNPUBLISH:break;case tsip_event_publish_type_e.AO_PUBLISH:case tsip_event_publish_type_e.AO_UNPUBLISH:e="i_ao_request"}e&&s.dispatchEvent({s_type:e,o_value:new SIPml.Session.Event(s,e,_)})},this.o_stack.on_event_subscribe=function(_){var e=null,t=_.o_session.i_id,s=_.o_session.o_stack.oStack.ao_sessions[t];if(!s)return void tsk_utils_log_warn("Cannot find session with id = "+t+" and event = "+_.e_invite_type);switch(_.e_subscribe_type){case tsip_event_subscribe_type_e.I_SUBSCRIBE:break;case tsip_event_subscribe_type_e.I_UNSUBSRIBE:break;case tsip_event_subscribe_type_e.AO_SUBSCRIBE:case tsip_event_subscribe_type_e.AO_UNSUBSCRIBE:case tsip_event_subscribe_type_e.AO_NOTIFY:e="i_ao_request";break;case tsip_event_subscribe_type_e.I_NOTIFY:e="i_notify"}e&&s.dispatchEvent({s_type:e,o_value:new SIPml.Session.Event(s,e,_)})},this.o_stack.on_event_invite=function(_){var e=null,t=_.o_session.i_id,s=_.o_session.o_stack.oStack.ao_sessions[t];if(!s)switch(_.e_invite_type){case tsip_event_invite_type_e.I_NEW_CALL:case tsip_event_invite_type_e.M_STREAM_LOCAL_REQUESTED:case tsip_event_invite_type_e.M_STREAM_LOCAL_ACCEPTED:case tsip_event_invite_type_e.M_STREAM_LOCAL_REFUSED:break;case tsip_event_invite_type_e.M_STREAM_LOCAL_ADDED:case tsip_event_invite_type_e.M_STREAM_REMOTE_ADDED:case tsip_event_invite_type_e.M_STREAM_LOCAL_REMOVED:case tsip_event_invite_type_e.M_STREAM_REMOTE_REMOVED:case tsip_event_invite_type_e.I_AO_REQUEST:return void tsk_utils_log_info("Not notifying to session with id = "+t+" for event = "+_.e_invite_type);default:return void tsk_utils_log_warn("Cannot find session with id = "+t+" and event = "+_.e_invite_type)}var i=function(_,e,t,s){if(e){if(!s&&e.videoTracks.length>0)return window.HTMLVideoElement&&_ instanceof window.HTMLVideoElement&&(_.src=t)&&_.play(),!0;if(s&&e.audioTracks.length>0)return window.HTMLAudioElement&&_ instanceof window.HTMLAudioElement&&(_.src=t)&&_.play(),!0}},r=function(e){var t=e?_.o_session.get_stream_local():_.o_session.get_stream_remote(),r=e?_.o_session.get_url_local():_.o_session.get_url_remote();i(e?s.videoLocal:s.videoRemote,t,r,!1)&&n(e?"m_stream_video_local_added":"m_stream_video_remote_added"),i(e?s.audioLocal:s.audioRemote,t,r,!0)&&n(e?"m_stream_audio_local_added":"m_stream_audio_remote_added")},a=function(e){var t=e?_.o_session.get_stream_local():_.o_session.get_stream_remote();i(e?s.videoLocal:s.videoRemote,t,null,!1)&&n(e?"m_stream_video_local_removed":"m_stream_video_remote_removed"),i(e?s.audioLocal:s.audioRemote,t,null,!0)&&n(e?"m_stream_audio_local_removed":"m_stream_audio_remote_removed")},n=function(e){if(e)switch(e){case"i_new_call":case"m_permission_requested":case"m_permission_accepted":case"m_permission_refused":var i=new SIPml.Stack.Event(e,_);"i_new_call"==e&&(i.newSession=new SIPml.Session.Call(_.o_session),_.o_session.o_stack.oStack.ao_sessions[t]=i.newSession),_.o_session.o_stack.oStack.dispatchEvent({s_type:e,o_value:i});break;default:s.dispatchEvent({s_type:e,o_value:new SIPml.Session.Event(s,e,_)})}};switch(_.e_invite_type){case tsip_event_invite_type_e.I_NEW_CALL:e="i_new_call";break;case tsip_event_invite_type_e.I_ECT_NEW_CALL:e="i_ect_new_call";break;case tsip_event_invite_type_e.I_AO_REQUEST:e="i_ao_request";break;case tsip_event_invite_type_e.M_EARLY_MEDIA:e="m_early_media";break;case tsip_event_invite_type_e.M_STREAM_LOCAL_REQUESTED:e="m_permission_requested";break;case tsip_event_invite_type_e.M_STREAM_LOCAL_ACCEPTED:e="m_permission_accepted";break;case tsip_event_invite_type_e.M_STREAM_LOCAL_REFUSED:e="m_permission_refused";break;case tsip_event_invite_type_e.M_STREAM_LOCAL_ADDED:return r(!0);case tsip_event_invite_type_e.M_STREAM_LOCAL_REMOVED:
return a(!0);case tsip_event_invite_type_e.M_STREAM_REMOTE_ADDED:return r(!1);case tsip_event_invite_type_e.M_STREAM_REMOTE_REMOVED:return a(!1);case tsip_event_invite_type_e.M_LOCAL_HOLD_OK:e="m_local_hold_ok";break;case tsip_event_invite_type_e.M_LOCAL_HOLD_NOK:e="m_local_hold_nok";break;case tsip_event_invite_type_e.M_LOCAL_RESUME_OK:e="m_local_resume_ok";break;case tsip_event_invite_type_e.M_LOCAL_RESUME_NOK:e="m_local_resume_nok";break;case tsip_event_invite_type_e.M_REMOTE_HOLD:e="m_remote_hold";break;case tsip_event_invite_type_e.M_REMOTE_RESUME:e="m_remote_resume";break;case tsip_event_invite_type_e.O_ECT_TRYING:e="o_ect_trying";break;case tsip_event_invite_type_e.O_ECT_ACCEPTED:e="o_ect_accepted";break;case tsip_event_invite_type_e.O_ECT_COMPLETED:e="o_ect_completed";break;case tsip_event_invite_type_e.I_ECT_COMPLETED:e="i_ect_completed";break;case tsip_event_invite_type_e.O_ECT_FAILED:e="o_ect_failed";break;case tsip_event_invite_type_e.I_ECT_FAILED:e="i_ect_failed";break;case tsip_event_invite_type_e.O_ECT_NOTIFY:e="o_ect_notify";break;case tsip_event_invite_type_e.I_ECT_NOTIFY:e="i_ect_notify";break;case tsip_event_invite_type_e.I_ECT_REQUESTED:e="i_ect_requested";break;case tsip_event_invite_type_e.DIALOG_REQUEST_INCOMING:_.o_message&&_.o_message.is_info()&&(e="i_info")}n(e)}},SIPml.Stack.prototype=Object.create(SIPml.EventTarget.prototype),SIPml.Stack.prototype.ao_sessions=[],SIPml.Stack.prototype.setConfiguration=function(_){if(_.realm&&!tsk_string_is_string(_.realm))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.realm+"' not a valid type for realm. String is expected");if(_.impi&&!tsk_string_is_string(_.impi))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.impi+"' not a valid type for impi. String is expected");if(_.impu&&!tsk_string_is_string(_.impu))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.impu+"' not a valid type for impu. String is expected");if(_.password&&!tsk_string_is_string(_.password))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.password+"' not a valid type for password. String is expected");if(_.display_name&&!tsk_string_is_string(_.display_name))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.display_name+"' not a valid type for display_name. String is expected");if(_.websocket_proxy_url&&!tsk_string_is_string(_.websocket_proxy_url))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.websocket_proxy_url+"' not a valid type for websocket_proxy_url. String is expected");if(_.outbound_proxy_url&&!tsk_string_is_string(_.outbound_proxy_url))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.outbound_proxy_url+"' not a valid type for outbound_proxy_url. String is expected");if(_.sip_headers&&"Array"!=typeof _.sip_headers&&!(_.sip_headers instanceof Array))throw new Error("ERR_INVALID_PARAMETER_TYPE: '"+typeof _.sip_headers+"' not a valid type for sip_headers. Array is expected");_.events_listener&&this.addEventListener(_.events_listener.events,_.events_listener.listener);var e=!!_.enable_rtcweb_breaker,t=!!_.enable_click2call,s=void 0==_.enable_early_ims?!0:!!_.enable_early_ims,i=!!_.enable_media_stream_cache,r=_.bandwidth?_.bandwidth:{audio:void 0,video:void 0},a=_.video_size?_.video_size:{minWidth:void 0,minHeight:void 0,maxWidth:void 0,maxHeight:void 0},n=_.audio_constraints?_.audio_constraints:{googEchoCancellation:void 0,googNoiseSuppression:void 0,googAutoGainControl:void 0},o=this.o_stack;return tsk_utils_log_info("s_websocket_server_url="+(_.websocket_proxy_url||"(null)")),tsk_utils_log_info("s_sip_outboundproxy_url="+(_.outbound_proxy_url||"(null)")),tsk_utils_log_info("b_rtcweb_breaker_enabled="+(e?"yes":"no")),tsk_utils_log_info("b_click2call_enabled="+(t?"yes":"no")),tsk_utils_log_info("b_early_ims="+(s?"yes":"no")),tsk_utils_log_info("b_enable_media_stream_cache="+(i?"yes":"no")),tsk_utils_log_info("o_bandwidth="+JSON.stringify(r)),tsk_utils_log_info("o_video_size="+JSON.stringify(a)),tsk_utils_log_info("o_audio_constraints="+JSON.stringify(n)),o.set(tsip_stack.prototype.SetPassword(_.password),tsip_stack.prototype.SetDigest(_.digest),tsip_stack.prototype.SetDisplayName(_.display_name),tsip_stack.prototype.SetProxyOutBoundUrl(_.outbound_proxy_url),tsip_stack.prototype.SetRTCWebBreakerEnabled(e),tsip_stack.prototype.SetClick2CallEnabled(t),tsip_stack.prototype.SetSecureTransportEnabled(e),tsip_stack.prototype.SetEarlyIMSEnabled(s),tsip_stack.prototype.SetWebsocketServerUrl(_.websocket_proxy_url),tsip_stack.prototype.SetIceServers(_.ice_servers),tsip_stack.prototype.SetMediaStreamCacheEnabled(i),tsip_stack.prototype.SetBandwidth(r),tsip_stack.prototype.SetVideoSize(a),tsip_stack.prototype.SetAudioConstraints(n)),_.sip_headers&&_.sip_headers.forEach(function(_){!_||tsk_string_is_null_or_empty(_.name)||_.value&&!tsk_string_is_string(_.value)||o.set(tsip_stack.prototype.SetHeader(_.name,_.value))}),0},SIPml.Stack.prototype.start=function(){return this.o_stack.start()},SIPml.Stack.prototype.stop=function(_){return this.o_stack.stop(_)},SIPml.Stack.prototype.newSession=function(_,e){var t,s;if("register"==_)t=new tsip_session_register(this.o_stack),s=SIPml.Session.Registration;else if("message"==_)t=new tsip_session_message(this.o_stack),s=SIPml.Session.Message;else if("publish"==_)t=new tsip_session_publish(this.o_stack),s=SIPml.Session.Publish;else if("subscribe"==_)t=new tsip_session_subscribe(this.o_stack),s=SIPml.Session.Subscribe;else{if("call-audio"!=_&&"call-audiovideo"!=_&&"call-video"!=_&&"call-screenshare"!=_)throw new Error("ERR_INVALID_PARAMETER_VALUE: '"+_+"' not valid as session type");t=new tsip_session_invite(this.o_stack),t.s_type=_,s=SIPml.Session.Call}t.b_local=!0;var i=new s(t,e);return this.ao_sessions[i.getId()]=i,i},SIPml.Stack.Event=function(_,e){SIPml.Event.call(this,_,e)},SIPml.Stack.Event.prototype=Object.create(SIPml.Event.prototype),SIPml.Session=function(_,e){if(SIPml.EventTarget.call(this),!_)throw new Error("ERR_INVALID_PARAMETER_VALUE: Invalid session value");this.o_session=_,this.setConfiguration(e)},SIPml.Session.prototype=Object.create(SIPml.EventTarget.prototype),SIPml.Session.prototype.o_session=null,SIPml.Session.prototype.o_session=null,SIPml.Session.prototype.o_configuration=null,SIPml.Session.prototype.getId=function(){return this.o_session.get_id()},SIPml.Session.prototype.setConfiguration=function(_){if(_){var e=this.o_session;if(_.events_listener&&this.addEventListener(_.events_listener.events,_.events_listener.listener),this instanceof SIPml.Session.Call){e.set(tsip_session.prototype.SetBandwidth(_.bandwidth?_.bandwidth:{audio:void 0,video:void 0}),tsip_session.prototype.SetVideoSize(_.video_size?_.video_size:{minWidth:void 0,minHeight:void 0,maxWidth:void 0,maxHeight:void 0}),tsip_session.prototype.SetAudioConstraints(_.audio_constraints?_.audio_constraints:{googEchoCancellation:void 0,googNoiseSuppression:void 0,googAutoGainControl:void 0})),this.videoLocal=_.video_local,this.videoRemote=_.video_remote,this.audioRemote=_.audio_remote,this.audioLocal=_.audio_local;var t=function(_,e,t,s){if(e){if(!s&&e.videoTracks.length>0){if(window.HTMLVideoElement&&_ instanceof window.HTMLVideoElement){if(_.src==t)return!1;(_.src=t)&&_.play()}return!0}if(s&&e.audioTracks.length>0){if(window.HTMLAudioElement&&_ instanceof window.HTMLAudioElement){if(_.src==t)return!1;(_.src=t)&&_.play()}return!0}}};t(this.videoLocal,e.get_stream_local(),e.get_url_local(),!1)&&this.dispatchEvent({s_type:"m_stream_video_local_added",o_value:new SIPml.Session.Event(this,"m_stream_video_local_added")}),t(this.videoRemote,e.get_stream_remote(),e.get_url_remote(),!1)&&this.dispatchEvent({s_type:"m_stream_video_remote_added",o_value:new SIPml.Session.Event(this,"m_stream_video_remote_added")}),t(this.audioLocal,e.get_stream_local(),e.get_url_local(),!0)&&this.dispatchEvent({s_type:"m_stream_audio_local_added",o_value:new SIPml.Session.Event(this,"m_stream_audio_local_added")}),t(this.audioRemote,e.get_stream_remote(),e.get_url_remote(),!0)&&this.dispatchEvent({s_type:"m_stream_audio_remote_added",o_value:new SIPml.Session.Event(this,"m_stream_audio_remote_added")})}_.sip_headers&&_.sip_headers.forEach(function(_){!_||tsk_string_is_null_or_empty(_.name)||_.value&&!tsk_string_is_string(_.value)||e.set(tsip_session.prototype.SetHeader(_.name,_.value))}),_.sip_caps&&_.sip_caps.forEach(function(_){!_||tsk_string_is_null_or_empty(_.name)||_.value&&!tsk_string_is_string(_.value)||e.set(tsip_session.prototype.SetCaps(_.name,_.value))}),_.expires&&e.set(tsip_session.prototype.SetExpires(_.expires)),_.from&&e.set(tsip_session.prototype.SetFromStr(_.from))}},SIPml.Session.prototype.getRemoteUri=function(){return(this.o_session.b_local?this.o_session.o_uri_to:this.o_session.o_uri_from).toString()},SIPml.Session.prototype.getRemoteFriendlyName=function(){var _=this.o_session.b_local?this.o_session.o_uri_to:this.o_session.o_uri_from;return _.s_display_name?_.s_display_name:_.s_user_name},SIPml.Session.prototype.reject=function(_){return this.setConfiguration(_),this.o_session.reject()},SIPml.Session.prototype.accept=function(_){return this.setConfiguration(_),this.o_session.accept()},SIPml.Session.Event=function(_,e,t){SIPml.Event.call(this,e,t),this.session=_},SIPml.Session.Event.prototype=Object.create(SIPml.Event.prototype),SIPml.Session.Event.prototype.getTransferDestinationFriendlyName=function(){var _=this.o_event?this.o_event.get_message():null;if(_){var e=_.get_header(tsip_header_type_e.Refer_To);if(e&&e.o_uri)return e.s_display_name?e.s_display_name:e.o_uri.s_user_name}return null},SIPml.Session.Registration=function(_,e){SIPml.Session.call(this,_,e)},SIPml.Session.Registration.prototype=Object.create(SIPml.Session.prototype),SIPml.Session.Registration.prototype.register=function(_){return this.setConfiguration(_),this.o_session.register()},SIPml.Session.Registration.prototype.unregister=function(_){return this.setConfiguration(_),this.o_session.unregister()},SIPml.Session.Call=function(_,e){switch(SIPml.Session.call(this,_,e),_.s_type){case"call-audio":this.mediaType=tmedia_type_e.AUDIO;break;case"call-audiovideo":this.mediaType=tmedia_type_e.AUDIO_VIDEO;break;case"call-video":this.mediaType=tmedia_type_e.VIDEO;break;case"call-screenshare":this.mediaType=tmedia_type_e.SCREEN_SHARE}},SIPml.Session.Call.prototype=Object.create(SIPml.Session.prototype),SIPml.Session.Call.prototype.videoLocal=null,SIPml.Session.Call.prototype.videoRemote=null,SIPml.Session.Call.prototype.call=function(_,e){if(tsk_string_is_null_or_empty(_))throw new Error("ERR_INVALID_PARAMETER_VALUE: 'to' must not be null");if(!SIPml.haveMediaStream())throw new Error("ERR_NOT_READY: Media engine not ready yet");return this.o_session.set(tsip_session.prototype.SetToStr(_)),this.setConfiguration(e),this.o_session.call(this.mediaType)},SIPml.Session.Call.prototype.hangup=function(_){return this.setConfiguration(_),this.o_session.hangup()},SIPml.Session.Call.prototype.hold=function(_){return this.setConfiguration(_),this.o_session.hold(this.mediaType)},SIPml.Session.Call.prototype.resume=function(_){return this.setConfiguration(_),this.o_session.resume(this.mediaType)},SIPml.Session.Call.prototype.info=function(_,e,t){return this.setConfiguration(t),this.o_session.info(_,e)},SIPml.Session.Call.prototype.dtmf=function(_,e){return this.setConfiguration(e),this.o_session.dtmf(_)},SIPml.Session.Call.prototype.transfer=function(_,e){return this.setConfiguration(e),this.o_session.transfer(_)},SIPml.Session.Call.prototype.acceptTransfer=function(_){return this.setConfiguration(_),this.o_session.transfer_accept()},SIPml.Session.Call.prototype.rejectTransfer=function(_){return this.setConfiguration(_),this.o_session.transfer_reject()},SIPml.Session.Message=function(_,e){SIPml.Session.call(this,_,e)},SIPml.Session.Message.prototype=Object.create(SIPml.Session.prototype),SIPml.Session.Message.prototype.send=function(_,e,t,s){if(tsk_string_is_null_or_empty(_))throw new Error("ERR_INVALID_PARAMETER_VALUE: 'to' must not be null");return this.setConfiguration(s),this.o_session.set(tsip_session.prototype.SetToStr(_)),this.o_session.send(e,t)},SIPml.Session.Publish=function(_,e){SIPml.Session.call(this,_,e),_.set(tsip_session.prototype.SetToUri(_.get_stack().identity.o_uri_impu))},SIPml.Session.Publish.prototype=Object.create(SIPml.Session.prototype),SIPml.Session.Publish.prototype.publish=function(_,e,t){return this.setConfiguration(t),this.o_session.publish(_,e)},SIPml.Session.Publish.prototype.unpublish=function(_){return this.setConfiguration(_),this.o_session.unpublish()},SIPml.Session.Subscribe=function(_,e){SIPml.Session.call(this,_,e)},SIPml.Session.Subscribe.prototype=Object.create(SIPml.Session.prototype),SIPml.Session.Subscribe.prototype.subscribe=function(_,e){if(tsk_string_is_null_or_empty(_))throw new Error("ERR_INVALID_PARAMETER_VALUE: 'to' must not be null");return this.o_session.set(tsip_session.prototype.SetToStr(_)),this.setConfiguration(e),this.o_session.subscribe()},SIPml.Session.Subscribe.prototype.unsubscribe=function(_){return this.setConfiguration(_),this.o_session.unsubscribe()};